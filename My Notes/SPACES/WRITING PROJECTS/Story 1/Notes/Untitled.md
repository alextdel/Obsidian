## Table of Contents

- [Grav Documentation](#grav-documentation)
  - [Table of Contents](#table-of-contents)
  - [Grav Documentation](#grav-documentation)
- [Grav Documentation](#grav-documentation)
  - [Table of Contents](#table-of-contents)
  - [Grav's Place in the Universe](#grav's-place-in-the-universe)
  - [Grav's Place in the Universe](#grav's-place-in-the-universe)
    - [Grav Logos and Press Information](#grav-logos-and-press-information)
  - [Web Servers](#web-servers)
  - [Web Servers](#web-servers)
    - [Mac](#mac)
    - [Windows](#windows)
    - [Linux](#linux)
    - [Apache Requirements](#apache-requirements)
    - [IIS Requirements](#iis-requirements)
    - [PHP Requirements](#php-requirements)
        - [Optional Modules](#optional-modules)
    - [Permissions](#permissions)
  - [Recommended Tools](#recommended-tools)
    - [PhpStorm](#phpstorm)
    - [Text Editors](#text-editors)
    - [Markdown Editors](#markdown-editors)
    - [FTP Clients](#ftp-clients)
    - [Git](#git)
  - [Check for PHP version](#check-for-php-version)
  - [Check for PHP version](#check-for-php-version)
  - [Option 1: Install from ZIP package](#option-1:-install-from-zip-package)
  - [Option 2: Install with composer](#option-2:-install-with-composer)
  - [Option 3: Install from GitHub](#option-3:-install-from-github)
  - [Further options](#further-options)
    - [Install with Docker](#install-with-docker)
    - [Install on Cloudron](#install-on-cloudron)
    - [Install through Linode Marketplace](#install-through-linode-marketplace)
  - [Webservers](#webservers)
      - [Apache/IIS/Nginx](#apache/iis/nginx)
      - [Running Grav with the Built-in PHP Webserver](#running-grav-with-the-built-in-php-webserver)
  - [Successful Installation](#successful-installation)
  - [Installation & Setup Problems](#installation-&-setup-problems)
  - [Grav Updates](#grav-updates)
  - [Content Basics](#content-basics)
  - [Content Basics](#content-basics)
  - [Home Page Configuration](#home-page-configuration)
  - [Page Editing](#page-editing)
- [Say Hello to Grav!](#say-hello-to-grav!)
  - [installation successful...](#installation-successful)
- [Say Hello to Grav!](#say-hello-to-grav!)
  - [installation successful...](#installation-successful)
  - [Adding a New Page](#adding-a-new-page)
- [My New Page!](#my-new-page!)
  - [System Configuration](#system-configuration)
  - [System Configuration](#system-configuration)
    - [Basic Options](#basic-options)
    - [Languages](#languages)
    - [Home](#home)
    - [Pages](#pages)
    - [Cache](#cache)
    - [Twig](#twig)
    - [Assets](#assets)
    - [Errors](#errors)
    - [Log](#log)
    - [Debugger](#debugger)
    - [Images](#images)
    - [Media](#media)
    - [Session](#session)
    - [GPM](#gpm)
    - [Accounts](#accounts)
    - [Flex](#flex)
    - [Strict Mode](#strict-mode)
  - [Site Configuration](#site-configuration)
- [ '/redirect-test': '/'                    # Redirect test goes to home page](#-'/redirect-test':-'/'--------------------#-redirect-test-goes-to-home-page)
- [ '/old/(.*)': '/new/$1'                   # Would redirect /old/my-page to /new/my-page](#-'/old/(*)':-'/new/$1'-------------------#-would-redirect-/old/my-page-to-/new/my-page)
- [ '/something/else': '/blog/sample-3'      # Alias for /blog/sample-3](#-'/something/else':-'/blog/sample-3'------#-alias-for-/blog/sample-3)
- [ '/new/(.*)': '/blog/$1'                  # Regex any /new/my-page URL to /blog/my-page Route](#-'/new/(*)':-'/blog/$1'------------------#-regex-any-/new/my-page-url-to-/blog/my-page-route)
- [   - text: Source](#-----text:-source)
- [     icon: github](#-----icon:-github)
- [     url: https://github.com/getgrav/grav](#-----url:-https://githubcom/getgrav/grav)
- [   - icon: twitter](#-----icon:-twitter)
- [     url: http://twitter.com/getgrav](#-----url:-http://twittercom/getgrav)
  - [Security](#security)
  - [Other Configuration Settings and Files](#other-configuration-settings-and-files)
    - [Config Variable Namespacing](#config-variable-namespacing)
    - [Plugins Configuration](#plugins-configuration)
    - [Themes Configuration](#themes-configuration)
  - [System Configuration](#system-configuration)
  - [System Configuration](#system-configuration)
    - [Basic Options](#basic-options)
    - [Languages](#languages)
    - [Home](#home)
    - [Pages](#pages)
    - [Cache](#cache)
    - [Twig](#twig)
    - [Assets](#assets)
    - [Errors](#errors)
    - [Log](#log)
    - [Debugger](#debugger)
    - [Images](#images)
    - [Media](#media)
    - [Session](#session)
    - [GPM](#gpm)
    - [Accounts](#accounts)
    - [Strict Mode](#strict-mode)
  - [Site Configuration](#site-configuration)
- [ '/redirect-test': '/'                    # Redirect test goes to home page](#-'/redirect-test':-'/'--------------------#-redirect-test-goes-to-home-page)
- [ '/old/(.*)': '/new/$1'                   # Would redirect /old/my-page to /new/my-page](#-'/old/(*)':-'/new/$1'-------------------#-would-redirect-/old/my-page-to-/new/my-page)
- [ '/something/else': '/blog/sample-3'      # Alias for /blog/sample-3](#-'/something/else':-'/blog/sample-3'------#-alias-for-/blog/sample-3)
- [ '/new/(.*)': '/blog/$1'                  # Regex any /new/my-page URL to /blog/my-page Route](#-'/new/(*)':-'/blog/$1'------------------#-regex-any-/new/my-page-url-to-/blog/my-page-route)
- [   - text: Source](#-----text:-source)
- [     icon: github](#-----icon:-github)
- [     url: https://github.com/getgrav/grav](#-----url:-https://githubcom/getgrav/grav)
- [   - icon: twitter](#-----icon:-twitter)
- [     url: http://twitter.com/getgrav](#-----url:-http://twittercom/getgrav)
  - [Security](#security)
  - [Other Configuration Settings and Files](#other-configuration-settings-and-files)
    - [Config Variable Namespacing](#config-variable-namespacing)
    - [Plugins Configuration](#plugins-configuration)
    - [Themes Configuration](#themes-configuration)
  - [/assets](#/assets)
    - [/assets](#/assets)
    - [/backup](#/backup)
    - [/bin](#/bin)
    - [/cache](#/cache)
    - [/images](#/images)
    - [/logs](#/logs)
    - [/system](#/system)
    - [/tmp](#/tmp)
    - [/vendor](#/vendor)
    - [/user](#/user)
    - [/user/accounts](#/user/accounts)
    - [/user/blueprints](#/user/blueprints)
    - [/user/config](#/user/config)
    - [/user/data](#/user/data)
    - [/user/images](#/user/images)
    - [/user/languages](#/user/languages)
    - [/user/pages](#/user/pages)
    - [/user/plugins](#/user/plugins)
    - [/user/themes](#/user/themes)
  - [Forum](#forum)
  - [Forum](#forum)
  - [Twitter](#twitter)
  - [Grav Blog](#grav-blog)
  - [GitHub Issues](#github-issues)
  - [Chat on Discord](#chat-on-discord)
  - [Which version do I have?](#which-version-do-i-have?)
    - [Which version do I have?](#which-version-do-i-have?)
    - [Upgrading from Grav 1.5 or older version](#upgrading-from-grav-15-or-older-version)
    - [Upgrading to the Next Version](#upgrading-to-the-next-version)
    - [Grav CMS Updates](#grav-cms-updates)
    - [Plugin and Theme Updates](#plugin-and-theme-updates)
  - [Chapter 1](#chapter-1)
    - [Chapter 1](#chapter-1)
- [Basics](#basics)
  - [Regular Page](#regular-page)
      - [Regular Page](#regular-page)
      - [Listing Page](#listing-page)
      - [Modular Page](#modular-page)
  - [Folders](#folders)
  - [Ordering](#ordering)
  - [Page File](#page-file)
- [Page Title](#page-title)
    - [Summary Size and Separator](#summary-size-and-separator)
    - [Finding other Pages](#finding-other-pages)
- [All Projects](#all-projects)
    - [contentMeta](#contentmeta)
  - [Basic Page Headers](#basic-page-headers)
  - [Basic Page Headers](#basic-page-headers)
    - [Cache Enable](#cache-enable)
    - [Date](#date)
    - [Menu](#menu)
    - [Published](#published)
    - [Slug](#slug)
    - [Taxonomy](#taxonomy)
    - [Title](#title)
  - [Advanced Headers](#advanced-headers)
    - [Append URL extension](#append-url-extension)
    - [Cache-Control](#cache-control)
    - [Date Format](#date-format)
    - [Debugger](#debugger)
    - [ETag](#etag)
    - [Expires](#expires)
    - [External Url](#external-url)
    - [HTTP Response Code](#http-response-code)
    - [Language](#language)
    - [LastModified](#lastmodified)
    - [Lightbox](#lightbox)
    - [Login Redirect Here](#login-redirect-here)
    - [Markdown](#markdown)
    - [Never Cache Twig](#never-cache-twig)
    - [Process](#process)
    - [Process Twig First](#process-twig-first)
    - [Publish Date](#publish-date)
    - [Redirect](#redirect)
    - [Routes](#routes)
    - [Routable](#routable)
    - [SSL](#ssl)
    - [Summary](#summary)
    - [Template](#template)
    - [Template Format](#template-format)
    - [Unpublish Date](#unpublish-date)
    - [Visible](#visible)
  - [Custom Page Headers](#custom-page-headers)
  - [Meta Page Headers](#meta-page-headers)
      - [Standard Metatag examples](#standard-metatag-examples)
      - [OpenGraph Metatag examples](#opengraph-metatag-examples)
      - [Facebook Metatag examples](#facebook-metatag-examples)
      - [Twitter Metatag examples](#twitter-metatag-examples)
  - [Frontmatter.yaml](#frontmatteryaml)
  - [Collection Object](#collection-object)
  - [Collection Object](#collection-object)
  - [Example Collection Definition](#example-collection-definition)
  - [Accessing Collections in Twig](#accessing-collections-in-twig)
  - [Collection Headers](#collection-headers)
    - [Summary of collection options](#summary-of-collection-options)
  - [Root Collections](#root-collections)
        - [@root.pages - Top level pages](#@rootpages---top-level-pages)
        - [@root.descendants - All the pages](#@rootdescendants---all-the-pages)
        - [@root.all - All the pages and modules](#@rootall---all-the-pages-and-modules)
  - [Self Collections](#self-collections)
        - [@self.page - Current page only](#@selfpage---current-page-only)
        - [@self.parent - The parent page of the current page](#@selfparent---the-parent-page-of-the-current-page)
        - [@self.siblings - Siblings of the current page](#@selfsiblings---siblings-of-the-current-page)
        - [@self.children - Children of the current page](#@selfchildren---children-of-the-current-page)
        - [@self.modules - Modules of the current page](#@selfmodules---modules-of-the-current-page)
        - [@self.all - Children and modules of the current page](#@selfall---children-and-modules-of-the-current-page)
        - [@self.descendants - Children + all descendants of the current page](#@selfdescendants---children-+-all-descendants-of-the-current-page)
  - [Page Collections](#page-collections)
        - [@page.page - Collection of just the specific page](#@pagepage---collection-of-just-the-specific-page)
        - [@page.parent - The parent page of a specific page](#@pageparent---the-parent-page-of-a-specific-page)
        - [@page.siblings - Siblings of a specific page](#@pagesiblings---siblings-of-a-specific-page)
        - [@page.children - Children of a specific page](#@pagechildren---children-of-a-specific-page)
        - [@page.modules - Modules of a specific page](#@pagemodules---modules-of-a-specific-page)
        - [@page.all - Children and modules of a specific page](#@pageall---children-and-modules-of-a-specific-page)
        - [@page.descendants - Collection of children + all descendants of a specific page](#@pagedescendants---collection-of-children-+-all-descendants-of-a-specific-page)
  - [Taxonomy Collections](#taxonomy-collections)
    - [Complex Collections](#complex-collections)
  - [Ordering Options](#ordering-options)
    - [Date Range](#date-range)
    - [Multiple Collections](#multiple-collections)
  - [Collection Object Methods](#collection-object-methods)
  - [Programmatic Collections](#programmatic-collections)
    - [PHP Collections](#php-collections)
      - [Advanced Collections](#advanced-collections)
      - [Pagination with Advanced Collections](#pagination-with-advanced-collections)
      - [Custom Collection Handling with `onCollectionProcessed()` Event](#custom-collection-handling-with-`oncollectionprocessed()`-event)
  - [Basics of Grav Collections](#basics-of-grav-collections)
  - [Basics of Grav Collections](#basics-of-grav-collections)
  - [Collection Object](#collection-object)
  - [Example Collection Definition](#example-collection-definition)
  - [Accessing Collections in Twig](#accessing-collections-in-twig)
  - [Collection Headers](#collection-headers)
    - [Summary of collection options](#summary-of-collection-options)
  - [Root Collections](#root-collections)
        - [@root - Top level children](#@root---top-level-children)
        - [@root - Top level children + all descendants](#@root---top-level-children-+-all-descendants)
  - [Self Collections](#self-collections)
        - [@self.children - Children of the current page](#@selfchildren---children-of-the-current-page)
        - [@self.descendants - Non-modular children + all descendants of the current page](#@selfdescendants---non-modular-children-+-all-descendants-of-the-current-page)
        - [@self.modular - Modular children of the current page](#@selfmodular---modular-children-of-the-current-page)
        - [@self.parent - The parent page of the current page](#@selfparent---the-parent-page-of-the-current-page)
        - [@self.siblings - All the sibling pages](#@selfsiblings---all-the-sibling-pages)
  - [Page Collections](#page-collections)
        - [@page or @page.children - Collection of children of a specific page](#@page-or-@pagechildren---collection-of-children-of-a-specific-page)
        - [@page.self or @page.page - Collection of just the specific page](#@pageself-or-@pagepage---collection-of-just-the-specific-page)
        - [@page.descendants - Collection of children + all descendants of a specific page](#@pagedescendants---collection-of-children-+-all-descendants-of-a-specific-page)
        - [@page.modular - Collection of modular children of a specific page](#@pagemodular---collection-of-modular-children-of-a-specific-page)
  - [Taxonomy Collections](#taxonomy-collections)
    - [Complex Collections](#complex-collections)
    - [Ordering Options](#ordering-options)
    - [Date Range](#date-range)
    - [Multiple Collections](#multiple-collections)
  - [Collection Object Methods](#collection-object-methods)
  - [Programmatic Collections](#programmatic-collections)
    - [PHP Collections](#php-collections)
      - [Advanced Collections](#advanced-collections)
      - [Pagination with Advanced Collections](#pagination-with-advanced-collections)
      - [Custom Collection Handling with `onCollectionProcessed()` Event](#custom-collection-handling-with-`oncollectionprocessed()`-event)
  - [Headings](#headings)
  - [Headings](#headings)
- [h1 Heading](#h1-heading)
  - [h2 Heading](#h2-heading)
    - [h3 Heading](#h3-heading)
      - [h4 Heading](#h4-heading)
        - [h5 Heading](#h5-heading)
          - [h6 Heading](#h6-heading)
- [h1 Heading](#h1-heading)
  - [h2 Heading](#h2-heading)
    - [h3 Heading](#h3-heading)
      - [h4 Heading](#h4-heading)
        - [h5 Heading](#h5-heading)
          - [h6 Heading](#h6-heading)
  - [Comments](#comments)
  - [Horizontal Rules](#horizontal-rules)
  - [Slug Relative](#slug-relative)
    - [Slug Relative](#slug-relative)
    - [Directory relative](#directory-relative)
    - [Absolute](#absolute)
    - [Remote](#remote)
    - [Link Attributes](#link-attributes)
        - [Class/Classes Attribute](#class/classes-attribute)
        - [ID Attribute](#id-attribute)
        - [Rel Attribute](#rel-attribute)
        - [Target Attribute](#target-attribute)
        - [Attribute Combinations](#attribute-combinations)
        - [Attribute Combinations with Anchors](#attribute-combinations-with-anchors)
        - [Anchor Links on the Same Page](#anchor-links-on-the-same-page)
        - [Pass-through of Non-Supported Attributes](#pass-through-of-non-supported-attributes)
        - [Skip All Attributes](#skip-all-attributes)
        - [Skip Certain Attributes](#skip-certain-attributes)
  - [Slug Relative](#slug-relative)
    - [Slug Relative](#slug-relative)
    - [Directory relative](#directory-relative)
    - [Absolute](#absolute)
    - [PHP Streams](#php-streams)
    - [Remote](#remote)
    - [Media Actions on Images](#media-actions-on-images)
    - [Image Attributes](#image-attributes)
        - [Single Class Attribute](#single-class-attribute)
        - [Multiple Classes Attributes](#multiple-classes-attributes)
        - [ID Attribute](#id-attribute)
  - [Supported Media Files](#supported-media-files)
  - [Supported Media Files](#supported-media-files)
  - [Where to put your media files](#where-to-put-your-media-files)
  - [Display modes](#display-modes)
  - [Thumbnail Location](#thumbnail-location)
  - [Links and Lightboxes](#links-and-lightboxes)
  - [Actions](#actions)
    - [General](#general)
      - [url](#url)
      - [html](#html)
      - [display](#display)
      - [link](#link)
      - [Cache only](#cache-only)
      - [lightbox](#lightbox)
        - [Result:](#result:)
      - [thumbnail](#thumbnail)
        - [Result:](#result:)
      - [attribute](#attribute)
  - [Image Actions](#image-actions)
      - [resize](#resize)
        - [Result:](#result:)
      - [forceResize](#forceresize)
        - [Result:](#result:)
      - [cropResize](#cropresize)
        - [Result:](#result:)
      - [crop](#crop)
        - [Result:](#result:)
      - [cropZoom](#cropzoom)
        - [Result:](#result:)
      - [quality](#quality)
        - [Result:](#result:)
      - [negate](#negate)
        - [Result:](#result:)
      - [brightness](#brightness)
        - [Result:](#result:)
      - [contrast](#contrast)
      - [grayscale](#grayscale)
        - [Result:](#result:)
      - [emboss](#emboss)
        - [Result:](#result:)
      - [smooth](#smooth)
        - [Result:](#result:)
      - [sharp](#sharp)
        - [Result:](#result:)
      - [edge](#edge)
        - [Result:](#result:)
      - [colorize](#colorize)
        - [Result:](#result:)
      - [sepia](#sepia)
        - [Result:](#result:)
      - [gaussianBlur](#gaussianblur)
        - [Result:](#result:)
      - [rotate](#rotate)
        - [Result:](#result:)
      - [flip](#flip)
        - [Result:](#result:)
      - [fixOrientation](#fixorientation)
      - [watermark](#watermark)
        - [Result:](#result:)
      - [loading](#loading)
      - [decoding](#decoding)
      - [fetchpriority](#fetchpriority)
  - [Animated / Vectorized Actions](#animated-/-vectorized-actions)
      - [resize](#resize)
      - [examples](#examples)
  - [Audio Actions](#audio-actions)
        - [Result:](#result:)
      - [controls](#controls)
      - [preload](#preload)
      - [autoplay](#autoplay)
      - [controlsList](#controlslist)
      - [muted](#muted)
      - [loop](#loop)
  - [File Actions](#file-actions)
        - [Result:](#result:)
    - [Combinations](#combinations)
        - [Result:](#result:)
      - [Resetting multiple calls to the same image](#resetting-multiple-calls-to-the-same-image)
    - [Responsive images](#responsive-images)
      - [Higher density displays](#higher-density-displays)
        - [Result:](#result:)
        - [Sizes with media queries](#sizes-with-media-queries)
        - [Result:](#result:)
        - [Sizes with media queries using derivatives](#sizes-with-media-queries-using-derivatives)
        - [Result:](#result:)
      - [Manual size definition](#manual-size-definition)
  - [Metafiles](#metafiles)
  - [Video Options](#video-options)
  - [Taxonomy Example](#taxonomy-example)
  - [Taxonomy Example](#taxonomy-example)
  - [Taxonomy based Collections](#taxonomy-based-collections)
  - [Adding Custom Taxonomy Values in Default and Options](#adding-custom-taxonomy-values-in-default-and-options)
  - [What are Modular Pages and what are they not?](#what-are-modular-pages-and-what-are-they-not?)
  - [What are Modular Pages and what are they not?](#what-are-modular-pages-and-what-are-they-not?)
  - [Example Folder Structure](#example-folder-structure)
  - [Setting Up the Primary Page](#setting-up-the-primary-page)
  - [Modules](#modules)
  - [Content Unchained](#content-unchained)
  - [Page Level Route and Redirect Overrides](#page-level-route-and-redirect-overrides)
  - [Page Level Route and Redirect Overrides](#page-level-route-and-redirect-overrides)
  - [Site Level Routes and Redirects](#site-level-routes-and-redirects)
    - [Route Aliases](#route-aliases)
      - [Simple Aliases](#simple-aliases)
      - [Regex-Based Aliases](#regex-based-aliases)
    - [Redirects](#redirects)
  - [Hiding the Home Route](#hiding-the-home-route)
  - [Single language different than English](#single-language-different-than-english)
  - [Single language different than English](#single-language-different-than-english)
  - [Multi-Language Basics](#multi-language-basics)
    - [Language Configuration](#language-configuration)
    - [Multiple Language Pages](#multiple-language-pages)
    - [Active Language via URL](#active-language-via-url)
    - [Active Language via Browser](#active-language-via-browser)
    - [Session-Based Active Language](#session-based-active-language)
    - [Set Locale to the Active Language](#set-locale-to-the-active-language)
    - [Default Language Prefix](#default-language-prefix)
    - [Default File Extension](#default-file-extension)
    - [Multi-Language Routing](#multi-language-routing)
    - [Language-Based Homepage](#language-based-homepage)
    - [Language-Based Twig Templates](#language-based-twig-templates)
    - [Translation via Twig](#translation-via-twig)
    - [Translations with Variables](#translations-with-variables)
    - [Complex Translations](#complex-translations)
    - [PHP Translations](#php-translations)
    - [Plugin and Theme Language Translations](#plugin-and-theme-language-translations)
    - [Translation Overrides](#translation-overrides)
  - [Advanced](#advanced)
    - [Environment-Based Language Handling](#environment-based-language-handling)
    - [Language Alias Routes](#language-alias-routes)
  - [Translation Support](#translation-support)
    - [Language Switcher](#language-switcher)
    - [Setup with Language Specific Domains](#setup-with-language-specific-domains)
- [http://www.cheat-sheets.org/saved-copy/mod_rewrite_cheat_sheet.pdf](#http://wwwcheat-sheetsorg/saved-copy/mod_rewrite_cheat_sheetpdf)
- [http://www.workingwith.me.uk/articles/scripting/mod_rewrite](#http://wwwworkingwithmeuk/articles/scripting/mod_rewrite)
- [handle top level e.g. http://grav-site.com/de](#handle-top-level-eg-http://grav-sitecom/de)
- [handle sub pages, exclude admin path](#handle-sub-pages,-exclude-admin-path)
- [http://www.cheat-sheets.org/saved-copy/mod_rewrite_cheat_sheet.pdf](#http://wwwcheat-sheetsorg/saved-copy/mod_rewrite_cheat_sheetpdf)
- [http://www.workingwith.me.uk/articles/scripting/mod_rewrite](#http://wwwworkingwithmeuk/articles/scripting/mod_rewrite)
- [Redirect top-level URLs](#redirect-top-level-urls)
- [Redirect sub-pages, excluding the admin path](#redirect-sub-pages,-excluding-the-admin-path)
    - [Language Logic in Twig Templates](#language-logic-in-twig-templates)
  - [Default Content Type](#default-content-type)
  - [Default Content Type](#default-content-type)
  - [Other Content Types](#other-content-types)
    - [Example with JSON files](#example-with-json-files)
  - [Custom Content Types](#custom-content-types)
  - [Chapter 2](#chapter-2)
    - [Chapter 2](#chapter-2)
- [Content](#content)
  - [Content Pages & Twig Templates](#content-pages-&-twig-templates)
  - [Content Pages & Twig Templates](#content-pages-&-twig-templates)
  - [Theme Organization](#theme-organization)
    - [Definition & Configuration](#definition-&-configuration)
    - [Templates](#templates)
    - [SCSS / LESS / CSS](#scss-/-less-/-css)
    - [Blueprints](#blueprints)
    - [Theme and Plugin Events](#theme-and-plugin-events)
    - [Other Folders](#other-folders)
  - [Theme Example](#theme-example)
  - [Quark](#quark)
  - [Quark](#quark)
  - [Pure.css](#purecss)
  - [Step 1 - Install DevTools Plugin](#step-1---install-devtools-plugin)
      - [Install via CLI GPM](#install-via-cli-gpm)
      - [Install via Admin Plugin](#install-via-admin-plugin)
  - [Step 2 - Create Base Theme](#step-2---create-base-theme)
  - [Step 3 - Theme Basics](#step-3---theme-basics)
    - [Required Items to Function](#required-items-to-function)
    - [Required Items for Release](#required-items-for-release)
  - [Step 4 - Base Template](#step-4---base-template)
  - [Step 5 - Breaking it Down](#step-5---breaking-it-down)
  - [Step 6 - Theme CSS](#step-6---theme-css)
  - [Step 7 - Testing](#step-7---testing)
  - [How Does Twig Work?](#how-does-twig-work?)
  - [How Does Twig Work?](#how-does-twig-work?)
  - [Twig Syntax](#twig-syntax)
    - [Tags](#tags)
      - [Comment Tags](#comment-tags)
      - [Output Tags](#output-tags)
      - [Action Tags](#action-tags)
    - [Filters](#filters)
    - [Functions](#functions)
  - [Resources](#resources)
  - [`markdown`](#`markdown`)
    - [`markdown`](#`markdown`)
    - [`script`](#`script`)
      - [Script File](#script-file)
      - [Inline Script](#inline-script)
    - [`style`](#`style`)
      - [CSS File](#css-file)
      - [Inline CSS](#inline-css)
    - [`link`](#`link`)
    - [`switch`](#`switch`)
    - [`deferred`](#`deferred`)
    - [`throw`](#`throw`)
    - [`try` & `catch`](#`try`-&-`catch`)
    - [`render`](#`render`)
    - [`cache`](#`cache`)
  - [`absolute_url`](#`absolute_url`)
    - [`absolute_url`](#`absolute_url`)
    - [`array_unique`](#`array_unique`)
    - [`base32_encode`](#`base32_encode`)
    - [`base32_decode`](#`base32_decode`)
    - [`base64_encode`](#`base64_encode`)
    - [`base64_decode`](#`base64_decode`)
    - [`basename`](#`basename`)
    - [`camelize`](#`camelize`)
    - [`chunk_split`](#`chunk_split`)
    - [`contains`](#`contains`)
      - [Casting Values](#casting-values)
    - [`string`](#`string`)
    - [`int`](#`int`)
    - [`bool`](#`bool`)
    - [`float`](#`float`)
    - [`array`](#`array`)
    - [`defined`](#`defined`)
    - [`dirname`](#`dirname`)
    - [`ends_with`](#`ends_with`)
    - [`fieldName`](#`fieldname`)
    - [`get_type`](#`get_type`)
    - [`humanize`](#`humanize`)
    - [`hyphenize`](#`hyphenize`)
    - [`json_decode`](#`json_decode`)
    - [`ksort`](#`ksort`)
    - [`ltrim`](#`ltrim`)
    - [`markdown`](#`markdown`)
    - [`md5`](#`md5`)
    - [`modulus`](#`modulus`)
    - [`monthize`](#`monthize`)
    - [`nicecron`](#`nicecron`)
    - [`nicefilesize`](#`nicefilesize`)
    - [`nicenumber`](#`nicenumber`)
    - [`nicetime`](#`nicetime`)
    - [`of_type`](#`of_type`)
    - [`ordinalize`](#`ordinalize`)
    - [`pad`](#`pad`)
    - [`pluralize`](#`pluralize`)
    - [`print_r`](#`print_r`)
    - [`randomize`](#`randomize`)
    - [`regex_replace`](#`regex_replace`)
    - [`rtrim`](#`rtrim`)
    - [`singularize`](#`singularize`)
    - [`safe_email`](#`safe_email`)
    - [`sort_by_key`](#`sort_by_key`)
    - [`starts_with`](#`starts_with`)
    - [`titleize`](#`titleize`)
    - [`t`](#`t`)
    - [`tu`](#`tu`)
    - [`ta`](#`ta`)
    - [`tl`](#`tl`)
    - [`truncate`](#`truncate`)
      - [Specialized versions:](#specialized-versions:)
    - [`safe_truncate`](#`safe_truncate`)
    - [`truncate_html`](#`truncate_html`)
    - [`safe_truncate_html`](#`safe_truncate_html`)
    - [`underscorize`](#`underscorize`)
    - [`yaml_encode`](#`yaml_encode`)
    - [`yaml_decode`](#`yaml_decode`)
  - [`array`](#`array`)
    - [`array`](#`array`)
    - [`array_diff`](#`array_diff`)
    - [`array_key_value`](#`array_key_value`)
    - [`array_key_exists`](#`array_key_exists`)
    - [`array_intersect`](#`array_intersect`)
    - [`array_unique`](#`array_unique`)
    - [`authorize`](#`authorize`)
    - [`body_class`](#`body_class`)
    - [`cron`](#`cron`)
    - [`dump`](#`dump`)
    - [`debug`](#`debug`)
    - [`evaluate`](#`evaluate`)
    - [`evaluate_twig`](#`evaluate_twig`)
    - [`exif`](#`exif`)
    - [`get_cookie`](#`get_cookie`)
    - [`get_type`](#`get_type`)
    - [`gist`](#`gist`)
    - [`header_var`](#`header_var`)
    - [`http_response_code`](#`http_response_code`)
    - [`isajaxrequest`](#`isajaxrequest`)
    - [`json_decode`](#`json_decode`)
    - [`media_directory`](#`media_directory`)
    - [`nicefilesize`](#`nicefilesize`)
    - [`nicenumber`](#`nicenumber`)
    - [`nicetime`](#`nicetime`)
    - [`nonce_field`](#`nonce_field`)
    - [`of_type`](#`of_type`)
    - [`pathinfo`](#`pathinfo`)
    - [`print_r`](#`print_r`)
    - [`random_string`](#`random_string`)
    - [`unique_id`](#`unique_id`)
    - [`range`](#`range`)
    - [`read_file`](#`read_file`)
- [Grav Standard Administration Panel Plugin](#grav-standard-administration-panel-plugin)
    - [`redirect_me`](#`redirect_me`)
    - [`regex_filter`](#`regex_filter`)
    - [`regex_replace`](#`regex_replace`)
    - [`regex_match`](#`regex_match`)
    - [`regex_split`](#`regex_split`)
    - [`repeat`](#`repeat`)
    - [`string`](#`string`)
    - [`svg_image`](#`svg_image`)
    - [`theme_var`](#`theme_var`)
    - [`t`](#`t`)
    - [`ta`](#`ta`)
    - [`tl`](#`tl`)
    - [`url`](#`url`)
    - [`vardump`](#`vardump`)
    - [`xss`](#`xss`)
  - [Tags](#tags)
  - [Tags](#tags)
  - [Filters](#filters)
  - [Functions](#functions)
  - [Accessing Theme Blueprint Information](#accessing-theme-blueprint-information)
  - [Accessing Theme Blueprint Information](#accessing-theme-blueprint-information)
  - [Accessing Theme Configuration](#accessing-theme-configuration)
    - [Alternative Notation](#alternative-notation)
  - [Core Objects](#core-objects)
  - [Core Objects](#core-objects)
    - [base_dir variable](#base_dir-variable)
    - [base_url variable](#base_url-variable)
    - [base_url_relative variable](#base_url_relative-variable)
    - [base_url_absolute variable](#base_url_absolute-variable)
    - [base_url_simple variable](#base_url_simple-variable)
    - [home_url variable](#home_url-variable)
    - [html_lang variable](#html_lang-variable)
    - [theme_dir variable](#theme_dir-variable)
    - [theme_url variable](#theme_url-variable)
    - [html_lang variable](#html_lang-variable)
    - [language_codes variable](#language_codes-variable)
    - [assets object](#assets-object)
    - [config object](#config-object)
    - [site object](#site-object)
    - [system object](#system-object)
    - [theme object](#theme-object)
    - [page object](#page-object)
        - [summary([size])](#summary([size]))
        - [content()](#content())
        - [header()](#header())
        - [media()](#media())
        - [title()](#title())
        - [menu()](#menu())
        - [visible()](#visible())
        - [routable()](#routable())
        - [slug()](#slug())
        - [url([include_host = false])](#url([include_host-=-false]))
        - [permalink()](#permalink())
        - [canonical()](#canonical())
        - [route()](#route())
        - [home()](#home())
        - [root()](#root())
        - [active()](#active())
        - [modular()](#modular())
        - [activeChild()](#activechild())
        - [find(url)](#find(url))
        - [collection()](#collection())
        - [currentPosition()](#currentposition())
        - [isFirst()](#isfirst())
        - [isLast()](#islast())
        - [nextSibling()](#nextsibling())
        - [prevSibling()](#prevsibling())
        - [children()](#children())
        - [orderBy()](#orderby())
        - [orderDir()](#orderdir())
        - [orderManual()](#ordermanual())
        - [maxCount()](#maxcount())
        - [children.count()](#childrencount())
        - [children.current()](#childrencurrent())
        - [children.next()](#childrennext())
        - [children.prev()](#childrenprev())
        - [children.nth(position)](#childrennth(position))
        - [children.sort(orderBy, orderDir)](#childrensort(orderby,-orderdir))
        - [parent()](#parent())
        - [isPage()](#ispage())
        - [isDir()](#isdir())
        - [id()](#id())
        - [modified()](#modified())
        - [date()](#date())
        - [template()](#template())
        - [filePath()](#filepath())
        - [filePathClean()](#filepathclean())
        - [path()](#path())
        - [folder()](#folder())
        - [taxonomy()](#taxonomy())
    - [pages object](#pages-object)
        - [children method](#children-method)
    - [media object](#media-object)
    - [uri object](#uri-object)
        - [path()](#path())
        - [paths()](#paths())
        - [route([absolute = false][, domain = false])](#route([absolute-=-false][,-domain-=-false]))
        - [params()](#params())
        - [param(id)](#param(id))
        - [query()](#query())
        - [query(id)](#query(id))
        - [url([include_host = true])](#url([include_host-=-true]))
        - [extension()](#extension())
        - [host()](#host())
        - [base()](#base())
        - [rootUrl([include_host = false])](#rooturl([include_host-=-false]))
        - [referrer()](#referrer())
    - [header object](#header-object)
    - [content string](#content-string)
    - [taxonomy object](#taxonomy-object)
    - [browser object](#browser-object)
    - [user object](#user-object)
  - [Adding Custom Variables](#adding-custom-variables)
  - [Adding Custom Objects](#adding-custom-objects)
  - [Configuration](#configuration)
  - [Configuration](#configuration)
  - [Assets in Themes](#assets-in-themes)
    - [Overview](#overview)
    - [Example](#example)
  - [Adding Assets](#adding-assets)
      - [add(asset, [options])](#add(asset,-[options]))
      - [addCss(asset, [options])](#addcss(asset,-[options]))
      - [addDirCss(directory)](#adddircss(directory))
      - [addInlineCss(css, [options])](#addinlinecss(css,-[options]))
      - [addJs(asset, [options])](#addjs(asset,-[options]))
      - [addInlineJs(javascript, [options])](#addinlinejs(javascript,-[options]))
      - [addDirJs(directory)](#adddirjs(directory))
      - [registerCollection(name, array)](#registercollection(name,-array))
  - [Options](#options)
      - [For CSS](#for-css)
      - [For JS](#for-js)
  - [Rendering Assets](#rendering-assets)
      - [css([group, [options]])](#css([group,-[options]]))
      - [js([group, [options]])](#js([group,-[options]]))
  - [Named Assets](#named-assets)
  - [Grouped Assets](#grouped-assets)
  - [Change attribute of the rendered CSS/JS assets](#change-attribute-of-the-rendered-css/js-assets)
  - [Inlining Assets](#inlining-assets)
  - [Static Assets](#static-assets)
  - [Configuration](#configuration)
  - [Configuration](#configuration)
  - [Structure](#structure)
  - [Assets in Themes](#assets-in-themes)
    - [Overview](#overview)
    - [Example](#example)
  - [Adding Assets](#adding-assets)
      - [add(asset, [options])](#add(asset,-[options]))
      - [addCss(asset, [options])](#addcss(asset,-[options]))
      - [addLink($asset, [options])](#addlink($asset,-[options]))
      - [addInlineCss(css, [options])](#addinlinecss(css,-[options]))
      - [addJs(asset, [options])](#addjs(asset,-[options]))
      - [addInlineJs(javascript, [options])](#addinlinejs(javascript,-[options]))
      - [addJsModule(asset, [options])](#addjsmodule(asset,-[options]))
      - [addInlineJsModule(javascript, [options])](#addinlinejsmodule(javascript,-[options]))
      - [registerCollection(name, array)](#registercollection(name,-array))
  - [Options](#options)
      - [For CSS](#for-css)
      - [For JS and JS Module](#for-js-and-js-module)
      - [Other Attributes](#other-attributes)
      - [Examples](#examples)
  - [Rendering Assets](#rendering-assets)
      - [css(group, [options], include_link = true)](#css(group,-[options],-include_link-=-true))
      - [link(group, [options])](#link(group,-[options]))
      - [js(group, [options], include_js_module = true)](#js(group,-[options],-include_js_module-=-true))
      - [jsModule(group, [options])](#jsmodule(group,-[options]))
      - [all(group, [options])](#all(group,-[options]))
  - [Named Assets and Collections](#named-assets-and-collections)
        - [Collections with attributes](#collections-with-attributes)
  - [Grouped Assets](#grouped-assets)
  - [Change attribute of the rendered CSS/JS assets](#change-attribute-of-the-rendered-css/js-assets)
  - [Inlining Assets](#inlining-assets)
  - [Static Assets](#static-assets)
  - [Custom CSS](#custom-css)
  - [Custom CSS](#custom-css)
  - [Custom SCSS/LESS](#custom-scss/less)
  - [Wellington SCSS](#wellington-scss)
  - [Theme Inheritance](#theme-inheritance)
    - [Inheriting using the CLI](#inheriting-using-the-cli)
    - [Inheriting manually](#inheriting-manually)
    - [Using SCSS](#using-scss)
  - [Chapter 3](#chapter-3)
    - [Chapter 3](#chapter-3)
- [Themes](#themes)
  - [Powerful!](#powerful!)
  - [Powerful!](#powerful!)
  - [Essentials](#essentials)
  - [Accessing Plugin Configuration Values via Twig](#accessing-plugin-configuration-values-via-twig)
  - [Using Flex in plugins](#using-flex-in-plugins)
  - [Installation](#installation)
  - [Installation](#installation)
    - [GPM Installation (Preferred)](#gpm-installation-(preferred))
    - [Manual Installation](#manual-installation)
    - [Admin Plugin](#admin-plugin)
  - [Randomizer Plugin Overview](#randomizer-plugin-overview)
  - [Randomizer Plugin Overview](#randomizer-plugin-overview)
  - [Step 1 - Install DevTools plugin](#step-1---install-devtools-plugin)
      - [Install via CLI GPM](#install-via-cli-gpm)
      - [Install via Admin plugin](#install-via-admin-plugin)
  - [Step 2 - Create Randomizer plugin](#step-2---create-randomizer-plugin)
  - [Step 3 - Plugin basics](#step-3---plugin-basics)
    - [Required items to function](#required-items-to-function)
    - [Required items for release](#required-items-for-release)
  - [Step 4 - Plugin configuration](#step-4---plugin-configuration)
  - [Step 5 - Base plugin structure](#step-5---base-plugin-structure)
  - [Step 6 - Subscribed events](#step-6---subscribed-events)
  - [Step 7 - Determine if the plugin should run](#step-7---determine-if-the-plugin-should-run)
  - [Step 8 - Display the random page](#step-8---display-the-random-page)
  - [Step 9 - Cleanup](#step-9---cleanup)
  - [Step 10 - Final plugin class](#step-10---final-plugin-class)
  - [Extending blueprints](#extending-blueprints)
  - [Merging Plugin and Page Configuration](#merging-plugin-and-page-configuration)
  - [Implementing CLI in your Plugin](#implementing-cli-in-your-plugin)
  - [Event Order](#event-order)
  - [Event Order](#event-order)
  - [Core Grav Event Hooks](#core-grav-event-hooks)
      - [onFatalException](#onfatalexception)
      - [onPluginsInitialized](#onpluginsinitialized)
      - [onAssetsInitialized](#onassetsinitialized)
      - [onPagesInitialized](#onpagesinitialized)
      - [onPageNotFound](#onpagenotfound)
      - [onPageInitialized](#onpageinitialized)
      - [onOutputGenerated](#onoutputgenerated)
      - [onPageHeaders](#onpageheaders)
      - [onOutputRendered](#onoutputrendered)
      - [onShutdown](#onshutdown)
      - [onBeforeDownload](#onbeforedownload)
      - [onGetPageTemplates](#ongetpagetemplates)
      - [onGetPageBlueprints](#ongetpageblueprints)
  - [Twig Event Hooks](#twig-event-hooks)
      - [onTwigTemplatePaths](#ontwigtemplatepaths)
      - [onTwigInitialized](#ontwiginitialized)
      - [onTwigExtensions](#ontwigextensions)
      - [onTwigPageVariables](#ontwigpagevariables)
      - [onTwigSiteVariables](#ontwigsitevariables)
  - [Collection Event Hooks](#collection-event-hooks)
      - [onCollectionProcessed](#oncollectionprocessed)
  - [Page Event Hooks](#page-event-hooks)
      - [onBuildPagesInitialized](#onbuildpagesinitialized)
      - [onBlueprintCreated](#onblueprintcreated)
      - [onPageContentRaw](#onpagecontentraw)
      - [onPageProcessed](#onpageprocessed)
      - [onMarkdownInitialized](#onmarkdowninitialized)
      - [onPageContentProcessed](#onpagecontentprocessed)
      - [onFolderProcessed](#onfolderprocessed)
      - [onPageFallBackUrl](#onpagefallbackurl)
      - [onMediaLocate](#onmedialocate)
      - [onTwigLoader](#ontwigloader)
  - [index.php](#indexphp)
    - [index.php](#indexphp)
    - [Page.php](#pagephp)
  - [index.php](#indexphp)
    - [index.php](#indexphp)
    - [Page.php](#pagephp)
  - [index.php](#indexphp)
    - [index.php](#indexphp)
    - [Page.php](#pagephp)
  - [Introduction](#introduction)
  - [Introduction](#introduction)
  - [Requirements](#requirements)
  - [Create your plugins](#create-your-plugins)
  - [What is done where](#what-is-done-where)
    - [Flex Object definition](#flex-object-definition)
    - [plugin hooks](#plugin-hooks)
  - [Modify the flex object schema](#modify-the-flex-object-schema)
  - [Add custom method to the flex object<a href="#addcustommethod"></a>](#add-custom-method-to-the-flex-object<a-href="#addcustommethod"></a>)
  - [Chapter 4](#chapter-4)
    - [Chapter 4](#chapter-4)
- [Plugins](#plugins)
  - [Features](#features)
    - [Features](#features)
    - [Support](#support)
    - [Installation](#installation)
    - [Creating a User](#creating-a-user)
    - [Username and Password Complexity](#username-and-password-complexity)
    - [Usage](#usage)
  - [Content](#content)
    - [Content](#content)
    - [Languages](#languages)
    - [HTTP Headers](#http-headers)
    - [Markdown](#markdown)
    - [Caching](#caching)
    - [Twig Templating](#twig-templating)
    - [Assets](#assets)
    - [Error Handler](#error-handler)
    - [Debugger](#debugger)
    - [Media](#media)
    - [Session](#session)
    - [Advanced](#advanced)
  - [Defaults](#defaults)
    - [Defaults](#defaults)
    - [Page Summary](#page-summary)
    - [Metadata](#metadata)
    - [Redirects and Routes](#redirects-and-routes)
  - [Profile Photo](#profile-photo)
    - [Profile Photo](#profile-photo)
    - [Account](#account)
    - [2-Factor Authentication](#2-factor-authentication)
    - [Access Levels](#access-levels)
  - [Cache and Updates Checking](#cache-and-updates-checking)
    - [Cache and Updates Checking](#cache-and-updates-checking)
    - [Maintenance and Page View Statistics](#maintenance-and-page-view-statistics)
    - [Latest Page Updates](#latest-page-updates)
  - [User Profile](#user-profile)
  - [User Profile](#user-profile)
    - [General Tab](#general-tab)
      - [Profile Photo](#profile-photo)
      - [Account](#account)
      - [2-Factor Authentication](#2-factor-authentication)
    - [Access Tab](#access-tab)
  - [User Group](#user-group)
  - [User Group](#user-group)
    - [Permissions](#permissions)
      - [Site](#site)
      - [Admin](#admin)
  - [docs.17](#docs17)
  - [docs.17](#docs17)
  - [docs.17](#docs17)
  - [Controls](#controls)
    - [Controls](#controls)
    - [Title](#title)
    - [Page Editor Content](#page-editor-content)
    - [Page Media](#page-media)
  - [Publishing](#publishing)
    - [Publishing](#publishing)
    - [Taxonomies](#taxonomies)
    - [Sitemap](#sitemap)
  - [Settings](#settings)
    - [Settings](#settings)
    - [Ordering](#ordering)
    - [Overrides](#overrides)
    - [Route Overrides](#route-overrides)
    - [Admin Specific Overrides](#admin-specific-overrides)
  - [docs.17](#docs17)
  - [docs.17](#docs17)
  - [Page CRUD Access Check Workflow](#page-crud-access-check-workflow)
    - [Page CRUD Access Check Workflow](#page-crud-access-check-workflow)
    - [Root Page](#root-page)
  - [Adding New Pages](#adding-new-pages)
    - [Adding New Pages](#adding-new-pages)
      - [Add Page](#add-page)
      - [Add Modular Page](#add-modular-page)
    - [Pages List](#pages-list)
  - [Plugin Information](#plugin-information)
    - [Plugin Information](#plugin-information)
    - [Basics](#basics)
    - [Dashboard](#dashboard)
    - [Notifications](#notifications)
    - [Popularity](#popularity)
  - [Controls](#controls)
    - [Controls](#controls)
    - [Installed Plugins](#installed-plugins)
  - [Controls](#controls)
    - [Controls](#controls)
      - [Adding a New Theme](#adding-a-new-theme)
    - [Installed Themes](#installed-themes)
  - [How to Set it Up](#how-to-set-it-up)
  - [How to Set it Up](#how-to-set-it-up)
  - [Frequently Asked Questions](#frequently-asked-questions)
      - [What Happens if I lose access to my 2FA device?](#what-happens-if-i-lose-access-to-my-2fa-device?)
      - [What if my 2FA secret is compromised?](#what-if-my-2fa-secret-is-compromised?)
  - [What You'll Need](#what-you'll-need)
  - [What You'll Need](#what-you'll-need)
  - [How to Set it Up](#how-to-set-it-up)
  - [docs](#docs)
  - [Uploading](#uploading)
    - [Uploading](#uploading)
      - [Remote Location](#remote-location)
  - [Available Admin Event Hooks](#available-admin-event-hooks)
  - [Available Admin Event Hooks](#available-admin-event-hooks)
  - [Enabling an Admin Event Hook](#enabling-an-admin-event-hook)
    - [onAdminTaskExecute](#onadmintaskexecute)
    - [onAdminCreatePageFrontmatter](#onadmincreatepagefrontmatter)
    - [onAdminSave](#onadminsave)
    - [onAdminAfterSave](#onadminaftersave)
    - [onAdminAfterSaveAs](#onadminaftersaveas)
    - [onAdminAfterDelete](#onadminafterdelete)
    - [onAdminAfterAddMedia](#onadminafteraddmedia)
    - [onAdminAfterDelMedia](#onadminafterdelmedia)
  - [Understanding Admin Themes](#understanding-admin-themes)
    - [Understanding Admin Themes](#understanding-admin-themes)
    - [Adding a custom field](#adding-a-custom-field)
    - [Creating custom page templates](#creating-custom-page-templates)
      - [Adding a custom page template to a theme/ plugin](#adding-a-custom-page-template-to-a-theme/-plugin)
      - [Adding a custom page blueprint to a theme/ plugin](#adding-a-custom-page-blueprint-to-a-theme/-plugin)
      - [Creating a new page](#creating-a-new-page)
  - [Manual Installation of Admin](#manual-installation-of-admin)
    - [Manual Installation of Admin](#manual-installation-of-admin)
    - [Adding and Managing Users](#adding-and-managing-users)
    - [Managing ACL](#managing-acl)
    - [Custom Admin URL](#custom-admin-url)
    - [Offline Mode](#offline-mode)
  - [Chapter 5](#chapter-5)
    - [Chapter 5](#chapter-5)
- [Administration Panel](#administration-panel)
  - [Available Form Fields for Use in the Admin](#available-form-fields-for-use-in-the-admin)
  - [Available Form Fields for Use in the Admin](#available-form-fields-for-use-in-the-admin)
    - [Special Form Fields Available Exclusively in the Admin](#special-form-fields-available-exclusively-in-the-admin)
    - [Common Fields Attributes](#common-fields-attributes)
    - [Know more about fields](#know-more-about-fields)
    - [Validation](#validation)
      - [validate.type](#validatetype)
    - [Array Field](#array-field)
    - [Colorpicker Field](#colorpicker-field)
    - [Columns / column Fields](#columns-/-column-fields)
    - [Dateformat Field](#dateformat-field)
    - [Datetime Field](#datetime-field)
    - [Editor Field](#editor-field)
    - [Elements Field](#elements-field)
    - [Fieldset Field](#fieldset-field)
      - [Icon of the fieldset](#icon-of-the-fieldset)
    - [File Field](#file-field)
    - [Filepicker Field](#filepicker-field)
    - [Honeypot Field](#honeypot-field)
    - [List Field](#list-field)
    - [PageMediaSelect Field](#pagemediaselect-field)
    - [Pages Field](#pages-field)
    - [Section Field](#section-field)
    - [Selectize Field](#selectize-field)
    - [Taxonomy Field](#taxonomy-field)
  - [docs](#docs)
  - [docs](#docs)
  - [A first example](#a-first-example)
    - [A first example](#a-first-example)
    - [How to name fields](#how-to-name-fields)
    - [Create a completely custom page form](#create-a-completely-custom-page-form)
    - [A note for Expert mode](#a-note-for-expert-mode)
    - [Where to put the Page Blueprints](#where-to-put-the-page-blueprints)
      - [In the User Blueprints folder](#in-the-user-blueprints-folder)
      - [In the Theme](#in-the-theme)
      - [In the Data folder](#in-the-data-folder)
      - [In a Plugin](#in-a-plugin)
  - [docs](#docs)
  - [File Uploads](#file-uploads)
    - [File Uploads](#file-uploads)
  - [Options](#options)
      - [Defaults](#defaults)
      - [`multiple`](#`multiple`)
      - [`destination`](#`destination`)
        - [Examples](#examples)
      - [`random_name`](#`random_name`)
        - [Example](#example)
      - [`avoid_overwriting`](#`avoid_overwriting`)
        - [Example](#example)
      - [`limit`](#`limit`)
      - [`accept`](#`accept`)
        - [Examples](#examples)
      - [`filesize`](#`filesize`)
        - [Examples](#examples)
  - [Defining Validation Rules](#defining-validation-rules)
  - [Defining Validation Rules](#defining-validation-rules)
  - [Extending Base Type (extends@)](#extending-base-type-(extends@))
    - [Understanding the type- and context-properties](#understanding-the-type--and-context-properties)
  - [Embedding Form (import@)](#embedding-form-(import@))
  - [Removing Fields / Properties (unset-*@)](#removing-fields-/-properties-(unset-*@))
  - [Replacing Fields / Properties (replace-*@)](#replacing-fields-/-properties-(replace-*@))
  - [Using Configuration (config-*@)](#using-configuration-(config-*@))
  - [Using Function Calls (data-*@)](#using-function-calls-(data-*@))
  - [Changing field ordering](#changing-field-ordering)
  - [Creating new form field type](#creating-new-form-field-type)
  - [onBlueprintCreated or accessing blueprint data](#onblueprintcreated-or-accessing-blueprint-data)
  - [What is a Blueprint?](#what-is-a-blueprint?)
  - [What is a Blueprint?](#what-is-a-blueprint?)
  - [Types of Blueprints](#types-of-blueprints)
      - [Themes and Plugins](#themes-and-plugins)
      - [Pages](#pages)
  - [Components of a Blueprint](#components-of-a-blueprint)
  - [Debugging Blueprints](#debugging-blueprints)
  - [Name](#name)
    - [Name](#name)
    - [Method](#method)
    - [Action](#action)
    - [Template](#template)
    - [ID](#id)
    - [Classes](#classes)
    - [Attributes](#attributes)
    - [Inline Errors](#inline-errors)
    - [Client-side Validation](#client-side-validation)
    - [XSS Checks](#xss-checks)
    - [Keep Alive](#keep-alive)
    - [Fieldsets](#fieldsets)
  - [Common Field Attributes](#common-field-attributes)
  - [Common Field Attributes](#common-field-attributes)
    - [Checkbox Field](#checkbox-field)
    - [Conditional Field](#conditional-field)
    - [Display Field](#display-field)
    - [File Field](#file-field)
- [Default settings](#default-settings)
    - [Honeypot Field](#honeypot-field)
    - [Number Field](#number-field)
    - [Radio Field](#radio-field)
    - [Section Field](#section-field)
    - [Select Optgroup Field](#select-optgroup-field)
    - [Tabs / Tab Fields](#tabs-/-tab-fields)
    - [Text Field](#text-field)
    - [Toggle Field](#toggle-field)
  - [Simple Contact Form](#simple-contact-form)
  - [Simple Contact Form](#simple-contact-form)
    - [A Live Example](#a-live-example)
    - [Setup the Page](#setup-the-page)
- [Contact form](#contact-form)
  - [Email sent!](#email-sent!)
    - [Live Demo](#live-demo)
  - [Form actions](#form-actions)
  - [Form actions](#form-actions)
    - [Email](#email)
        - [Dynamic email attribute](#dynamic-email-attribute)
    - [Redirect](#redirect)
    - [Message](#message)
      - [Validation Message](#validation-message)
    - [Display](#display)
  - [Email sent!](#email-sent!)
    - [Save](#save)
    - [Captcha](#captcha)
    - [User IP Address](#user-ip-address)
    - [Timestamp](#timestamp)
    - [Reset the form after submit](#reset-the-form-after-submit)
    - [Remember field values](#remember-field-values)
  - [Custom Actions](#custom-actions)
      - [An example of custom form handling](#an-example-of-custom-form-handling)
  - [Using forms in modular pages](#using-forms-in-modular-pages)
  - [Using forms in modular pages](#using-forms-in-modular-pages)
      - [A live example](#a-live-example)
      - [Troubleshooting forms in modular pages](#troubleshooting-forms-in-modular-pages)
  - [Submitting forms via XHR/Ajax](#submitting-forms-via-xhr/ajax)
  - [Submitting forms via XHR/Ajax](#submitting-forms-via-xhr/ajax)
  - [Automatic Approach (Form plugin >= `v7.3.0`)](#automatic-approach-(form-plugin->=-`v730`))
  - [Manual Approach (required for Form plugin < `v7.3.0`)](#manual-approach-(required-for-form-plugin-<-`v730`))
    - [Creating the form](#creating-the-form)
    - [The page content](#the-page-content)
  - [Create a simple single form](#create-a-simple-single-form)
  - [Create a simple single form](#create-a-simple-single-form)
- [My Form](#my-form)
  - [Multiple Forms](#multiple-forms)
  - [Displaying Forms from Twig](#displaying-forms-from-twig)
- [Contact Form](#contact-form)
- [Newsletter Signup](#newsletter-signup)
- [Contact Form](#contact-form)
  - [Displaying Forms in Page Content](#displaying-forms-in-page-content)
- [Contact Form](#contact-form)
- [Newsletter Signup](#newsletter-signup)
  - [Modular Forms](#modular-forms)
  - [Modular Form](#modular-form)
  - [Chapter 6](#chapter-6)
    - [Chapter 6](#chapter-6)
- [Forms](#forms)
  - [MacOS](#macos)
  - [MacOS](#macos)
  - [Linux](#linux)
  - [Windows](#windows)
  - [Grav-specific Commands](#grav-specific-commands)
  - [Symbolic Links](#symbolic-links)
    - [Symbolic Links in MacOS and Linux](#symbolic-links-in-macos-and-linux)
    - [Symbolic Links in Windows](#symbolic-links-in-windows)
    - [Example Commands](#example-commands)
        - [Link Contents of One Folder to Another](#link-contents-of-one-folder-to-another)
        - [Link Entire Folders from One Place to Another](#link-entire-folders-from-one-place-to-another)
        - [Link Individual File(s) from One Place to Another](#link-individual-file(s)-from-one-place-to-another)
  - [Backup](#backup)
  - [Backup](#backup)
  - [Clean](#clean)
  - [Clear-Cache](#clear-cache)
  - [Composer](#composer)
  - [Install](#install)
  - [Log Viewer](#log-viewer)
  - [New Project](#new-project)
  - [Sandbox](#sandbox)
  - [Scheduler](#scheduler)
  - [Security](#security)
      - [PHP CGI-FCGI Information](#php-cgi-fcgi-information)
  - [Reserved Commands and Options](#reserved-commands-and-options)
  - [Reserved Commands and Options](#reserved-commands-and-options)
  - [How to Use the CLI for Plugins](#how-to-use-the-cli-for-plugins)
  - [Developers: Integrate the CLI in Plugin](#developers:-integrate-the-cli-in-plugin)
  - [PHP CGI-FCGI Information](#php-cgi-fcgi-information)
      - [PHP CGI-FCGI Information](#php-cgi-fcgi-information)
  - [How Does it Work?](#how-does-it-work?)
  - [Commands](#commands)
  - [Index](#index)
  - [Info](#info)
  - [Install](#install)
  - [Update](#update)
  - [Uninstall](#uninstall)
  - [Self-upgrade](#self-upgrade)
  - [Important Developer Information](#important-developer-information)
      - [Blueprints](#blueprints)
      - [Releases](#releases)
      - [Add your resource to the repository](#add-your-resource-to-the-repository)
  - [Prerequisites](#prerequisites)
  - [Prerequisites](#prerequisites)
  - [Setup](#setup)
  - [Configuration](#configuration)
    - [Servers](#servers)
    - [Tasks](#tasks)
  - [Conclusion](#conclusion)
  - [Chapter 7](#chapter-7)
    - [Chapter 7](#chapter-7)
- [CLI Console](#cli-console)
  - [Enabling a Directory](#enabling-a-directory)
  - [Enabling a Directory](#enabling-a-directory)
  - [Install Sample Data (Optional)](#install-sample-data-(optional))
  - [Create a Page](#create-a-page)
- [Directory Example](#directory-example)
  - [Display the Page](#display-the-page)
  - [Controls](#controls)
  - [Controls](#controls)
  - [Navigation](#navigation)
  - [Single Row](#single-row)
  - [Controls](#controls)
    - [Controls](#controls)
    - [Edit Form](#edit-form)
  - [Controls](#controls)
      - [Controls](#controls)
    - [Caching Tab](#caching-tab)
  - [Enabling a Directory](#enabling-a-directory)
  - [Enabling a Directory](#enabling-a-directory)
  - [Directory Listing](#directory-listing)
      - [Controls](#controls)
      - [Directories](#directories)
  - [count()](#count())
  - [count()](#count())
  - [getDirectories()](#getdirectories())
  - [hasDirectory()](#hasdirectory())
  - [getDirectory()](#getdirectory())
  - [getObject()](#getobject())
  - [getCollection()](#getcollection())
  - [getTitle()](#gettitle())
  - [getTitle()](#gettitle())
  - [getDescription()](#getdescription())
  - [getObject()](#getobject())
  - [getCollection()](#getcollection())
  - [Render Collection](#render-collection)
- [Render Collection](#render-collection)
  - [render()](#render())
- [Collection Manipulation](#collection-manipulation)
  - [sort()](#sort())
  - [limit()](#limit())
  - [filterBy()](#filterby())
  - [reverse()](#reverse())
  - [shuffle()](#shuffle())
  - [select()](#select())
  - [unselect()](#unselect())
  - [search()](#search())
  - [copy()](#copy())
- [Iterate Through Collection](#iterate-through-collection)
  - [first()](#first())
  - [last()](#last())
  - [next()](#next())
  - [current()](#current())
  - [key()](#key())
- [Get Object / Key](#get-object-/-key)
  - [Array Access](#array-access)
  - [get()](#get())
- [Collection as Array](#collection-as-array)
  - [getKeys()](#getkeys())
  - [GetObjectKeys()](#getobjectkeys())
  - [getValues()](#getvalues())
  - [toArray()](#toarray())
  - [slice()](#slice())
  - [chunk()](#chunk())
  - [group()](#group())
- [Adding and Removing Objects](#adding-and-removing-objects)
  - [add()](#add())
  - [remove()](#remove())
  - [removeElement()](#removeelement())
  - [clear()](#clear())
- [Tests](#tests)
  - [containsKey()](#containskey())
  - [contains()](#contains())
  - [indexOf()](#indexof())
  - [isEmpty()](#isempty())
  - [count()](#count())
- [Bulk Actions for Objects](#bulk-actions-for-objects)
  - [hasProperty()](#hasproperty())
  - [getProperty()](#getproperty())
  - [setProperty()](#setproperty())
  - [defProperty()](#defproperty())
  - [unsetProperty()](#unsetproperty())
  - [call()](#call())
  - [getTimestamps()](#gettimestamps())
  - [getStorageKeys()](#getstoragekeys())
  - [getFlexKeys()](#getflexkeys())
  - [withKeyField()](#withkeyfield())
- [Closure Tests (PHP only)](#closure-tests-(php-only))
  - [exists()](#exists())
  - [forAll()](#forall())
- [Closure Filtering (PHP only)](#closure-filtering-(php-only))
  - [filter()](#filter())
  - [map()](#map())
  - [collectionGroup()](#collectiongroup())
  - [matching()](#matching())
  - [orderBy()](#orderby())
  - [partition()](#partition())
  - [Render Object](#render-object)
- [Render Object](#render-object)
  - [render()](#render())
- [Other](#other)
  - [getKey()](#getkey())
  - [hasKey()](#haskey())
  - [getFlexType()](#getflextype())
  - [hasProperty()](#hasproperty())
  - [getProperty()](#getproperty())
  - [setProperty()](#setproperty())
  - [defProperty()](#defproperty())
  - [unsetProperty()](#unsetproperty())
  - [isAuthorized()](#isauthorized())
  - [getFlexDirectory()](#getflexdirectory())
  - [getTimestamp()](#gettimestamp())
  - [search()](#search())
  - [getFlexKey()](#getflexkey())
  - [getStorageKey()](#getstoragekey())
  - [exists()](#exists())
  - [update()](#update())
  - [create()](#create())
  - [createCopy()](#createcopy())
  - [save()](#save())
  - [delete()](#delete())
  - [getBlueprint()](#getblueprint())
  - [getForm()](#getform())
  - [getDefaultValue()](#getdefaultvalue())
  - [getDefaultValues()](#getdefaultvalues())
  - [getFormValue()](#getformvalue())
  - [triggerEvent()](#triggerevent())
  - [Using `flex-objects` Page Type](#using-`flex-objects`-page-type)
  - [Using `flex-objects` Page Type](#using-`flex-objects`-page-type)
- [Directories](#directories)
- [Contacts](#contacts)
  - [Rendering Collections and Objects](#rendering-collections-and-objects)
  - [Templating Basics](#templating-basics)
    - [Collection Template](#collection-template)
    - [Object Template](#object-template)
    - [Custom Layouts](#custom-layouts)
  - [Flex Configuration](#flex-configuration)
- [Flex Configuration](#flex-configuration)
- [Flex Directory Forms](#flex-directory-forms)
- [Flex Object Form](#flex-object-form)
  - [Form](#form)
- [Flex Object Form](#flex-object-form)
  - [Config](#config)
- [Flex Configuration](#flex-configuration)
- [Flex Configuration](#flex-configuration)
    - [Config > Data](#config->-data)
- [JSON](#json)
- [YAML](#yaml)
- [Markdown](#markdown)
- [PHP Serialize](#php-serialize)
- [INI](#ini)
- [CSV](#csv)
    - [Config > Admin](#config->-admin)
      - [List View](#list-view)
      - [Edit View](#edit-view)
      - [Configure view](#configure-view)
      - [Preview view](#preview-view)
      - [Export view](#export-view)
    - [Config > Site](#config->-site)
  - [Blueprints](#blueprints)
  - [docs.17](#docs17)
  - [Introduction](#introduction)
  - [Introduction](#introduction)
      - [Flex](#flex)
      - [Flex Type](#flex-type)
      - [Flex Directory](#flex-directory)
      - [Flex Collection](#flex-collection)
      - [Flex Object](#flex-object)
      - [Flex Index](#flex-index)
      - [Flex Storage](#flex-storage)
      - [Flex Form](#flex-form)
      - [Flex Administration ####](#flex-administration-####)
  - [Current Limitations](#current-limitations)
  - [Performance](#performance)
  - [Performance](#performance)
  - [Caching Options](#caching-options)
  - [Caching Types](#caching-types)
    - [Grav Core Caching](#grav-core-caching)
      - [Memcache Specific Options](#memcache-specific-options)
      - [Memcached Specific Options](#memcached-specific-options)
      - [Redis Specific Options](#redis-specific-options)
      - [Twig Specific Options](#twig-specific-options)
  - [Caching and Events](#caching-and-events)
  - [Debug Bar](#debug-bar)
  - [Debug Bar](#debug-bar)
    - [Dump Command for PHP](#dump-command-for-php)
    - [Dump command for Twig](#dump-command-for-twig)
    - [Dump to browser console from Twig](#dump-to-browser-console-from-twig)
  - [Error Display](#error-display)
  - [Logging](#logging)
  - [Automatic Environment Configuration](#automatic-environment-configuration)
    - [Automatic Environment Configuration](#automatic-environment-configuration)
      - [Plugin Overrides](#plugin-overrides)
      - [Theme Overrides](#theme-overrides)
    - [Server Based Environment Configuration](#server-based-environment-configuration)
    - [Custom Environment Paths](#custom-environment-paths)
      - [Custom location for all the environments](#custom-location-for-all-the-environments)
      - [Custom location for the current environment](#custom-location-for-the-current-environment)
    - [Further Customization](#further-customization)
  - [What is a Multisite Setup?](#what-is-a-multisite-setup?)
    - [What is a Multisite Setup?](#what-is-a-multisite-setup?)
    - [Requirements for a Grav Multisite Setup](#requirements-for-a-grav-multisite-setup)
    - [Setup and installation](#setup-and-installation)
      - [Quickstart (for Beginners)](#quickstart-(for-beginners))
        - [Snippets](#snippets)
        - [GPM (Grav Package Manager) and multiple setups](#gpm-(grav-package-manager)-and-multiple-setups)
      - [Advanced configuration (for Experts)](#advanced-configuration-(for-experts))
      - [Streams](#streams)
    - [Server Based Multi-Site Configuration](#server-based-multi-site-configuration)
      - [Server Based Configuration Overrides](#server-based-configuration-overrides)
  - [What is a Multisite Setup?](#what-is-a-multisite-setup?)
    - [What is a Multisite Setup?](#what-is-a-multisite-setup?)
    - [Requirements for a Grav Multisite Setup](#requirements-for-a-grav-multisite-setup)
    - [Setup and installation](#setup-and-installation)
      - [Quickstart (for Beginners)](#quickstart-(for-beginners))
        - [Snippets](#snippets)
      - [Advanced configuration (for Experts)](#advanced-configuration-(for-experts))
      - [Streams](#streams)
    - [Server Based Multi-Site Configuration](#server-based-multi-site-configuration)
      - [Server Based Configuration Overrides](#server-based-configuration-overrides)
  - [docs](#docs)
  - [Installation](#installation)
  - [Installation](#installation)
  - [Scheduling Basics](#scheduling-basics)
  - [Configuration File](#configuration-file)
  - [Manually Running Jobs](#manually-running-jobs)
  - [Grav System Jobs](#grav-system-jobs)
  - [Custom Jobs](#custom-jobs)
  - [Plugin-provided Jobs](#plugin-provided-jobs)
  - [Configuration](#configuration)
  - [Configuration](#configuration)
      - [Purge](#purge)
      - [Profiles](#profiles)
  - [CLI Command](#cli-command)
  - [Preparations](#preparations)
  - [Preparations](#preparations)
  - [Step to Grav 1.6.31](#step-to-grav-1631)
  - [Upgrading to Grav 1.7](#upgrading-to-grav-17)
  - [Deprecated Debug Bar Tab](#deprecated-debug-bar-tab)
  - [Deprecated Debug Bar Tab](#deprecated-debug-bar-tab)
  - [YAML Parsing](#yaml-parsing)
        - [Look for these YAML errors:](#look-for-these-yaml-errors:)
    - [YAML Compatibility Mode](#yaml-compatibility-mode)
  - [Twig](#twig)
    - [Deferred Blocks](#deferred-blocks)
    - [Deprecated Twig](#deprecated-twig)
        - [Look for these Twig issues:](#look-for-these-twig-issues:)
    - [Auto-Escaping](#auto-escaping)
  - [Most Common Issues](#most-common-issues)
    - [Most Common Issues](#most-common-issues)
    - [Quick Update Guide](#quick-update-guide)
    - [YAML](#yaml)
    - [Twig](#twig)
  - [Forms](#forms)
    - [Environments and Multi-Site](#environments-and-multi-site)
    - [User Accounts](#user-accounts)
    - [Pages](#pages)
    - [Multi-language](#multi-language)
    - [Media](#media)
    - [CLI](#cli)
    - [Configuration](#configuration)
  - [DEVELOPERS](#developers)
    - [Debugging](#debugging)
    - [Use composer autoloader](#use-composer-autoloader)
    - [Plugin/Theme Blueprints (`blueprints.yaml`)](#plugin/theme-blueprints-(`blueprintsyaml`))
    - [Sessions](#sessions)
    - [ACL](#acl)
    - [Pages](#pages)
    - [Media](#media)
    - [Markdown](#markdown)
    - [Users](#users)
    - [Flex](#flex)
    - [Multi-language](#multi-language)
    - [Multi-site](#multi-site)
    - [Serialization](#serialization)
    - [Blueprints](#blueprints)
    - [Events](#events)
    - [JavaScript](#javascript)
    - [Misc](#misc)
    - [CLI](#cli)
    - [Used Libraries](#used-libraries)
  - [PLUGINS](#plugins)
    - [Admin](#admin)
    - [Shortcode Core](#shortcode-core)
  - [Troubleshooting Issues](#troubleshooting-issues)
      - [`ERROR: flex-objects.html.twig template not found for page`](#`error:-flex-objectshtmltwig-template-not-found-for-page`)
      - [Untranslated Admin](#untranslated-admin)
      - [Page blueprints stop working in Admin](#page-blueprints-stop-working-in-admin)
      - [Error: Loop detected while extending blueprint file](#error:-loop-detected-while-extending-blueprint-file)
      - [Missing CSS Styling in Admin](#missing-css-styling-in-admin)
  - [Reverting back to latest Grav 1.6](#reverting-back-to-latest-grav-16)
  - [Grav Core](#grav-core)
  - [Grav Core](#grav-core)
  - [Running Tests](#running-tests)
  - [Grav Plugins](#grav-plugins)
      - [Plugin Requirements](#plugin-requirements)
  - [Grav Skeletons](#grav-skeletons)
      - [Skeleton Requirements](#skeleton-requirements)
  - [Grav Themes](#grav-themes)
      - [Theme Requirements](#theme-requirements)
  - [Demo Content](#demo-content)
  - [Theme/Plugin Release Process](#theme/plugin-release-process)
  - [ChangeLog Format](#changelog-format)

# Grav Documentation

> Compiled on Wed 30 Apr 2025 17:17:58 AEST

> Contains 194 documents

## Table of Contents

- [Grav Documentation](#grav-documentation) - grav-documentation.md
- [Grav's Place in the Universe](#grav-s-place-in-the-universe) - grav-learn/pages/01.basics/01.what-is-grav/docs.md
- [Web Servers](#web-servers) - grav-learn/pages/01.basics/02.requirements/docs.md
- [Check for PHP version](#check-for-php-version) - grav-learn/pages/01.basics/03.installation/docs.md
- [Content Basics](#content-basics) - grav-learn/pages/01.basics/04.basic-tutorial/docs.md
- [System Configuration](#system-configuration) - grav-learn/pages/01.basics/05.grav-configuration/docs.17.md
- [System Configuration](#system-configuration) - grav-learn/pages/01.basics/05.grav-configuration/docs.md
- [/assets](#-assets) - grav-learn/pages/01.basics/06.folder-structure/docs.md
- [Forum](#forum) - grav-learn/pages/01.basics/07.getting-help/docs.md
- [Which version do I have?](#which-version-do-i-have-) - grav-learn/pages/01.basics/08.updates/docs.md
- [Chapter 1](#chapter-1) - grav-learn/pages/01.basics/chapter.md
- [Regular Page](#regular-page) - grav-learn/pages/02.content/01.content-pages/docs.md
- [Basic Page Headers](#basic-page-headers) - grav-learn/pages/02.content/02.headers/docs.md
- [Collection Object](#collection-object) - grav-learn/pages/02.content/03.collections/docs.17.md
- [Basics of Grav Collections](#basics-of-grav-collections) - grav-learn/pages/02.content/03.collections/docs.md
- [Headings](#headings) - grav-learn/pages/02.content/04.markdown/docs.md
- [Slug Relative](#slug-relative) - grav-learn/pages/02.content/05.linking/docs.md
- [Slug Relative](#slug-relative) - grav-learn/pages/02.content/06.image-linking/docs.md
- [Supported Media Files](#supported-media-files) - grav-learn/pages/02.content/07.media/docs.md
- [Taxonomy Example](#taxonomy-example) - grav-learn/pages/02.content/08.taxonomy/docs.md
- [What are Modular Pages and what are they not?](#what-are-modular-pages-and-what-are-they-not-) - grav-learn/pages/02.content/09.modular/docs.md
- [Page Level Route and Redirect Overrides](#page-level-route-and-redirect-overrides) - grav-learn/pages/02.content/10.routing/docs.md
- [Single language different than English](#single-language-different-than-english) - grav-learn/pages/02.content/11.multi-language/docs.md
- [Default Content Type](#default-content-type) - grav-learn/pages/02.content/12.content-types/docs.md
- [Chapter 2](#chapter-2) - grav-learn/pages/02.content/chapter.md
- [Content Pages & Twig Templates](#content-pages---twig-templates) - grav-learn/pages/03.themes/01.theme-basics/docs.md
- [Quark](#quark) - grav-learn/pages/03.themes/02.theme-tutorial/docs.md
- [How Does Twig Work?](#how-does-twig-work-) - grav-learn/pages/03.themes/03.twig-primer/docs.md
- [`markdown`](#-markdown-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/01.tags/docs.md
- [`absolute_url`](#-absolute-url-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/02.filters/docs.md
- [`array`](#-array-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/03.functions/docs.md
- [Tags](#tags) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/docs.md
- [Accessing Theme Blueprint Information](#accessing-theme-blueprint-information) - grav-learn/pages/03.themes/05.theme-configuration/docs.md
- [Core Objects](#core-objects) - grav-learn/pages/03.themes/06.theme-vars/docs.md
- [Configuration](#configuration) - grav-learn/pages/03.themes/07.asset-manager/docs.15.md
- [Configuration](#configuration) - grav-learn/pages/03.themes/07.asset-manager/docs.16.md
- [Custom CSS](#custom-css) - grav-learn/pages/03.themes/08.customization/docs.md
- [Chapter 3](#chapter-3) - grav-learn/pages/03.themes/chapter.md
- [Powerful!](#powerful-) - grav-learn/pages/04.plugins/01.plugin-basics/docs.md
- [Installation](#installation) - grav-learn/pages/04.plugins/02.plugin-install/docs.md
- [Randomizer Plugin Overview](#randomizer-plugin-overview) - grav-learn/pages/04.plugins/03.plugin-tutorial/docs.md
- [Event Order](#event-order) - grav-learn/pages/04.plugins/04.event-hooks/docs.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.16.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.17.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.md
- [Introduction](#introduction) - grav-learn/pages/04.plugins/06.plugin-flex/docs.md
- [Chapter 4](#chapter-4) - grav-learn/pages/04.plugins/chapter.md
- [Features](#features) - grav-learn/pages/05.admin-panel/01.introduction/docs.md
- [Content](#content) - grav-learn/pages/05.admin-panel/02.dashboard/01.configuration-system/docs.md
- [Defaults](#defaults) - grav-learn/pages/05.admin-panel/02.dashboard/02.configuration-site/docs.md
- [Profile Photo](#profile-photo) - grav-learn/pages/05.admin-panel/02.dashboard/03.profile/docs.md
- [Cache and Updates Checking](#cache-and-updates-checking) - grav-learn/pages/05.admin-panel/02.dashboard/docs.md
- [User Profile](#user-profile) - grav-learn/pages/05.admin-panel/03.accounts/01.users/docs.17.md
- [User Group](#user-group) - grav-learn/pages/05.admin-panel/03.accounts/02.groups/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/03.configuration/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/04.permissions/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/docs.17.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/03.page/01.editor/docs.md
- [Publishing](#publishing) - grav-learn/pages/05.admin-panel/03.page/02.options/docs.md
- [Settings](#settings) - grav-learn/pages/05.admin-panel/03.page/03.advanced/docs.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.page/04.security/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.page/05.configuration/docs.17.md
- [Page CRUD Access Check Workflow](#page-crud-access-check-workflow) - grav-learn/pages/05.admin-panel/03.page/06.permissions/docs.17.md
- [Adding New Pages](#adding-new-pages) - grav-learn/pages/05.admin-panel/03.page/docs.md
- [Plugin Information](#plugin-information) - grav-learn/pages/05.admin-panel/04.plugins/01.options/docs.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/04.plugins/docs.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/05.themes/docs.md
- [How to Set it Up](#how-to-set-it-up) - grav-learn/pages/05.admin-panel/06.security/01.2fa/docs.md
- [What You'll Need](#what-you-ll-need) - grav-learn/pages/05.admin-panel/06.security/02.rate-limiting/docs.md
- [docs](#docs) - grav-learn/pages/05.admin-panel/06.security/docs.md
- [Uploading](#uploading) - grav-learn/pages/05.admin-panel/07.tools/docs.md
- [Available Admin Event Hooks](#available-admin-event-hooks) - grav-learn/pages/05.admin-panel/08.extending/01.admin-events/docs.md
- [Understanding Admin Themes](#understanding-admin-themes) - grav-learn/pages/05.admin-panel/08.extending/docs.md
- [Manual Installation of Admin](#manual-installation-of-admin) - grav-learn/pages/05.admin-panel/09.faq/docs.md
- [Chapter 5](#chapter-5) - grav-learn/pages/05.admin-panel/chapter.md
- [Available Form Fields for Use in the Admin](#available-form-fields-for-use-in-the-admin) - grav-learn/pages/06.forms/01.blueprints/01.fields-available/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/02.example-plugin-blueprint/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/03.example-plugin-configuration/docs.md
- [A first example](#a-first-example) - grav-learn/pages/06.forms/01.blueprints/04.example-page-blueprint/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/05.example-config-blueprints/docs.md
- [File Uploads](#file-uploads) - grav-learn/pages/06.forms/01.blueprints/06.how-to-add-file-upload/docs.md
- [Defining Validation Rules](#defining-validation-rules) - grav-learn/pages/06.forms/01.blueprints/07.advanced-features/docs.md
- [What is a Blueprint?](#what-is-a-blueprint-) - grav-learn/pages/06.forms/01.blueprints/docs.md
- [Name](#name) - grav-learn/pages/06.forms/02.forms/01.form-options/docs.md
- [Common Field Attributes](#common-field-attributes) - grav-learn/pages/06.forms/02.forms/02.fields-available/docs.md
- [Simple Contact Form](#simple-contact-form) - grav-learn/pages/06.forms/02.forms/03.example-form/docs.md
- [Form actions](#form-actions) - grav-learn/pages/06.forms/02.forms/04.reference-form-actions/docs.md
- [Using forms in modular pages](#using-forms-in-modular-pages) - grav-learn/pages/06.forms/02.forms/05.how-to-forms-in-modular-pages/docs.md
- [Submitting forms via XHR/Ajax](#submitting-forms-via-xhr-ajax) - grav-learn/pages/06.forms/02.forms/06.how-to-ajax-submission/docs.md
- [Create a simple single form](#create-a-simple-single-form) - grav-learn/pages/06.forms/02.forms/docs.md
- [Chapter 6](#chapter-6) - grav-learn/pages/06.forms/chapter.md
- [MacOS](#macos) - grav-learn/pages/07.cli-console/01.command-line-intro/docs.md
- [Backup](#backup) - grav-learn/pages/07.cli-console/02.grav-cli/docs.md
- [Reserved Commands and Options](#reserved-commands-and-options) - grav-learn/pages/07.cli-console/03.grav-cli-plugin/docs.md
- [PHP CGI-FCGI Information](#php-cgi-fcgi-information) - grav-learn/pages/07.cli-console/04.grav-cli-gpm/docs.md
- [Prerequisites](#prerequisites) - grav-learn/pages/07.cli-console/05.scripted-upgrades/docs.md
- [Chapter 7](#chapter-7) - grav-learn/pages/07.cli-console/chapter.md
- [Enabling a Directory](#enabling-a-directory) - grav-learn/pages/08.advanced/01.flex/01.administration/01.introduction/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/01.views-list/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/02.views-edit/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/03.configuration/docs.17.md
- [Enabling a Directory](#enabling-a-directory) - grav-learn/pages/08.advanced/01.flex/01.administration/docs.17.md
- [count()](#count--) - grav-learn/pages/08.advanced/01.flex/02.using/01.flex/docs.17.md
- [getTitle()](#gettitle--) - grav-learn/pages/08.advanced/01.flex/02.using/02.directory/docs.17.md
- [Render Collection](#render-collection) - grav-learn/pages/08.advanced/01.flex/02.using/03.collection/docs.17.md
- [Render Object](#render-object) - grav-learn/pages/08.advanced/01.flex/02.using/04.object/docs.17.md
- [Using `flex-objects` Page Type](#using--flex-objects--page-type) - grav-learn/pages/08.advanced/01.flex/02.using/docs.17.md
- [Flex Configuration](#flex-configuration) - grav-learn/pages/08.advanced/01.flex/03.custom-types/01.blueprint/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/08.advanced/01.flex/03.custom-types/docs.17.md
- [Introduction](#introduction) - grav-learn/pages/08.advanced/01.flex/docs.17.md
- [Performance](#performance) - grav-learn/pages/08.advanced/02.performance-and-caching/docs.md
- [Debug Bar](#debug-bar) - grav-learn/pages/08.advanced/03.debugging/docs.md
- [Automatic Environment Configuration](#automatic-environment-configuration) - grav-learn/pages/08.advanced/04.environment-config/docs.md
- [What is a Multisite Setup?](#what-is-a-multisite-setup-) - grav-learn/pages/08.advanced/05.multisite-setup/docs.17.md
- [What is a Multisite Setup?](#what-is-a-multisite-setup-) - grav-learn/pages/08.advanced/05.multisite-setup/docs.md
- [docs](#docs) - grav-learn/pages/08.advanced/06.plugin-prioritization/docs.md
- [Installation](#installation) - grav-learn/pages/08.advanced/06.scheduler/docs.16.md
- [Configuration](#configuration) - grav-learn/pages/08.advanced/07.backups/docs.16.md
- [Preparations](#preparations) - grav-learn/pages/08.advanced/09.grav-development/01.grav-15-upgrade-guide/docs.md
- [Deprecated Debug Bar Tab](#deprecated-debug-bar-tab) - grav-learn/pages/08.advanced/09.grav-development/02.grav-16-upgrade-guide/docs.md
- [Most Common Issues](#most-common-issues) - grav-learn/pages/08.advanced/09.grav-development/03.grav-17-upgrade-guide/docs.md
- [Grav Core](#grav-core) - grav-learn/pages/08.advanced/09.grav-development/docs.md
- [Scalars](#scalars) - grav-learn/pages/08.advanced/11.yaml/docs.md
- [Defining groups](#defining-groups) - grav-learn/pages/08.advanced/14.groups-and-permissions/docs.md
- [Scenario 1, run in the domain root folder](#scenario-1--run-in-the-domain-root-folder) - grav-learn/pages/08.advanced/15.change-site-url/docs.md
- [Chapter 8](#chapter-8) - grav-learn/pages/08.advanced/chapter.md
- [Requirements](#requirements) - grav-learn/pages/09.webservers-hosting/00.servers/01.nginx/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/00.servers/02.grav-built-in/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/00.servers/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/01.rochen/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/02.wirenine/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/03.crucial/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/04.siteground/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/05.arvixe/docs.md
- [Configuring PHP](#configuring-php) - grav-learn/pages/09.webservers-hosting/01.shared/06.dreamhost/docs.md
- [Install Grav from Marketplace](#install-grav-from-marketplace) - grav-learn/pages/09.webservers-hosting/01.shared/07.alwaysdata/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/01.shared/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/02.linode/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/03.rosehosting/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/04.vultr/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/docs.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/generic/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-14.04/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-16.04/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-18.04/default.md
- [Sign up](#sign-up) - grav-learn/pages/09.webservers-hosting/03.paas/01.fortrabbit/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/02.heroku/docs.md
- [Signing Up On Cloudways](#signing-up-on-cloudways) - grav-learn/pages/09.webservers-hosting/03.paas/03.cloudways/docs.md
- [Things you'll need](#things-you-ll-need) - grav-learn/pages/09.webservers-hosting/03.paas/04.azure/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/05.dokku/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/docs.md
- [Installing ddev](#installing-ddev) - grav-learn/pages/09.webservers-hosting/04.local-development-with-ddev/docs.md
- [Test Hosting with the PHP Built-in Web Server](#test-hosting-with-the-php-built-in-web-server) - grav-learn/pages/09.webservers-hosting/06.php-built-in-web-server/docs.md
- [Installing Windows Subsystem for Linux](#installing-windows-subsystem-for-linux) - grav-learn/pages/09.webservers-hosting/06.windows-subsystem-for-linux/docs.md
- [Chapter 9](#chapter-9) - grav-learn/pages/09.webservers-hosting/chapter.md
- [Change the PHP CLI version](#change-the-php-cli-version) - grav-learn/pages/10.cookbook/01.general-recipes/docs.md
- [List the last 5 recent blog posts](#list-the-last-5-recent-blog-posts) - grav-learn/pages/10.cookbook/02.twig-recipes/docs.md
- [Output some PHP code result in a Twig template](#output-some-php-code-result-in-a-twig-template) - grav-learn/pages/10.cookbook/03.plugin-recipes/docs.md
- [Add a custom YAML file](#add-a-custom-yaml-file) - grav-learn/pages/10.cookbook/04.admin-recipes/docs.md
- [Check your theme provides the Blog and Item page templates](#check-your-theme-provides-the-blog-and-item-page-templates) - grav-learn/pages/10.cookbook/06.tutorials/04.create-a-blog/docs.md
- [Tutorials](#tutorials) - grav-learn/pages/10.cookbook/06.tutorials/chapter.md
- [Chapter 10](#chapter-10) - grav-learn/pages/10.cookbook/chapter.md
- [IIS use of .htaccess file](#iis-use-of--htaccess-file) - grav-learn/pages/11.troubleshooting/01.page-not-found/docs.md
- [Out-of-date configuration](#out-of-date-configuration) - grav-learn/pages/11.troubleshooting/02.server-error/docs.md
- [Test PHP is Working](#test-php-is-working) - grav-learn/pages/11.troubleshooting/03.internal-server-error/docs.md
- [403 issue in Admin](#403-issue-in-admin) - grav-learn/pages/11.troubleshooting/04.forbidden/docs.md
- [docs](#docs) - grav-learn/pages/11.troubleshooting/05.invalid-security-token/docs.md
- [#!/bin/sh](#---bin-sh) - grav-learn/pages/11.troubleshooting/05.permissions/docs.md
- [docs](#docs) - grav-learn/pages/11.troubleshooting/06.proxy/docs.md
- [Cannot connect to the GPM](#cannot-connect-to-the-gpm) - grav-learn/pages/11.troubleshooting/07.common-problems/docs.md
- [How to Edit .htaccess in Windows and macOS](#how-to-edit--htaccess-in-windows-and-macos) - grav-learn/pages/11.troubleshooting/07.htaccess/docs.md
- [Chapter 11](#chapter-11) - grav-learn/pages/11.troubleshooting/chapter.md
- [Requirements](#requirements) - grav-learn/pages/12.migration/01.drupal7tograv/docs.16.md
- [Requirements](#requirements) - grav-learn/pages/12.migration/02.wordpresstograv/docs.16.md
- [Chapter 12](#chapter-12) - grav-learn/pages/12.migration/chapter.md
- [Submitting a report
](#submitting-a-report-) - grav-learn/pages/13.security/01.overview/docs.md
- [Production Site](#production-site) - grav-learn/pages/13.security/02.configuration/docs.17.md
- [Grav Users and the Administration Panel](#grav-users-and-the-administration-panel) - grav-learn/pages/13.security/03.users/docs.md
- [Best practices](#best-practices) - grav-learn/pages/13.security/04.developers/docs.md
- [Grav and default configuration](#grav-and-default-configuration) - grav-learn/pages/13.security/05.server-side/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/2017-06-17/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/2018-06-11/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/admin-2018-001/docs.md
- [docs](#docs) - grav-learn/pages/13.security/06.reports/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/report-template/docs.md
- [Chapter 13
](#chapter-13-) - grav-learn/pages/13.security/chapter.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.16.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.17.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.md
- [docs](#docs) - grav-learn/pages/15.hints-tips/00.blogging/01.metadata/docs.md
- [docs](#docs) - grav-learn/pages/15.hints-tips/00.blogging/docs.md
- [Chapter 15](#chapter-15) - grav-learn/pages/15.hints-tips/chapter.md
- [Advanced Search](#advanced-search) - grav-learn/pages/search/search.md
- [Grav Documentation](#grav-documentation) - grav-learn/README.md

---

## Grav Documentation

> Path: grav-documentation.md

# Grav Documentation

> Compiled on Wed 30 Apr 2025 17:17:58 AEST

> Contains 194 documents

## Table of Contents

- [Grav Documentation](#grav-documentation) - grav-documentation.md
- [Grav's Place in the Universe](#grav-s-place-in-the-universe) - grav-learn/pages/01.basics/01.what-is-grav/docs.md
- [Web Servers](#web-servers) - grav-learn/pages/01.basics/02.requirements/docs.md
- [Check for PHP version](#check-for-php-version) - grav-learn/pages/01.basics/03.installation/docs.md
- [Content Basics](#content-basics) - grav-learn/pages/01.basics/04.basic-tutorial/docs.md
- [System Configuration](#system-configuration) - grav-learn/pages/01.basics/05.grav-configuration/docs.17.md
- [System Configuration](#system-configuration) - grav-learn/pages/01.basics/05.grav-configuration/docs.md
- [/assets](#-assets) - grav-learn/pages/01.basics/06.folder-structure/docs.md
- [Forum](#forum) - grav-learn/pages/01.basics/07.getting-help/docs.md
- [Which version do I have?](#which-version-do-i-have-) - grav-learn/pages/01.basics/08.updates/docs.md
- [Chapter 1](#chapter-1) - grav-learn/pages/01.basics/chapter.md
- [Regular Page](#regular-page) - grav-learn/pages/02.content/01.content-pages/docs.md
- [Basic Page Headers](#basic-page-headers) - grav-learn/pages/02.content/02.headers/docs.md
- [Collection Object](#collection-object) - grav-learn/pages/02.content/03.collections/docs.17.md
- [Basics of Grav Collections](#basics-of-grav-collections) - grav-learn/pages/02.content/03.collections/docs.md
- [Headings](#headings) - grav-learn/pages/02.content/04.markdown/docs.md
- [Slug Relative](#slug-relative) - grav-learn/pages/02.content/05.linking/docs.md
- [Slug Relative](#slug-relative) - grav-learn/pages/02.content/06.image-linking/docs.md
- [Supported Media Files](#supported-media-files) - grav-learn/pages/02.content/07.media/docs.md
- [Taxonomy Example](#taxonomy-example) - grav-learn/pages/02.content/08.taxonomy/docs.md
- [What are Modular Pages and what are they not?](#what-are-modular-pages-and-what-are-they-not-) - grav-learn/pages/02.content/09.modular/docs.md
- [Page Level Route and Redirect Overrides](#page-level-route-and-redirect-overrides) - grav-learn/pages/02.content/10.routing/docs.md
- [Single language different than English](#single-language-different-than-english) - grav-learn/pages/02.content/11.multi-language/docs.md
- [Default Content Type](#default-content-type) - grav-learn/pages/02.content/12.content-types/docs.md
- [Chapter 2](#chapter-2) - grav-learn/pages/02.content/chapter.md
- [Content Pages & Twig Templates](#content-pages---twig-templates) - grav-learn/pages/03.themes/01.theme-basics/docs.md
- [Quark](#quark) - grav-learn/pages/03.themes/02.theme-tutorial/docs.md
- [How Does Twig Work?](#how-does-twig-work-) - grav-learn/pages/03.themes/03.twig-primer/docs.md
- [`markdown`](#-markdown-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/01.tags/docs.md
- [`absolute_url`](#-absolute-url-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/02.filters/docs.md
- [`array`](#-array-) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/03.functions/docs.md
- [Tags](#tags) - grav-learn/pages/03.themes/04.twig-tags-filters-functions/docs.md
- [Accessing Theme Blueprint Information](#accessing-theme-blueprint-information) - grav-learn/pages/03.themes/05.theme-configuration/docs.md
- [Core Objects](#core-objects) - grav-learn/pages/03.themes/06.theme-vars/docs.md
- [Configuration](#configuration) - grav-learn/pages/03.themes/07.asset-manager/docs.15.md
- [Configuration](#configuration) - grav-learn/pages/03.themes/07.asset-manager/docs.16.md
- [Custom CSS](#custom-css) - grav-learn/pages/03.themes/08.customization/docs.md
- [Chapter 3](#chapter-3) - grav-learn/pages/03.themes/chapter.md
- [Powerful!](#powerful-) - grav-learn/pages/04.plugins/01.plugin-basics/docs.md
- [Installation](#installation) - grav-learn/pages/04.plugins/02.plugin-install/docs.md
- [Randomizer Plugin Overview](#randomizer-plugin-overview) - grav-learn/pages/04.plugins/03.plugin-tutorial/docs.md
- [Event Order](#event-order) - grav-learn/pages/04.plugins/04.event-hooks/docs.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.16.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.17.md
- [index.php](#index-php) - grav-learn/pages/04.plugins/05.grav-lifecycle/docs.md
- [Introduction](#introduction) - grav-learn/pages/04.plugins/06.plugin-flex/docs.md
- [Chapter 4](#chapter-4) - grav-learn/pages/04.plugins/chapter.md
- [Features](#features) - grav-learn/pages/05.admin-panel/01.introduction/docs.md
- [Content](#content) - grav-learn/pages/05.admin-panel/02.dashboard/01.configuration-system/docs.md
- [Defaults](#defaults) - grav-learn/pages/05.admin-panel/02.dashboard/02.configuration-site/docs.md
- [Profile Photo](#profile-photo) - grav-learn/pages/05.admin-panel/02.dashboard/03.profile/docs.md
- [Cache and Updates Checking](#cache-and-updates-checking) - grav-learn/pages/05.admin-panel/02.dashboard/docs.md
- [User Profile](#user-profile) - grav-learn/pages/05.admin-panel/03.accounts/01.users/docs.17.md
- [User Group](#user-group) - grav-learn/pages/05.admin-panel/03.accounts/02.groups/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/03.configuration/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/04.permissions/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.accounts/docs.17.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/03.page/01.editor/docs.md
- [Publishing](#publishing) - grav-learn/pages/05.admin-panel/03.page/02.options/docs.md
- [Settings](#settings) - grav-learn/pages/05.admin-panel/03.page/03.advanced/docs.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.page/04.security/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/05.admin-panel/03.page/05.configuration/docs.17.md
- [Page CRUD Access Check Workflow](#page-crud-access-check-workflow) - grav-learn/pages/05.admin-panel/03.page/06.permissions/docs.17.md
- [Adding New Pages](#adding-new-pages) - grav-learn/pages/05.admin-panel/03.page/docs.md
- [Plugin Information](#plugin-information) - grav-learn/pages/05.admin-panel/04.plugins/01.options/docs.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/04.plugins/docs.md
- [Controls](#controls) - grav-learn/pages/05.admin-panel/05.themes/docs.md
- [How to Set it Up](#how-to-set-it-up) - grav-learn/pages/05.admin-panel/06.security/01.2fa/docs.md
- [What You'll Need](#what-you-ll-need) - grav-learn/pages/05.admin-panel/06.security/02.rate-limiting/docs.md
- [docs](#docs) - grav-learn/pages/05.admin-panel/06.security/docs.md
- [Uploading](#uploading) - grav-learn/pages/05.admin-panel/07.tools/docs.md
- [Available Admin Event Hooks](#available-admin-event-hooks) - grav-learn/pages/05.admin-panel/08.extending/01.admin-events/docs.md
- [Understanding Admin Themes](#understanding-admin-themes) - grav-learn/pages/05.admin-panel/08.extending/docs.md
- [Manual Installation of Admin](#manual-installation-of-admin) - grav-learn/pages/05.admin-panel/09.faq/docs.md
- [Chapter 5](#chapter-5) - grav-learn/pages/05.admin-panel/chapter.md
- [Available Form Fields for Use in the Admin](#available-form-fields-for-use-in-the-admin) - grav-learn/pages/06.forms/01.blueprints/01.fields-available/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/02.example-plugin-blueprint/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/03.example-plugin-configuration/docs.md
- [A first example](#a-first-example) - grav-learn/pages/06.forms/01.blueprints/04.example-page-blueprint/docs.md
- [docs](#docs) - grav-learn/pages/06.forms/01.blueprints/05.example-config-blueprints/docs.md
- [File Uploads](#file-uploads) - grav-learn/pages/06.forms/01.blueprints/06.how-to-add-file-upload/docs.md
- [Defining Validation Rules](#defining-validation-rules) - grav-learn/pages/06.forms/01.blueprints/07.advanced-features/docs.md
- [What is a Blueprint?](#what-is-a-blueprint-) - grav-learn/pages/06.forms/01.blueprints/docs.md
- [Name](#name) - grav-learn/pages/06.forms/02.forms/01.form-options/docs.md
- [Common Field Attributes](#common-field-attributes) - grav-learn/pages/06.forms/02.forms/02.fields-available/docs.md
- [Simple Contact Form](#simple-contact-form) - grav-learn/pages/06.forms/02.forms/03.example-form/docs.md
- [Form actions](#form-actions) - grav-learn/pages/06.forms/02.forms/04.reference-form-actions/docs.md
- [Using forms in modular pages](#using-forms-in-modular-pages) - grav-learn/pages/06.forms/02.forms/05.how-to-forms-in-modular-pages/docs.md
- [Submitting forms via XHR/Ajax](#submitting-forms-via-xhr-ajax) - grav-learn/pages/06.forms/02.forms/06.how-to-ajax-submission/docs.md
- [Create a simple single form](#create-a-simple-single-form) - grav-learn/pages/06.forms/02.forms/docs.md
- [Chapter 6](#chapter-6) - grav-learn/pages/06.forms/chapter.md
- [MacOS](#macos) - grav-learn/pages/07.cli-console/01.command-line-intro/docs.md
- [Backup](#backup) - grav-learn/pages/07.cli-console/02.grav-cli/docs.md
- [Reserved Commands and Options](#reserved-commands-and-options) - grav-learn/pages/07.cli-console/03.grav-cli-plugin/docs.md
- [PHP CGI-FCGI Information](#php-cgi-fcgi-information) - grav-learn/pages/07.cli-console/04.grav-cli-gpm/docs.md
- [Prerequisites](#prerequisites) - grav-learn/pages/07.cli-console/05.scripted-upgrades/docs.md
- [Chapter 7](#chapter-7) - grav-learn/pages/07.cli-console/chapter.md
- [Enabling a Directory](#enabling-a-directory) - grav-learn/pages/08.advanced/01.flex/01.administration/01.introduction/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/01.views-list/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/02.views-edit/docs.17.md
- [Controls](#controls) - grav-learn/pages/08.advanced/01.flex/01.administration/03.configuration/docs.17.md
- [Enabling a Directory](#enabling-a-directory) - grav-learn/pages/08.advanced/01.flex/01.administration/docs.17.md
- [count()](#count--) - grav-learn/pages/08.advanced/01.flex/02.using/01.flex/docs.17.md
- [getTitle()](#gettitle--) - grav-learn/pages/08.advanced/01.flex/02.using/02.directory/docs.17.md
- [Render Collection](#render-collection) - grav-learn/pages/08.advanced/01.flex/02.using/03.collection/docs.17.md
- [Render Object](#render-object) - grav-learn/pages/08.advanced/01.flex/02.using/04.object/docs.17.md
- [Using `flex-objects` Page Type](#using--flex-objects--page-type) - grav-learn/pages/08.advanced/01.flex/02.using/docs.17.md
- [Flex Configuration](#flex-configuration) - grav-learn/pages/08.advanced/01.flex/03.custom-types/01.blueprint/docs.17.md
- [docs.17](#docs-17) - grav-learn/pages/08.advanced/01.flex/03.custom-types/docs.17.md
- [Introduction](#introduction) - grav-learn/pages/08.advanced/01.flex/docs.17.md
- [Performance](#performance) - grav-learn/pages/08.advanced/02.performance-and-caching/docs.md
- [Debug Bar](#debug-bar) - grav-learn/pages/08.advanced/03.debugging/docs.md
- [Automatic Environment Configuration](#automatic-environment-configuration) - grav-learn/pages/08.advanced/04.environment-config/docs.md
- [What is a Multisite Setup?](#what-is-a-multisite-setup-) - grav-learn/pages/08.advanced/05.multisite-setup/docs.17.md
- [What is a Multisite Setup?](#what-is-a-multisite-setup-) - grav-learn/pages/08.advanced/05.multisite-setup/docs.md
- [docs](#docs) - grav-learn/pages/08.advanced/06.plugin-prioritization/docs.md
- [Installation](#installation) - grav-learn/pages/08.advanced/06.scheduler/docs.16.md
- [Configuration](#configuration) - grav-learn/pages/08.advanced/07.backups/docs.16.md
- [Preparations](#preparations) - grav-learn/pages/08.advanced/09.grav-development/01.grav-15-upgrade-guide/docs.md
- [Deprecated Debug Bar Tab](#deprecated-debug-bar-tab) - grav-learn/pages/08.advanced/09.grav-development/02.grav-16-upgrade-guide/docs.md
- [Most Common Issues](#most-common-issues) - grav-learn/pages/08.advanced/09.grav-development/03.grav-17-upgrade-guide/docs.md
- [Grav Core](#grav-core) - grav-learn/pages/08.advanced/09.grav-development/docs.md
- [Scalars](#scalars) - grav-learn/pages/08.advanced/11.yaml/docs.md
- [Defining groups](#defining-groups) - grav-learn/pages/08.advanced/14.groups-and-permissions/docs.md
- [Scenario 1, run in the domain root folder](#scenario-1--run-in-the-domain-root-folder) - grav-learn/pages/08.advanced/15.change-site-url/docs.md
- [Chapter 8](#chapter-8) - grav-learn/pages/08.advanced/chapter.md
- [Requirements](#requirements) - grav-learn/pages/09.webservers-hosting/00.servers/01.nginx/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/00.servers/02.grav-built-in/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/00.servers/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/01.rochen/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/02.wirenine/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/03.crucial/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/04.siteground/docs.md
- [Picking your Hosting Plan](#picking-your-hosting-plan) - grav-learn/pages/09.webservers-hosting/01.shared/05.arvixe/docs.md
- [Configuring PHP](#configuring-php) - grav-learn/pages/09.webservers-hosting/01.shared/06.dreamhost/docs.md
- [Install Grav from Marketplace](#install-grav-from-marketplace) - grav-learn/pages/09.webservers-hosting/01.shared/07.alwaysdata/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/01.shared/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/02.linode/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/03.rosehosting/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/04.vultr/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/02.vps/docs.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/generic/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-14.04/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-16.04/default.md
- [Update and Upgrade Packages](#update-and-upgrade-packages) - grav-learn/pages/09.webservers-hosting/02.vps/ubuntu-18.04/default.md
- [Sign up](#sign-up) - grav-learn/pages/09.webservers-hosting/03.paas/01.fortrabbit/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/02.heroku/docs.md
- [Signing Up On Cloudways](#signing-up-on-cloudways) - grav-learn/pages/09.webservers-hosting/03.paas/03.cloudways/docs.md
- [Things you'll need](#things-you-ll-need) - grav-learn/pages/09.webservers-hosting/03.paas/04.azure/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/05.dokku/docs.md
- [docs](#docs) - grav-learn/pages/09.webservers-hosting/03.paas/docs.md
- [Installing ddev](#installing-ddev) - grav-learn/pages/09.webservers-hosting/04.local-development-with-ddev/docs.md
- [Test Hosting with the PHP Built-in Web Server](#test-hosting-with-the-php-built-in-web-server) - grav-learn/pages/09.webservers-hosting/06.php-built-in-web-server/docs.md
- [Installing Windows Subsystem for Linux](#installing-windows-subsystem-for-linux) - grav-learn/pages/09.webservers-hosting/06.windows-subsystem-for-linux/docs.md
- [Chapter 9](#chapter-9) - grav-learn/pages/09.webservers-hosting/chapter.md
- [Change the PHP CLI version](#change-the-php-cli-version) - grav-learn/pages/10.cookbook/01.general-recipes/docs.md
- [List the last 5 recent blog posts](#list-the-last-5-recent-blog-posts) - grav-learn/pages/10.cookbook/02.twig-recipes/docs.md
- [Output some PHP code result in a Twig template](#output-some-php-code-result-in-a-twig-template) - grav-learn/pages/10.cookbook/03.plugin-recipes/docs.md
- [Add a custom YAML file](#add-a-custom-yaml-file) - grav-learn/pages/10.cookbook/04.admin-recipes/docs.md
- [Check your theme provides the Blog and Item page templates](#check-your-theme-provides-the-blog-and-item-page-templates) - grav-learn/pages/10.cookbook/06.tutorials/04.create-a-blog/docs.md
- [Tutorials](#tutorials) - grav-learn/pages/10.cookbook/06.tutorials/chapter.md
- [Chapter 10](#chapter-10) - grav-learn/pages/10.cookbook/chapter.md
- [IIS use of .htaccess file](#iis-use-of--htaccess-file) - grav-learn/pages/11.troubleshooting/01.page-not-found/docs.md
- [Out-of-date configuration](#out-of-date-configuration) - grav-learn/pages/11.troubleshooting/02.server-error/docs.md
- [Test PHP is Working](#test-php-is-working) - grav-learn/pages/11.troubleshooting/03.internal-server-error/docs.md
- [403 issue in Admin](#403-issue-in-admin) - grav-learn/pages/11.troubleshooting/04.forbidden/docs.md
- [docs](#docs) - grav-learn/pages/11.troubleshooting/05.invalid-security-token/docs.md
- [#!/bin/sh](#---bin-sh) - grav-learn/pages/11.troubleshooting/05.permissions/docs.md
- [docs](#docs) - grav-learn/pages/11.troubleshooting/06.proxy/docs.md
- [Cannot connect to the GPM](#cannot-connect-to-the-gpm) - grav-learn/pages/11.troubleshooting/07.common-problems/docs.md
- [How to Edit .htaccess in Windows and macOS](#how-to-edit--htaccess-in-windows-and-macos) - grav-learn/pages/11.troubleshooting/07.htaccess/docs.md
- [Chapter 11](#chapter-11) - grav-learn/pages/11.troubleshooting/chapter.md
- [Requirements](#requirements) - grav-learn/pages/12.migration/01.drupal7tograv/docs.16.md
- [Requirements](#requirements) - grav-learn/pages/12.migration/02.wordpresstograv/docs.16.md
- [Chapter 12](#chapter-12) - grav-learn/pages/12.migration/chapter.md
- [Submitting a report
](#submitting-a-report-) - grav-learn/pages/13.security/01.overview/docs.md
- [Production Site](#production-site) - grav-learn/pages/13.security/02.configuration/docs.17.md
- [Grav Users and the Administration Panel](#grav-users-and-the-administration-panel) - grav-learn/pages/13.security/03.users/docs.md
- [Best practices](#best-practices) - grav-learn/pages/13.security/04.developers/docs.md
- [Grav and default configuration](#grav-and-default-configuration) - grav-learn/pages/13.security/05.server-side/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/2017-06-17/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/2018-06-11/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/admin-2018-001/docs.md
- [docs](#docs) - grav-learn/pages/13.security/06.reports/docs.md
- [Advisory](#advisory) - grav-learn/pages/13.security/06.reports/report-template/docs.md
- [Chapter 13
](#chapter-13-) - grav-learn/pages/13.security/chapter.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.16.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.17.md
- [Table of contents](#table-of-contents) - grav-learn/pages/14.api/default.md
- [docs](#docs) - grav-learn/pages/15.hints-tips/00.blogging/01.metadata/docs.md
- [docs](#docs) - grav-learn/pages/15.hints-tips/00.blogging/docs.md
- [Chapter 15](#chapter-15) - grav-learn/pages/15.hints-tips/chapter.md
- [Advanced Search](#advanced-search) - grav-learn/pages/search/search.md
- [Grav Documentation](#grav-documentation) - grav-learn/README.md


---

## Grav's Place in the Universe

> Path: grav-learn/pages/01.basics/01.what-is-grav/docs.md


Grav is a **Fast**, **Simple**, and **Flexible** file-based Web-platform. There is **Zero** installation required.  Just extract the ZIP archive, and you are already up and running.  Although Grav follows principles similar to other flat-file CMS platforms, it has a different design philosophy than most.

The name **Grav** is just a shortened version of the word **Gravity**. The shared namespace of our platform and a movie starring Sandra Bullock is pure coincidence! More importantly, gravity is also a fundamental physical principle that describes the forces of attraction between objects. Frankly, the name was chosen as a temporary "codename" for the project, and it just stuck.

The underlying architecture of Grav is built using well established and _best-in-class_ technologies. This is to ensure that Grav is simple to use and easy to extend. Some of these key technologies include:

* [Twig Templating](https://twig.symfony.com/): for powerful control of the user interface
* [Markdown](https://en.wikipedia.org/wiki/Markdown): for easy content creation
* [YAML](https://yaml.org): for simple configuration
* [Parsedown](https://parsedown.org/): for fast Markdown and Markdown Extra support
* [Doctrine Cache](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/caching.html): for performance
* [Pimple Dependency Injection Container](https://github.com/silexphp/Pimple): for extensibility and maintainability
* [Symfony Event Dispatcher](https://symfony.com/doc/current/components/event_dispatcher.html): for plugin event handling
* [Symfony Console](https://symfony.com/doc/current/components/console.html): for CLI interface
* [Gregwar Image Library](https://github.com/Gregwar/Image): for dynamic image manipulation

## Grav's Place in the Universe

There are many powerful open source CMS solutions for building complex websites.  Some of the more commonly used ones are [Joomla](https://www.joomla.org), [WordPress](https://wordpress.org), and [Drupal](https://www.drupal.org). The downside of these platforms is that they have a steep learning curve associated with them. This requires a significant amount of your time - and this may be the time that you do not have.

These platforms provide a wealth of features and functionality that you can extend with a wide variety of open source and proprietary plug-ins and themes.  These extensions and themes are themselves often feature-packed, requiring more knowledge and time on the part of the developer yet.

In the end, you often find yourself creating a website that requires many plugins and extensions from many different vendors. This can make your design overly complicated and difficult to maintain over the long term.

Grav tackles the problem differently.  It focuses primarily on your content and turns your content structure into a navigable site.  The underpinnings of Grav are simple, yet via extensive **events**, you have complete control over every step in the Grav workflow.

This solution allows simple plugins to quickly and easily add powerful functionality. Using **Grav** also leads to a rapid development environment with an installation process that takes seconds, including a straightforward content creation method with a minimal learning curve. All of this contributes to making Grav friendly to the designer, the developer, and the end user.

To get a basic site up-and-running requires minimal Web development experience. If you dig a little deeper, you will discover that there is very little Grav cannot accomplish.

### Grav Logos and Press Information

You can find a summary about Grav, including **Grav logos** and **press information**, on our [media page](https://getgrav.org/media).

!!! The simplest way to navigate the documentation is to use the **Previous** and **Next** arrows (<i class="fa fa-angle-left"></i> | <i class="fa fa-angle-right"></i>) at the top of each page. You can see your progress represented by the check marks (<i class="fa fa-check-circle"></i>) in the sidebar.

---

## Web Servers

> Path: grav-learn/pages/01.basics/02.requirements/docs.md


Grav is intentionally designed with few requirements. You can easily run Grav on your local computer, as well as 99% of all Web hosting providers. If you have a pen handy, jot down the following Grav system requirements:

1. Web Server (Apache, Nginx, LiteSpeed, Lightly, IIS, etc.)
[version=15]
2. PHP 5.6.3 or higher
[/version]
[version=16]
3. PHP 7.1.3 or higher
[/version]
[version=17]
4. PHP 7.3.6 or higher
[/version]

5. hmm... that's it really, (but please look at PHP requirements for a smooth experience)!

Grav is built with plain text files for your content. There is no database needed.

!! A PHP user cache such as APCu, Memcached, or Redis is highly recommended for optimal performance. Not to worry though, these are usually already part of your hosting package!

## Web Servers

Grav is so simple and versatile that you don't even need a web server to run it. You can run it directly off the built-in PHP webserver, as long as you're running [version=15]**PHP 5.6.3**[/version][version=16]**PHP 7.1.3**[/version][version=17]**PHP 7.3.6**[/version] or later.

Testing with the built-in webservers is a useful way to check a Grav install and perform some brief development, but it is **not** recommended for a live site or even for advanced development tasks. We've outlined how in our [Installation guide](../installation#running-grav-with-the-built-in-php-webserver-using-routerphp).

Even though technically you do not need a standalone web server, it is better to run one, even for local development. There are many great options available:

### Mac

* MacOS 10.14 Mojave already ships with the Apache Web server and PHP 7.1, so job done!
* [MAMP/MAMP Pro](https://www.mamp.info/en/mac/) comes with Apache, MySQL and of course PHP. It is a great way to get more control over which version of PHP you are running, setting up virtual hosts, plus other useful features such as automatically handling dynamic DNS.
* [DDEV](https://ddev.com/) for docker-based PHP development environments.
* [AMPPS](https://www.ampps.com/downloads) is a software stack from Softaculous enabling Apache, PHP, Perl, Python,.. This includes everything you need (and more) for GRAV development.
* [Brew Apache/PHP](https://getgrav.org/blog/macos-mojave-apache-multiple-php-versions) is an alternative approach that allows a fully configurable installation with various PHP versions.

### Windows

* [Laragon](https://laragon.org/) portable, isolated, fast & powerful universal development environment for PHP, Node.js, and more. It is fast, lightweight, easy-to-use and easy-to-extend.
* [XAMPP](https://www.apachefriends.org/index.html) provides Apache, PHP, and MySQL in one simple package.
* [EasyPHP](https://www.easyphp.org/) provides a personal Web hosting package as well as a more powerful developer version.
* [MAMP for Windows](https://www.mamp.info/en/windows/) is a long-time Mac favorite, but now available for Windows.
* [IIS with PHP](https://php.iis.net/) is a fast way to run PHP on Windows.
* [DDEV](https://ddev.com/) for docker-based PHP development environments.
* [AMPPS](https://www.ampps.com/downloads) is a software stack from Softaculous enabling Apache, PHP, Perl, Python,.. This includes everything you need (and more) for GRAV development.
* [Linux Subsystem](https://medium.freecodecamp.org/setup-a-php-development-environment-on-windows-subsystem-for-linux-wsl-9193ff28ae83) is a great way to Run a linux-like environment on Windows

### Linux

* Many distributions of Linux already come with Apache and PHP built-in. If they're not, the distribution usually provides a package manager through which you can install them without much hassle. More advanced configurations should be investigated with the help of a good search engine.

### Apache Requirements

Even though most distributions of Apache come with everything needed, for the sake of completeness, here is a list of required Apache modules:

* `mod_rewrite`
* `mod_ssl` (if you wish to run Grav under SSL)
* `mod_mpm_itk_module` (if you wish to run Grav under its own user account)

You should also ensure you have `AllowOverride All` set in the `<Directory>` and/or `<VirtualHost>` blocks so that the `.htaccess` file processes correctly, and rewrite rules take effect.

### IIS Requirements

Although IIS is considered a web server ready to run 'out-of-the-box', some changes need to be made.

To get **Grav** running on an IIS server, you need to install **URL Rewrite**. This can be accomplished using **Microsoft Web Platform Installer** from within IIS. You can also install URL Rewrite by going to [iis.net](https://www.iis.net/downloads/microsoft/url-rewrite).

### PHP Requirements

Most hosting providers and even local LAMP setups have PHP pre-configured with everything you need for Grav to run 'out-of-the-box'. However, some Windows setups, and even Linux distributions local or on VPS (I'm looking at you Debian!) - ship with a very minimal PHP compile. Therefore, you may need to install or enable these PHP modules:

* `curl` (client for URL handling used by GPM)
* `ctype` (used by symfony/yaml/Inline)
* `dom` (used by grav/admin newsfeed)
* `gd` (a graphics library used to manipulate images)
* `json` (used by Symfony/Composer/GPM)
* `mbstring` (multibyte string support)
* `openssl` (secure sockets library used by GPM)
* `session` (used by toolbox)
* `simplexml` (used by grav/admin newsfeed)
* `xml` (XML support)
* `zip` extension support (used by GPM)

For enabling `openssl` and (un)zip support you will need to find in the `php.ini` file of your Linux distribution for lines like:

[prism classes="language-bash line-numbers"]
;extension=openssl.so
;extension=zip.so
[/prism]

and remove the leading semicolon.

##### Optional Modules

* `apcu` for increased cache performance
* `opcache` for increased PHP performance
* `yaml` PECL Yaml provides native yaml processing and can dramatically increase performance
* `xdebug` useful for debugging in a development environment

### Permissions

For Grav to function correctly, your web server needs to have the appropriate **file permissions** to write logs, caches, etc. When using either the [CLI](/advanced/grav-cli) (Command Line Interface) or [GPM](/advanced/grav-gpm) (Grav Package Manager), the user running PHP from the command line also needs to have the appropriate permissions to modify files.

By default, Grav will install with `644` and `755` permissions for files and folders, respectively. Most hosting providers have configurations that ensure that a web server running PHP will allow you to create and modify files within your user account. This means that Grav runs **out-of-the-box** on the vast majority of hosting providers.

However, if you are running on a dedicated server or even your local environment, you may need to adjust permissions to ensure your **user** and your **web server** can modify files as needed. There are a couple of approaches you can take.

1. In a **local development environment**, you can usually configure your web server to run under your user profile. This way the web server will always allow you to create and modify files.

2. Change the **group permissions** on all files and folders so that the web server's group has write access to files and folders while keeping the standard permissions. This requires a few commands to make this work.

First, find out which user Apache runs with by running the following command:

[prism classes="language-bash command-line"]
ps aux | grep -v root | grep apache | cut -d\  -f1 | sort | uniq
[/prism]

Now, find out which group this user belongs to by running this command (note: adjust USERNAME with the apache username you found in the previous command)

[prism classes="language-bash command-line"]
groups USERNAME
[/prism]

(note: adjust `GROUP` to be the group your apache runs under, found in the previous command. [`www-data`, `apache`, `nobody`, etc.]):

[prism classes="language-bash line-numbers"]
chgrp -R GROUP .
find . -type f | xargs chmod 664
find . /bin -type f | xargs chmod 775
find . -type d | xargs chmod 775
find . -type d | xargs chmod +s
umask 0002
[/prism]

If you need to invoke superuser permissions, you would run `find  | sudo xargs chmod ` instead.

## Recommended Tools

### PhpStorm

Grav is developed using [PhpStorm](https://www.jetbrains.com/phpstorm/), which makes it the best IDE for Grav. However, it does not come for free.

PhpStorm is best suited for PHP developers, including people who write complicated Grav plugins. It offers automated code compilation for Grav (you just need to add Grav and any plugin you use into includes), and many other tools to aid with the code development. It has also good support for formatting twig, yaml, html, js, scss and tailwind.

### Text Editors

Although you can get away with Notepad, Textedit, Vi, or whatever default text editor comes with your platform, we recommend using a good text editor with syntax highlighting to make things easier. Here are some recommended options:

1. [Visual Studio Code](https://code.visualstudio.com/) - Similar to Atom, it's built using Electron, Node, as well as HTML/CSS.  It's quite lightweight and has many plugins available, including very good support for PHP and JavaScript.  This is the current recommended editor for developing for Grav.
2. [SublimeText](https://www.sublimetext.com/) - MacOS/Windows/Linux - A commercial developer's editor, but well worth the price. Very powerful especially combined with plugins such as [Markdown Extended](https://sublime.wbond.net/packages/Markdown%20Extended), [Pretty YAML](https://sublime.wbond.net/packages/Pretty%20YAML), and [PHP-Twig](https://sublime.wbond.net/packages/PHP-Twig).
3. [Notepad++](https://notepad-plus-plus.org/) - Windows - A free and very popular developer's editor for Windows.
4. [Bluefish](https://bluefish.openoffice.nl/index.html) - MacOS/Windows/Linux - A free, open source text editor geared towards programmers and web developers.
5. [Kate](https://kate-editor.org/about-kate/) - MacOS/Windows/Linux - A light yet powerfull and versatile opensource text editor and programming tool, supporting highlighting for over 300 languages (including Markdown).

### Markdown Editors

Another option if you primarily work with just creating content, is to use a dedicated **Markdown Editor**. These often are very content-centric and usually provide a **live-preview** of your content rendered as HTML. There are literally hundreds of these, but some good options include:

1. [MacDown](https://macdown.uranusjr.com/) - MacOS - Free, a simple, lightweight open source Markdown editor.
2. [LightPaper](https://getlightpaper.com/) - MacOS - $17.99, clean, powerful. Our markdown editor of choice on the Mac. **Get 25% OFF with Discount Code: GET_GRAV_25**
3. [MarkDrop](https://culturezoo.com/markdrop/) - MacOS - $5, but super clean and Droplr support built-in.
4. [MarkdownPad](https://markdownpad.com/) - Windows - Free and Pro versions. Even has YAML front-matter support. An excellent solution for Windows users.
5. [Mark Text](https://github.com/marktext/marktext) - Free, open source Markdown editor for Windows / Linux / MacOS.

### FTP Clients

Although there are many ways to deploy **Grav**, fundamentally you only need to copy your local site to your hosting provider. The most basic way to do this is with an [FTP Client](https://en.wikipedia.org/wiki/File_Transfer_Protocol). There are many available, but some recommended ones include:

1. [Transmit](https://panic.com/transmit/) - MacOS - The de facto FTP/SFTP client on MacOS. Easy to use, fast, folder-syncing and pretty much anything else you could ask for.
2. [FileZilla](https://filezilla-project.org/) - MacOS/Windows/Linux - Probably the best option for Windows and Linux users. Free and very powerful (but very ugly on the Mac!).
3. [Cyberduck](https://cyberduck.io/) - MacOS/Windows - A decent free option for both MacOS and Windows users. Not as full-featured as the others.
4. [ForkLift](https://www.binarynights.com/forklift/) - MacOS - A solid alternative to Transmit, and slightly cheaper to boot.

### Git

If you run the [Git](https://git-scm.com/) distributed version control system on your development and server environments, you can set up a simple workflow via a hosted Git service like [Github](https://github.com) or [GitLab](https://about.gitlab.com/). This is slightly more work to set up, but provides a cleaner, more robust workflow that takes care of backups for you. Try this only if you are comfortable with Git and its client tools.

!!! We provide more details about using Git in your workflow later under [Deploying with Git](/webservers-hosting/deploying-with-git) section in the [Web Servers & Hosting chapter](/webservers-hosting).

---

## Check for PHP version

> Path: grav-learn/pages/01.basics/03.installation/docs.md


Installation of Grav is a trivial process. In fact, there is no real installation. You have several options for installing Grav. The first  and simplest  way is to download the **zip** archive, and extract it. The second way is to install with **Composer**. The third way is to clone the source project directly from **GitHub**, and then run an included script command to install needed dependencies. There are [more ways](#further-options) that involve running bundled scripts.

## Check for PHP version

Grav is incredibly easy to set up and get running. Be sure you have at least PHP version [version=15]5.6.3+[/version][version=16]7.1.3+[/version][version=17]7.3.6+[/version] by going to the terminal and typing `php -v`:

[prism classes="language-bash command-line" cl-output="2-10"]
php -v
PHP 7.3.18 (cli) (built: Jun  5 2020 11:06:30) ( NTS )
Copyright (c) 1997-2018 The PHP Group
Zend Engine v3.3.18, Copyright (c) 1998-2018 Zend Technologies
    with Zend OPcache v7.3.18, Copyright (c) 1999-2018, by Zend Technologies
[/prism]


## Option 1: Install from ZIP package

The easiest way to install Grav is to download the ZIP package and extract it:

1. Download the latest-and-greatest **[Grav](https://getgrav.org/download/core/grav/latest)** or **[Grav + Admin](https://getgrav.org/download/core/grav-admin/latest)** package.
2. Extract the ZIP file in the [webroot](https://www.wordnik.com/words/webroot) of your web server, e.g. `~/webroot/grav`

!!! There are [Skeleton](https://getgrav.org/downloads/skeletons)-packages available, which include the core Grav system, sample pages, plugins, and configuration. They are a great way to get started; all you have to do is [download the Skeleton](https://getgrav.org/downloads/skeletons)-package you prefer, and follow the steps above.

You can also download any pre-packaged installation of a [tagged release](https://github.com/getgrav/grav/tags) from getgrav.org. Use the format `https://getgrav.org/download/TYPE/PACKAGE/VERSION`.

- [getgrav.org/download/core/grav/1.7.0](https://getgrav.org/download/core/grav/1.7.0) downloads Grav Core v1.7.0
- [getgrav.org/download/core/grav/1.7.0-rc.10?testing=true](https://getgrav.org/download/core/grav/1.7.0-rc.10?testing=true) downloads Grav Core v1.7.0-rc.10, a testing release
- [getgrav.org/download/core/grav-admin/1.7.0](https://getgrav.org/download/core/grav-admin/1.7.0) downloads Grav Core with the Admin plugin, at Core v1.7.0
- [getgrav.org/download/core/grav-admin/1.7.0-rc.10?testing=true](https://getgrav.org/download/core/grav-admin/1.7.0-rc.10?testing=true) downloads Grav Core v1.7.0-rc.10 with the Admin plugin, a testing release
- [getgrav.org/download/core/grav-update/1.7.0](https://getgrav.org/download/core/grav-update/1.7.0) downloads the update package for Grav Core
- [getgrav.org/download/plugins/flex-objects-json/0.1.0](https://getgrav.org/download/plugins/flex-objects-json/0.1.0) downloads the Flex Objects JSON plugin at v0.1.0
- [getgrav.org/download/themes/quark/2.0.3](https://getgrav.org/download/themes/quark/2.0.3) downloads the Quark theme at v2.0.3

!!!! If you downloaded the ZIP file and then plan to move it to your webroot, please move the **ENTIRE FOLDER** because it contains several hidden files (such as .htaccess) that will not be selected by default. The omission of these hidden files can cause problems when running Grav.


## Option 2: Install with composer

The alternative method is to install Grav with [composer](https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx):

[prism classes="language-bash command-line"]
composer create-project getgrav/grav ~/webroot/grav
[/prism]

If you want to check out the bleeding edge version of Grav, add `1.x-dev` as an additional parameter:

[prism classes="language-bash command-line"]
composer create-project getgrav/grav ~/webroot/grav 1.x-dev
[/prism]

## Option 3: Install from GitHub

Another method is to clone Grav from the GitHub repository, and then run a simple dependency installation script:

1. Clone the Grav repository from [GitHub](https://github.com/getgrav/grav) to a folder in the webroot of your server, e.g. `~/webroot/grav`. Launch a **terminal** or **console** and navigate to the webroot folder:

   [prism classes="language-bash command-line"]
   cd ~/webroot
   git clone -b master https://github.com/getgrav/grav.git
   [/prism]

2. Install **vendor dependencies** via [composer](https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx):

   [prism classes="language-bash command-line"]
   cd ~/webroot/grav
   composer install --no-dev -o
   [/prism]

3. Install the **plugin** and **theme dependencies** by using the [Grav CLI application](../../advanced/grav-cli) `bin/grav`:

   [prism classes="language-bash command-line"]
   cd ~/webroot/grav
   bin/grav install
   [/prism]

   This will automatically **clone** the required dependencies from GitHub directly into this Grav installation.

## Further options

### Install with Docker

[Docker](https://en.wikipedia.org/wiki/Docker_(software)) is an extremely efficient way to bootstrap platforms and services on both servers and local environments. If you are setting up several environments that need to be the same, or working collaboratively, it offers a simple way to ensure consistency between installations. If you are developing several Grav sites, you can streamline setting them up using Docker.

Stable Docker images are available that use [Apache](https://github.com/getgrav/docker-grav) (the official image), [Nginx](https://github.com/dsavell/docker-grav), and [Caddy](https://github.com/hughbris/grav-daddy) webservers. If you search, you will find more that you can try. With any image, make sure you create volumes to persist Grav's `user`, `backups`, and `logs` folders. (Backups and logs are optional if you don't need to keep that data.)

### Install on Cloudron

Cloudron is a complete solution for running apps on your server and keeping them up-to-date and secure. On your Cloudron you can install Grav with a few clicks. If you host multiple sites, you can install them completely isolated from one another on the same server.

[![button: Cloudron install](https://cloudron.io/img/button.svg)](https://cloudron.io/store/org.getgrav.cloudronapp.html)

The source code for the package can be found [here](https://git.cloudron.io/cloudron/grav-app).

### Install through Linode Marketplace

If you use Linode servers, there is an [easy, documented method using Linode Marketplace](https://www.linode.com/docs/guides/grav-marketplace-app/). This will set up a new Grav site on a new dedicated Linode virtual server. The virtual server will incur a periodic charge.

## Webservers

#### Apache/IIS/Nginx

Using Grav with a web server such as Apache, IIS, or Nginx is as simple as extracting Grav into a folder under the [webroot](https://www.wordnik.com/words/webroot). All it requires to function is [version=15]PHP 5.6.3[/version][version=16]PHP 7.1.3[/version][version=17]PHP 7.3.6[/version] or higher, so you should make sure that your server instance meets that requirement. More information about Grav requirements can be found in the [requirements](../requirements) chapter of this guide.

If your web root is, for example, `~/public_html` then you could extract it into this folder and reach it via `http://localhost`. If you extracted it into `~/public_html/grav` you would reach it via `http://localhost/grav`.

!!! Every web server must be configured. Grav ships with .htaccess by default, for Apache, and comes with some [default server configuration files](https://github.com/getgrav/grav/tree/master/webserver-configs), for `nginx`, `caddy server`, `iis`, and `lighttpd`. Use them accordingly when needed.

#### Running Grav with the Built-in PHP Webserver

You can run Grav using a simple command from Terminal / Command Prompt using the built-in PHP server available as long as you have PHP installed.

All you need to do is navigate to the root of your Grav install using the Terminal or Command Prompt and enter `bin/grav server`.

!! While technically all you need is PHP installed, if you install the [Symfony CLI application](https://symfony.com/download) the server will provide an SSL certificate so you can use `https://` and make use of PHP-FPM for better performance.

Entering this command will present you with output similar to the following:

[prism classes="language-bash command-line" cl-output="2-100"]
 bin/grav server

Grav Web Server
===============

Tailing Web Server log file (/Users/joeblow/.symfony/log/96e710135f52930318e745e901e4010d0907cec3.log)
Tailing PHP-FPM log file (/Users/joeblow/.symfony/log/96e710135f52930318e745e901e4010d0907cec3/53fb8ec204547646acb3461995e4da5a54cc7575.log)
Tailing PHP-FPM log file (/Users/joeblow/.symfony/log/96e710135f52930318e745e901e4010d0907cec3/53fb8ec204547646acb3461995e4da5a54cc7575.log)

[OK] Web server listening
The Web server is using PHP FPM 8.0.8
https://127.0.0.1:8000


[Web Server ] Jul 30 14:54:53 |DEBUG  | PHP    Reloading PHP versions
[Web Server ] Jul 30 14:54:54 |DEBUG  | PHP    Using PHP version 8.0.8 (from default version in $PATH)
[PHP-FPM    ] Jul  6 14:40:17 |NOTICE | FPM    fpm is running, pid 64992
[PHP-FPM    ] Jul  6 14:40:17 |NOTICE | FPM    ready to handle connections
[PHP-FPM    ] Jul  6 14:40:17 |NOTICE | FPM    fpm is running, pid 64992
[PHP-FPM    ] Jul  6 14:40:17 |NOTICE | FPM    ready to handle connections
[Web Server ] Jul 30 14:54:54 |INFO   | PHP    listening path="/usr/local/Cellar/php/8.0.8_2/sbin/php-fpm" php="8.0.8" port=65140
[PHP-FPM    ] Jul 30 14:54:54 |NOTICE | FPM    fpm is running, pid 73709
[PHP-FPM    ] Jul 30 14:54:54 |NOTICE | FPM    ready to handle connections
[PHP-FPM    ] Jul 30 14:54:54 |NOTICE | FPM    fpm is running, pid 73709
[PHP-FPM    ] Jul 30 14:54:54 |NOTICE | FPM    ready to handle connections
[/prism]

Your terminal will also give you real-time updates of any activity on this ad hoc-style server. You can copy the URL provided in the `[OK] Web server listening` line and paste that into your browser of choice to access your site, including the administrator.

```
https://127.0.0.1:8000
```

!!!! This is a useful tool for quick development, and should **not** be used in place of a dedicated web server such as Apache or Nginx.

## Successful Installation

The first time it loads, Grav pre-compiles some files. If you now refresh your browser, you will get a faster, cached version.

![Grav Installed](install.png)

!! In the previous examples, **$** represents the command prompt. This may look different on various platforms.

By default, Grav comes with some sample pages to give you something to get started with. Your site is already fully functional and you can configure it, add content, extend it, or customize it as much as you like.

## Installation & Setup Problems

If any issues are discovered during the initial page load (or after a cache-flush event) you may see an error page:

![Grav with Problems](problems.png)

Please consult the [Troubleshooting](../../troubleshooting) section for help regarding specific issues.

! If you have issues with file permissions, please check the [Permissions Troubleshooting documentation](/troubleshooting/permissions). Also, you could look at the [Hosting Guides documentation](/webservers-hosting) that has specific instructions for various hosting environments

## Grav Updates

To keep your site up to date, please read [Updating Grav & Plugins](/basics/updates).

---

## Content Basics

> Path: grav-learn/pages/01.basics/04.basic-tutorial/docs.md


Assuming you successfully [installed Grav](../installation) with the instructions listed in the previous chapter, we can continue and play around with Grav a little to get you more comfortable.

Because Grav does not require a database, it is pretty easy to work with, without having to worry about causing issues between your Grav installation and any other significant data source. If something goes awry, you can generally recover very easily.

## Content Basics

First, let us familiarize ourselves with where Grav stores content.  We will go into more depth in a [future chapter](../folder-structure), but for the time being, you need to be aware that all our user content, is stored in the `user/pages/` folder of your Grav install.

Currently, there are two folders in the pages folder, the first one is called `01.home` and the second is `02.typography`.  The `01.` portion of the folder is optional but provides a couple of things that can be handy.

Firstly, it lets you expressly define the order of your pages.  For example, `01` will come before `02`, but `00` will come before `01`.

The other thing that the numeric portion of the folder name does is explicitly inform Grav this page should be visible in the menu.  It is important to note that the numeric portion up to and including the `.` will be removed from URLs.

## Home Page Configuration

There is an option in the `user/config/system.yaml` file that sets the location of the __home page__, in other words, where Grav points to when you reference the root of your site: `http://yoursite.com`.

If you examine this configuration file in your install, you will see that it already points to the alias for `/home`.  We can leave it like this in this example.

## Page Editing

Pages in **Grav** are composed in **Markdown** syntax.  Markdown is a plain text formatting syntax that a computer can readily parse and convert to HTML. It uses basic text symbols to indicate presentation (e.g. **bold**, _italics_, headings, lists, etc.), making it easy to write without needing to know the complexities of HTML. Benefits of Markdown include lower error rate, readability, ease of learning and use, etc.

You can read an [extensive write-up of available syntax](../../content/markdown) with examples in the documentation, but for now, follow along.

Open the home page in your text editor. The file that controls the homepage is located in the `user/pages/01.home/` folder and is called `default.md`. All of the content you create will be created in the `user/pages/` folder in your Grav installation.

When you edit the page in a text editor, the content will look something like this:

[div class="no-margin-bottom"]
[prism classes="language-yaml line-numbers"]
[/prism]
[/div]
[div class="no-margin-top"]
[prism classes="language-markdown line-numbers" ln-start="5"]
# Say Hello to Grav!
## installation successful...

Congratulations! You have installed the **Base Grav Package** that provides a **simple page** and the default **Quark** theme to get you started.

!! If you see a **404 Error** when you click `Typography` in the menu, please refer to the [troubleshooting guide](https://learn.getgrav.org/troubleshooting/page-not-found).
[/prism]
[/div]

Let us break this down a little so you can see how easy it is to write in Markdown. The stuff between the `---` indicators are the [Page Headers](../../content/headers), and these are written in a straightforward format called [YAML](../../advanced/yaml). This configuration block that sits in the `.md` file is commonly known as **YAML Front Matter**.

[prism classes="language-bash line-numbers"]
title: Home
body_classes: title-center title-h1h2
[/prism]

This block sets the HTML title tag for the page (the text you see in the browser tab).  You can also access this from your themes via the `page.title` attribute.  There are a [few standard headers](../../content/headers) that let you configure a variety of options for this page. Another example is `menu: Something` that lets you override the text used to display the name of the page in a menu.  By default, Grav will use the title for the menu value.

[prism classes="language-markdown line-numbers"]
# Say Hello to Grav!
## installation successful...
[/prism]

The `#` or `hashes` syntax in markdown indicates a title.  A single `#` with a space and then text converts into an `<h1>` header in HTML. `##` or double hash would convert into an `<h2>` tag.  Of course, this goes all the way up to the HTML valid `<h6>` tag which of course, would be six hashes: `###### My H6 Level Header`.

[prism classes="language-markdown line-numbers"]
Congratulations! You have installed the **Base Grav Package** that provides a **simple page** and the default **Quark** theme to get you started.
[/prism]

This is a simple paragraph that would have been wrapped in regular `<p>` tags when converted to HTML.  The `**` markers indicate bold text or `<strong>`, formerly `<b>`, in HTML.  Italic text is indicated by wrapping text in `_` markers.

[prism classes="language-markdown line-numbers"]
!! If you see a **404 Error** when you click `Typography` in the menu, please refer to the [troubleshooting guide](https://learn.getgrav.org/troubleshooting/page-not-found).
[/prism]

This section uses a custom markdown feature that is provided by the included `markdown-notices` plugin.  This allows you to create simple notices by prefix a paragraph of text with a number of `!` (exclamation mark) symbols, from `!` to `!!!!`.

This overview should provide you with a few key pointers for writing Markdown, but you should check out our more [detailed explanation](../../content/markdown) to get a thorough understanding.

!! Ensure you save your `.md` files as `UTF8` files.  This will ensure they work with language-specific special characters.

## Adding a New Page

Creating a new page is a simple affair in **Grav**.  Just follow these simple steps:

1. Navigate to your pages folder: `user/pages/` and create a new folder.  In this example, we will use [explicit default ordering](https://learn.getgrav.org/content/content-pages) and call the folder `03.mypage`.
2. Launch your text editor, create a new file, and paste in the following sample code:

[div class="no-margin-bottom"]
[prism classes="language-yaml line-numbers"]
[/prism]
[/div]
[div class="no-margin-top"]
[prism classes="language-markdown line-numbers" ln-start="4"]
# My New Page!

This is the body of **my new page** and I can easily use _Markdown_ syntax here.
[/prism]
[/div]

3. Save this file in the `user/pages/03.mypage/` folder as `default.md`. This will tell **Grav** to render the page using the **default** template in the current theme: `user/themes/quark/templates/default.html.twig`.
4. That's it! Reload your browser to see your new page in the menu at the top.

The page will automatically show up in the menu after the **"Typography"** menu item. If you wish to change the name that shows up in the menu, add: `menu: My Page` between the dashes in the page frontmatter.

**Congratulations**, you have now successfully created a new page in Grav.  There is much more you can do with Grav, so please continue reading to find out about more advanced capabilities and in-depth features.

!! If you have any issues accessing this new page, you are either missing an `.htaccess` file (Apache web server only) or you may need to edit the `RewriteBase` command in the `.htaccess` file. Please consult the [Troubleshooting](../../troubleshooting) chapter for more information.

---

## System Configuration

> Path: grav-learn/pages/01.basics/05.grav-configuration/docs.17.md


All Grav configuration files are written in [YAML syntax](../../advanced/yaml) with a `.yaml` file extension.  YAML is very intuitive which makes it very easy to both read and write, however, you can check out the [YAML page in the Advanced chapter](../../advanced/yaml) to get a complete understanding of the syntax available.

!!! **TIP:** See [Security > Configuration](/security/configuration) for a quick guide how to secure and optimize your production site.

## System Configuration

Grav focuses on making things as easy as possible for the user, and the same goes for configuration.  Grav comes with some sensible default options, and these are contained in a file that resides in the `system/config/system.yaml` file.

However, **you should never change this file**, instead any configuration changes you need to make should be stored in a file called `user/config/system.yaml`.  Any setting in this file with the same structure and naming will override the setting provided in the default system configuration file.

!!!! Generally speaking you should **NEVER** change anything in the `system/` folder.  All things the user does (creating content, installing plugins, editing configuration, etc.) should be done in the `user/` folder.  This way it allows simpler upgrading and also keeps your changes all in one location for backing up, synchronizing, etc.

Here are the variables found in the default `system/config/system.yaml` file:

### Basic Options

[prism classes="language-yaml line-numbers"]
absolute_urls: false
timezone: ''
default_locale:
param_sep: ':'
wrapped_site: false
reverse_proxy_setup: false
force_ssl: false
force_lowercase_urls: true
custom_base_url: ''
username_regex: '^[a-z0-9_-]{3,16}$'
pwd_regex: '(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}'
intl_enabled: true
http_x_forwarded:
  protocol: true
  host: false
  port: true
  ip: true
[/prism]

These configuration options do not appear within their own child sections. They're general options that affect the way the site operates, its timezone, and base URL.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **absolute_urls:** | Absolute or relative URLs for `base_url` |
| **timezone:** | Valid values can be found [here](https://php.net/manual/en/timezones.php) |
| **default_locale:** | Default locale (defaults to system) |
| **param_sep:** | This is used for Grav parameters in the URL.  Don't change this unless you know what you are doing.  Grav automatically sets this to `;` for users running Apache web server on Windows |
| **wrapped_site:** | For themes/plugins to know if Grav is wrapped by another platform. Can be `true` or `false` |
| **reverse_proxy_setup:** | Running in a reverse proxy scenario with different webserver ports than proxy. Can be `true` or `false` |
| **force_ssl:** | If enabled, Grav forces to be accessed via HTTPS (NOTE: Not an ideal solution). Can be `true` or `false` |
| **force_lowercase_urls:** |If you want to support mixed cased URLs set this to `false` |
| **custom_base_url:** | Manually set the base_url here |
| **username_regex:** | Only lowercase chars, digits, dashes, underscores. 3 - 16 chars |
| **pwd_regex:** | At least one number, one uppercase and lowercase letter, and be at least 8+ chars |
| **intl_enabled:** | Special logic for PHP International Extension (mod_intl) |
| **http_x_forwarded:** | Configuration options for the various HTTP_X_FORWARD headers (**Grav 1.7.0+**) |
[/div]

### Languages

[prism classes="language-yaml line-numbers"]
languages:
  supported: []
  default_lang:
  include_default_lang: true
  include_default_lang_file_extension: true
  pages_fallback_only: false
  translations: true
  translations_fallback: true
  session_store_active: false
  http_accept_language: false
  override_locale: false
  content_fallback: {}
[/prism]

The **Languages** area of the file establishes the site's language settings. This includes which language(s) are supported, designation of the default language in the URLs, and translations. Here is the breakdown for the **Languages** area of the system configuration file:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **supported:** | List of languages supported. eg: `[en, fr, de]` |
| **default_lang:** | Default is the first supported language. Must be one of the supported languages |
| **include_default_lang:** | Include the default lang prefix in all URLs. Can be `true` or `false` |
| **include_default_lang_file_extension:** | If enabled, saving a page will prepend the default language to the file extension (eg. `.en.md`). Disable it to keep the default language using `.md` file extension. Can be `true` or `false` (**Grav 1.7.0+**) |
| **pages_fallback_only:** | Only fallback to find page content through supported languages. Can be `true` or `false` |
| **translations:** | Enable translations by default. Can be `true` or `false` |
| **translations_fallback:** | Fallback through supported translations if active lang doesn't exist. Can be `true` or `false` |
| **session_store_active:** | Store active language in session. Can be `true` or `false` |
| **http_accept_language:** | Attempt to set the language based on http_accept_language header in the browser. Can be `true` or `false` |
| **override_locale:** | Override the default or system locale with language specific one. Can be `true` or `false` |
| **content_fallback:** | By default if the content isn't translated, Grav will display the content in the default language. Use this setting to override that behavior per language basis. (**Grav 1.7.0+**) |
[/div]

### Home

[prism classes="language-yaml line-numbers"]
home:
  alias: '/home'
  hide_in_urls: false
[/prism]

The **Home** section is where you set the default route to the site's homepage. You can also choose to hide the home route in URLs.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **alias:** | Default path for home, ie: `/home` or `/` |
| **hide_in_urls:** | Hide the home route in URLs. Can be `true` or `false` |
[/div]

### Pages

[prism classes="language-yaml line-numbers"]
pages:
  type: regular
  theme: quark
  order:
    by: default
    dir: asc
  list:
    count: 20
  dateformat:
    default:
    short: 'jS M Y'
    long: 'F jS \a\t g:ia'
  publish_dates: true
  process:
    markdown: true
    twig: false
  twig_first: false
  never_cache_twig: false
  events:
    page: true
    twig: true
  markdown:
    extra: false
    auto_line_breaks: false
    auto_url_links: false
    escape_markup: false
    special_chars:
      '>': 'gt'
      '<': 'lt'
    valid_link_attributes:
      - rel
      - target
      - id
      - class
      - classes
  types: [html,htm,xml,txt,json,rss,atom]
  append_url_extension: ''
  expires: 604800
  cache_control:
  last_modified: false
  etag: false
  vary_accept_encoding: false
  redirect_default_route: false
  redirect_default_code: 302
  redirect_trailing_slash: true
  ignore_files: [.DS_Store]
  ignore_folders: [.git, .idea]
  ignore_hidden: true
  hide_empty_folders: false
  url_taxonomy_filters: true
  frontmatter:
    process_twig: false
    ignore_fields: ['form','forms']
[/prism]

The **Pages** section of the `system/config/system.yaml` file is where you set a lot of the main theme-related settings. For example, this is where you set the theme used to render the site, page ordering, twig and markdown processing defaults, and more. This is where most of the decisions that affect the way your pages are rendered are made.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **type:** | Experimental setting to enable **Flex Pages** in frontend. Use `flex` to enable, `regular` otherwise. This defaults to `regular` (**Grav 1.7+**) |
| **theme:** | This is where you set the default theme. This defaults to `quark` |
| **order:** | |
| ... **by:** | Order pages by `default`, `alpha` or `date` |
| ... **dir:** | Default ordering direction, `asc` or `desc` |
| **list:** | |
| ... **count:** | Default item count per page |
| **dateformat:** | |
| ... **default:** | The default date format Grav expects in the `date: ` field |
| ... **short:** | Short date format. Example: `'jS M Y'` |
| ... **long:** | Long date format. Example: `'F jS \a\t g:ia'` |
| **publish_dates:** | Automatically publish/unpublish based on dates. Can be set `true` or `false` |
| **process:** | |
| ... **markdown:** | Enable or disable the processing of markdown on the front end. Can be set `true` or `false` |
| ... **twig:** | Enable or disable the processing of twig on the front end. Can be set `true` or `false` |
| **twig_first:** | Process Twig before markdown when processing both on a page. Can be set `true` or `false` |
| **never_cache_twig:** | Enabling this will allow you to add a processing logic that can change dynamically on each page load, rather than caching the results and storing it for each page load. This can be enabled/disabled site-wide in the **system.yaml**, or on a specific page. Can be set `true` or `false` |
| **events:** | |
| ... **page:** | Enable page-level events. Can be set `true` or `false` |
| ... **twig:** | Enable Twig-level events. Can be set `true` or `false` |
| **markdown:** | |
| ... **extra:** | Enable support for Markdown Extra support (GitHub-flavored Markdown (GFM) by default). Can be set `true` or `false` |
| ... **auto_line_breaks:** | Enable automatic line breaks. Can be set `true` or `false` |
| ... **auto_url_links:** | Enable automatic HTML links. Can be set `true` or `false` |
| ... **escape_markup:** | Escape markup tags into entities. Can be set `true` or `false` |
| ... **special_chars:** | List of special characters to automatically convert to entities. Each character consumes a line below this variable. Example: `'>': 'gt'` |
| ... **valid_link_attributes:** | Valid attributes to pass through via markdown links (**Grav 1.7+**) |
| **types:** | List of valid page types. For example: `[txt,xml,html,htm,json,rss,atom]` |
| **append_url_extension:** | Append page's extension in Page URLs (e.g. `.html` results in **/path/page.html**) |
| **expires:** | Page expires time in seconds (604800 seconds = 7 days) (`no cache` is also possible) |
| **cache_control:** | Can be blank for no setting, or a [valid](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) `cache-control` text value |
| **last_modified:** | Set the last modified date header based on file modification timestamp. Can be set `true` or `false` |
| **etag:** | Set the etag header tag. Can be set to `true` or `false` |
| **vary_accept_encoding:** | Add `Vary: Accept-Encoding` header. Can be set to `true` or `false` |
| **redirect_default_route:** | Automatically redirect to a page's default route. Can be set to `true` or `false` |
| **redirect_default_code:** | Default code to use for redirects. For example: `302` |
| **redirect_trailing_slash:** | Handle automatically or 302 redirect a trailing / URL |
| **ignore_files:** | Files to ignore in Pages. Example: `[.DS_Store] ` |
| **ignore_folders:** | Folders to ignore in Pages. Example: `[.git, .idea]` |
| **ignore_hidden:** | Ignore all Hidden files and folders. Can be set to `true` or `false` |
| **hide_empty_folders:** | If folder has no .md file, should it be hidden. Can be set to `true` or `false` |
| **url_taxonomy_filters:** | Enable auto-magic URL-based taxonomy filters for page collections. Can be set to `true` or `false` |
| **frontmatter:** | |
| ... **process_twig:** | Should the frontmatter be processed to replace Twig variables? Can be set to `true` or `false` |
| ... **ignore_fields:** | Fields that might contain Twig variables and should not be processed. Example: `['form','forms']` |
[/div]

### Cache

[prism classes="language-yaml line-numbers"]
cache:
  enabled: true
  check:
    method: file
  driver: auto
  prefix: 'g'
  purge_at: '0 4 * * *'
  clear_at: '0 3 * * *'
  clear_job_type: 'standard'
  clear_images_by_default: false
  cli_compatibility: false
  lifetime: 604800
  gzip: false
  allow_webserver_gzip: false
  redis:
    socket: false
    password:
    database:
[/prism]

The **Cache** section is where you can configure the site's caching settings. You can enable, disable, choose the method, and more.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Set to `true` to enable caching. Can be set to `true` or `false` |
| **check:** | |
| ... **method:** | Method to check for updates in pages. Options: `file`, `folder`, `hash` and `none`. [more details](../../advanced/performance-and-caching#grav-core-caching) |
| **driver:** | Select a cache driver. Options are: `auto`, `file`, `apcu`, `redis`, `memcache`, and `wincache` |
| **prefix:** | Cache prefix string (prevents cache conflicts). Example: `g` |
| **purge_at:** | Scheduler: How often to purge old cache using cron `at` syntax |
| **clear_at:** | Scheduler: How often to clear the cache using cron `at` syntax |
| **clear_job_type:** | Type to clear when processing the scheduled clear job. Options: `standard` \| `all` |
| **clear_images_by_default:** | By default grav does not include processed images when cache clears, this can be enabled by setting this to `true` |
| **cli_compatibility:** | Ensures only non-volatile drivers are used (file, redis, memcache, etc.) |
| **lifetime:** | Lifetime of cached data in seconds (`0` = infinite). `604800` is 7 days |
| **gzip:** | GZip compress the page output. Can be set to `true` or `false` |
| **allow_webserver_gzip:** | This option will change the header to `Content-Encoding: identity` allowing gzip to be more reliably set by the webserver although this usually breaks the out-of-process `onShutDown()` capability.  The event will still run, but it won't be out of process, and may hold up the page until the event is complete |
| **redis:** | |
| **... socket:** | The path to the redis socket file |
| **... password:** | Optional password |
| **... database:** | Optional database ID |
[/div]

### Twig

[prism classes="language-yaml line-numbers"]
twig:
  cache: true
  debug: true
  auto_reload: true
  autoescape: false
  undefined_functions: true
  undefined_filters: true
  umask_fix: false
[/prism]

The **Twig** section gives you a quick set of tools with which to configure Twig on your site for debugging, caching, and optimization.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **cache:** | Set to `true` to enable Twig caching. Can be set to `true` or `false` |
| **debug:** | Enable Twig debug. Can be set to `true` or `false` |
| **auto_reload:** | Refresh cache on changes. Can be set to `true` or `false` |
| **autoescape:** | Autoescape Twig vars. Can be set to `true` or `false` |
| **undefined_functions:** | Allow undefined functions. Can be set to `true` or `false` |
| **undefined_filters:** | Allow undefined filters. Can be set to `true` or `false` |
| **umask_fix:** | By default Twig creates cached files as 755, fix switches this to 775. Can be set to `true` or `false` |
[/div]

### Assets

[prism classes="language-yaml line-numbers"]
assets:
  css_pipeline: false
  css_pipeline_include_externals: true
  css_pipeline_before_excludes: true
  css_minify: true
  css_minify_windows: false
  css_rewrite: true
  js_pipeline: false
  js_pipeline_include_externals: true
  js_pipeline_before_excludes: true
  js_module_pipeline: false
  js_module_pipeline_include_externals: true
  js_module_pipeline_before_excludes: true
  js_minify: true
  enable_asset_timestamp: false
  enable_asset_sri: false
  collections:
    jquery: system://assets/jquery/jquery-2.x.min.js
[/prism]

The **Assets** section enables you to configure options related to the Assets Manager (JS, CSS).

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **css_pipeline:** | The CSS pipeline is the unification of multiple CSS resources into one file. Can be set to `true` or `false` |
| **css_pipeline_include_externals:** | Include external URLs in the pipeline by default. Can be set to `true` or `false` |
| **css_pipeline_before_excludes:** | Render the pipeline before any excluded files. Can be set to `true` or `false` |
| **css_minify:** | Minify the CSS during pipelining. Can be set to `true` or `false` |
| **css_minify_windows:** | Minify Override for Windows platforms. `false` by default due to ThreadStackSize. Can be set to `true` or `false` |
| **css_rewrite:** | Rewrite any CSS relative URLs during pipelining. Can be set to `true` or `false` |
| **js_pipeline:** | The JS pipeline is the unification of multiple JS resources into one file. Can be set to `true` or `false` |
| **js_pipeline_include_externals:** | Include external URLs in the pipeline by default. Can be set to `true` or `false` |
| **js_pipeline_before_excludes:** | Render the pipeline before any excluded files. Can be set to `true` or `false` |
| **js_module_pipeline** | The JS Module pipeline is the unification of multiple JS Module resources into one file. Can be set to `true` or `false` |
| **js_module_pipeline_include_externals** | Include external URLs in the pipeline by default. Can be set to `true` or `false` |
| **js_module_pipeline_before_excludes** | Render the pipeline before any excluded files. Can be set to `true` or `false` |
| **js_minify:** | Minify the JS during pipelining. Can be set to `true` or `false` |
| **enable_asset_timestamp:** | Enable asset timestamps. Can be set to `true` or `false` |
| **enable_asset_sri:** | Enable asset SRI. Can be set to `true` or `false` |
| **collections:** | This contains collections, designated as sub-items. For example: `jquery: system://assets/jquery/jquery-3.x.min.js`. [Read more about this](/themes/asset-manager#collections-and-attributes) |
[/div]

### Errors

[prism classes="language-yaml line-numbers"]
errors:
  display: 0
  log: true
[/prism]

The **Errors** section determines how Grav handles error display and logging.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **display:** | Determines how errors are displayed. Enter either `1` for the full backtrace, `0` for Simple Error, or `-1` for System Error |
| **log:** | Log errors to `/logs` folder. Can be set to `true` or `false` |
[/div]

### Log

[prism classes="language-yaml line-numbers"]
log:
  handler: file
  syslog:
    facility: local6
[/prism]

The **Log** section allows you to configure alternate logging capabilities for Grav.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **handler:** | Log handler. Currently supported: `file` \| `syslog` |
| **syslog:** | |
| ... **facility:** | Syslog facilities output |
[/div]

### Debugger

[prism classes="language-yaml line-numbers"]
debugger:
  enabled: false
  provider: clockwork
  censored: false
  shutdown:
    close_connection: true
[/prism]

The **Debugger** section gives you the ability to activate Grav's debugger. A useful tool during development.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Enable Grav debugger and following settings. Can be set to `true` or `false` |
| **provider:** | Debugger provider: Can be set to `debugbar` or `clockwork` (**Grav 1.7+**) |
| **censored:** | Censor potentially sensitive information (POST parameters, cookies, files, configuration and most array/object data in log messages). Can be set to `true` or `false` (**Grav 1.7+**) |
| **shutdown:** | |
| ... **close_connection:** | Close the connection before calling `onShutdown()`. `false` for debugging |
[/div]

### Images

[prism classes="language-yaml line-numbers"]
images:
  default_image_quality: 85
  cache_all: false
  cache_perms: '0755'
  debug: false
  auto_fix_orientation: false
  seofriendly: false
  cls:
    auto_sizes: false
    aspect_ratio: false
    retina_scale: 1
  defaults:
    loading: auto
[/prism]

The **Images** section gives you the ability to set the default image quality images are resampled to, as well as to control image caching and debugging features.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **default_image_quality:** | Default image quality to use when resampling images. For example: `85` = 85% |
| **cache_all:** | Cache all images by default. Can be set to `true` or `false` |
| **cache_perms:** | **Must be in quotes!** Default cache folder perms. Usually `'0755'` or `'0775'` |
| **debug:** | Show an overlay over images indicating the pixel depth of the image when working with retina, for example. Can be set to `true` or `false` |
| **auto_fix_orientation:** | Try to automatically fix images uploaded with non-standard rotation |
| **seofriendly:** | SEO-friendly processed image names |
| **cls:** | Cumulative Layout Shift. [More details](https://web.dev/optimize-cls/) |
| **... auto_sizes:** | Automatically add height/width to image |
| **... aspect_ratio:** | Reserve space with aspect ratio style |
| **... retina_scale:** | Scale to adjust auto-sizes for better handling of HiDPI resolutions |
| **defaults:** | (**Grav 1.7+**) |
| **... loading:** | Let browser pick: `auto`, `lazy` or `eager` (**Grav 1.7+**) |
[/div]


### Media

[prism classes="language-yaml line-numbers"]
media:
  enable_media_timestamp: false
  unsupported_inline_types: []
  allowed_fallback_types: []
  auto_metadata_exif: false
[/prism]

The **Media** section handles the configuration options for settings related to the handling of media files. This includes timestamp display, upload size, and more.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enable_media_timestamp:** | Enable media timetsamps |
| **unsupported_inline_types:** | Array of supported media types to try to display inline. These file types are placed within `[]` brackets |
| **allowed_fallback_types:** | Array of allowed media types of files found if accessed via Page route. These file types are placed within `[]` brackets |
| **auto_metadata_exif:** | Automatically create metadata files from Exif data where possible |
[/div]

### Session

[prism classes="language-yaml line-numbers"]
session:
  enabled: true
  initialize: true
  timeout: 1800
  name: grav-site
  uniqueness: path
  secure: false
  httponly: true
  samesite: Lax
  split: true
  domain:
  path:
[/prism]

These options determine session properties for your site.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Enable Session support. Can be set to `true` or `false` |
| **initialize:** | Initialize session from Grav (if `false`, plugin needs to start the session) |
| **timeout:** | Timeout in seconds. For example: `1800` |
| **name:** | Name prefix of the session cookie. Use alphanumeric, dashes or underscores only. Do not use dots in the session name. For example: `grav-site` |
| **uniqueness:** | Should sessions be `path` based or `security.salt` based |
| **secure:** | Set session secure. If `true`, indicates that communication for this cookie must be over an encrypted transmission. Enable this only on sites that run exclusively on HTTPS. Can be set to `true` or `false` |
| **httponly:** | Set session HTTP only. If `true`, indicates that cookies should be used only over HTTP, and JavaScript modification is not allowed. Can be set to `true` or `false` |
| **samesite:** | Set session SameSite. Possible values are Lax, Strict and None. See [here](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite) |
| **domain:** | The session domain to be used in the responses. Use only if you you rewrite the site domain for example in a Docker Container. |
| **path:** | The session path to be used in the responses. Use only if you you rewrite the site subfolder for example in a Docker Container. |
[/div]

### GPM

[prism classes="language-yaml line-numbers"]
gpm:
  releases: stable
  proxy_url:
  method: 'auto'
  verify_peer: true
  official_gpm_only: true
[/prism]

Options in the **GPM** section control Grav's GPM (Grav Package Manager). For example, you can restrict GPM to using official sources and select the method GPM uses to retrieve packages. You can also choose between stable and testing releases, as well as set up a proxy URL.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **releases:** | Set to either `stable` or `testing` to determine if you want to update to the latest stable or testing build |
| **proxy_url:** | Configure a manual proxy URL for GPM. For example: `127.0.0.1:3128` |
| **method:** | Either `'curl'`, `'fopen'` or `'auto'`. `'auto'` will try fopen first and if not available cURL |
| **verify_peer:** | On some systems (Windows mostly) GPM is unable to connect because the SSL certificate cannot be verified. Disabling this setting might help |
| **official_gpm_only:** | By default GPM direct-install will only allow URLs via the official GPM proxy to ensure security, disable this to allow other sources |
[/div]

### Accounts

[prism classes="language-yaml line-numbers"]
accounts:
  type: regular
  storage: file
[/prism]

Accounts settings allows you to try out the new experimental Flex Users.  This basically means that Users are stored as Flex objects allowing more power and performance.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **type:** | Account type: `regular` or `flex` |
| **storage:** | Flex storage type: `file` or `folder` |
[/div]

### Flex

[prism classes="language-yaml line-numbers"]
flex:
  cache:
    index:
      enabled: true
      lifetime: 60
    object:
      enabled: true
      lifetime: 600
    render:
      enabled: true
      lifetime: 600
[/prism]

Flex Objects cache configuration settings are new in **Grav 1.7**. These are default settings for all Flex types, but they can be overridden for each `Flex Directory`.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **cache:** | (**Grav 1.7+**) |
| **... index:** | (**Grav 1.7+**) |
| **... ... enabled:** | Set to true to enable Flex index caching. Is used to cache timestamps in files (**Grav 1.7+**) |
| **... ... lifetime:** | Lifetime of cached index in seconds (0 = infinite) (**Grav 1.7+**) |
| **... object:** | (**Grav 1.7+**) |
| **... ... enabled:** | Set to true to enable Flex object caching. Is used to cache object data (**Grav 1.7+**) |
| **... ... lifetime:** | Lifetime of cached objects in seconds (0 = infinite) (**Grav 1.7+**) |
| **... render:** | (**Grav 1.7+**) |
| **... ... enabled:** | Set to true to enable Flex render caching. Is used to cache rendered output (**Grav 1.7+**) |
| **... ... lifetime:** | Lifetime of cached HTML in seconds (0 = infinite) (**Grav 1.7+**) |
[/div]

### Strict Mode

[prism classes="language-yaml line-numbers"]
strict_mode:
  yaml_compat: true
  twig_compat: true
  blueprint_compat: false
[/prism]

Strict mode allows for a cleaner migration to future versions of Grav by moving to the newer versions of YAML and Twig processors.  These may not be compatible with all 3rd party extensions.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **yaml_compat:** | Enables YAML backwards compatibility |
| **twig_compat:** | Enables deprecated Twig autoescape setting |
| **blueprint_compat:** | Enables backward compatible strict support for blueprints |
[/div]

!! You do not need to copy the **entire** configuration file to override it, you can override as little or as much as you like.  Just ensure you have the **exact same naming structure** for the particular setting you want to override.

## Site Configuration

As well as the `system.yaml` file, Grav also provides a default `site.yaml` configuration file that is used to set some front-end specific configuration such as author name, author email, as well as some key taxonomy settings.  You can override these in the same way as you would the system.yaml by providing your own configuration file in `user/config/site.yaml`. You can also use this file to put in arbitrary configuration options that you may want to reference from your content or templates.

The default `system/config/site.yaml` file that ships with Grav looks something like this:

[prism classes="language-yaml line-numbers"]
title: Grav                                 # Name of the site
default_lang: en                            # Default language for site (potentially used by theme)

author:
  name: John Appleseed                      # Default author name
  email: 'john@example.com'                 # Default author email

taxonomies: [category,tag]                  # Arbitrary list of taxonomy types

metadata:
  description: 'My Grav Site'               # Site description

summary:
  enabled: true                             # enable or disable summary of page
  format: short                             # long = summary delimiter will be ignored; short = use the first occurrence of delimiter or size
  size: 300                                 # Maximum length of summary (characters)
  delimiter: ===                            # The summary delimiter

redirects:
#  '/redirect-test': '/'                    # Redirect test goes to home page
#  '/old/(.*)': '/new/$1'                   # Would redirect /old/my-page to /new/my-page

routes:
#  '/something/else': '/blog/sample-3'      # Alias for /blog/sample-3
#  '/new/(.*)': '/blog/$1'                  # Regex any /new/my-page URL to /blog/my-page Route

blog:
  route: '/blog'                            # Custom value added (accessible via site.blog.route)

#menu:                                      # Menu Example
#    - text: Source
#      icon: github
#      url: https://github.com/getgrav/grav
#    - icon: twitter
#      url: http://twitter.com/getgrav
[/prism]

Let's break down the elements of this sample file:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **title:** | The title is a simple string variable that can be referenced whenever you want to display the name of this site |
| **author:** | |
| ... **name:** | The name of the author of the site, that can be referenced whenever you need it |
| ... **email:** | A default email for use in your site |
| **taxonomies:** | An arbitrary list of high-level types that you can use to organize your content.  You can assign content to specific taxonomy types, for example, categories or tags. Feel free to edit, or add your own |
| **metadata:** | Set default metadata for all your pages, see the [content page headers](../../content/headers) section for more details |
| **summary:** | |
| ... **size:** | A variable to override the default number of characters that can be used to set the summary size when displaying a portion of content |
| **routes:** | This is a basic map that can provide simple URL alias capabilities in Grav.  If you browse to `/something/else` you will actually be sent to `/blog/sample-3`. Feel free to edit, or add your own as needed. **Regex Replacements** (`(.*) - $1`) are now supported at the end of route aliases.  You should put these at the bottom of the list for optimal performance |
| **(custom options)** | You can create any option you like in this file and a good example is the `blog: route: '/blog'` option that is accessible in your Twig templates with `site.blog.route` |
[/div]

!! For most people, the most important element of this file is the `Taxonomy` list.  The taxonomies in this list **must** be defined here if you wish to use them in your content.

## Security

For increased security there is `system/config/security.yaml` file that sets some sensible defaults and is used by the Admin plugin when **Saving** content, as well in the new **Reports** section of **Tools**.

The default configuration looks like this:

[prism classes="language-yaml line-numbers"]
xss_whitelist: [admin.super]
xss_enabled:
    on_events: true
    invalid_protocols: true
    moz_binding: true
    html_inline_styles: true
    dangerous_tags: true
xss_invalid_protocols:
    - javascript
    - livescript
    - vbscript
    - mocha
    - feed
    - data
xss_dangerous_tags:
    - applet
    - meta
    - xml
    - blink
    - link
    - style
    - script
    - embed
    - object
    - iframe
    - frame
    - frameset
    - ilayer
    - layer
    - bgsound
    - title
    - base
uploads_dangerous_extensions:
    - php
    - html
    - htm
    - js
    - exe
sanitize_svg: true
[/prism]

If you wish to make any changes to these settings, you should copy this file to `user/config/security.yaml` and make edits there.

## Other Configuration Settings and Files

User configuration is completely optional. You can override as little or as much of the default settings as you need. This applies to both the system, site, and any plugin configurations in your site.

You are also not limited to the `user/config/system.yaml` or the `user/config/site.yaml` files as described above. You can create any arbitrary `.yaml` configuration file in the `user/config` folder you wish and it will get picked up by Grav automatically.

As an example if the new configuration file is named `user/config/data.yaml` and a yaml variable in this file is called count:

```
count: 39
```

The variable would be accessed in your Twig template by using the following syntax:

```
{{ config.data.count }}
```

It would also be accessible via PHP from any plugin with the code:

```
$count_var = Grav::instance()['config']->get('data.count');
```

! You can also provide a custom blueprint to enable your custom file to be editable in the admin plugin. Check out the relevant [recipe in the Admin Cookbook section](/cookbook/admin-recipes#add-a-custom-yaml-file).

### Config Variable Namespacing

Paths to the configuration files will be used as a **namespace** for your configuration options.

Alternatively, you can put all the options into one file and use YAML structures to specify the hierarchy for your configuration options. This namespacing is built from a combination of the **path + filename + option name**.

For example: An option such as `author: Frank Smith` in file `plugins/myplugin.yaml` could be accessible via: `plugins.myplugin.author`. However, you could also have a `plugins.yaml` file and in that file have an option name called `myplugin: author: Frank Smith` and it would still be reachable by the same `plugins.myplugin.author` namespace.

Some example configuration files could be structured:

[div class="table-keycol"]
| File | Description |
| -------- | ----------- |
| **user/config/system.yaml**           | Global system configuration file                  |
| **user/config/site.yaml**             | A site-specific configuration file                |
| **user/config/plugins/myplugin.yaml** | Individual configuration file for myplugin plugin |
| **user/config/themes/mytheme.yaml**  | Individual configuration file for mytheme theme   |
[/div]

!! Having a namespaced configuration file will override or mask all options having the same path in the default configuration files

### Plugins Configuration

Most **plugins** will come with their own YAML configuration file. We recommend copying this file to the `user/config/plugins/` directory rather than editing configuration options directly to the file located in the plugin's directory. Doing this will ensure that an update to the plugin will not overwrite your settings, and keep all of your configurable options in one, convenient place.

If you have a plugin called `user/plugins/myplugin` that has a configuration file called `user/plugins/myplugin/myplugin.yaml` then you would copy this file to `user/config/plugins/myplugin.yaml` and edit the file there.

The YAML file that exists within the plugin's primary directory will act as a fallback. Any settings listed there and not in the User folder's copy will be picked up and used by Grav.

### Themes Configuration

The same rules for **themes** apply as they did for plugins.  So if you have a theme called `user/themes/mytheme` that has a configuration file called `user/themes/mytheme/mytheme.yaml` then you would copy this file to `user/config/themes/mytheme.yaml` and edit the file there.

---

## System Configuration

> Path: grav-learn/pages/01.basics/05.grav-configuration/docs.md


All Grav configuration files are written in [YAML syntax](../../advanced/yaml) with a `.yaml` file extension.  YAML is very intuitive which makes it very easy to both read and write, however, you can check out the [YAML page in the Advanced chapter](../../advanced/yaml) to get a complete understanding of the syntax available.

## System Configuration

Grav focuses on making things as easy as possible for the user, and the same goes for configuration.  Grav comes with some sensible default options, and these are contained in a file that resides in the `system/config/system.yaml` file.

However, **you should never change this file**, instead any configuration changes you need to make should be stored in a file called `user/config/system.yaml`.  Any setting in this file with the same structure and naming will override the setting provided in the default system configuration file.

!!!! Generally speaking you should **NEVER** change anything in the `system/` folder.  All things the user does (creating content, installing plugins, editing configuration, etc.) should be done in the `user/` folder.  This way it allows simpler upgrading and also keeps your changes all in one location for backing up, synchronizing, etc.

Here are the variables found in the default `system/config/system.yaml` file:

### Basic Options

[prism classes="language-yaml line-numbers"]
absolute_urls: false
timezone: ''
default_locale:
param_sep: ':'
wrapped_site: false
reverse_proxy_setup: false
force_ssl: false
force_lowercase_urls: true
custom_base_url: ''
username_regex: '^[a-z0-9_-]{3,16}$'
pwd_regex: '(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}'
intl_enabled: true
[/prism]

These configuration options do not appear within their own child sections. They're general options that affect the way the site operates, its timezone, and base URL.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **absolute_urls:** | Absolute or relative URLs for `base_url` |
| **timezone:** | Valid values can be found [here](https://php.net/manual/en/timezones.php) |
| **default_locale:** | Default locale (defaults to system) |
| **param_sep:** | This is used for Grav parameters in the URL.  Don't change this unless you know what you are doing.  Grav > `1.1.16` automatically sets this to `;` for users running Apache web server on Windows |
| **wrapped_site:** | For themes/plugins to know if Grav is wrapped by another platform. Can be `true` or `false` |
| **reverse_proxy_setup:** | Running in a reverse proxy scenario with different webserver ports than proxy. Can be `true` or `false` |
| **force_ssl:** | If enabled, Grav forces to be accessed via HTTPS (NOTE: Not an ideal solution). Can be `true` or `false` |
| **force_lowercase_urls:** |If you want to support mixed cased URLs set this to `false` |
| **custom_base_url:** | Manually set the base_url here |
| **username_regex:** | Only lowercase chars, digits, dashes, underscores. 3 - 16 chars |
| **pwd_regex:** | At least one number, one uppercase and lowercase letter, and be at least 8+ chars |
| **intl_enabled:** | Special logic for PHP International Extension (mod_intl) |
[/div]

### Languages

[prism classes="language-yaml line-numbers"]
languages:
  supported: []
  include_default_lang: true
  pages_fallback_only: false
  translations: true
  translations_fallback: true
  session_store_active: false
  http_accept_language: false
  override_locale: false
[/prism]

The **Languages** area of the file establishes the site's language settings. This includes which language(s) are supported, designation of the default language in the URLs, and translations. Here is the breakdown for the **Languages** area of the system configuration file:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **supported:** | List of languages supported. eg: `[en, fr, de]` |
| **include_default_lang:** | Include the default lang prefix in all URLs. Can be `true` or `false` |
| **pages_fallback_only:** | Only fallback to find page content through supported languages. Can be `true` or `false` |
| **translations:** | Enable translations by default. Can be `true` or `false` |
| **translations_fallback:** | Fallback through supported translations if active lang doesn't exist. Can be `true` or `false` |
| **session_store_active:** | Store active language in session. Can be `true` or `false` |
| **http_accept_language:** | Attempt to set the language based on http_accept_language header in the browser. Can be `true` or `false` |
| **override_locale:** | Override the default or system locale with language specific one. Can be `true` or `false` |
[/div]

### Home

[prism classes="language-yaml line-numbers"]
home:
  alias: '/home'
  hide_in_urls: false
[/prism]

The **Home** section is where you set the default path for the site's homepage. You can also choose to hide the home route in URLs.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **alias:** | Default path for home, ie: `/home` or `/` |
| **hide_in_urls:** | Hide the home route in URLs. Can be `true` or `false` |
[/div]

### Pages

[prism classes="language-yaml line-numbers"]
pages:
  theme: quark
  order:
    by: default
    dir: asc
  list:
    count: 20
  dateformat:
    default:
    short: 'jS M Y'
    long: 'F jS \a\t g:ia'
  publish_dates: true
  process:
    markdown: true
    twig: false
  twig_first: false
  never_cache_twig: false
  events:
    page: true
    twig: true
  markdown:
    extra: false
    auto_line_breaks: false
    auto_url_links: false
    escape_markup: false
    special_chars:
      '>': 'gt'
      '<': 'lt'
  types: [txt,xml,html,htm,json,rss,atom]
  append_url_extension: ''
  expires: 604800
  cache_control:
  last_modified: false
  etag: false
  vary_accept_encoding: false
  redirect_default_route: false
  redirect_default_code: 302
  redirect_trailing_slash: true
  ignore_files: [.DS_Store]
  ignore_folders: [.git, .idea]
  ignore_hidden: true
  hide_empty_folders: false
  url_taxonomy_filters: true
  frontmatter:
    process_twig: false
    ignore_fields: ['form','forms']
[/prism]

The **Pages** section of the `system/config/system.yaml` file is where you set a lot of the main theme-related settings. For example, this is where you set the theme used to render the site, page ordering, twig and markdown processing defaults, and more. This is where most of the decisions that affect the way your pages are rendered are made.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **theme:** | This is where you set the default theme. This defaults to `quark` |
| **order:** | |
| ... **by:** | Order pages by `default`, `alpha` or `date` |
| ... **dir:** | Default ordering direction, `asc` or `desc` |
| **list:** | |
| ... **count:** | Default item count per page |
| **dateformat:** | |
| ... **default:** | The default date format Grav expects in the `date: ` field |
| ... **short:** | Short date format. Example: `'jS M Y'` |
| ... **long:** | Long date format. Example: `'F jS \a\t g:ia'` |
| **publish_dates:** | Automatically publish/unpublish based on dates. Can be set `true` or `false` |
| **process:** | |
| ... **markdown:** | Enable or disable the processing of markdown on the front end. Can be set `true` or `false` |
| ... **twig:** | Enable or disable the processing of twig on the front end. Can be set `true` or `false` |
| **twig_first:** | Process Twig before markdown when processing both on a page. Can be set `true` or `false` |
| **never_cache_twig:** | Enabling this will allow you to add a processing logic that can change dynamically on each page load, rather than caching the results and storing it for each page load. This can be enabled/disabled site-wide in the **system.yaml**, or on a specific page. Can be set `true` or `false` |
| **events:** | |
| ... **page:** | Enable page-level events. Can be set `true` or `false` |
| ... **twig:** | Enable Twig-level events. Can be set `true` or `false` |
| **markdown:** | |
| ... **extra:** | Enable support for Markdown Extra support (GitHub-flavored Markdown (GFM) by default). Can be set `true` or `false` |
| ... **auto_line_breaks:** | Enable automatic line breaks. Can be set `true` or `false` |
| ... **auto_url_links:** | Enable automatic HTML links. Can be set `true` or `false` |
| ... **escape_markup:** | Escape markup tags into entities. Can be set `true` or `false` |
| ... **special_chars:** | List of special characters to automatically convert to entities. Each character consumes a line below this variable. Example: `'>': 'gt'` |
| **types:** | List of valid page types. For example: `[txt,xml,html,htm,json,rss,atom]` |
| **append_url_extension:** | Append page's extension in Page URLs (e.g. `.html` results in **/path/page.html**) |
| **expires:** | Page expires time in seconds (604800 seconds = 7 days) (`no cache` is also possible) |
| **cache_control:** | Can be blank for no setting, or a [valid](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) `cache-control` text value |
| **last_modified:** | Set the last modified date header based on file modification timestamp. Can be set `true` or `false` |
| **etag:** | Set the etag header tag. Can be set to `true` or `false` |
| **vary_accept_encoding:** | Add `Vary: Accept-Encoding` header. Can be set to `true` or `false` |
| **redirect_default_route:** | Automatically redirect to a page's default route. Can be set to `true` or `false` |
| **redirect_default_code:** | Default code to use for redirects. For example: `302` |
| **redirect_trailing_slash:** | Handle automatically or 302 redirect a trailing / URL |
| **ignore_files:** | Files to ignore in Pages. Example: `[.DS_Store] ` |
| **ignore_folders:** | Folders to ignore in Pages. Example: `[.git, .idea]` |
| **ignore_hidden:** | Ignore all Hidden files and folders. Can be set to `true` or `false` |
| **hide_empty_folders:** | If folder has no .md file, should it be hidden. Can be set to `true` or `false` |
| **url_taxonomy_filters:** | Enable auto-magic URL-based taxonomy filters for page collections. Can be set to `true` or `false` |
| **frontmatter:** | |
| ... **process_twig:** | Should the frontmatter be processed to replace Twig variables? Can be set to `true` or `false` |
| ... **ignore_fields:** | Fields that might contain Twig variables and should not be processed. Example: `['form','forms']` |
[/div]

### Cache

[version=15]
[prism classes="language-yaml line-numbers"]
cache:
  enabled: true
  check:
    method: file
  driver: auto
  prefix: 'g'
  clear_images_by_default: true
  cli_compatibility: false
  lifetime: 604800
  gzip: false
  allow_webserver_gzip: false
  redis:
    socket: false
[/prism]
[/version]

[version=16]
[prism classes="language-yaml line-numbers"]
cache:
  enabled: true
  check:
    method: file
  driver: auto
  prefix: 'g'
  purge_at: '0 4 * * *'
  clear_at: '0 3 * * *'
  clear_job_type: 'standard'
  clear_images_by_default: true
  cli_compatibility: false
  lifetime: 604800
  gzip: false
  allow_webserver_gzip: false
  redis:
    socket: false
[/prism]
[/version]

The **Cache** section is where you can configure the site's caching settings. You can enable, disable, choose the method, and more.

[version=15]
[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Set to `true` to enable caching. Can be set to `true` or `false` |
| **check:** | |
| ... **method:** | Method to check for updates in pages. Options: `file`, `folder`, `hash` and `none`. [more details](../../advanced/performance-and-caching#grav-core-caching) |
| **driver:** | Select a cache driver. Options are: `auto`, `file`, `apcu`, `redis`, `memcache`, and `wincache` |
| **prefix:** | Cache prefix string (prevents cache conflicts). Example: `g` |
| **clear_images_by_default:** | By default grav will include processed images when cache clears, this can be disabled by setting this to `false` |
| **cli_compatibility:** | Ensures only non-volatile drivers are used (file, redis, memcache, etc.) |
| **lifetime:** | Lifetime of cached data in seconds (`0` = infinite). `604800` is 7 days |
| **gzip:** | GZip compress the page output. Can be set to `true` or `false` |
| **allow_webserver_gzip:** | This option will change the header to `Content-Encoding: identity` allowing gzip to be more reliably set by the webserver although this usually breaks the out-of-process `onShutDown()` capability.  The event will still run, but it won't be out of process, and may hold up the page until the event is complete |
| **redis:** | |
| **... socket:** | The path to the redis socket file |
[/div]
[/version]

[version=16]
[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Set to `true` to enable caching. Can be set to `true` or `false` |
| **check:** | |
| ... **method:** | Method to check for updates in pages. Options: `file`, `folder`, `hash` and `none`. [more details](../../advanced/performance-and-caching#grav-core-caching) |
| **driver:** | Select a cache driver. Options are: `auto`, `file`, `apcu`, `redis`, `memcache`, and `wincache` |
| **prefix:** | Cache prefix string (prevents cache conflicts). Example: `g` |
| **purge_at:** | Scheduler: How often to purge old cache using cron `at` syntax |
| **clear_at:** | Scheduler: How often to clear the cache using cron `at` syntax |
| **clear_job_type:** | Type to clear when processing the scheduled clear job. Options: `standard` \| `all` |
| **clear_images_by_default:** | By default grav will include processed images when cache clears, this can be disabled by setting this to `false` |
| **cli_compatibility:** | Ensures only non-volatile drivers are used (file, redis, memcache, etc.) |
| **lifetime:** | Lifetime of cached data in seconds (`0` = infinite). `604800` is 7 days |
| **gzip:** | GZip compress the page output. Can be set to `true` or `false` |
| **allow_webserver_gzip:** | This option will change the header to `Content-Encoding: identity` allowing gzip to be more reliably set by the webserver although this usually breaks the out-of-process `onShutDown()` capability.  The event will still run, but it won't be out of process, and may hold up the page until the event is complete |
| **redis:** | |
| **... socket:** | The path to the redis socket file |
[/div]
[/version]

### Twig

[prism classes="language-yaml line-numbers"]
twig:
  cache: true
  debug: true
  auto_reload: true
  autoescape: false
  undefined_functions: true
  undefined_filters: true
  umask_fix: false
[/prism]

The **Twig** section gives you a quick set of tools with which to configure Twig on your site for debugging, caching, and optimization.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **cache:** | Set to `true` to enable Twig caching. Can be set to `true` or `false` |
| **debug:** | Enable Twig debug. Can be set to `true` or `false` |
| **auto_reload:** | Refresh cache on changes. Can be set to `true` or `false` |
| **autoescape:** | Autoescape Twig vars. Can be set to `true` or `false` |
| **undefined_functions:** | Allow undefined functions. Can be set to `true` or `false` |
| **undefined_filters:** | Allow undefined filters. Can be set to `true` or `false` |
| **umask_fix:** | By default Twig creates cached files as 755, fix switches this to 775. Can be set to `true` or `false` |
[/div]

### Assets

[prism classes="language-yaml line-numbers"]
assets:
  css_pipeline: false
  css_pipeline_include_externals: true
  css_pipeline_before_excludes: true
  css_minify: true
  css_minify_windows: false
  css_rewrite: true
  js_pipeline: false
  js_pipeline_include_externals: true
  js_pipeline_before_excludes: true
  js_minify: true
  enable_asset_timestamp: false
  collections:
    jquery: system://assets/jquery/jquery-2.x.min.js
[/prism]

The **Assets** section enables you to configure options related to the Assets Manager (JS, CSS).

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **css_pipeline:** | The CSS pipeline is the unification of multiple CSS resources into one file. Can be set to `true` or `false` |
| **css_pipeline_include_externals:** | Include external URLs in the pipeline by default. Can be set to `true` or `false` |
| **css_pipeline_before_excludes:** | Render the pipeline before any excluded files. Can be set to `true` or `false` |
| **css_minify:** | Minify the CSS during pipelining. Can be set to `true` or `false` |
| **css_minify_windows:** | Minify Override for Windows platforms. `false` by default due to ThreadStackSize. Can be set to `true` or `false` |
| **css_rewrite:** | Rewrite any CSS relative URLs during pipelining. Can be set to `true` or `false` |
| **js_pipeline:** | The JS pipeline is the unification of multiple JS resources into one file. Can be set to `true` or `false` |
| **js_pipeline_include_externals:** | Include external URLs in the pipeline by default. Can be set to `true` or `false` |
| **js_pipeline_before_excludes:** | Render the pipeline before any excluded files. Can be set to `true` or `false` |
| **js_minify:** | Minify the JS during pipelining. Can be set to `true` or `false` |
| **enable_asset_timestamp:** | Enable asset timestamps. Can be set to `true` or `false` |
| **collections:** | This contains collections, designated as sub-items. For example: `jquery: system://assets/jquery/jquery-3.x.min.js` |
[/div]

### Errors

[prism classes="language-yaml line-numbers"]
errors:
  display: 0
  log: true
[/prism]

The **Errors** section determines how Grav handles error display and logging.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **display:** | Determines how errors are displayed. Enter either `1` for the full backtrace, `0` for Simple Error, or `-1` for System Error |
| **log:** | Log errors to `/logs` folder. Can be set to `true` or `false` |
[/div]

### Log

[prism classes="language-yaml line-numbers"]
log:
  handler: file
  syslog:
    facility: local6
[/prism]

The **Log** section allows you to configure alternate logging capabilities for Grav.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **handler:** | Log handler. Currently supported: `file` \| `syslog` |
| **syslog:** | |
| ... **facility:** | Syslog facilities output |
[/div]

### Debugger

[prism classes="language-yaml line-numbers"]
debugger:
  enabled: false
  shutdown:
    close_connection: true
[/prism]

The **Debugger** section gives you the ability to activate Grav's debugger. A useful tool during development.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Enable Grav debugger and following settings. Can be set to `true` or `false` |
| **shutdown:** | |
| ... **close_connection:** | Close the connection before calling `onShutdown()`. `false` for debugging |
[/div]

### Images

[prism classes="language-yaml line-numbers"]
images:
  default_image_quality: 85
  cache_all: false
  cache_perms: '0755'
  debug: false
  auto_fix_orientation: false
  seofriendly: false
[/prism]

The **Images** section gives you the ability to set the default image quality images are resampled to, as well as to control image caching and debugging features.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **default_image_quality:** | Default image quality to use when resampling images. For example: `85` = 85% |
| **cache_all:** | Cache all images by default. Can be set to `true` or `false` |
| **cache_perms:** | **Must be in quotes!** Default cache folder perms. Usually `'0755'` or `'0775'` |
| **debug:** | Show an overlay over images indicating the pixel depth of the image when working with retina, for example. Can be set to `true` or `false` |
| **auto_fix_orientation:** | Try to automatically fix images uploaded with non-standard rotation |
| **seofriendly:** | SEO-friendly processed image names |
[/div]


### Media

[prism classes="language-yaml line-numbers"]
media:
  enable_media_timestamp: false
  unsupported_inline_types: []
  allowed_fallback_types: []
  auto_metadata_exif: false
[/prism]

The **Media** section handles the configuration options for settings related to the handling of media files. This includes timestamp display, upload size, and more.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enable_media_timestamp:** | Enable media timetsamps |
| **unsupported_inline_types:** | Array of supported media types to try to display inline. These file types are placed within `[]` brackets |
| **allowed_fallback_types:** | Array of allowed media types of files found if accessed via Page route. These file types are placed within `[]` brackets |
| **auto_metadata_exif:** | Automatically create metadata files from Exif data where possible |
[/div]

### Session

[prism classes="language-yaml line-numbers"]
session:
  enabled: true
  initialize: true
  timeout: 1800
  name: grav-site
  uniqueness: path
  secure: false
  httponly: true
  split: true
  path:
[/prism]

These options determine session properties for your site.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Enable Session support. Can be set to `true` or `false` |
| **initialize:** | Initialize session from Grav (if `false`, plugin needs to start the session) |
| **timeout:** | Timeout in seconds. For example: `1800` |
| **name:** | Name prefix of the session cookie. Use alphanumeric, dashes or underscores only. Do not use dots in the session name. For example: `grav-site` |
| **uniqueness:** | Should sessions be `path` based or `security.salt` based |
| **secure:** | Set session secure. If `true`, indicates that communication for this cookie must be over an encrypted transmission. Enable this only on sites that run exclusively on HTTPS. Can be set to `true` or `false` |
| **httponly:** | Set session HTTP only. If `true`, indicates that cookies should be used only over HTTP, and JavaScript modification is not allowed. Can be set to `true` or `false` |
| **path:** | The path where sessions are stored |
[/div]

### GPM

[prism classes="language-yaml line-numbers"]
gpm:
  releases: stable
  proxy_url:
  method: 'auto'
  verify_peer: true
  official_gpm_only: true
[/prism]

Options in the **GPM** section control Grav's GPM (Grav Package Manager). For example, you can restrict GPM to using official sources and select the method GPM uses to retrieve packages. You can also choose between stable and testing releases, as well as set up a proxy URL.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **releases:** | Set to either `stable` or `testing` to determine if you want to update to the latest stable or testing build |
| **proxy_url:** | Configure a manual proxy URL for GPM. For example: `127.0.0.1:3128` |
| **method:** | Either `'curl'`, `'fopen'` or `'auto'`. `'auto'` will try fopen first and if not available cURL |
| **verify_peer:** | On some systems (Windows mostly) GPM is unable to connect because the SSL certificate cannot be verified. Disabling this setting might help |
| **official_gpm_only:** | By default GPM direct-install will only allow URLs via the official GPM proxy to ensure security, disable this to allow other sources |
[/div]

[version=16]
### Accounts

[prism classes="language-yaml line-numbers"]
accounts:
  type: data
  storage: file
[/prism]

Accounts is a new setting for 1.6 that allows you to try out the new experimental Flex Users.  This basically means that Users are stored as Flex objects allowing more power and performance.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **type:** | Account type: `data` or `flex` |
| **storage:** | Flex storage type: `file` or `folder` |
[/div]

### Strict Mode

[prism classes="language-yaml line-numbers"]
strict_mode:
  yaml_compat: true
  twig_compat: true
[/prism]

Strict mode allows for a cleaner migration to future versions of Grav by moving to the newer versions of YAML and Twig processors.  These may not be compatible with all 3rd party extensions.

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **yaml_compat:** | Enables YAML backwards compatibility |
| **twig_compat:** | Enables deprecated Twig autoescape setting |
[/div]
[/version]

!! You do not need to copy the **entire** configuration file to override it, you can override as little or as much as you like.  Just ensure you have the **exact same naming structure** for the particular setting you want to override.

## Site Configuration

As well as the `system.yaml` file, Grav also provides a default `site.yaml` configuration file that is used to set some front-end specific configuration such as author name, author email, as well as some key taxonomy settings.  You can override these in the same way as you would the system.yaml by providing your own configuration file in `user/config/site.yaml`. You can also use this file to put in arbitrary configuration options that you may want to reference from your content or templates.

The default `system/config/site.yaml` file that ships with Grav looks something like this:

[prism classes="language-yaml line-numbers"]
title: Grav                                 # Name of the site
default_lang: en                            # Default language for site (potentially used by theme)

author:
  name: John Appleseed                      # Default author name
  email: 'john@example.com'                 # Default author email

taxonomies: [category,tag]                  # Arbitrary list of taxonomy types

metadata:
  description: 'My Grav Site'               # Site description

summary:
  enabled: true                             # enable or disable summary of page
  format: short                             # long = summary delimiter will be ignored; short = use the first occurrence of delimiter or size
  size: 300                                 # Maximum length of summary (characters)
  delimiter: ===                            # The summary delimiter

redirects:
#  '/redirect-test': '/'                    # Redirect test goes to home page
#  '/old/(.*)': '/new/$1'                   # Would redirect /old/my-page to /new/my-page

routes:
#  '/something/else': '/blog/sample-3'      # Alias for /blog/sample-3
#  '/new/(.*)': '/blog/$1'                  # Regex any /new/my-page URL to /blog/my-page Route

blog:
  route: '/blog'                            # Custom value added (accessible via site.blog.route)

#menu:                                      # Menu Example
#    - text: Source
#      icon: github
#      url: https://github.com/getgrav/grav
#    - icon: twitter
#      url: http://twitter.com/getgrav
[/prism]

Let's break down the elements of this sample file:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **title:** | The title is a simple string variable that can be referenced whenever you want to display the name of this site |
| **author:** | |
| ... **name:** | The name of the author of the site, that can be referenced whenever you need it |
| ... **email:** | A default email for use in your site |
| **taxonomies:** | An arbitrary list of high-level types that you can use to organize your content.  You can assign content to specific taxonomy types, for example, categories or tags. Feel free to edit, or add your own |
| **metadata:** | Set default metadata for all your pages, see the [content page headers](../../content/headers) section for more details |
| **summary:** | |
| ... **size:** | A variable to override the default number of characters that can be used to set the summary size when displaying a portion of content |
| **routes:** | This is a basic map that can provide simple URL alias capabilities in Grav.  If you browse to `/something/else` you will actually be sent to `/blog/sample-3`. Feel free to edit, or add your own as needed. **Regex Replacements** (`(.*) - $1`) are now supported at the end of route aliases.  You should put these at the bottom of the list for optimal performance |
| **(custom options)** | You can create any option you like in this file and a good example is the `blog: route: '/blog'` option that is accessible in your Twig templates with `site.blog.route` |
[/div]

!! For most people, the most important element of this file is the `Taxonomy` list.  The taxonomies in this list **must** be defined here if you wish to use them in your content.

## Security

In Grav 1.5 we introduced a new `system/config/security.yaml` file that sets some sensible defaults and is used by the Admin plugin when **Saving** content[version=16], as well in the new **Reports** section of **Tools**[/version].

The default configuration looks like this:

[prism classes="language-yaml line-numbers"]
xss_whitelist: [admin.super]
xss_enabled:
    on_events: true
    invalid_protocols: true
    moz_binding: true
    html_inline_styles: true
    dangerous_tags: true
xss_invalid_protocols:
    - javascript
    - livescript
    - vbscript
    - mocha
    - feed
    - data
xss_dangerous_tags:
    - applet
    - meta
    - xml
    - blink
    - link
    - style
    - script
    - embed
    - object
    - iframe
    - frame
    - frameset
    - ilayer
    - layer
    - bgsound
    - title
    - base
uploads_dangerous_extensions:
    - php
    - html
    - htm
    - js
    - exe
[/prism]

If you wish to make any changes to these settings, you should copy this file to `user/config/security.yaml` and make edits there.

## Other Configuration Settings and Files

User configuration is completely optional. You can override as little or as much of the default settings as you need. This applies to both the system, site, and any plugin configurations in your site.

You are also not limited to the `user/config/system.yaml` or the `user/config/site.yaml` files as described above. You can create any arbitrary `.yaml` configuration file in the `user/config` folder you wish and it will get picked up by Grav automatically.

As an example if the new configuration file is named `user/config/data.yaml` and a yaml variable in this file is called count:

```
count: 39
```

The variable would be accessed in your Twig template by using the following syntax:

```
{{ config.data.count }}
```

It would also be accessible via PHP from any plugin with the code:

```
$count_var = Grav::instance()['config']->get('data.count');
```

! You can also provide a custom blueprint to enable your custom file to be editable in the admin plugin. Check out the relevant [recipe in the Admin Cookbook section](/cookbook/admin-recipes#add-a-custom-yaml-file).

### Config Variable Namespacing

Paths to the configuration files will be used as a **namespace** for your configuration options.

Alternatively, you can put all the options into one file and use YAML structures to specify the hierarchy for your configuration options. This namespacing is built from a combination of the **path + filename + option name**.

For example: An option such as `author: Frank Smith` in file `plugins/myplugin.yaml` could be accessible via: `plugins.myplugin.author`. However, you could also have a `plugins.yaml` file and in that file have an option name called `myplugin: author: Frank Smith` and it would still be reachable by the same `plugins.myplugin.author` namespace.

Some example configuration files could be structured:

[div class="table-keycol"]
| File | Description |
| -------- | ----------- |
| **user/config/system.yaml**           | Global system configuration file                  |
| **user/config/site.yaml**             | A site-specific configuration file                |
| **user/config/plugins/myplugin.yaml** | Individual configuration file for myplugin plugin |
| **user/config/themes/mytheme.yaml**  | Individual configuration file for mytheme theme   |
[/div]

!! Having a namespaced configuration file will override or mask all options having the same path in the default configuration files

### Plugins Configuration

Most **plugins** will come with their own YAML configuration file. We recommend copying this file to the `user/config/plugins/` directory rather than editing configuration options directly to the file located in the plugin's directory. Doing this will ensure that an update to the plugin will not overwrite your settings, and keep all of your configurable options in one, convenient place.

If you have a plugin called `user/plugins/myplugin` that has a configuration file called `user/plugins/myplugin/myplugin.yaml` then you would copy this file to `user/config/plugins/myplugin.yaml` and edit the file there.

The YAML file that exists within the plugin's primary directory will act as a fallback. Any settings listed there and not in the User folder's copy will be picked up and used by Grav.

### Themes Configuration

The same rules for **themes** apply as they did for plugins.  So if you have a theme called `user/themes/mytheme` that has a configuration file called `user/themes/mytheme/mytheme.yaml` then you would copy this file to `user/config/themes/mytheme.yaml` and edit the file there.

---

## /assets

> Path: grav-learn/pages/01.basics/06.folder-structure/docs.md


Because Grav is a **flat-file based CMS**, meaning no database underpins it, the folder structure of your site is very important.  At the **top level** of your Grav installation the folder structure looks like:

[prism classes="language-bash line-numbers"]
/assets
/backup
/bin
/cache
/images
/logs
/system
/tmp
/vendor
/user
[/prism]

So let us dig a little deeper into each of these top-level folders and explain what they are for:

### /assets

The `assets` folder is used by the new asset management system within Grav to store processed `.css` and `.js` files.

!! This folder should not be used to store any user data, as it is routinely flushed of all data.

### /backup

The `backup` folder is the default location for Grav backups.

### /bin

The `bin` folder contains the [Grav CLI application](../../cli-console/grav-cli) that can be used to perform some handy tasks from the command line.  This is a relatively advanced feature primarily intended for developers so we'll set this topic aside for later discussion.

### /cache

The `cache` folder is used to store temporary cached files that are automatically generated by Grav to improve performance.  By default, Grav handles caching automatically, selecting the best available option for your hosting environment to ensure your site runs as fast as possible.

If Grav decides that the **filesystem** is the best caching method, the cached files it generates will be stored here.  The Twig template engine also uses this location to store its pre-compiled template files.  Again, this is done to ensure that Grav performs at its optimum speed.

!! This folder should not be used to store any user data, as it is routinely flushed of all data.

### /images

Grav comes with a built-in powerful yet very [easy-to-use image manipulation library](../../content/media).  This means you can easily resize an image on-the-fly from your content or even from a plugin.  These images are stored in the `images` folder so that they can be reused if the same image with the same size is requested again.

This folder acts like an image cache and is intended for automatically generated files.  User provided media should be stored in the `user/pages/`, `user/themes/` or even a custom `user/images/` folder.

!! This folder should not be used to store any user data, as it is routinely flushed of all data.

### /logs

When Grav detects an error, or if you have extra logging or profiling turned on, it stores the relevant log files in the `logs` folder.

### /system

The `system` folder is where the files that make Grav actually function live.  You should not edit anything in this folder because an update to Grav could overwrite your changes.  If you need to change something related to how Grav works, you can use plugins as discussed in later chapters.

### /tmp

The `tmp` folder is used by Grav and plugins to store temporary files.

!! This folder should not be used to store any user data, as it is routinely flushed of all data.

### /vendor

The `vendor` folder contains important libraries that Grav relies on.  This folder is similar to the `system` folder in that its contents should not be edited unless you are absolutely certain of what you're doing.

If you [installed](../installation) Grav from GitHub, the `vendor` folder won't have been installed with it. In order to create and populate the vendor folder, you will have to run `bin/grav install` or `composer install` from the root of your Grav instance. More details can be found in the [installation](../installation) section.

### /user

This is the most important folder for the majority of Grav users. This folder is where you will spend your time creating content, using plugins and editing your themes. Let us burrow a little further into this folder:

[prism classes="language-bash line-numbers"]
/user/accounts
/user/blueprints
/user/config
/user/data
/user/images
/user/languages
/user/pages
/user/plugins
/user/themes
[/prism]

### /user/accounts

The `accounts` folder is where you will define user accounts if access restrictions are required to certain portions of your site.

### /user/blueprints

The `blueprints` folder contains your custom blueprints for the site.

### /user/config

The [files in the config directory](../grav-configuration) are used to configure the website and have been discussed in the previous chapter.

### /user/data

The `data` folder can be used by plugins to store data that you can reference later.  A good example of a plugin that utilizes this folder is the **Forms** plugin that can take a web form and store the submitted data in a text file in this folder.  You can also store other things such as user-uploads or anything you wish to really.

!! This folder is not accessible via a browser by default.

### /user/images

The `images` folder can be used for storing your images. It can be accessed by using `image://` stream.


### /user/languages

The `languages` folder contains [Translation Overrides](../../content/multi-language#translation-overrides).

### /user/pages

This is the heart of Grav. The `pages` folder is where you create and edit your content.  We will go into much more depth in the [next chapter](../../content).

### /user/plugins

A plugin can extend the fast core of Grav with particular features you may need for your Website. Plugins can be downloaded from [GetGrav.org/downloads/plugins](https://getgrav.org/downloads/plugins), or you can [develop your own](../../plugins/plugin-tutorial).

### /user/themes

A theme turns your content into a true website.  It converts the content you have constructed into the HTML that a browser understands and displays to your audience.  There is a base theme that is provided with Grav, but you can also download others from [GetGrav.org/downloads/themes](https://getgrav.org/downloads/themes) or even create your own.  The [Themes](../../themes) chapter will outline this in further detail.

---

## Forum

> Path: grav-learn/pages/01.basics/07.getting-help/docs.md


Although we have done our best to cover as much as possible here in the documentation, it is inevitable that there will be questions about Grav that we have not answered.  We want to be as accessible as possible, so we have several methods to get help directly from the developers:

## Forum

We have a new [real-time forum solution](https://discourse.getgrav.org/) utilizing the **Discourse** platform to provide a simple way to get your Grav questions answered quickly.

## Twitter

We **highly recommend** you [follow us on Twitter](https://twitter.com/getgrav) as it provides a real-time way for us to reach out to our followers and let them know about news and events related to Grav development.

## Grav Blog

You can join in a discussion on any of the topics we post about on the [Grav Development Blog](https://getgrav.org/blog) via the comments.  We will post all the major news and information to our blog, as well as useful posts about development in general. We also have plans to share tutorials and hints on how to get the most out of Grav.

## GitHub Issues

If you find a bug, have a general question or even want to contribute to the Grav project as a whole, you can use the [Grav GitHub Issues tracker](https://github.com/getgrav/grav/issues).  We are very diligent about responding to issues posted here, and it can provide a useful way to start a conversation with us.  If you have a specific problem with one of our plugins, themes or skeletons, you can also submit an issue on that repository.

## Chat on Discord

You can **chat with us live** on [Discord](https://chat.getgrav.org). We recently [moved from Slack to Discord](https://getgrav.org/blog/chat-moving-to-discord) for our community chat platform, and now hang out there.  So [join us there](https://chat.getgrav.org) and get involved with the growing Grav community!





---

## Which version do I have?

> Path: grav-learn/pages/01.basics/08.updates/docs.md


The preferred method for keeping Grav, Plugins and Themes up to date is to use the **Grav Package Manager (GPM)**. Full information can be found in the [Grav GPM Documentation](../../advanced/grav-gpm).

We also have **GPM** integrated into our [Administration Panel](../../admin-panel) plugin which will check, prompt, and automatically install any updates.

### Which version do I have?

There are multiple ways to find out which version of Grav and plugins the site is using:

* **Admin Panel**: Version of Grav is listed in a footer of any page. Plugin and theme versions can be found from their own sections.
* **CLI**: Run command `bin/gpm version grav`. To get list of theme and plugin versions, you can list them by their names.
* **Filesystem**: Easiest way to see the version is to look for `CHANGELOG.md` file in the root of the Grav installation. Same is true for plugins and themes, they can usually be found in `user/plugins` and `user/themes` folders.

### Upgrading from Grav 1.5 or older version

Updating an older version of Grav may need some extra preparations and work because of the increased minimum requirements and potential incompatibilities.

The basic workflow is following:

- Copy the site to a server with **PHP 7.3** and **CLI** support
- Upgrade manually **to Grav 1.6.31**
- Upgrade to the latest version

A detailed guide **[Upgrading from Grav <1.6](/advanced/grav-development/grav-15-upgrade-guide)** should help you in the process.

### Upgrading to the Next Version

For upgrading to the next version, there are special guides to help you to make sure everything still works after upgrade.

- **[Upgrading to Grav 1.7](/advanced/grav-development/grav-17-upgrade-guide)**
- **[Upgrading to Grav 1.6](/advanced/grav-development/grav-16-upgrade-guide)**

! **NOTE:** It is recommended to read the upgrade guides before you install the next version of Grav.

### Grav CMS Updates

The preferred method for updating Grav is to use the **Grav Package Manager (GPM)**. All you need to do  is to navigate to the root of your Grav site and type:

[prism classes="language-bash command-line"]
bin/gpm selfupgrade -f
[/prism]

!!! **TIP:** More information about the command can be found from [GPM Command > Self-upgrade](/cli-console/grav-cli-gpm#self-upgrade).

### Plugin and Theme Updates

Plugins and Themes can be kept up to date by running following command from the root of your Grav site:

[prism classes="language-bash command-line"]
bin/gpm update
[/prism]

!!! **TIP:** More information about the command can be found from [GPM Command > Update](/cli-console/grav-cli-gpm#update).

---

## Chapter 1

> Path: grav-learn/pages/01.basics/chapter.md


### Chapter 1

# Basics

Discover what **Grav** is all about and the core concepts behind it.

---

## Regular Page

> Path: grav-learn/pages/02.content/01.content-pages/docs.md


In Grav-speak, **Pages** are the fundamental building blocks of your site. They are how you write content and provide navigation in the Grav system.

Combining content and navigation ensures that the system is intuitive to use for even the most inexperienced of content authors. However, this system, in conjunction with powerful taxonomy capabilities, is still powerful enough to handle complex content requirements.

Grav natively supports **3 types of Pages** that allow you to create a rich selection of web content. Those types are:

![Grav Page Types](page-types.png)

#### Regular Page

![Standard Page](content-standard.png)

A regular Page is generally a single page such as a **blog post**, **contact form**, **error page** etc. This is the most common type of page that you will create. By default a Page is considered a regular page unless you tell Grav otherwise.

When you download and install the **Core Grav** package, you are greeted by a standard page. We covered creating a simple regular Page in the [Basic Tutorial](/basics/basic-tutorial).

#### Listing Page

![Listing Page](content-listing.png)

This is an extension of a regular Page. This is a page that has a reference to a collection of pages.

The most straightforward approach to setting this up is to create **child-pages** below the Listing Page. An example of this would be a **blog listing page**, where you would display a summary list of blog posts that exist as child-pages.

There is also some configuration settings to **control the order** of the listing as well as a **limit on the number of items**, and whether or not **pagination** should be enabled.

!! A sample **Blog Skeleton** using a **Listing Page** can be found in the [Grav Downloads](https://getgrav.org/downloads/skeletons).

#### Modular Page

![Modular Page](content-modular.png)

A **Modular Page** is a special type of listing page because it builds a **single page** from its **child pages** or **modules**. This allows for the ability to build very complex **one-page layouts** from Modules. This is accomplished by constructing the **Modular Page** from multiple **Modules** found in the modular page's primary folder.

!! A sample **One-Page Skeleton** using a **Modular Page** can be found in the [Grav Downloads](https://getgrav.org/downloads/skeletons).

Each of these page types follows the same basic structure, so before we can get into the nitty-gritty of each type, we must explain how pages in Grav are constructed.

!! A Module, because it is intended to be part of another page, is inherently not a page you can reach directly via a URL. Because of this, all module pages are by default set as **non-routable**.

## Folders

All content pages are located in the `/user/pages` folder. Each **Page** should be placed in its own folder.

!! Folder names should also be valid **slugs**. Slugs are entirely lowercase, with accented characters replaced by letters from the Latin alphabet and whitespace characters replaced by a dash or an underscore, to avoid being encoded.

Grav understands that any integer value followed by a period will be solely for ordering, and is removed internally in the system. For example, if you have a folder named `01.home`, Grav will treat this folder as `home`, but will ensure that with default ordering, it comes before `02.blog`.

[prism classes="language-txt line-numbers"]
/user
 /pages
     /01.home
        /_header
        /_features
        /_body
     /02.blog
        /blog-item-1
        /blog-item-2
        /blog-item-3
        /blog-item-4
        /blog-item-5
     /03.about-us
     /error
[/prism]

Your site must have an entry-point so that it knows where to go when you point your browser to the root of your site. For example if you were to enter `http://yoursite.com` in your browser, by default Grav expects an alias `home/`, but you can override the home-location by changing the `home.alias` option in the [Grav configuration file](/basics/grav-configuration).

**Modules** are identified by an underscore (`_`) before the folder name. This is a special folder type that is intended to be used only with **modular content**.  These are **not routable** and **not visible** in the navigation. An example of a modular page setup would be a folder such as `user/pages/01.home`. Home is configured as a **modular page** that would contain a collection of **modules**, and would be constructed from the `_header`, `_features`, and `_body` folders within the home folder.

The textual name of each folder defaults to the _slug_ that the system uses as part of the URL. For example if you have a folder such as `/user/pages/02.blog`, the slug for this page would default to `blog`, and the full URL would be `http://yoursite.com/blog`. A blog item page, located in `/user/pages/02.blog/blog-item-5` would be accessible via `http://yoursite.com/blog/blog-item-5`.

If no number is provided as a prefix of the folder name, the page is considered to be **invisible**, and will not show up in the navigation. An example of this would be the `error` page in the above folder-structure.

!! This can actually be overridden in the page itself by setting the [visible parameter](/content/headers#visible) in the headers.

## Ordering

When dealing with collections, there are several options available to control how folders are ordered. The most important option is set in the `content.order.by` of the page configuration settings. The options are:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **default**  | The order is based on the file system, i.e. `01.home` before `02.advark` |
| **title**    | The order is based on the title as defined in each page |
| **basename** | The order is based on the alphabetic folder without numeric order |
| **date**     | The order is based on the date as defined in each page |
| **modified** | The order is based on the modified timestamp of the page |
| **folder**   | The order is based on the folder name with any numerical prefix, i.e. `01.`, removed |
| **header.x** | The order is based on any page header field. i.e. `header.taxonomy.year`. Also a default can be added via a pipe. i.e. `header.taxonomy.year|2015` |
| **manual**   | The order is based on the `order_manual` variable |
| **random**   | The order is randomized |
[/div]

You can specifically define a manual order by providing a list of options to the `content.order.custom` configuration setting. This will work in conjunction with the `content.order.by` because it first tries to order the pages manually, but any pages not specified in the manual order, will fall through and be ordered by the ordering provided.

!! You can override the **default behavior** for folder ordering and the direction in which the ordering occurs by setting the `pages.order.dir` and the `pages.order.by` options in the [Grav system configuration file](/basics/grav-configuration).

## Page File

Within the page-folder, we create the actual page-file. The filename should end with `.md` to indicate that it is a Markdown-formatted file. Technically, it is Markdown with YAML FrontMatter, which sounds impressive but really is not a big deal at all. We will cover the details of the file-structure soon.

The important thing to understand is the name of the file directly references the name of the theme's template file that will be used to render. The standard name for the main template file is **default**, so the file would be named `default.md`.

You can, of course, name your file whatever you like, for example: `document.md`, which would make Grav look for a template file in the theme that matches, such as the **document.html.twig** Twig-template.

!! This behavior can be overridden in the page by setting the [template parameter](/content/headers#template) in the headers.

An example page file could look like this:

[div class="no-margin-bottom"]
[prism classes="language-yaml line-numbers"]
[/prism]
[/div]
[div class="no-margin-top"]
[prism classes="language-markdown line-numbers" ln-start="6"]
# Page Title

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque porttitor eu
felis sed ornare. Sed a mauris venenatis, pulvinar velit vel, dictum enim. Phasellus
ac rutrum velit. **Nunc lorem** purus, hendrerit sit amet augue aliquet, iaculis
ultricies nisl. Suspendisse tincidunt euismod risus, _quis feugiat_ arcu tincidunt
eget. Nulla eros mi, commodo vel ipsum vel, aliquet congue odio. Class aptent taciti
sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Pellentesque
velit orci, laoreet at adipiscing eu, interdum quis nibh. Nunc a accumsan purus.
[/prism]
[/div]

The settings between the pair of `---` markers are known as the YAML FrontMatter, and it is comprised of basic YAML settings for the page.

In this example, we are explicitly setting the title, as well the taxonomy to **blog** so we can filter it later.  The content after the second `---` is the actual content that will be compiled and rendered as HTML on your site.  This is written in [Markdown](/content/markdown), which will be covered in detail in a future chapter. Just know that the `#`, `**`, and `_` markers translate to **heading 1**, **bold**, and **italics**, respectively.

!! Ensure you save your `.md` files as `UTF-8`-encoded files. This will ensure they work with language-specific special characters.

### Summary Size and Separator

There is a setting in the `site.yaml` file that lets you define a default size (in characters) of the summary that can be used via `page.summary()` to display a summary or synopsis of the page. This is particularly useful for blogs where you want to have a listing that contains just summary information, and not the full page content.

By default, this value is `300` characters. You can override this in your `user/config/site.yaml` file, but an even more useful approach is to use the manual **summary separator** also known as the **summary delimiter**: `===`.

You need to ensure you put this in your content with blank lines **above** and **below**. For example:

[prism classes="language-markdown line-numbers"]
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat.

===

Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
[/prism]

This will use the text above the separator when referenced by `page.summary()` and the full page content when referenced by `page.content()`.

!! When using `page.summary()`, the summary size setting will be used if the separator is not found in the page content.

### Finding other Pages

Grav has a useful feature that allows you to find another page and perform actions on that page. This can be accomplished with the `find()`-method that simply takes the **route** and returns a new Page-object.

This allows you to perform a wide variety of functionality from any page on your Grav site. For example, you may want to provide a list of all current projects on a particular project detail page:

{% verbatim %}
[prism classes="language-twig line-numbers"]
# All Projects
<ul>
{% for p in pages.find('/projects').children if p != page %}
<li><a href="{{ p.url|e }}">{{ p.title|e }}</a></li>
{% endfor %}
</ul>
[/prism]
{% endverbatim %}

{% verbatim %}
!! The `pages`-object is unavailable when [processing Twig directly in Markdown-content](https://learn.getgrav.org/content/headers#process). However, the `page`-object and its inherited `find()`-method is, so you could use `{% for p in page.find('/projects').children %}` as a replacement for the above. Note that the **pages** refers to all the Pages available to Grav, and **page** refers to a single, and often the current, Page.
{% endverbatim %}

In the next sections, we will continue to dig into the specifics of a page and page collections in detail.

### contentMeta

Referencing pages and content is straightforward, but what about the content that doesn't get rendered on the front-end along with the rest of the page?

When Grav reads page content, it stores this content in cache. That way, the next time the page is rendered it doesn't have to read all the content from the `.md` file. Generally, this content is all rendered to the front-end. However, there are instances where having some additional data stored alongside the page in the cache is useful.

This is where `contentMeta()` comes in. We use ContentMeta in our [Shortcode](https://github.com/getgrav/grav-plugin-shortcode-core)-plugin to [retrieve sections from other pages](https://github.com/getgrav/grav-plugin-shortcode-core#sections-from-other-pages) using shortcodes. For example:

{% verbatim %}
[prism classes="language-twig line-numbers"]
<div id="author">{{ page.find('/my/custom/page').contentMeta.shortcodeMeta.shortcode.section.author|e }}</div>
[/prism]
{% endverbatim %}

We used this in Shortcode Core to store CSS and JS assets that the shortcode on the page requires, however this feature can be used to store just about any data structure you need.

---

## Basic Page Headers

> Path: grav-learn/pages/02.content/02.headers/docs.md


The page headers (alternatively known as frontmatter) at the top of a page are completely optional, you do not need them at all for a page to display within Grav. There are 3 primary types of pages (**Standard**, **Listing**, and **Modular**) within Grav, and each has relevant headers.

! Headers are also known as **Page Frontmatter** and are commonly referred to as such so as not to be confused with HTTP Headers.

## Basic Page Headers

There are a number of basic header options available.

### Cache Enable

```yaml
cache_enable: false
```

By default, Grav will cache the contents of the page file to ensure things run as fast as possible.  There are advanced scenarios where you do not want the page to be cached.

An example of this is when you are using dynamic Twig variables in your content. The `cache_enable` variable allows this behavior to be overridden.  We will cover Twig Content variables in a later chapter. Valid values are `true` or `false`.

### Date

```yaml
date: 01/01/2020 3:14pm
```

The `date` variable allows you to specifically set a date associated with this page.  This is often used to indicate when a post was created and can be used for display or sort-order purposes.  If not set, this defaults to the last **modified time** of the page.

! Dates in the `m/d/y` or `d-m-y` formats are disambiguated by looking at the separator between the various components: if the separator is a slash (`/`), then the **American** `m/d/y` is assumed; whereas if the separator is a dash (`-`) or a dot (`.`), then the **European** `d.m.y` format is assumed.

### Menu

```yaml
menu: My Page
```

The `menu` variable lets you set the text to be used in the navigation. There are several layers of fall-backs for the menu, so if no `menu` variable is set, Grav will try to use the `title` variable.

### Published

```yaml
published: true
```

By default, a page is **published** unless you explicitly set `published: false` or via a `publish_date` being in the future, or `unpublish_date` in the past. Valid values are `true` or `false`.

### Slug

```yaml
slug: my-page-slug
```

The `slug` variable allows you to specifically set the page's portion of the URL. For example: `http://yoursite.com/my-page-slug` would be the URL if you set the `slug` above.  If the `slug` is not set in the page, Grav falls back to using the folder name (without any numerical prefixes).

[Slugs](http://en.wikipedia.org/wiki/Semantic_URL#Slug) are generally entirely lowercase, with accented characters replaced by letters from the English alphabet and whitespace characters replaced by a dash or an underscore. While future versions of Grav will support spaces in slugs, having blank spaces or capital lettering is not recommended.

For example: If a blog post's title is `Blog Post Example`, the recommended slug would be `blog-post-example`.

### Taxonomy

```yaml
taxonomy:
    category: blog
    tag: [sample, demo, grav]
```

A very useful header variable, `taxonomy` lets you assign values to **taxonomy** you defined as valid types in the [Site Configuration](../../basics/grav-configuration#site-configuration) file.

If the taxonomy is not defined in that file, it will be ignored.  In this example, the page is defined as being in the `blog` category, and has the tags: `sample`, `demo`, and `grav`.  These taxonomies can be used to find these pages from other pages, plugins and even themes. The [Taxonomy](../taxonomy) chapter will cover this concept in more detail.

### Title

If you have no headers at all, you will not have any control over the title of the page as it shows in the browser and search engines.  For this reason, it is recommended to _at least_ put the `title` variable in the header of the page:

```yaml
title: Title of my Page
```

If the `title` variable is not set, Grav has a fallback solution, and will try to use the capitalized `slug` variable.

## Advanced Headers

These are still important but less commonly used. They can be used to provide advanced functionality within your page.

### Append URL extension

```yaml
append_url_extension: '.json'
```

Allows the page to override the default extension and set one programmatically.  It will also set the appropriate header attributes for the response.

### Cache-Control

```yaml
cache_control: max-age=604800
```

Can be blank for no setting, or a [valid](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control) `cache-control` text value.

! Make sure you're using `no-cache` if the page contains information that can change based on the user. Otherwise the content can leak to other users. [Expires](/content/headers#expires) setting if set to `expires: 0` has the same effect.

### Date Format

```yaml
dateformat: 'Y-m-d H:i:s'
```

Overrides the default Grav configuration for date formats and lets it be set at the page level. You can use any of the [PHP date formats](https://www.php.net/manual/en/function.date.php) available.

### Debugger

When you enable the debugger via the `system.yaml` configuration file, the debugger will display on every page.  There are cases where this may not be desirable or may cause conflicts with the output.  Such an example is when you are requesting a page that is intended to return rendered HTML to an Ajax call.  This should not have the debugger injected into the resulting data.  To disable the debugger on this page you can use the `debugger` page header:

```yaml
debugger: false
```

### ETag

```yaml
etag: true
```

Enable or disable on a page level whether or not to display an ETag header variable with a unique value. `false` by default unless overridden in your `system.yaml`.

### Expires

```yaml
expires: 604800
```

Page expires time in seconds (604800 seconds = 7 days).

! Make sure you're using `expires: 0` if the page contains information that can change based on the user. Otherwise the content can leak to other users. See also [Cache-Control](/content/headers#Cache-Control) setting.

### External Url

```yaml
external_url: https://www.mysite.com/foo/bar
```

Allows you to override the dynamically generated URL with one you explicitly provide.


### HTTP Response Code

```yaml
http_response_code: 404
```

Allows the dynamic setting of an HTTP Response Code.

### Language

```yaml
language: fr
```

This allows you to override the language for a particular page.

### LastModified

```yaml
last_modified: true
```

Enable or disable on a page level whether or not to display a Last Modified header variable with modified date. `false` by default unless overridden in your `system.yaml`.

### Lightbox

```yaml
lightbox: true
```

Although strictly speaking this is not a standard page header, it is a common way to enable the loading of a standard lightbox JavaScript and CSS for a page.  By default the core `antimatter` theme does not load the prerequisites to enable lightbox capabilities of images, be sure to install a lightbox plugin such as **Featherlight**, which is available via GPM.

### Login Redirect Here

```yaml
login_redirect_here: false
```

The `login_redirect_here` header enables you to determine whether or not someone is kept on that page after logging in through the [Grav Login Plugin](https://github.com/getgrav/grav-plugin-login). Setting this header to `false` will forward someone to the prior page after a successful login.

A `true` setting here will enable the person to stay on the current page after a successful login. This is also the default setting, which applies if there is no `login_redirect_here` header in the frontmatter.

You can override this default behavior by forcing a standard location by specifying an explicit option in your Login configuration YAML:

```yaml
redirect_after_login: '/profile'
```

This will always take you to the `/profile` route after a successful login.

### Markdown

```yaml
  markdown:
    extra: false
    auto_line_breaks: false
    auto_url_links: false
    escape_markup: false
    special_chars:
      '>': 'gt'
      '<': 'lt'
```

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **extra:** | Enable support for Markdown Extra (GFM by default) |
| **auto_line_breaks:** | Enable automatic line breaks |
| **auto_url_links:** | Enable automatic HTML links |
| **escape_markup:** | Escape markup tags into entities |
| **special_chars:** | List of special characters to automatically convert to |
[/div]

You can enable these globally via your `user/config/system.yaml` configuration file, or you can override this global setting _per-page_ with this `markdown` header option.

### Never Cache Twig

```yaml
never_cache_twig: true
```

Enabling this will allow you to add a processing logic that can change dynamically on each page load, rather than caching the results and storing it for each page load. This can be enabled/disabled site-wide in the **system.yaml**, or on a specific page. Can be set `true` or `false`.

This is a subtle change, but one that is especially useful in modular pages as it keeps you from having to constantly disable caching when you're working with it. The page is still cached, but not the Twig. The Twig is processed after the cached content is retrieved. For modular forms, it now works with just this setting rather than having to disable the modular page cache.

!! This is not compatible with `twig_first: true` currently because all processing is happening in the one Twig call.

### Process

```yaml
process:
	markdown: false
	twig: true
```

Processing of the page is another advanced capability. By default Grav will process `markdown` but will **not** process `twig` in a page.  This choice to not process Twig by default is purely for performance reasons as this is not a commonly needed feature.  The `process` variable allows you to override this behavior.

You may want to disable `markdown` on a particular page if you want to use 100% HTML in your page and not have the markdown process run at all.  Also it allows a plugin to process content in another manner completely. Valid values are `true` or `false`.

There are situations when you want to use Twig templating functionality in your content, and this is accomplished by setting the `twig` variable to true.

### Process Twig First

```yaml
twig_first: false
```

If set to `true` Twig processing will occur before any Markdown processing. This can be particularly useful if your Twig generates markdown that needs to be available in order to be processed by the Markdown compiler.  One thing to note, if have `cache_enable: false` **and** `twig_first: true` page caching is effectively disabled.

### Publish Date

```yaml
publish_date: 01/23/2020 13:00
```

Optional field, but can provide a date to automatically trigger publication. Valid values are any string date values that [strtotime()](https://php.net/manual/en/function.strtotime.php) supports.

### Redirect

```yaml
redirect: '/some/custom/route'
```

or

```yaml
redirect: 'http://someexternalsite.com'
```

You can redirect to another internal or external page right from a page header.  Of course this means this page will not be displayed, but the page can still be in a collection, menu, etc because it will exist as a page within Grav.

You can also append a redirect code to a URL by using square brackets:

```yaml
redirect: '/some/custom/route[303]'
```

### Routes

```yaml
routes:
  default: '/my/example/page'
  canonical: '/canonical/url/alias'
  aliases:
    - '/some/other/route'
    - '/can-be-any-valid-slug'
```

You can now provide a **default route** that overrides the standard route structure as defined by the folder structure.

You can also specify a specific **canonical route** that can be used in themes to output a canonical link:

```html
<link rel="canonical" href="https://yoursite/dresses/green-dresses-are-awesome" />
```

Lastly, you can specify an array of **route aliases** that can be used as alternative routes for a particular page.

### Routable

```yaml
routable: false
```

By default, all pages are **routable**.  This means that they can be reached by pointing your browser to the URL of the page.  However, you may need to create a page that is created to hold specific content, but it is meant to be called directly by a plugin, other content, or even a theme directly.  A good example of this is a `404 Error` page.

Grav automatically looks for a page with the route `/error` if another page cannot be found.  With this being an actual page within Grav, you would have complete control over what this page looks like.  You probably do not want people accessing this page directly in their browser, however, so this page commonly has its `routable` variable set to false. Valid values are `true` or `false`.

### SSL

```yaml
ssl: true
```

You can now enable a specific page to be forced with SSL **on** or **off**.  This **only works** with the `absolute_urls: true` option set in the `system.yaml` configuration.  This is because to be able to switch back and forth between SSL and non-SSL pages, you must be using full URLs with the protocol and host included.

### Summary

```yaml
summary:
  enabled: true
  format: short | long
  size: int
```

The **summary** option configures what the `page.summary()` method returns.  This is most often used in a blog-listing type scenario, but can be used anytime you need a synopsis or summary of the page content.  The scenarios are as follows:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| **enabled:** | Switch off page summary (the summary returns the same as the page content) |
| **format:** | <ul><li>`long` = Any summary delimiter of the content will be ignored<li>`short` = Detect and truncate content up to summary delimiter position</ul> |
[/div]

The `size` attribute has different meanings when the format is set to `short` and `long`:

[div class="table-keycol"]
| Short Size | Description |
| -------- | ----------- |
| **size: 0** | If no summary delimiter is found, the summary equals the page content, otherwise the content will be truncated up to summary delimiter position |
| **size:** `int` | Always truncate the content after **int** chars. If a summary delimiter was found, then truncate content up to summary delimiter position |
[/div]

[div class="table-keycol"]
| Long Size | Description |
| -------- | ----------- |
| **size: 0** | Summary equals the entire page content |
| **size:** `int` | The content will be truncated after **int** chars, independent of summary delimiter position |
[/div]

### Template

```yaml
template: custom
```

As explained in [the previous chapter](../content-pages), the template from the theme that is used to render a page is based on the filename of the `.md` file.

So a file called `default.md`, will use the `default` template in the active theme.  You can, of course, override this behavior by simply setting the `template` variable in the header and choosing a different template.

In the example above, the page will use the `custom` template from the theme.  This variable exists because you may need to change the template of a page programmatically from a plugin.

### Template Format

```yaml
template_format: xml
```

Traditionally, if you want a page to output a specific format (ie: xml, json, etc.) you needed to append the format to the url. For example, entering `http://example.com/sitemap.xml` would tell the browser to render the content using the `xml` twig template ending in `.xml.twig`. This is all well and good, because we love doing things simply in Grav.

Using the `template_format` page header, we can tell the browser how to render the page without any need for extensions in the URL. By entering `template_format: xml` in our `sitemap` page, we can make `http://example.com/sitemap` work for us without having to append `.xml` to the end of it.

We [used this method](https://github.com/getgrav/grav-plugin-sitemap/commit/00c23738bdbfe9683627bf0f99bda12eab9505d5#diff-190081f40350c0272970d9171f3437a2) with the [Grav Sitemap Plugin](https://github.com/getgrav/grav-plugin-sitemap).

### Unpublish Date

```yaml
unpublish_date: 05/17/2020 00:32
```

Optional field, but can provide a date to automatically trigger un-publication. Valid values are any string date values that [strtotime()](https://php.net/manual/en/function.strtotime.php) supports.

### Visible

```yaml
visible: false
```

By default, a page is **visible** in the **navigation** if the surrounding folder has a numerical prefix, i.e. `/01.home` is visible, while `/error` is **not visible**. This behavior can be overwritten by setting the `visible` variable in the header. Valid values are `true` or `false`.

## Custom Page Headers

Of course, you can create your own custom page headers using any valid YAML syntax.  These would be page-specific and be available for any plugin, or theme to make use of. A good example of this would be to set some variable specific to a sitemap plugin, such as:

[prism classes="language-yaml line-numbers"]
sitemap:
    changefreq: monthly
    priority: 1.03
[/prism]

The significance of these headers is that Grav does not use them by default. They are only read by the **sitemap plugin** to determine how often this particular page is modified and what its priority should be.

Any page header such as this should be documented, and generally, there will be some default value that will be used if the page does not provide it.

Another example would be to store page-specific data that could then be used by Twig in the content of the page.

For example, you might have want to associate some author reference for the page. If you added these YAML settings to the page header:

[prism classes="language-yaml line-numbers"]
author:
    name: Sandy Johnson
    twitter: @sandyjohnson
    bio: Sandy is a freelance journalist and author of several publications on open source CMS platforms.
[/prism]

You could then access them from Twig:

[prism classes="language-twig line-numbers"]
<section id="author-details">
    <h2>{{ page.header.author.name|e }}</h2>
    <p>{{ page.header.author.bio|e }}</p>
    <span>Contact: <a href="https://twitter.com/{{ page.header.author.twitter|e }}"><i class="fa fa-twitter"></i></a></span>
</section>
[/prism]

If the variable name [contains a special character like a dash](https://github.com/getgrav/grav/issues/1957#issuecomment-723236844) you should use [twigs attribute function](https://twig.symfony.com/doc/1.x/functions/attribute.html):

[prism classes="language-twig"] attribute(page.header, 'plugin-name').active [/prism]


## Meta Page Headers

Meta headers allow you to set the [standard set of HTML **<meta> tags**](http://www.w3schools.com/tags/tag_meta.asp) for each page as well as [OpenGraph](http://ogp.me/), [Facebook](https://developers.facebook.com/docs/sharing/best-practices), and [Twitter](https://dev.twitter.com/cards/overview).

#### Standard Metatag examples

[prism classes="language-yaml line-numbers"]
metadata:
    refresh: 30
    generator: 'Grav'
    description: 'Your page description goes here'
    keywords: 'HTML, CSS, XML, JavaScript'
    author: 'John Smith'
    robots: 'noindex, nofollow'
    my_key: 'my_value'
[/prism]

This will produce the HTML:

[prism classes="language-twig line-numbers"]
<meta name="generator" content="Grav" />
<meta name="description" content="Your page description goes here" />
<meta http-equiv="refresh" content="30" />
<meta name="keywords" content="HTML, CSS, XML, JavaScript" />
<meta name="author" content="John Smith" />
<meta name="robots" content="noindex, nofollow" />
<meta name="my_key" content="my_value" />
[/prism]

All HTML5 metatags are supported.

#### OpenGraph Metatag examples

[prism classes="language-yaml line-numbers"]
metadata:
    'og:title': The Rock
    'og:type': video.movie
    'og:url': http://www.imdb.com/title/tt0117500/
    'og:image': http://ia.media-imdb.com/images/rock.jpg
[/prism]

This will produce the HTML:

[prism classes="language-html line-numbers"]
<meta name="og:title" property="og:title" content="The Rock" />
<meta name="og:type" property="og:type" content="video.movie" />
<meta name="og:url" property="og:url" content="http://www.imdb.com/title/tt0117500/" />
<meta name="og:image" property="og:image" content="http://ia.media-imdb.com/images/rock.jpg" />
[/prism]

For a full outline of all OpenGraph metatags that can be used, please consult the [official documentation](http://ogp.me/).

#### Facebook Metatag examples

[prism classes="language-yaml line-numbers"]
metadata:
    'fb:app_id': your_facebook_app_id
[/prism]

This will produce the HTML:

[prism classes="language-html line-numbers"]
<meta name="fb:app_id" property="fb:app_id" content="your_facebook_app_id" />
[/prism]

Facebook mostly uses OpenGraph metatags, but there are some Facebook-specific tags and these are supported automatically by Grav.

#### Twitter Metatag examples

[prism classes="language-yaml line-numbers"]
metadata:
    'twitter:card' : summary
    'twitter:site' : @flickr
    'twitter:title' : Your Page Title
    'twitter:description' : Your page description can contain summary information
    'twitter:image' : https://farm6.staticflickr.com/5510/14338202952_93595258ff_z.jpg
[/prism]

This will produce the HTML:

[prism classes="language-twig line-numbers"]
<meta name="twitter:card" property="twitter:card" content="summary" />
<meta name="twitter:site" property="twitter:site" content="@flickr" />
<meta name="twitter:title" property="twitter:title" content="Your Page Title" />
<meta name="twitter:description" property="twitter:description" content="Your page description can contain summary information" />
<meta name="twitter:image" property="twitter:image" content="https://farm6.staticflickr.com/5510/14338202952_93595258ff_z.jpg" />
[/prism]

For a full outline of all Twitter metatags that can be used, please consult the [official documentation](https://dev.twitter.com/cards/overview).

This really provides a lot of flexibility and power.

## Frontmatter.yaml

An advanced feature that can come in handy for some power users is the ability to use common frontmatter values via a `frontmatter.yaml` file located in the page folder.  This is particular useful when working with multi-language sites where you may wish to share a portion of the frontmatter between all the language versions of a given page.

To take advantage of this, simply create a `frontmatter.yaml` file alongside your page's `.md` file and add any valid frontmatter values.  For example:

[prism classes="language-yaml line-numbers"]
metadata:
    generator: 'Super Grav'
    description: Give your page a powerup with Grav!
[/prism]

! If a header is defined in both frontmatter.yaml and in page frontmatter, the page values is used, frontmatter.yaml values are overridden.

!!!! Utilizing frontmatter.yaml is a file-side feature and is **not supported** by the admin plugin.

---

## Collection Object

> Path: grav-learn/pages/02.content/03.collections/docs.17.md


In Grav, the most common type of collection is a list of pages that can be defined either in the page's frontmatter or in the twig itself. The most common is to define a collection in the frontmatter. With a collection defined, it is available in the Twig of the page to do with as you wish. By using page collection methods or looping through each [page object](https://learn.getgrav.org/themes/theme-vars#page-object) and using the page methods or properties you can do powerful things. Common examples of this include displaying a list of blog posts or displaying modular sub-pages to render a complex page design.

## Collection Object

When you define a collection in the page header, you are dynamically creating a [Grav Collection](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Page/Collection.php) that is available in the page's Twig.  This Collection object is **iterable** and can be treated like an **array** which allows you to do things such as:

[prism classes="language-twig line-numbers"]
{{ dump(page.collection[page.path]) }}
[/prism]

## Example Collection Definition

An example collection defined in the page's frontmatter:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    order:
        by: date
        dir: desc
    limit: 10
    pagination: true
[/prism]

The `content.items` value in the page's frontmatter tells Grav to gather up a collection of items and information passed to this defines how the collection is to be built.

This definition creates a collection for the page that consists of all **child pages** sorted by **date** in **descending** order with **pagination** showing **10 items** per-page.

Pagination links are added only if [Pagination plugin](https://github.com/getgrav/grav-plugin-pagination) is installed and enabled.

## Accessing Collections in Twig

When this collection is defined in the header, Grav creates a collection **page.collection** that you can access in a twig template with:

[prism classes="language-twig line-numbers"]
{% for p in page.collection %}
<h2>{{ p.title|e }}</h2>
{{ p.summary|raw }}
{% endfor %}
[/prism]

This simply loops over the [pages](https://learn.getgrav.org/themes/theme-vars#page-object) in the collection displaying the title and summary.

You can also include an order parameter to change the default ordering of pages:

[prism classes="language-twig line-numbers"]
{% for p in page.collection.order('folder','asc') %}
<h2>{{ p.title|e }}</h2>
{{ p.summary|raw }}
{% endfor %}
[/prism]

## Collection Headers

To tell Grav that a specific page should be a listing page and contain child-pages, there are a number of variables that can be used:

### Summary of collection options

[div class="table-keycol"]
|                   String                      |                           Result                          |
|-----------------------------------------------|-----------------------------------------------------------|
| `'@root.pages'`                               | Get the top level pages                                   |
| `'@root.descendants'`                         | Get all the pages of the site                             |
| `'@root.all'`                                 | Get all the pages and modules of the site                 |
|                                               |                                                           |
| `'@self.page'`                                | Get a collection with only the current page               |
| `'@self.parent'`                              | Get a collection with only the parent of the current page |
| `'@self.siblings'`                            | Get siblings of the current page                          |
| `'@self.children'`                            | Get children of the current page                          |
| `'@self.modules'`                             | Get modules of the current page                           |
| `'@self.all'`                                 | Get both children and modules of the current page         |
| `'@self.descendants'`                         | Recurse through all the children of the current page      |
|                                               |                                                           |
| `'@page.page': '/fruit'`                      | Get a collection with only the page `/fruit`              |
| `'@page.parent': '/fruit'`                    | Get a collection with only the parent of the page `/fruit`|
| `'@page.siblings': '/fruit'`                  | Get siblings of the page `/fruit`                         |
| `'@page.children': '/fruit'`                  | Get children of the page `/fruit`                         |
| `'@page.modules': '/fruit'`                   | Get modules of the page `/fruit`                          |
| `'@page.all': '/fruit'`                       | Get both children and modules of the page `/fruit`        |
| `'@page.descendants': '/fruit'`               | Get and recurse through all the children of page `/fruit` |
|                                               |                                                           |
| `'@taxonomy.tag': photography`                | taxonomy with tag=`photography`                           |
| `'@taxonomy': {tag: birds, category: blog}`   | taxonomy with tag=`birds` && category=`blog`              |
[/div]

! This document outlines the use of `@page`, `@taxonomy.category` etc, but a more YAML-safe alternative format is `page@`, `taxonomy@.category`.  All the `@` commands can be written in either prefix or postfix format.

!! Collection options have been improved and changed since **Grav 1.6**. The old versions will still work, but are not recommended to use.

We will cover these more in detail.

## Root Collections

##### @root.pages - Top level pages

This can be used to retrieve the top/root level **published pages** of a site. Particular useful for getting the items that make up the primary navigation for example:

[prism classes="language-yaml line-numbers"]
content:
    items: '@root.pages'
[/prism]

An alias of `'@root.children'` is also valid. Using `'@root'` is deprecated as its meaning can change in the future.

##### @root.descendants - All the pages

This will effectively get every page in your site as it recursively navigates through all the children from the root page down, and builds a collection of **all** the **published pages** of a site:

[prism classes="language-yaml line-numbers"]
content:
    items: '@root.descendants'
[/prism]

##### @root.all - All the pages and modules

This will do the same as above, but it includes **all** the **published pages and modules** of the site.

[prism classes="language-yaml line-numbers"]
content:
    items: '@root.all'
[/prism]

## Self Collections

##### @self.page - Current page only

This will return a collection containing only the current page.

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.page'
[/prism]

An alias of `'@self.self'` is also valid.

! Empty collection will be returned if the page has not been published.

##### @self.parent - The parent page of the current page

This is a special case collection because it will always return just the **parent** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.parent'
[/prism]

! Empty collection will be returned if the page is in the top level.

##### @self.siblings - Siblings of the current page

This collection will collect all the **published pages** at the same level of the current page, excluding the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.siblings'
[/prism]

##### @self.children - Children of the current page

This is used to list the **published children** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
[/prism]

An alias of `'@self.pages'` is also valid. Using `'@self'` is deprecated as its meaning can change in the future.

##### @self.modules - Modules of the current page

This method retrieves only **published modules** of the current page (`_features`, `_showcase`, etc.):

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.modules'
[/prism]

Using alias of `'@self.modular'` is deprecated.

##### @self.all - Children and modules of the current page

This method retrieves only **published children and modules** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.all'
[/prism]

##### @self.descendants - Children + all descendants of the current page

Similar to `.children`, the `.descendants` collection will retrieve all the **published children** but continue to recurse through all their children:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.descendants'
[/prism]

## Page Collections

##### @page.page - Collection of just the specific page

This collection takes a slug route of a page as an argument and will return collection containing that page (if it is a **published page**):

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.page': '/blog'
[/prism]

An alias of `'@page.self': '/blog'` is also valid.

! Empty collection will be returned if the page has not been published.

##### @page.parent - The parent page of a specific page

This is a special case collection because it will always return just the **parent** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.parent': '/blog'
[/prism]
@
! Empty collection will be returned if the page is in the top level.

##### @page.siblings - Siblings of a specific page

This collection will collect all the **published pages** at the same level of the page, excluding the page itself:

[prism classes="language-yaml line-numbers"]
content:
    items:
        '@page.siblings': '/blog'
[/prism]

##### @page.children - Children of a specific page

This collection takes a slug route of a page as an argument and will return all the **published children** of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.children': '/blog'
[/prism]

An alias of `'@page.pages': '/blog'` is also valid. Using `'@page': '/blog'` is deprecated as its meaning can change in the future.

##### @page.modules - Modules of a specific page

This collection takes a slug route of a page as an argument and will return all the **published modules** of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.modules': '/blog'
[/prism]

Using alias of `'@page.modular': '/blog'` is deprecated.

##### @page.all - Children and modules of a specific page

This method retrieves only **published children and modules** of the specific page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.all': '/blog'
[/prism]

##### @page.descendants - Collection of children + all descendants of a specific page

This collection takes a slug route of a page as an argument and will return all the **published children** and all their descendants of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.descendants': '/blog'
[/prism]


## Taxonomy Collections

[prism classes="language-yaml line-numbers"]
content:
   items:
      '@taxonomy.tag': foo
[/prism]

Using the `@taxonomy` option, you can utilize Grav's powerful taxonomy functionality.  This is where the `taxonomy` variable in the [Site Configuration](../../basics/grav-configuration#site-configuration) file comes into play. There **must** be a definition for the taxonomy defined in that configuration file for Grav to interpret a page reference to it as valid.

By setting `@taxonomy.tag: foo`, Grav will find all the **published pages** in the `/user/pages` folder that have themselves set `tag: foo` in their taxonomy variable:

[prism classes="language-yaml line-numbers"]
content:
    items:
       '@taxonomy.tag': [foo, bar]
[/prism]

The `content.items` variable can take an array of taxonomies and it will gather up all pages that satisfy these rules. Published pages that have **both** `foo` **and** `bar` tags will be collected.  The [Taxonomy](../taxonomy) chapter will cover this concept in more detail.

!! If you wish to place multiple variables inline, you will need to separate sub-variables from their parents with `{}` brackets. You can then separate individual variables on that level with a comma. For example: `'@taxonomy': {category: [blog, featured], tag: [foo, bar]}`. In this example, the `category` and `tag` sub-variables are placed under `@taxonomy` in the hierarchy, each with listed values placed within `[]` brackets. Pages must meet **all** these requirements to be found.

If you have multiple variables in a single parent to set, you can do this using the inline method, but for simplicity, we recommend using the standard method. Here is an example:

[prism classes="language-yaml line-numbers"]
content:
  items:
    '@taxonomy':
      category: [blog, featured]
      tag: [foo, bar]
[/prism]

Each level in the hierarchy adds two whitespaces before the variable. YAML will allow you to use as many spaces as you want here, but two is standard practice. In the above example, both the `category` and `tag` variables are set under `@taxonomy`.

Page collections will automatically be filtered by taxonomy when one has been set in the URL (e.g. /archive/category:news). This enables you to build a single blog archive template but filter the collection dynamically using the URL. If your page collection should ignore the taxonomy set in the URL use the flag `url_taxonomy_filters:false` to disable this feature.

### Complex Collections

You can also provide multiple complex collection definitions and the resulting collection will be the sum of all the pages found from each of the collection definitions. For example:

[prism classes="language-yaml line-numbers"]
content:
  items:
    - '@self.children'
    - '@taxonomy':
         category: [blog, featured]
[/prism]

Additionally, you can filter the collection by using `filter: type: value`. The type can be any of the following: `published`, `visible`, `page`, `module`, `routable`. These correspond to the [Collection-specific methods](#collection-object-methods), and you can use several to filter your collection. They are all either `true` or `false`. Additionally, there is `type` which takes a single template-name, `types` which takes an array of template-names, and `access` which takes an array of access-levels. For example:

[prism classes="language-yaml line-numbers"]
 content:
  items: '@self.siblings'
  filter:
    visible: true
    type: 'blog'
    access: ['site.login']
[/prism]

The type can also be negative: `non-published`, `non-visible`, `non-page` (=module), `non-module` (=page) and `non-routable`, but it preferred if you use the positive version with the value `false`.

[prism classes="language-yaml line-numbers"]
 content:
  items: '@self.children'
  filter:
    published: false
[/prism]

!! Collection filters have been simplified since **Grav 1.6**. The old `modular` and `non-modular` variants will still work, but are not recommended to use. Use `module` and `page` instead.

## Ordering Options

[prism classes="language-yaml line-numbers"]
content:
    order:
        by: date
        dir: desc
    limit: 5
    pagination: true
[/prism]

Ordering of sub-pages follows the same rules as ordering of folders, the available options are:

[div class="table-keycol"]
| Ordering     | Details                                                                                                                                            |
| :----------  | :----------                                                                                                                                        |
| `default`    | The order is based on the file system, i.e. `01.home` before `02.advark`                                                                              |
| `title`      | The order is based on the title as defined in each page                                                                                            |
| `basename`   | The order is based on the alphabetic folder name after it has been processed by the `basename()` PHP function                                      |
| `date`       | The order is based on the date as defined in each page                                                                                                |
| `modified`   | The order is based on the modified timestamp of the page                                                                                              |
| `folder`     | The order is based on the folder name with any numerical prefix, i.e. `01.`, removed                                                                  |
| `header.x`   | The order is based on any page header field. i.e. `header.taxonomy.year`. Also a default can be added via a pipe. i.e. `header.taxonomy.year|2015`    |
| `random`     | The order is randomized                                                                                                                            |
| `custom`     | The order is based on the `content.order.custom` variable                                                                                                                             |
| `manual`     | The order is based on the `order_manual` variable. **DEPRECATED**                                                                                                    |
| `sort_flags` | Allow to override sorting flags for page header-based or default ordering. If the `intl` PHP extension is loaded, only [these flags](https://secure.php.net/manual/en/collator.asort.php) are available. Otherwise, you can use the PHP [standard sorting flags](https://secure.php.net/manual/en/array.constants.php). |
[/div]

The `content.order.dir` variable controls which direction the ordering should be in. Valid values are either `desc` or `asc`.

[prism classes="language-yaml line-numbers"]
content:
    order:
        by: default
        custom:
            - _showcase
            - _highlights
            - _callout
            - _features
    limit: 5
    pagination: true
[/prism]

In the above configuration, you can see that `content.order.custom` is defining a **custom manual ordering** to ensure the page is constructed with the **showcase** first, **highlights** section second etc. Please note that if a page is not specified in the custom ordering list, then Grav falls back on the `content.order.by` for the unspecified pages.

If a page has a custom slug, you must use that slug in the `content.order.custom` list.

The `content.pagination` is a simple boolean flag to be used by plugins etc to know if **pagination** should be initialized for this collection. `content.limit` is the number of items displayed per-page when pagination is enabled.

### Date Range

There is also an ability to filter pages by a date range:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    dateRange:
        start: 1/1/2014
        end: 1/1/2015
[/prism]

You can use any string date format supported by [strtotime()](https://php.net/manual/en/function.strtotime.php) such as `-6 weeks` or `last Monday` as well as more traditional dates such as `01/23/2014` or `23 January 2014`. The dateRange will filter out any pages that have a date outside the provided dateRange.  Both **start** and **end** dates are optional, but at least one should be provided.

### Multiple Collections

When you create a collection with `content: items:` in your YAML, you are defining a single collection based on several conditions.  However, Grav does let you create an arbitrary set of collections per page, you just need to create another one:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    order:
        by: date
        dir: desc
    limit: 10
    pagination: true

fruit:
    items:
       '@taxonomy.tag': [fruit]
[/prism]

This sets up **2 collections** for this page, the first uses the default `content` collection, but the second one defines a taxonomy-based collection called `fruit`.  To access these two collections via Twig you can use the following syntax:

[prism classes="language-yaml line-numbers"]
{% set default_collection = page.collection %}
{% set fruit_collection = page.collection('fruit') %}
[/prism]

## Collection Object Methods

Iterable methods include:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| `Collection::append($items)` | Add another collection or array |
| `Collection::first()` | Get the first item in the collection |
| `Collection::last()` | Get the last item in the collection |
| `Collection::random($num)` | Pick `$num` random items from the collection |
| `Collection::reverse()` | Reverse the order of the collection |
| `Collection::shuffle()` | Randomize the entire collection |
| `Collection::slice($offset, $length)` | Slice the list |
[/div]

Also has several useful Collection-specific methods:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| `Collection::addPage($page)` | You can append another page to this collection |
| `Collection::copy()` | Creates a copy of the current collection |
| `Collection::current()` | Gets the current item in the collection |
| `Collection::key()` | Returns the slug of the current item |
| `Collection::remove($path)` | Removes a specific page in the collection, or current if `$path = null` |
| `Collection::order($by, $dir, $manual)` | Orders the current collection |
| `Collection::intersect($collection2)` | Merge two collections, keeping items that occur in both collections (like an "AND" condition) |
| `Collection::merge($collection2)` | Merge two collections, keeping items that occur in either collection (like an "OR" condition) |
| `Collection::isFirst($path)` | Determines if the page identified by path is first |
| `Collection::isLast($path)` | Determines if the page identified by path is last |
| `Collection::prevSibling($path)` | Returns the previous sibling page if possible |
| `Collection::nextSibling($path)` | Returns the next sibling page if possible |
| `Collection::currentPosition($path)` | Returns the current index |
| `Collection::dateRange($startDate, $endDate, $field)` | Filters the current collection with dates |
| `Collection::visible()` | Filters the current collection to include only visible pages |
| `Collection::nonVisible()` | Filters the current collection to include only non-visible pages |
| `Collection::pages()` | Filters the current collection to include only pages (and not modules) |
| `Collection::modules()` | Filters the current collection to include only modules (and not pages) |
| `Collection::published()` | Filters the current collection to include only published pages |
| `Collection::nonPublished()` | Filters the current collection to include only non-published pages |
| `Collection::routable()` | Filters the current collection to include only routable pages |
| `Collection::nonRoutable()` | Filters the current collection to include only non-routable pages |
| `Collection::ofType($type)` | Filters the current collection to include only pages where template = `$type` |
| `Collection::ofOneOfTheseTypes($types)` | Filters the current collection to include only pages where template is in the array `$types` |
| `Collection::ofOneOfTheseAccessLevels($levels)` | Filters the current collection to include only pages where page access is in the array of `$levels` |
[/div]

!! The following methods have been deprecated in **Grav 1.7**: `Collection::modular()` and `Collection::nonModular()`. Use `Collection::modules()` and `Collection::pages()` respectively.

Here is an example taken from the **Learn2** theme's **docs.html.twig** that defines a collection based on taxonomy (and optionally tags if they exist) and uses the `Collection::isFirst` and `Collection::isLast` methods to conditionally add page navigation:

[prism classes="language-twig line-numbers"]
{% set tags = page.taxonomy.tag %}
{% if tags %}
    {% set progress = page.collection({'items':{'@taxonomy':{'category': 'docs', 'tag': tags}},'order': {'by': 'default', 'dir': 'asc'}}) %}
{% else %}
    {% set progress = page.collection({'items':{'@taxonomy':{'category': 'docs'}},'order': {'by': 'default', 'dir': 'asc'}}) %}
{% endif %}

{% block navigation %}
        <div id="navigation">
        {% if not progress.isFirst(page.path) %}
            <a class="nav nav-prev" href="{{ progress.nextSibling(page.path).url|e }}"> <i class="fa fa-chevron-left"></i></a>
        {% endif %}

        {% if not progress.isLast(page.path) %}
            <a class="nav nav-next" href="{{ progress.prevSibling(page.path).url|e }}"><i class="fa fa-chevron-right"></i></a>
        {% endif %}
        </div>
{% endblock %}
[/prism]

`nextSibling()` is up the list and `prevSibling()` is down the list, this is how it works:

Assuming you have the pages:

[prism classes="language-txt line-numbers"]
Project A
Project B
Project C
[/prism]

You are on Project A, the previous page is Project B.
If you are on Project B, the previous page is Project C and next is Project A


## Programmatic Collections

You can take full control of collections directly from PHP in Grav plugins, themes, or even from Twig.  This is a more hard-coded approach compared to defining them in your page frontmatter, but it also allows for more complex and flexible collections logic.

### PHP Collections

You can perform advanced collection logic with PHP, for example:

[prism classes="language-php line-numbers"]
$collection = new Collection($pages);
$collection->setParams(['taxonomies' => ['tag' => ['dog', 'cat']]])->dateRange('01/01/2016', '12/31/2016')->published()->ofType('blog-item')->order('date', 'desc');

$titles = [];

foreach ($collection as $page) {
    $titles[] = $page->title();
}
[/prism]

The `order()`-function can also, in addition to the `by`- and `dir`-parameters, take a `manual`- and `sort_flags`-parameter. These are [documented above](#ordering-options). You can also use the same `evaluate()` method that the frontmatter-based page collections make use of:

[prism classes="language-php line-numbers"]
$page = Grav::instance()['page'];
$collection = $page->evaluate(['@page.children' => '/blog', '@taxonomy.tag' => 'photography']);
$ordered_collection = $collection->order('date', 'desc');
[/prism]

And another example of custom ordering would be:

[prism classes="language-php line-numbers"]
$ordered_collection = $collection->order('header.price','asc',null,SORT_NUMERIC);
[/prism]

You can also do similar directly in **Twig Templates**:

[prism classes="language-twig line-numbers"]
{% set collection = page.evaluate([{'@page.children':'/blog', '@taxonomy.tag':'photography'}]) %}
{% set ordered_collection = collection.order('date','desc') %}
[/prism]

#### Advanced Collections

By default when you call `page.collection()` in the Twig of a page that has a collection defined in the header, Grav looks for a collection called `content`.  This allows the ability to define [multiple collections](#multiple-collections), but you can even take this a step further.

If you need to programmatically generate a collection, you can do so by calling `page.collection()` and passing in an array in the same format as the page header collection definition.  For example:

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@page.children': '/my/pages'}, 'limit': 5, 'order': {'by': 'date', 'dir': 'desc'}, 'pagination': true } %}
{% set my_collection = page.collection(options) %}

<ul>
{% for p in my_collection %}
<li>{{ p.title|e }}</li>
{% endfor %}
</ul>
[/prism]

Generating menu for the whole site (you need to set *menu* property in the page's frontmatter):


[prism classes="language-yaml line-numbers"]
[/prism]

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@root.descendants':''}, 'order': {'by': 'folder', 'dir': 'asc'}} %}
{% set my_collection = page.collection(options) %}

{% for p in my_collection %}
{% if p.header.menu %}
	<ul>
	{% if page.slug == p.slug %}
		<li class="{{ p.slug|e }} active"><span>{{ p.menu|e }}</span></li>
	{% else %}
		<li class="{{ p.slug|e }}"><a href="{{ p.url|e }}">{{ p.menu|e }}</a></li>
	{% endif %}
	</ul>
{% endif %}
{% endfor %}
[/prism]

#### Pagination with Advanced Collections

A common question we hear is regarding how to enable pagiation for custom collections.  Pagination is a plugin that can be installed via GPM with the name `pagination`.  Once installed it works "out-of-the-box" with page configured collections, but knows nothing about custom collections created in Twig.  To make this process easier, pagination comes with it's own Twig function called `paginate()` that will provide the pagination functionality we need.

After we pass the collection and the limit to the `paginate()` function, we also need to pass the pagination information directly to the `partials/pagination.html.twig` template to render properly.

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@root.descendants':''}, 'order': {'by': 'folder', 'dir': 'asc'}} %}
{% set my_collection = page.collection(options) %}
{% do paginate( my_collection, 5 ) %}

{% for p in my_collection %}
    <ul>
        {% if page.slug == p.slug %}
            <li class="{{ p.slug|e }} active"><span>{{ p.menu|e }}</span></li>
        {% else %}
            <li class="{{ p.slug|e }}"><a href="{{ p.url|e }}">{{ p.menu|e }}</a></li>
        {% endif %}
    </ul>
{% endfor %}

{% include 'partials/pagination.html.twig' with {'base_url':page.url, 'pagination':my_collection.params.pagination} %}
[/prism]


#### Custom Collection Handling with `onCollectionProcessed()` Event

There are times when the event options are just not enough.  Times when you want to get a collection but then further manipulate the collection based on something very custom.  Imagine if you will, a use case where you have what seems like a rather bog-standard blog listing, but your client wants to have fine grain control over what displays in the listing.  They want to have a custom toggle on every blog item that lets them remove it from the listing, but still have it published and available via a direct link.

To make this happen, we can simply add a custom `display_in_listing: false` option in the page header for the item:

[prism classes="language-yaml line-numbers"]
...
[/prism]

The problem is that there is no way to define or include this filter when defining a collection in the listing page.  It probably is defined something like this:

[prism classes="language-yaml line-numbers"]
...
[/prism]

So the collection is simply defined by the `self@.children` directive to get all the published children of the current page. So what about those pages that have the `display_in_listing: false` set? We need to do some extra work on that collection before it is returned to ensure we remove any items that we don't want to see.  To do this we can use the `onCollectionProcessed()` event in a custom plugin.  We need to add the listener:

[prism classes="language-php line-numbers"]
    public static function getSubscribedEvents(): array
    {
        return [
            ['autoload', 100000],
            'onPluginsInitialized' => ['onPluginsInitialized', 0],
            'onCollectionProcessed' => ['onCollectionProcessed', 10]
        ];
    }
[/prism]

Then, we need to define the method and loop over the collection items, looking for any pages with that `display_in_listing:` field set, then remove it if it is `false`:

[prism classes="language-php line-numbers"]
    /**
     * Remove any page from collection with display_in_listing: false|0
     *
     * @param Event $event
     */
    public function onCollectionProcessed(Event $event): void
    {
        /** @var Collection $collection */
        $collection = $event['collection'];

        foreach ($collection as $item) {
            $display_in_listing = $item->header()->display_in_listing ?? true;
            if ((bool) $display_in_listing === false) {
                $collection->remove($item->path());
            }
        }

    }
[/prism]

Now your collection has the correct items, and all other plugins or Twig templates that rely on that collection will see this modified collection so things like pagination will work as expected.

---

## Basics of Grav Collections

> Path: grav-learn/pages/02.content/03.collections/docs.md


Collections have grown considerably since the early betas of Grav. We started off with a very limited set of page-based collections, but with the help of our community, we have increased these capabilities to make them even more powerful!  So much so that they now have their own section in the documentation.

## Basics of Grav Collections

In Grav, the most common type of collection is a list of pages that can be defined either in the page's frontmatter or in the twig itself. The most common is to define a collection in the frontmatter. With a collection defined, it is available in the Twig of the page to do with as you wish. By using page collection methods or looping through each [page object](https://learn.getgrav.org/themes/theme-vars#page-object) and using the page methods or properties you can do powerful things. Common examples of this include displaying a list of blog posts or displaying modular sub-pages to render a complex page design.

## Collection Object

When you define a collection in the page header, you are dynamically creating a [Grav Collection](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Page/Collection.php) that is available in the page's Twig.  This Collection object is **iterable** and can be treated like an **array** which allows you to do things such as:

[prism classes="language-twig line-numbers"]
{{ dump(page.collection[page.path]) }}
[/prism]

## Example Collection Definition

An example collection defined in the page's frontmatter:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    order:
        by: date
        dir: desc
    limit: 10
    pagination: true
[/prism]

The `content.items` value in the page's frontmatter tells Grav to gather up a collection of items and information passed to this defines how the collection is to be built.

This definition creates a collection for the page that consists of all **child pages** sorted by **date** in **descending** order with **pagination** showing **10 items** per-page.

## Accessing Collections in Twig

When this collection is defined in the header, Grav creates a collection **page.collection** that you can access in a twig template with:

[prism classes="language-twig line-numbers"]
{% for p in page.collection %}
<h2>{{ p.title|e }}</h2>
{{ p.summary|raw }}
{% endfor %}
[/prism]

This simply loops over the [pages](https://learn.getgrav.org/themes/theme-vars#page-object) in the collection displaying the title and summary.

You can also include an order parameter to change the default ordering of pages:

[prism classes="language-twig line-numbers"]
{% for p in page.collection.order('folder','asc') %}
<h2>{{ p.title|e }}</h2>
{{ p.summary|raw }}
{% endfor %}
[/prism]

## Collection Headers

To tell Grav that a specific page should be a listing page and contain child-pages, there are a number of variables that can be used:

### Summary of collection options

[div class="table-keycol"]
|                   String                  |                           Result                          |
|-------------------------------------------|-----------------------------------------------------------|
| `'@root'`                                   | Get the root children                                     |
| `'@root.children'`                          | Get the root children (alternative)                       |
| `'@root.descendants'`                       | Get the root and recurse through ALL children             |
|                                           |                                                           |
| `'@self.parent'`                            | Get the parent of the current page                        |
| `'@self.siblings'`                          | A collection of all other pages on this level             |
| `'@self.modular'`                           | Get only the modular children                             |
| `'@self.children'`                          | Get the non-modular children                              |
| `'@self.descendants'`                       | Recurse through all the non-modular children              |
|                                           |                                                           |
| `'@page': '/fruit'`                         | Get all the children of page `/fruit`                     |
| `'@page.children': '/fruit'`                | Alternative to above                                      |
| `'@page.self': '/fruit'`                    | Get a collection with only the page `/fruit`              |
| `'@page.page': '/fruit'`                    | Alternative to above                                      |
| `'@page.descendants': '/fruit'`             | Get and recurse through all the children of page `/fruit` |
| `'@page.modular': '/fruit'`                | Get a collection of all modular subpages of `/fruit`      |
|                                           |                                                           |
| `'@taxonomy.tag': photography`              | taxonomy with tag=`photography`                           |
| `'@taxonomy': {tag: birds, category: blog}` | taxonomy with tag=`birds` && category=`blog`              |
[/div]

! This document outlines the use of `@page`, `@taxonomy.category` etc, but a more YAML-safe alternative format is `page@`, `taxonomy@.category`.  All the `@` commands can be written in either prefix or postfix format.

We will cover these more in detail.

## Root Collections

##### @root - Top level children

This can be used to retrieve the top/root level **published non-modular children** of a site. Particular useful for getting the items that make up the primary navigation for example:

[prism classes="language-yaml line-numbers"]
content:
    items: '@root'
[/prism]

an alias is also valid:

[prism classes="language-yaml line-numbers"]
content:
    items: '@root.children'
[/prism]

##### @root - Top level children + all descendants

This will effectively get every page in your site as it recursively navigates through all the children from the root page down, and builds a collection of **all** the **published non-modular children** of a site:

[prism classes="language-yaml line-numbers"]
content:
    items: '@root.descendants'
[/prism]

## Self Collections

##### @self.children - Children of the current page

This is used to list the **published non-modular children** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
[/prism]

##### @self.descendants - Non-modular children + all descendants of the current page

Similar to `.children`, the `.descendants` collection will retrieve all the **published non-modular children** but continue to recurse through all their children:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.descendants'
[/prism]

##### @self.modular - Modular children of the current page

The inverse of `.children`, this method retrieves only **published modular children** of the current page (`_features`, `_showcase`, etc.):

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.modular'
[/prism]

##### @self.parent - The parent page of the current page

This is a special case collection because it will always return just the one **parent** of the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.parent'
[/prism]

##### @self.siblings - All the sibling pages

This collection will collect all the **published** Pages at the same level of the current page, excluding the current page:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.siblings'
[/prism]

## Page Collections

##### @page or @page.children - Collection of children of a specific page

This collection takes a slug route of a page as an argument and will return all the **published non-modular** children of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page': '/blog'
[/prism]

alternatively:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.children': '/blog'
[/prism]

##### @page.self or @page.page - Collection of just the specific page

This collection takes a slug route of a page as an argument and will return collection containing that page (if it is **published and non-modular**):

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.self': '/blog'
[/prism]

##### @page.descendants - Collection of children + all descendants of a specific page

This collection takes a slug route of a page as an argument and will return all the **published non-modular** children and all their descendants of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.descendants': '/blog'
[/prism]

##### @page.modular - Collection of modular children of a specific page

This collection takes a slug route of a page as an argument and will return all the **published modular** children of that page:

[prism classes="language-yaml line-numbers"]
content:
    items:
      '@page.modular': '/blog'
[/prism]


## Taxonomy Collections

[prism classes="language-yaml line-numbers"]
content:
   items:
      '@taxonomy.tag': foo
[/prism]

Using the `@taxonomy` option, you can utilize Grav's powerful taxonomy functionality.  This is where the `taxonomy` variable in the [Site Configuration](../../basics/grav-configuration#site-configuration) file comes into play. There **must** be a definition for the taxonomy defined in that configuration file for Grav to interpret a page reference to it as valid.

By setting `@taxonomy.tag: foo`, Grav will find all the **published pages** in the `/user/pages` folder that have themselves set `tag: foo` in their taxonomy variable:

[prism classes="language-yaml line-numbers"]
content:
    items:
       '@taxonomy.tag': [foo, bar]
[/prism]

The `content.items` variable can take an array of taxonomies and it will gather up all pages that satisfy these rules. Published pages that have **both** `foo` **and** `bar` tags will be collected.  The [Taxonomy](../taxonomy) chapter will cover this concept in more detail.

!! If you wish to place multiple variables inline, you will need to separate sub-variables from their parents with `{}` brackets. You can then separate individual variables on that level with a comma. For example: `'@taxonomy': {category: [blog, featured], tag: [foo, bar]}`. In this example, the `category` and `tag` sub-variables are placed under `@taxonomy` in the hierarchy, each with listed values placed within `[]` brackets. Pages must meet **all** these requirements to be found.

If you have multiple variables in a single parent to set, you can do this using the inline method, but for simplicity, we recommend using the standard method. Here is an example:

[prism classes="language-yaml line-numbers"]
content:
  items:
    '@taxonomy':
      category: [blog, featured]
      tag: [foo, bar]
[/prism]

Each level in the hierarchy adds two whitespaces before the variable. YAML will allow you to use as many spaces as you want here, but two is standard practice. In the above example, both the `category` and `tag` variables are set under `@taxonomy`.

Page collections will automatically be filtered by taxonomy when one has been set in the URL (e.g. /archive/category:news). This enables you to build a single blog archive template but filter the collection dynamically using the URL. If your page collection should ignore the taxonomy set in the URL use the flag `url_taxonomy_filters:false` to disable this feature.

### Complex Collections

You can also provide multiple complex collection definitions and the resulting collection will be the sum of all the pages found from each of the collection definitions. For example:

[prism classes="language-yaml line-numbers"]
content:
  items:
    - '@self.children'
    - '@taxonomy':
         category: [blog, featured]
[/prism]

Additionally, you can filter the collection by using `filter: type: value`. The type can be any of the following: `published`, `non-published`, `visible`, `non-visible`, `modular`, `non-modular`, `routable`, `non-routable`, `type`, `types`, `access`. These correspond to the [Collection-specific methods](#collection-object-methods), and you can use several to filter your collection. They are all either `true` or `false`, except for `type` which takes a single template-name, `types` which takes an array of template-names, and `access` which takes an array of access-levels. For example:

[prism classes="language-yaml line-numbers"]
 content:
  items: '@self.siblings'
  filter:
    published: true
    type: 'blog'
[/prism]

### Ordering Options

[prism classes="language-yaml line-numbers"]
content:
    order:
        by: date
        dir: desc
    limit: 5
    pagination: true
[/prism]

Ordering of sub-pages follows the same rules as ordering of folders, the available options are:

[div class="table-keycol"]
| Ordering     | Details                                                                                                                                            |
| :----------  | :----------                                                                                                                                        |
| `default`    | The order is based on the file system, i.e. `01.home` before `02.advark`                                                                              |
| `title`      | The order is based on the title as defined in each page                                                                                            |
| `basename`   | The order is based on the alphabetic folder name after it has been processed by the `basename()` PHP function                                      |
| `date`       | The order is based on the date as defined in each page                                                                                                |
| `modified`   | The order is based on the modified timestamp of the page                                                                                              |
| `folder`     | The order is based on the folder name with any numerical prefix, i.e. `01.`, removed                                                                  |
| `header.x`   | The order is based on any page header field. i.e. `header.taxonomy.year`. Also a default can be added via a pipe. i.e. `header.taxonomy.year|2015`    |
| `manual`     | The order is based on the `order_manual` variable                                                                                                     |
| `random`     | The order is randomized                                                                                                                            |
| `custom`     | The order is based on the `content.order.custom` variable                                                                                                                             |
| `sort_flags` | Allow to override sorting flags for page header-based or default ordering. If the `intl` PHP extension is loaded, only [these flags](https://secure.php.net/manual/en/collator.asort.php) are available. Otherwise, you can use the PHP [standard sorting flags](https://secure.php.net/manual/en/array.constants.php). |
[/div]

!! `header.x` will order pages based on the **value as a string**.
!!
!! If you intend to sort custom dates, make sure you [setup your _Page date format_ as `Y-m-d H:i`](../../admin-panel/dashboard/configuration-system#content) for the sorting to behave as expected.
!!
!! **Example:** `08-12-2020 12:00` (December 8th) will be considered earlier than `09-11-2020 12:00` (November 9th). `2020-12-08 12:00` will be considered later than `2020-11-09 12:00`, as expected for dates.

<!-- TODO: ### Sort based on the type of the header in the blueprint? -->

The `content.order.dir` variable controls which direction the ordering should be in. Valid values are either `desc` or `asc`.

[prism classes="language-yaml line-numbers"]
content:
    order:
        by: default
        custom:
            - _showcase
            - _highlights
            - _callout
            - _features
    limit: 5
    pagination: true
[/prism]

In the above configuration, you can see that `content.order.custom` is defining a **custom manual ordering** to ensure the page is constructed with the **showcase** first, **highlights** section second etc. Please note that if a page is not specified in the custom ordering list, then Grav falls back on the `content.order.by` for the unspecified pages.

If a page has a custom slug, you must use that slug in the `content.order.custom` list.

The `content.pagination` is a simple boolean flag to be used by plugins etc to know if **pagination** should be initialized for this collection. `content.limit` is the number of items displayed per-page when pagination is enabled.

### Date Range

New as of **Grav 0.9.13** is the ability to filter by a date range:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    dateRange:
        start: 1/1/2014
        end: 1/1/2015
[/prism]

You can use any string date format supported by [strtotime()](https://php.net/manual/en/function.strtotime.php) such as `-6 weeks` or `last Monday` as well as more traditional dates such as `01/23/2014` or `23 January 2014`. The dateRange will filter out any pages that have a date outside the provided dateRange.  Both **start** and **end** dates are optional, but at least one should be provided.

### Multiple Collections

When you create a collection with `content: items:` in your YAML, you are defining a single collection based on several conditions.  However, Grav does let you create an arbitrary set of collections per page, you just need to create another one:

[prism classes="language-yaml line-numbers"]
content:
    items: '@self.children'
    order:
        by: date
        dir: desc
    limit: 10
    pagination: true

fruit:
    items:
       '@taxonomy.tag': [fruit]
[/prism]

This sets up **2 collections** for this page, the first uses the default `content` collection, but the second one defines a taxonomy-based collection called `fruit`.  To access these two collections via Twig you can use the following syntax:

[prism classes="language-yaml line-numbers"]
{% set default_collection = page.collection %}
{% set fruit_collection = page.collection('fruit') %}
[/prism]

## Collection Object Methods

Iterable methods include:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| `Collection::append($items)` | Add another collection or array |
| `Collection::first()` | Get the first item in the collection |
| `Collection::last()` | Get the last item in the collection |
| `Collection::random($num)` | Pick `$num` random items from the collection |
| `Collection::reverse()` | Reverse the order of the collection |
| `Collection::shuffle()` | Randomize the entire collection |
| `Collection::slice($offset, $length)` | Slice the list |
[/div]

Also has several useful Collection-specific methods:

[div class="table-keycol"]
| Property | Description |
| -------- | ----------- |
| `Collection::addPage($page)` | You can append another page to this collection |
| `Collection::copy()` | Creates a copy of the current collection |
| `Collection::current()` | Gets the current item in the collection |
| `Collection::key()` | Returns the slug of the current item |
| `Collection::remove($path)` | Removes a specific page in the collection, or current if `$path = null` |
| `Collection::order($by, $dir, $manual)` | Orders the current collection |
| `Collection::intersect($collection2)` | Merge two collections, keeping items that occur in both collections (like an "AND" condition) |
| `Collection::merge($collection2)` | Merge two collections, keeping items that occur in either collection (like an "OR" condition) |
| `Collection::isFirst($path)` | Determines if the page identified by path is first |
| `Collection::isLast($path)` | Determines if the page identified by path is last |
| `Collection::prevSibling($path)` | Returns the previous sibling page if possible |
| `Collection::nextSibling($path)` | Returns the next sibling page if possible |
| `Collection::currentPosition($path)` | Returns the current index |
| `Collection::dateRange($startDate, $endDate, $field)` | Filters the current collection with dates |
| `Collection::visible()` | Filters the current collection to include only visible pages |
| `Collection::nonVisible()` | Filters the current collection to include only non-visible pages |
| `Collection::modular()` | Filters the current collection to include only modular pages |
| `Collection::nonModular()` | Filters the current collection to include only non-modular pages |
| `Collection::published()` | Filters the current collection to include only published pages |
| `Collection::nonPublished()` | Filters the current collection to include only non-published pages |
| `Collection::routable()` | Filters the current collection to include only routable pages |
| `Collection::nonRoutable()` | Filters the current collection to include only non-routable pages |
| `Collection::ofType($type)` | Filters the current collection to include only pages where template = `$type` |
| `Collection::ofOneOfTheseTypes($types)` | Filters the current collection to include only pages where template is in the array `$types` |
| `Collection::ofOneOfTheseAccessLevels($levels)` | Filters the current collection to include only pages where page access is in the array of `$levels` |
[/div]

Here is an example taken from the **Learn2** theme's **docs.html.twig** that defines a collection based on taxonomy (and optionally tags if they exist) and uses the `Collection::isFirst` and `Collection::isLast` methods to conditionally add page navigation:

[prism classes="language-twig line-numbers"]
{% set tags = page.taxonomy.tag %}
{% if tags %}
    {% set progress = page.collection({'items':{'@taxonomy':{'category': 'docs', 'tag': tags}},'order': {'by': 'default', 'dir': 'asc'}}) %}
{% else %}
    {% set progress = page.collection({'items':{'@taxonomy':{'category': 'docs'}},'order': {'by': 'default', 'dir': 'asc'}}) %}
{% endif %}

{% block navigation %}
        <div id="navigation">
        {% if not progress.isFirst(page.path) %}
            <a class="nav nav-prev" href="{{ progress.nextSibling(page.path).url|e }}"> <i class="fa fa-chevron-left"></i></a>
        {% endif %}

        {% if not progress.isLast(page.path) %}
            <a class="nav nav-next" href="{{ progress.prevSibling(page.path).url|e }}"><i class="fa fa-chevron-right"></i></a>
        {% endif %}
        </div>
{% endblock %}
[/prism]

`nextSibling()` is up the list and `prevSibling()` is down the list, this is how it works:

Assuming you have the pages:

[prism classes="language-txt line-numbers"]
Project A
Project B
Project C
[/prism]

You are on Project A, the previous page is Project B.
If you are on Project B, the previous page is Project C and next is Project A


## Programmatic Collections

You can take full control of collections directly from PHP in Grav plugins, themes, or even from Twig.  This is a more hard-coded approach compared to defining them in your page frontmatter, but it also allows for more complex and flexible collections logic.

### PHP Collections

You can perform advanced collection logic with PHP, for example:

[prism classes="language-php line-numbers"]
$collection = new Collection($pages);
$collection->setParams(['taxonomies' => ['tag' => ['dog', 'cat']]])->dateRange('01/01/2016', '12/31/2016')->published()->ofType('blog-item')->order('date', 'desc');

$titles = [];

foreach ($collection as $page) {
    $titles[] = $page->title();
}
[/prism]

The `order()`-function can also, in addition to the `by`- and `dir`-parameters, take a `manual`- and `sort_flags`-parameter. These are [documented above](#ordering-options). You can also use the same `evaluate()` method that the frontmatter-based page collections make use of:

[prism classes="language-php line-numbers"]
$page = Grav::instance()['page'];
$collection = $page->evaluate(['@page.children' => '/blog', '@taxonomy.tag' => 'photography']);
$ordered_collection = $collection->order('date', 'desc');
[/prism]

And another example of custom ordering would be:

[prism classes="language-php line-numbers"]
$ordered_collection = $collection->order('header.price','asc',null,SORT_NUMERIC);
[/prism]

You can also do similar directly in **Twig Templates**:

[prism classes="language-twig line-numbers"]
{% set collection = page.evaluate([{'@page.children':'/blog', '@taxonomy.tag':'photography'}]) %}
{% set ordered_collection = collection.order('date','desc') %}
[/prism]

#### Advanced Collections

By default when you call `page.collection()` in the Twig of a page that has a collection defined in the header, Grav looks for a collection called `content`.  This allows the ability to define [multiple collections](#multiple-collections), but you can even take this a step further.

If you need to programmatically generate a collection, you can do so by calling `page.collection()` and passing in an array in the same format as the page header collection definition.  For example:

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@page.children': '/my/pages'}, 'limit': 5, 'order': {'by': 'date', 'dir': 'desc'}, 'pagination': true } %}
{% set my_collection = page.collection(options) %}

<ul>
{% for p in my_collection %}
<li>{{ p.title|e }}</li>
{% endfor %}
</ul>
[/prism]

Generating menu for the whole site (you need to set *menu* property in the page's frontmatter):


[prism classes="language-yaml line-numbers"]
[/prism]

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@root.descendants':''}, 'order': {'by': 'folder', 'dir': 'asc'}} %}
{% set my_collection = page.collection(options) %}

{% for p in my_collection %}
{% if p.header.menu %}
	<ul>
	{% if page.slug == p.slug %}
		<li class="{{ p.slug|e }} active"><span>{{ p.menu|e }}</span></li>
	{% else %}
		<li class="{{ p.slug|e }}"><a href="{{ p.url|e }}">{{ p.menu|e }}</a></li>
	{% endif %}
	</ul>
{% endif %}
{% endfor %}
[/prism]

#### Pagination with Advanced Collections

A common question we hear is regarding how to enable pagiation for custom collections.  Pagination is a plugin that can be installed via GPM with the name `pagination`.  Once installed it works "out-of-the-box" with page configured collections, but knows nothing about custom collections created in Twig.  To make this process easier, pagination comes with it's own Twig function called `paginate()` that will provide the pagination functionality we need.

After we pass the collection and the limit to the `paginate()` function, we also need to pass the pagination information directly to the `partials/pagination.html.twig` template to render properly.

[prism classes="language-twig line-numbers"]
{% set options = { items: {'@root.descendants':''}, 'order': {'by': 'folder', 'dir': 'asc'}} %}
{% set my_collection = page.collection(options) %}
{% do paginate( my_collection, 5 ) %}

{% for p in my_collection %}
    <ul>
        {% if page.slug == p.slug %}
            <li class="{{ p.slug|e }} active"><span>{{ p.menu|e }}</span></li>
        {% else %}
            <li class="{{ p.slug|e }}"><a href="{{ p.url|e }}">{{ p.menu|e }}</a></li>
        {% endif %}
    </ul>
{% endfor %}

{% include 'partials/pagination.html.twig' with {'base_url':page.url, 'pagination':my_collection.params.pagination} %}
[/prism]


[version=16]
#### Custom Collection Handling with `onCollectionProcessed()` Event

There are times when the event options are just not enough.  Times when you want to get a collection but then further manipulate the collection based on something very custom.  Imagine if you will, a use case where you have what seems like a rather bog-standard blog listing, but your client wants to have fine grain control over what displays in the listing.  They want to have a custom toggle on every blog item that lets them remove it from the listing, but still have it published and available via a direct link.

To make this happen, we can simply add a custom `display_in_listing: false` option in the page header for the item:

[prism classes="language-yaml line-numbers"]
...
[/prism]

The problem is that there is no way to define or include this filter when defining a collection in the listing page.  It probably is defined something like this:

[prism classes="language-yaml line-numbers"]
...
[/prism]

So the collection is simply defined by the `self@.children` directive to get all the published children of the current page. So what about those pages that have the `display_in_listing: false` set? We need to do some extra work on that collection before it is returned to ensure we remove any items that we don't want to see.  To do this we can use the `onCollectionProcessed()` event in a custom plugin.  We need to add the listener:

[prism classes="language-php line-numbers"]
    public static function getSubscribedEvents()
    {
        return [
            ['autoload', 100000],
            'onPluginsInitialized' => ['onPluginsInitialized', 0],
            'onCollectionProcessed' => ['onCollectionProcessed', 10]
        ];
    }
[/prism]

Then, we need to define the method and loop over the collection items, looking for any pages with that `display_in_listing:` field set, then remove it if it is `false`:

[prism classes="language-php line-numbers"]
    /**
     * Remove any page from collection with display_in_listing: false|0
     *
     * @param Event $event
     */
    public function onCollectionProcessed(Event $event)
    {
        /** @var Collection $collection */
        $collection = $event['collection'];

        foreach ($collection as $item) {
            $display_in_listing = $item->header()->display_in_listing ?? true;
            if ((bool) $display_in_listing === false) {
                $collection->remove($item->path());
            }
        }

    }
[/prism]

Now your collection has the correct items, and all other plugins or Twig templates that rely on that collection will see this modified collection so things like pagination will work as expected.
[/version]

---

## Headings

> Path: grav-learn/pages/02.content/04.markdown/docs.md


Let's face it: Writing content for the Web is tiresome. WYSIWYG editors help alleviate this task, but they generally result in horrible code, or worse yet, ugly web pages.

**Markdown** is a better way to write **HTML**, without all the complexities and ugliness that usually accompanies it.

Some of the key benefits are:

1. Markdown is simple to learn, with minimal extra characters, so it's also quicker to write content.
2. Less chance of errors when writing in markdown.
3. Produces valid XHTML output.
4. Keeps the content and the visual display separate, so you cannot mess up the look of your site.
5. Write in any text editor or Markdown application you like.
6. Markdown is a joy to use!

John Gruber, the author of Markdown, puts it like this:

> The overriding design goal for Markdowns formatting syntax is to make it as readable as possible. The idea is that a Markdown-formatted document should be publishable as-is, as plain text, without looking like its been marked up with tags or formatting instructions. While Markdowns syntax has been influenced by several existing text-to-HTML filters, the single biggest source of inspiration for Markdowns syntax is the format of plain text email.
> -- <cite>John Gruber</cite>

Grav ships with built-in support for [Markdown](https://daringfireball.net/projects/markdown/) and [Markdown Extra](https://michelf.ca/projects/php-markdown/extra/). You must enable **Markdown Extra** in your `system.yaml` configuration file.

Without further delay, let us go over the main elements of Markdown and what the resulting HTML looks like:

!! <i class="fa fa-bookmark"></i> Bookmark this page for easy future reference!

## Headings

Headings from `h1` through `h6` are constructed with a `#` for each level:

[prism classes="language-markdown"]
# h1 Heading
## h2 Heading
### h3 Heading
#### h4 Heading
##### h5 Heading
###### h6 Heading
[/prism]

Renders to:

# h1 Heading
## h2 Heading
### h3 Heading
#### h4 Heading
##### h5 Heading
###### h6 Heading

HTML:

[prism classes="language-html"]
<h1>h1 Heading</h1>
<h2>h2 Heading</h2>
<h3>h3 Heading</h3>
<h4>h4 Heading</h4>
<h5>h5 Heading</h5>
<h6>h6 Heading</h6>
[/prism]

## Comments

Comments should be HTML compatible

[prism classes="language-html"]
<!--
This is a comment
-->
[/prism]

Comment below should **NOT** be seen:

<!--
This is a comment
-->

## Horizontal Rules

The HTML `<hr>` element is for creating a "thematic break" between paragraph-level elements. In markdown, you can create a `<hr>` with any of the following:

* `___`: three consecutive underscores
* `---`: three consecutive dashes
* `***`: three consecutive asterisks

renders to:

___


---

## Slug Relative

> Path: grav-learn/pages/02.content/05.linking/docs.md


Grav has a variety of flexible linking options that allow you to link from one page to another, and even to remote pages. If you have ever linked files using HTML or worked with a file system using a command line, a lot of this should be very easy to pick up.

We will run to some easy examples using this very basic, trimmed down model of what a Grav site's **Pages** directory might look like.

![Pages Directory](pages.jpg)

Using this directory structure as an example, we will take a look at the different types of links you can use in your content.

To get us started, here is a quick look at some of the common components of a Grav link, and what they mean.

```markdown
[Linked Content](../path/slug/page)
```

[div class="table-keycol"]
| String | Description |
| :----- | :----- |
| `[]`   | The square bracket is used to wrap the text or alternate content that becomes linked. In HTML, this would be the content placed between `<a href="">` and `</a>`. |
| `()`   | The parenthesis is used to surround the link itself. This is placed directly after the square bracket. |
| `../`  | When used in the link, it indicates a move up a directory. |
[/div]

### Slug Relative

Grav doesn't just limit your internal links to specific names within your file/directory structure. It can also pull slugs assigned both in the header of the file, as well as the fallback directory name. This makes creating quick links easy as you don't have to remember the specific file name, but an easily remembered (and relevant) slug.

Grav's templating engine uses file names to determine which template to apply to them. For example, a blog might use the standard file name `item.md` for each blog post. The blog post itself can be assigned a slug that makes more sense, such as `grass` or `grass-is-green`.

Directory names also have numbers assigned which helps with ordering. You don't have to include these numbers with slug-relative links. Grav ignores them when creating the slug, so your site's URL structure is cleaner.

Here are a few examples of slug-relative links.

In this example, we're moving up a directory and loading the default page located in the `pages/01.blue/02.water/item.md` directory from `pages/01.blue/01.sky/item.md`. The file, `item.md`, has no assigned slug, so Grav uses the directory name.

```markdown
[link](../water)
```

This next example does a very similar thing, linking from `pages/01.blue/01.sky/item.md` to `pages/02.green/02.tree/item.md`, but when loading the `item.md` file, a slug has been assigned to the file of `tree-is-green`.

```markdown
[link](../../green/tree-is-green)
```

The slug placed in the header of `item.md` replaces the `green` slug from the defaulting folder name.

### Directory relative

**Directory Relative** links use destinations set relative to the current page. This can be as simple as linking to another file in the current directory, such as an image file, or as complex as going up several directory levels and then back down to the specific folder/file you need to have displayed.

With relative links, the location of the source file is every bit as important as that of the destination. If either file in the mix is moved, changing the path between them, the link can be broken.

The advantage of this type of linking structure is that you can easily switch between a local development server and a live server with a different domain name and as long as the file structure remains consistent, the links should work without a problem.

A file link points to a particular file by name, rather than its directory or slug. If you were creating a link from `pages/01.blue/01.sky/item.md` to `/pages/02.green/01.grass/item.md` you would use the following command.

```markdown
[link](../../02.green/01.grass/item.md)
```

This link moves up two folders, as indicated by `../../`, and then down two folders, pointing directly to `item.md` as the destination.

Sometimes, you just want to direct the user up a single directory, loading the default page. Since an exact file is not indicated, Grav is trusted to choose the right one to load. For a well-organized Grav site, this should be no problem.

In this example, we will be linking `pages/01.blue/01.sky/item.md` to `/pages/02.green/` which would load the `color.md` file by default.

```markdown
[link](../../02.green)
```

If you want to link to a directory two steps up, you can do so using this process. 

The next example is a lot like the file link we demonstrated earlier. Instead of linking directly to the file, we're linking to its directory, which should load the file we want anyway since it's the default file. If you were creating a link from `pages/01.blue/01.sky/item.md` to `/pages/02.green/01.grass/` you would use the following command.

```markdown
[link](../../02.green/01.grass)
```

### Absolute

Absolute links are similar to relative links, but are relative to the root of the site. In **Grav**, this is typically based in your **/user/pages/** directory. This type of link can be done in two different ways.

You can do it in a similar fashion to the **Slug Relative** style which uses the slug, or directory name in the path for simplicity. This method removes potential issues of order changes later on (changing the number at the beginning of the folder name) breaking the link. This would be the most commonly used method of absolute linking.

In an absolute link, the link opens with a `/`. Here is an example of an absolute link made to `pages/01.blue/01.sky/item.md` in the **Slug** style.

```markdown
[link](/blue/sky)
```

The second method is fashioned after the **Directory Relative** style detailed previously. This method leaves in elements like the ordering numbers at the beginning of directory names. While this does add the potential of a broken link when content is reordered, it is more reliable when used with services like [Github](https://github.com) where content links do not have the benefit of Grav's flexibility. Here is an example of an absolute link made to `pages/01.blue/01.sky/item.md` using this style.

```markdown
[link](/01.blue/01.sky)
```

### Remote

Remote links enable you to link directly to pretty much any file or document out there via its URL. This doesn't have to include your own site's content, but it can. Here is an example of how you would link to Google's home page.

```markdown
[link](http://www.google.com)
```

You can link to pretty much any direct URL, including secured HTTPS links. For example:

```markdown
[link](https://github.com)
```

### Link Attributes

A great new feature you can take advantage of is providing link attributes directly via the markdown syntax. This allows you to easily add **class**, **id**, **rel**, and **target** HTML attributes without the need of [Markdown Extra](https://michelf.ca/projects/php-markdown/extra/).

Some examples of this are:

##### Class/Classes Attribute

```markdown
[Big Button](../some-page?classes=button,big)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page" class="button big">Big Button</a>
```

##### ID Attribute

```markdown
[Unique Button](../some-page?id=important-button)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page" id="important-button">Unique Button</a>
```

##### Rel Attribute

```markdown
[NoFollow Link](../some-page?rel=nofollow)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page" rel="nofollow">NoFollow Link</a>
```

##### Target Attribute

```markdown
[Link in new Tab](../some-page?target=_blank)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page" target="_blank">Link in new Tab</a>
```

##### Attribute Combinations

```markdown
[Combinations of Attributes](../some-page?target=_blank&classes=button)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page" target="_blank" class="button">Combinations of Attributes</a>
```

##### Attribute Combinations with Anchors

```markdown
[Element Anchor](../some-page?target=_blank&classes=button#element-id)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page#element-id" target="_blank" class="button">Element Anchor</a>
```

##### Anchor Links on the Same Page

```markdown
[Element Anchor](?classes=button#element-id)
```

which will result in HTML similar to:

```html
<a href="#element-id" class="button">
```

Note that the anchor should come _after_ the query as discussed in [Issue 1324](https://github.com/getgrav/grav/issues/1324#issuecomment-282587549)

##### Pass-through of Non-Supported Attributes

```markdown
[Pass-through of 'cat' attribute](../some-page?classes=underline&cat=black)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page?cat=black" class="underline">Pass-through of 'cat' attribute</a>
```

##### Skip All Attributes

```markdown
[Skip all attributes](../some-page?classes=underline&rel=nofollow&noprocess)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page?rel=nofollow&classes=underline">Skip All attributes</a>
```

##### Skip Certain Attributes

```markdown
[Skip Certain attributes](../some-page?id=myvariable&classes=underline&target=_blank&noprocess=id,classes)
```

which will result in HTML similar to:

```html
<a href="/your/pages/some-page?id=myvariable&classes=underline" target="_blank">Skip Certain attributes</a>
```

This is useful when trying to skip 1 or more specific attributes without affecting the others.

---

## Slug Relative

> Path: grav-learn/pages/02.content/06.image-linking/docs.md


Grav has a variety of flexible linking options that allow you to link images from one page to another, and even from remote sources. If you have ever linked files using HTML or worked with a file system using a command line, a lot of this should be elementary to pick up.

We will run to some easy examples using this very basic, trimmed down model of what a Grav site's **Pages** directory might look like.

![Pages Directory](pages.png)

Using this directory structure as an example, we will take a look at the different types of links you can use to display media files in your content. We have image files in every folder, including one image for each blog post, and three images in a special `/images` directory which acts as a page but contains only media files.

The use of the `/images` folder serves as an example of how you can maintain a simple, centralized image directory to store files that are frequently used by multiple pages. This simplifies the linking process in these cases.

!!!! If you decide to use a centralized image directory, be advised that this directory should exist within the `/pages` folder as this folder is intended for front-end content.

To get us started, here is a quick look at some of the standard components of a Grav markdown-based image tag.

```markdown
![Alt Text](../path/image.ext)
```

[div class="table-keycol"]
| String | Description                                                                                                              |
| :----- | :-----                                                                                                                   |
| `!`    | When placed at the beginning of a traditional markdown link tag, it indicates this is an image tag.                      |
| `[]`   | The square bracket is used to wrap the **optional** alt-text for the image.                                              |
| `()`   | The parenthesis is used to surround the reference to the image itself. This is placed directly after the square bracket. |
| `../`  | When used in the link, it indicates a move up a directory.                                                               |
[/div]

!!! You can combine a regular page link and an image link like to wrap an image in a link: `[![Alt text](/path/to/img.jpg)](http://example.net/)`

### Slug Relative

**Relative** image links use destinations set relative to the current page. This can be as simple as linking to another file in the current directory, such as an image file associated with the current page, or as complex as going up several directory levels and then back down to the specific folder/file where an image may reside.

With relative links, the location of the source file is every bit as important as that of the destination. If either file in the mix is moved, changing the path between them, the link can be broken.

The advantage of this type of linking structure is that you can quickly switch between a local development server and a live server with a different domain name and as long as the file structure remains consistent, the links should work without a problem.

A file link points to a particular file by name, rather than its directory or slug. If you were creating an image link in `pages/01.blog/test-post-1/item.md` to `/pages/01.blog/test-post-3/test-image-3.jpg` you would use the following command.

```markdown
![Test Image 3](../test-post-3/test-image-3.jpg)
```

This link moves up one folder, as indicated by `../`, and then down one folder, pointing directly to `test-image-3.jpg` as the destination.

If we want to load `blog-header.jpg` from the `01.blog` directory, we would do the following:

```markdown
![Blog Header](../../blog/blog-header.jpg)
```

! You do not need to include ordering numerals (`01.`) for slug relative links.

Grav has integrated support for slugs in the header of the page's primary markdown file. This slug supersedes the folder name for the page, and any media files contained within.

For example, **Test Post 2** has a slug set through its markdown file (`/pages/01.blog/test-post-2/item.md`). The header of this file contains the following:

[prism classes="language-yaml line-numbers"]
[/prism]

You will notice the slug `test-slug` has been set. Slugs set this way are completely optional, and do not have to be present. As mentioned in the last chapter, they do provide an easy way of linking. If a slug is set, then any link you make to a media file within that folder will have to be either **Slug Relative** or **Absolute** with a full URL set for the link.

If we want to link `test-image-2.jpg` from **Test Post 2**, we would enter the following:

```markdown
![Test Image 2](../test-slug/test-image-2.jpg)
```

You will notice that we navigated up one directory using (`../`) and then down into the `test-slug` page folder using the slug which was set in `/pages/01.blog/test-post-2/item.md` file.

### Directory relative

**Directory Relative** image links use destinations set relative to the current page. The main difference between a slug relative, and directory relative link, is that rather than using the URL slugs, you reference via the full path with folder names.

An example of this would be something like:

```markdown
![Test Image 3](../../01.blog/02.my_folder/test-image-3.jpg)
```

!! The main benefit of this, is that you can maintain link integrity in other systems outside of Grav, such as GitHub.

### Absolute

Absolute links are similar to relative links, but are relative to the root of the site. In **Grav**, this is typically based in your **/user/pages/** directory. This type of link can be done in two different ways.

You can do it in a similar fashion to the **Slug Relative** style which uses the slug, or directory name in the path for simplicity. This method removes potential issues of order changes later on (changing the number at the beginning of the folder name) breaking the link. This would be the most commonly used method of absolute linking.

In an absolute link, the link opens with a `/`. Here is an example of an absolute link made to `pages/01.blog/test-post-2/test-image-2.jpg` in the **Slug** style from `pages/01.blog/blog.md`.

```markdown
![Test Image 2](/blog/test-slug/test-image-2.jpg)
```

!!! A powerful technique is to create a `user/pages/images/` folder in your Grav site and put your images here.  Then you can easily reference them with an absolute URL from any Grav page: `/images/test-image-4.jpg` and still be able to perform [media actions](../media) on them.

### PHP Streams

Grav has also the ability to reference and link images via PHP streams.  There are several built-in PHP streams available which are useful including:

* `user://` - user folder. e.g. `user/`
* `page://` - pages folder. e.g. `user/pages/`
* `image://` - images folder. e.g. `user/images/`
* `plugins://` - plugins folder.  e.g. `user/plugins/`
* `theme://` - current theme.  e.g. `user/themes/antimatter/`

These allow you to easily access images that are traditionally outside of the Pages hierarchy (`user/pages/`).

```markdown
![Stream Image](user://media/images/my-image.jpg)
```

or:

```markdown
![Stream Image](theme://images/my-image.jpg)
```

For complete list of default stream locations, see [Multisite Setup - Streams](/advanced/multisite-setup#streams).

### Remote

Remote image links enable you to directly display pretty much any media file via its URL. This doesn't have to include your own site's content, but it can. Here is an example of how you would display a remote image file.

```markdown
![Remote Image 1](https://getgrav.org/images/testimage.png)
```

You can link to pretty much any direct URL, including secured HTTPS links.

### Media Actions on Images

One of the main benefits of using images associated with pages is that it enables you to take advantage of [Grav's powerful media actions](../media). For example, here is a line you would use to load an image from another page:

```markdown
![Styling Example](../test-post-3/test-image-3.jpg?cropResize=400,200)
```

or taking advantage of streams to access an image in your current theme:

```markdown
![Stream Image](theme://images/default-avatar.jpg?cropZoom=200,200&brightness=-75)
```

You will find more information about actions and other [media file functionality in the next chapter](../media).

### Image Attributes

A great new feature you can take advantage of is providing image attributes directly via the markdown syntax. This allows you to easily add **classes** and **id** HTML attributes without the need of [Markdown Extra](https://michelf.ca/projects/php-markdown/extra/).

Some examples of this are:

##### Single Class Attribute

```markdown
![My Image](my-image.jpg?classes=float-left)
```

which will result in HTML similar to:

```html
<img src="/your/pages/some-page/my-image.jpg" class="float-left" />
```

##### Multiple Classes Attributes

```markdown
![My Image](my-image.jpg?classes=float-left,shadow)
```

which will result in HTML similar to:

```html
<img src="/your/pages/some-page/my-image.jpg" class="float-left shadow" />
```

##### ID Attribute

```markdown
![My Image](my-image.jpg?id=special-id)
```

which will result in HTML similar to:

```html
<img src="/your/pages/some-page/my-image.jpg" id="special-id" />
```

---

## Supported Media Files

> Path: grav-learn/pages/02.content/07.media/docs.md


When creating content in **Grav**, you often need to display different types of media like **images**, **videos**, and various other **files**. These files are automatically found and processed by Grav and are made available to use by any page.  This is particularly handy because you can then use the built-in functionality of the page to leverage thumbnails, access metadata and modify the media dynamically (e.g. resizing images, setting the display size for videos, etc.) as you need them.

Grav uses a **smart-caching** system that automatically creates in-cache copies of the dynamically generated media when necessary. This way all subsequent requests can use the cached version instead of having to generate the media all over again.

## Supported Media Files

The following media file types are supported natively by Grav. Additional support for media files and streaming embeds may be added via plugins.

[div class="table-keycol"]
| Media Type         | File Type                                                                                                                                                             |
| :-----             | :-----                                                                                                                                                                |
| Image              | jpg, jpeg, png                                                                                                                                                        |
| Audio              | mp3, wav, wma, ogg, m4a, aiff, aif                                                                                                                                    |
| Animated image     | gif                                                                                                                                                                   |
| Vectorized image   | svg                                                                                                                                                                   |
| Video              | mp4, mov, m4v, swf, flv, webm, ogv                                                                                                                                    |
| Data / Information | txt, doc, docx, html, htm, pdf, zip, gz, 7z, tar, css, js, json, xml, xls, xlt, xlm, xlsm, xld, xla, xlc, xlw, xll, ppt, pps, rtf, bmp, tiff, mpeg, mpg, mpe, avi, wmv |
[/div]

A full list of supported mimetypes can be found in the `system/config/media.yaml` file.  If there is a mimetype that is not currently supported, you can simply create your own `user/config/media.yaml` and add it in there.  Just ensure you follow the same format as the original `system` file.  The simplest approach is to copy the whole original file and make your edits.

## Where to put your media files

Usually you'll use a media file within a page, so just put the file in the page folder, and you can reference it in the Markdown of the page, for example:

[prism classes="language-markdown"]
![my image](image.jpg)
[/prism]

If you want to put all your images in a single folder, you can put them in a `user/pages/images` folder. That way, in Twig, you can reach them via

{% verbatim %}
```twig
{% set my_image = page.find('/images').media['my-image.jpg'] %}
```
{% endverbatim %}

and also you can find them easily via markdown and perform operations on them:

```markdown
![my image](/images/my-image.jpg?cropResize=300,300)
```

Alternatively you can put them in your theme, as that is easily accessible via CSS references or from a markdown file by using `theme://` stream:

```markdown
![my image](theme://images/theme-image.jpg)
```

Another option is `user/images`, where you can use `image://` stream to access them:

```markdown
![my image](image://my-image.jpg)
```

You can actually use any stream including any folder inside `user/` via the `user://` stream:

```markdown
![my image](user://themes/mytheme/images/my-image.jpg)
```

You can also do these same kinds of things using the Twig `Media` object:

{% verbatim %}
```twig
{{ media['user://themes/mytheme/images/my-image.jpg'].html()|raw }}
```
{% endverbatim %}

!!!! Grav has an `/images` folder. Do not put your own images in that folder, as it hosts Grav auto-generated, cached images.

You may also want to put all the media files into their own folder, so that they can all be accessed at one go. For instance you might want to keep all your MP3 files in a folder `user/pages/mp3s` (not visible) and put the name of the MP3 file associated with a particular page in a header field called `thistrack`. If you then wish to access the file for a particular page and play it using the HTML5 audio element, you will need code like this:

{% verbatim %}
[prism classes="language-twig line-numbers"]
<audio controls>
  <source src="{{ page.find('/mp3s').media[page.header.thistrack~'.mp3']|e }}">
</audio>
[/prism]
{% endverbatim %}

## Display modes

Grav provides a few different display modes for every kind of media object.

[div class="table-keycol"]
| Mode      | Explanation                                                                     |
| :-----    | :-----                                                                          |
| source    | Visual representation of the media itself, i.e. the actual image, video or file |
| text      | Textual representation of the media                                             |
| thumbnail | The thumbnail image for this media object                                       |
[/div]

!!!! **Data / Information** type media do not support `source` mode, they will default to `text` mode if another mode is not explicitly chosen.

## Thumbnail Location

There are three locations Grav will look for your thumbnail.

1. In the same folder as your media file: `[media-name].[media-extension].thumb.[thumb-extension]` where `media-name` and `media-extension` are respectively the name and extension of the original media file and `thumb-extension` is any extension that is supported by the `image` media type. Examples are `my_video.mp4.thumb.jpg` and `my-image.jpg.thumb.png`
**For images only!** The image itself will be used as thumbnail.
2. Your user folder: `user/images/media/thumb-[media-extension].png` where `media-extension` is the extension of the original media file. Examples are `thumb-mp4.png` and `thumb-jpg.jpg`
3. The system folder: `system/images/media/thumb-[media-extension].png` where `media-extension` is the extension of the original media file. **The thumbnails in the system folders are pre-provided by Grav.**

!! You can also manually select the desired thumbnail with the actions explained below.

## Links and Lightboxes

The display modes above can also be used in combination with links and lightboxes, which are explained in more detail later. Important to note however is:

!!!! Grav does not provide lightbox-functionality out of the box, you need a plugin for this. You can use the [FeatherLight Grav plugin](https://github.com/getgrav/grav-plugin-featherlight) to achieve this.

When you use Grav's media functionality to render a lightbox, all Grav does is output an **anchor** tag that has some attributes for the lightbox plugin to read. If you are interested in using a lightbox library that is not in our plugin repository or you want to create your own plugin, you can use the table below as a reference.

[div class="table-keycol"]
| Attribute   | Explanation                                                                                                  |
| :-----      | :-----                                                                                                       |
| rel         | A simple indicator that this is not a regular link, but a lightbox link. The value will always be `lightbox`. |
| href        | A URL to the media object itself.                                                                             |
| data-width  | The width the user requested this lightbox to be.                                                             |
| data-height | The height the user requested this lightbox to be.                                                            |
| data-srcset | In case of image media, this contains the `srcset` string. ([more info](../media#responsive-images))         |
[/div]

## Actions

Grav employs a **builder-pattern** when handling media, so you can perform **multiple actions** on a particular medium. Some actions are available for every kind of medium while others are specific to the medium.

### General

These actions are available for all media types.

#### url

!! This method is only intended to be used in **Twig** templates, hence the lack of Markdown syntax.

This returns **raw url path** to the media.

[ui-tabs]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].url|e }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].url|e }}
```
[/ui-tab]
[/ui-tabs]


#### html

!! In Markdown this method is implicitly called when using the `![]` syntax.

The `html` action will output a valid HTML tag for the media based on the current display mode.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Some ALT text](sample-image.jpg?classes=myclass "My title")
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].html('My title', 'Some ALT text', 'myclass')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].html('My title', 'Some ALT text', 'myclass')|e }}
```
[/ui-tab]
[/ui-tabs]


#### display

Use this action to switch between the various display modes that Grav provides. Once you switch display mode, all previous actions will be reset. The exceptions to this rule are the `lightbox` and `link` actions and any actions that have been used before those two.

For example, the thumbnail that results from calling `page.media['sample-image.jpg'].sepia().display('thumbnail').html()` will not have the `sepia()` action applied, but `page.media['sample-image.jpg'].display('thumbnail').sepia().html()` will.

! Once you switch to thumbnail mode, you will be manipulating an image. This means that even if your current media is a video, you can use all the image-type actions on the thumbnail.

#### link

Turn your media object into a link. All actions that you call before `link()` will be applied to the target of the link, while any actions called after will apply to what's displayed on your page.

!! After calling `link()`, Grav will automatically switch the display mode to **thumbnail**.

The following example will display a textual link (`display('text')`) to a sepia version of the `sample-image.jpg` file:

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Image link](sample-image.jpg?sepia&link&display=text)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].sepia().link().display('text').html('Image link')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].sepia().link().display('text').html('Image link')|e }}
```
[/ui-tab]
[/ui-tabs]

#### Cache only

Grav can be set to cache all image files, this may increase the speed that files are served. However, images will go through the Grav image manipulation system which may lead to a considerably larger file size for images that have already been optimized prior to Grav. Image manipulation can be bypassed.

Enable `cache_all` in `system/config/system.yaml`
{% verbatim %}
```yaml
images:
  default_image_quality: 85
  cache_all: false
```
{% endverbatim %}

Disable image manipulation with the `cache`option.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![](sample-image.jpg?cache)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cache.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].cache.html()|e }}
```
[/ui-tab]
[/ui-tabs]

#### lightbox

The lightbox action is essentially the same as the link action but with a few extras. Like explained above ([Links and Lightboxes](https://learn.getgrav.org/16/content/media#links-and-lightboxes)), the lightbox action will not do anything more than create a link with some extra attributes. It differs from the link action in that it adds a `rel="lightbox"` attribute and accepts a `width` and `height` attribute.

If possible (currently only in the case of images), Grav will resize your media to the requested width and height. Otherwise it will simply add a `data-width` and `data-height` attribute to the link.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?lightbox=600,400&resize=200,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].lightbox(600,400).resize(200,200).html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].lightbox(600,400).resize(200,200).html('Sample Image')|e }}
```
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?lightbox=600,400&resize=200,200)

#### thumbnail

Manually choose the thumbnail Grav should use. You can choose between `page` and `default` for any type of media as well as `media` for image media if you want to use the media object itself as your thumbnail.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?thumbnail=default&display=thumbnail)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].thumbnail('default').display('thumbnail').html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].thumbnail('default').display('thumbnail').html('Sample Image')|e }}
```
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?thumbnail=default&display=thumbnail)

#### attribute

This adds an additional HTML attribute to the output.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?attribute=myattribute,myvalue)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].attribute('myattribute', 'myvalue').html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-image.jpg'].attribute('myattribute', 'myvalue').html('Sample Image')|e }}
```
[/ui-tab]
[/ui-tabs]


## Image Actions

#### resize

Resizing does exactly what you would expect it to do.  `resize` lets you create a new image based on the `width` and the `height`.  The aspect ratio is maintained and the new image will contain blank areas in the color of the **optional** background color provided as a `hex value`, e.g. `0xffffff`. The background parameter is optional, and if not provided will default to **transparent** if the image is a PNG, or **white** if it is a JPEG.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?resize=400,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].resize(400, 200).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?resize=400,200)

#### forceResize

Resizes the image to the `width` and `height` as provided.  `forceResize` will not respect original aspect-ratio and will stretch the image as needed to fit the new image size.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?forceResize=200,300)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].forceResize(200, 300).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?forceResize=200,300)

#### cropResize

`cropResize` resizes an image to a smaller or larger size based on the `width` and the `height`.  The aspect ratio is maintained and the new image will be resized to fit in the bounding-box as described by the `width` and `height` provided. In other words, any background area you would see in a regular `resize` is cropped.

For example, if you have an image that is `640` x `480` and you perform a `cropResize(100, 100)` action upon it, you will end up with an image that is `100` x `75`.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropResize=300,300)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropResize(300, 300).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropResize=300,300)

#### crop

`crop` will not resize the image at all, it will merely crop the original image so that only the portion of the bounding box as described by the `width` and the `height` originating from the `x` and `y` location is used to create the new image.

For example, an image that is `640` x `480` with `crop(0, 0, 400, 100)` will produce an image with a width of `400` and a height of `100` originating from the top-left corner as described by `0, 0`.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?crop=100,100,300,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].crop(100,100,300,200).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?crop=100,100,300,200)

#### cropZoom

Similar to regular `cropResize`, `cropZoom` also takes a `width` and a `height` but will **resize and crop** the image to ensure the resulting image is the exact size you requested.  The aspect ratio is maintained but parts of the image may be cropped, however the resulting image is centered.

!! The primary difference between **cropResize** and **cropZoom** is that in cropResize, the image is resized maintaining aspect ratio so that the entire image is shown, and any extra space is considered background.

With **cropZoom**, the image is resized so that there is no background visible, and the extra image area of the image outside of the new image size is cropped.

For example if you have an image that is `640` x `480` and you perform a `cropZoom(400, 100)` action, the resulting image will be resized to `400` x `300` and then the height is cropped resulting in a `400` x `100` image.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=600,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(600,200).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

!! Folks familiar with using `zoomCrop` for this purpose will find that it also works in Grav.

##### Result:

![Sample Image](sample-image.jpg?cropZoom=600,200)

#### quality

Dynamically allows the setting of a **compression percentage** `value` for the image between `0` and `100`. A lower number means less quality, where `100` means maximum quality.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&quality=25)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).quality(25).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&quality=25)

#### negate

Applies a **negative filter** to the image where colors are inverted.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&negate)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).negate.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&negate)

#### brightness

Applies a **brightness filter** to the image with a `value` from `-255` to `+255`. Larger negative numbers will make the image darker, while larger positive numbers will make the image brighter.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&brightness=-100)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).brightness(-100).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&brightness=-100)

#### contrast

This applies a **contrast filter** to the image with a `value` from `-100` to `+100`. Larger negative numbers will increase the contrast, while larger positive numbers will reduce the contrast.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&contrast=-50)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).contrast(-50).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

![Sample Image](sample-image.jpg?cropZoom=300,200&contrast=-50)

#### grayscale

This processes the image with a **grayscale filter**.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&grayscale)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).grayscale.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&grayscale)

#### emboss

This processes the image with an **embossing filter**.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&emboss)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).emboss.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&emboss)

#### smooth

This applies a **smoothing filter** to the image based on smooth `value` setting from `-10` to `10`.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&smooth=5)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).smooth(5).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&smooth=5)

#### sharp

This applies a **sharpening filter** on the image.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&sharp)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).sharp.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&sharp)

#### edge

This applies an **edge finding filter** on the image.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&edge)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).edge.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&edge)

#### colorize

You can colorize the image based on adjusting the `red`, `green`, and `blue` values for the image from `-255` to `+255` for each color.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&colorize=100,-100,40)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).colorize(100,-100,40).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&colorize=100,-100,40)

#### sepia

This applies a **sepia filter** on the image to produce a vintage look.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&sepia)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).sepia.html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&sepia)

#### gaussianBlur

**blurs** the image by an Factor, that defines how often the blur filter is applied to the image. Default is 1 time.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?gaussianBlur=3)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].gaussianBlur(3).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?gaussianBlur=3)

#### rotate

**rotates** the image by `angle` degrees counterclockwise, negative values rotate clockwise.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&rotate=-90)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).rotate(-90).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&rotate=-90)

#### flip

**flips** the image in the given directions. Both params can be `0|1`.  Both `0` is equivalent to no flipping in either direction.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?cropZoom=300,200&flip=0,1)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].cropZoom(300,200).flip(0,1).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?cropZoom=300,200&flip=0,1)

#### fixOrientation

Fixes the orientation of the image when rotation is made via EXIF data (applies to jpeg images taken with phones and cameras).

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?fixOrientation)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].fixOrientation().html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

#### watermark

The **watermark action** merges two images, a watermark image and a source image, into a final watermarked image. This is a very specific action that needs a more detailed description than other actions or filters. In particular, the specific behavior when [combining filters](#combinations) must be taken into account. For those interested, there is a very detailed [blog post about the watermark action](https://www.grav.cz/blog/vodoznak-aneb-nepokrades-kelisova), written by [Vt Petira](https://github.com/petira), but only in Czech. However, the instructions are easy to understand.

! If you are using a page-level [stream](/content/image-linking#php-streams), then page prefixes must also be specified.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?watermark=user://pages/02.content/07.media/sample-watermark.png,top-left,50)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].watermark('user://pages/02.content/07.media/sample-watermark.png','top-left',50).html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?watermark=user://pages/02.content/07.media/sample-watermark.png,top-left,50)

#### loading

The loading attributing on images gives authors control over when the browser should start loading the resource. The value for the loading attribute can be one of `auto` (default), `lazy`, `eager`.
Value can be set in `system.images.defaults.loading` as default value, or per md image with `?loading=lazy`
When value `auto` is chosen, no `loading` attribute is added and browser will determine which strategy to use.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?loading=lazy)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{# Using default value as defined in 'config.system.images.defaults.loading' #}
{{ page.media['sample-image.jpg'].loading.html('Sample Image')|raw }}

{# Using explicit value #}
{{ page.media['sample-image.jpg'].loading('lazy').html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
<img loading="lazy" title="Sample Image"  src="/images/e/f/1/0/5/ef10554cd3a99f2e65136e79dce170d4f8a7a1b9-sample-image.jpg" />
```
[/ui-tab]
[/ui-tabs]

#### decoding

The decoding attributing on images gives authors control over when the browser should start decoding the resource. The value for the decoding attribute can be one of `auto` (default), `sync`, `async`.
Value can be set in `system.images.defaults.decoding` as default value, or per md image with `?decoding=async`
When value `auto` is chosen, no `decoding` attribute is added and browser will determine which strategy to use.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?decoding=async)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{# Using default value as defined in `config.system.images.defaults.decoding` #}
{{ page.media['sample-image.jpg'].decoding.html('Sample Image')|raw }}

{# Using explicit value #}
{{ page.media['sample-image.jpg'].decoding('async').html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
<img decoding="async" title="Sample Image"  src="/images/e/f/1/0/5/ef10554cd3a99f2e65136e79dce170d4f8a7a1b9-sample-image.jpg" />
```
[/ui-tab]
[/ui-tabs]

#### fetchpriority

The fetchpriority attributing gives authors control over when the browser should prioritize the fetch of the image relative to other images. The value for the fetchpriority attribute can be one of `auto` (default), `high`, `low`.
Value can be set in `system.images.defaults.fetchpriority` as default value, or per md image with `?fetchpriority=high`
When value `auto` is chosen, no `fetchpriority` attribute is added and browser will determine which strategy to use.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?fetchpriority=high)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{# Using default value as defined in `config.system.images.defaults.fetchpriority` #}
{{ page.media['sample-image.jpg'].fetchpriority.html('Sample Image')|raw }}

{# Using explicit value #}
{{ page.media['sample-image.jpg'].fetchpriority('high').html('Sample Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
<img fetchpriority="high" title="Sample Image"  src="/images/e/f/1/0/5/ef10554cd3a99f2e65136e79dce170d4f8a7a1b9-sample-image.jpg" />
```
[/ui-tab]
[/ui-tabs]

## Animated / Vectorized Actions

#### resize

Because PHP cannot handle dynamically resizing these types of media, the resize action will only make sure that a `width` and `height` or `data-width` and `data-height` attribute are set on your `<img>`/`<video>` or `<a>` tag respectively. This means your image or video will be displayed in the requested size, but the actual image or video file will not be converted in any way.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Trailer](sample-trailer.mov?resize=400,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-trailer.mov'].resize(400, 200).html('Sample Trailer')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['sample-trailer.mov'].resize(400, 200).html('Sample Trailer')|e }}
```
[/ui-tab]
[/ui-tabs]


#### examples

Some examples of this:

[ui-tabs]
[ui-tab title="Vector Image"]
```markdown
![Sample Vector](sample-vector.svg?resize=300,300)
```
![Sample Vector](sample-vector.svg?resize=300,300)
[/ui-tab]
[ui-tab title="Animated Image"]
```markdown
![Animated Gif](sample-animated.gif?resize=300,300)
```
![Animated Gif](sample-animated.gif?resize=300,300)
[/ui-tab]
[ui-tab title="Video"]
```markdown
![Sample Trailer](sample-trailer.mov?resize=400,200)
```
![Sample Trailer](sample-trailer.mov?resize=400,200)
[/ui-tab]
[/ui-tabs]

## Audio Actions

Audio media will display an HTML5 audio link:

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Hal 9000: I'm Sorry Dave](hal9000.mp3)

#### controls

Allows explicitly setting or removing the HTML5 default controls. Passing `0` hides browser's controls for playback, volume, etc..

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?controls=0)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].controls(0)|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
```html
{{ page.media['hal9000.mp3'].controls(0)|e }}
```
[/ui-tab]
[/ui-tabs]

#### preload

Allows setting of `preload` property, which defaults to `auto`. Permitted params are `auto`, `metadata`, and `none`.

!! <q cite="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/audio#attr-preload">If not set, its default value is browser-defined (i.e. each browser may have its own default value). The spec advises it to be set to <code>metadata</code>.</q>

!! The `preload` attribute is ignored if `autoplay` is present.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?preload=metadata)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].preload('metadata')|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

#### autoplay

Allows setting whether audio will `autoplay` upon page load. Defaults to `false` by omission if not set.

!! If `autoplay` and `preload` are both present on a given `audio` element, `preload` will be ignored.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?autoplay=1)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].autoplay(1)|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]


#### controlsList

Allows setting of `controlsList` property, which takes one or more of three possible values: `nodownload`, `nofullscreen`, and `noremoteplayback`.

!! If setting more than one parameter in markdown, separate each with a dash (`-`). These will be replaced by spaces in the output HTML.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?controlsList=nodownload-nofullscreen-noremoteplayback)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].controlsList('nodownload nofullscreen noremoteplayback')|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

#### muted

Allows setting whether audio is `muted` on load. Defaults to `false` by omission if not set.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?muted=1)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].muted(1)|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

#### loop

Allows setting whether audio will `loop` upon playing through completion. Defaults to `false` by omission if not set.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Hal 9000: I'm Sorry Dave](hal9000.mp3?loop=1)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['hal9000.mp3'].loop(1)|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

## File Actions

Grav does not provide any custom actions on files at this point in time and there are no plans to add any. Should you think of something, please contact us.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
[View Text File](acronyms.txt)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
<a href="{{ page.media['acronyms.txt'].url()|raw }}">View Text File</a>
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

[View Text File](acronyms.txt)

### Combinations

As you can see: Grav provides some powerful image manipulation functionality that makes it really easy to work with images!  The real power comes when you combine multiple effects and produce some very sophisticated dynamic image manipulations.  For example, this is totally valid:

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Sample Image](sample-image.jpg?negate&lightbox&cropZoom=200,200)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['sample-image.jpg'].negate.lightbox.cropZoom(200,200)|raw }}
```
{% endverbatim %}
[/ui-tab]
[/ui-tabs]

##### Result:

![Sample Image](sample-image.jpg?negate&lightbox&cropZoom=200,200)

#### Resetting multiple calls to the same image

When you access the same image multiple times in a single page, actions you have provided to the image are not reset by default.  So if you resize an image, and output the HTML, then later in the same page, simply output the image URL, you will also get the URL to the resized image. You were probably expecting the URL to the original image.

To combat this, you can reset the actions on the images by passing `false` to the `url()` method:

{% verbatim %}
```twig
{% for item in page.header.gallery %}
    {% set image = page.media[item.src].cropZoom(800, 600).quality(70) %}
    <a href="{{ image.url(false)|e }}">
      <img src="{{ image.url|e }}" alt="{{ item.alt|e }}" title="{{ item.title|e }}" />
    </a>
{% endfor %}
```
{% endverbatim %}

### Responsive images

#### Higher density displays

Grav has built-in support for responsive images for higher density displays (e.g. **Retina** screens). Grav accomplishes this by implementing `srcset` from the [Picture element HTML proposal](https://html.spec.whatwg.org/multipage/embedded-content.html#the-picture-element). A good article to read if you want to understand this better is [this blog post by Eric Portis](http://ericportis.com/posts/2014/srcset-sizes/).

!! Grav sets the `sizes` argument mentioned in the posts above to full viewport width by default. Use the `sizes` action showcased below to choose yourself.

To start using responsive images, all you need to do is add higher density images to your pages by adding a suffix to the file name. If you only provide higher density images, Grav will automatically generate lower quality versions for you. Naming works as follows: `[image-name]@[density-ratio]x.[image-extension]`, so for example adding `sample-image@3x.jpg` to your page will result in Grav creating a `2x` and a `1x` (regular size) version by default.

! These files generated by Grav will be stored in the `images/` cache folder, not your page folder.

Let's assume you have a file called `retina@2x.jpg`, you would actually reference this in your links as `retina.jpg`, and then Grav will not find this image, and start looking for retina image sizes.  It will find `retina@2x.jpg` and then realize it needs to make a `@1x` variant and display the appropriate `srcset` output:

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Retina Image](retina.jpg?sizes=80vw)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['retina.jpg'].sizes('80vw').html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
{% set code_sample %}
![Retina Image](retina.jpg?sizes=80vw)
{% endset %}
```html
{{ code_sample|e }}
```
[/ui-tab]
[/ui-tabs]

##### Result:

![Retina Image](retina.jpg?sizes=80vw)

!!!! Depending on your display and your browser's implementation and support for `srcset`, you might never see a difference. We included the HTML markup in the third tab so you can see what's happening behind the screens.

##### Sizes with media queries

Grav also has support for media queries inside the `sizes` attribute, allowing you to use different widths depending on the device's screen size. In contrast to the first method, you don't have to create multiple images; they will get created automatically. The fallback image is the current image, so a browser without support for `srcset`, will display the original image.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Retina Image](retina.jpg?sizes=%28max-width%3A26em%29+100vw%2C+50vw)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['retina.jpg'].sizes('(max-width:26em) 100vw, 50vw').html('Retina Image')|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
{% set code_sample %}
![Retina Image](retina.jpg?sizes=%28max-width%3A26em%29+100vw%2C+50vw)
{% endset %}
```html
{{ code_sample|e }}
```
[/ui-tab]
[/ui-tabs]

##### Result:

![Retina Image](retina.jpg?sizes=%28max-width%3A26em%29+100vw%2C+50vw)

!!!! Depending on your display and your browser's implementation and support for `srcset`, you might never see a difference. We included the HTML markup in the fourth tab so you can see what's happening behind the screens.

##### Sizes with media queries using derivatives

If you want to customize the sizes of the automatically created files, you can use the `derivatives()` method (as shown below). The first parameter is the width of the smallest of the generated images. The second is the maximum width (exclusive) of the generated images. The third, and only optional parameter, dictates the intervals with which to generate the photos (default is 200). For example, if you set the first parameter to be `320` and the third to be `100`, Grav will generate an image for 320, 420, 520, 620, and so on until it reaches its set maximum.

In our example, we set the maximum to `1600`. This will result in increments of 300 being met from `320` to `1520` as `1620` would be above the threshold.

!! For the moment it does not work inside markdown, only in your ```twig``` files.

[ui-tabs]
[ui-tab title="Markdown"]
```markdown
![Retina Image](retina.jpg?derivatives=320,1600,300&sizes=%28max-width%3A26em%29+100vw%2C+50vw)
```
[/ui-tab]
[ui-tab title="Twig"]
{% verbatim %}
```twig
{{ page.media['retina.jpg'].derivatives(320,1600,300).sizes('(max-width:26em) 100vw, 50vw').html()|raw }}
```
{% endverbatim %}
[/ui-tab]
[ui-tab title="HTML Code"]
{% set code_sample %}
![Retina Image](retina.jpg?derivatives=320,1600,300&sizes=%28max-width%3A26em%29+100vw%2C+50vw)
{% endset %}
```html
{{ code_sample|e }}
```
[/ui-tab]
[/ui-tabs]

##### Result:

![Retina Image](retina.jpg?derivatives=320,1600,300&sizes=%28max-width%3A26em%29+100vw%2C+50vw)

!!!! Depending on your display and your browser's implementation and support for `srcset`, you might never see a difference. We included the HTML markup in the fourth tab so you can see what's happening behind the screens.


#### Manual size definition

Instead of letting Grav generate the sizes in even steps between given boundaries, you may manually define which sizes Grav should generate:

```markdown
![Retina Image](retina.jpg?derivatives=[360,720,1200])
```

This will generate downsized versions of the `retina.jpg` image in three widths: 360, 720 and 1200px.

## Metafiles

Every medium that you reference in Grav, e.g. `image1.jpg`, `sample-trailer.mov`, or even `archive.zip` has the ability to have variables set or even overridden via a **metafile**.  These files take the format of `<filename>.meta.yaml`.  For example, for an image with the filename `image1.jpg` you could create a metafile called `image1.jpg.meta.yaml`.

You can add just about any setting or piece of metadata you would like using this method.

The contents of this file should be in YAML syntax, an example could be:

```yaml
image:
    filters:
        default:
            - [cropResize, 300, 300]
            - sharp
alt_text: My Alt Text
```

If you are using this method to add file-specific styling or meta tags for a single file, you will want to put the YAML file in the same folder as the referenced file. This will ensure that the file is pulled along with the YAML data. It's a handy way to even set file-specific metadata as you are unable to do so from the page itself.

Let's say you wanted to just pull the `alt_text` value listed for the image file `sample-image.jpg`. You would then create a file called `sample-image.jpg.meta.yaml` and place it in the folder with the referenced image file. Then, insert the data used in the example above and save that YAML file. In the markdown file for the page, you can display this data by using the following line:

{% verbatim %}
```yaml
{{ page.media['sample-image.jpg'].meta.alt_text|e }}
```
{% endverbatim %}

This will pull up the example phrase `My Alt Text` instead of the image. This is just a basic example. You can use this method for a number of things, including creating a gallery with multiple unique data points you want to have referenced for each image. Your images, in essence, have a set of data unique to them that can be easily referenced and pulled as needed.

## Video Options

In-line video control options are another capability baked into Grav. These options, added in-line with the file name, give you the ability to determine an embedded video's `autoplay`, `controls`, and `loop` settings.

Here is an example:

```markdown
![video.mov](video.mov?loop=1&controls=0&autoplay=1&muted)
```

The options are as follows:

[div class="table-keycol"]
| Attribute   | Explanation                                                                               |
| :-----      | :-----                                                                                    |
| autoplay    | Enables (`1`) or Disables (`0`) autoplay for the video on pageload.                       |
| controls    | Enables (`1`) or Disables (`0`) media controls for the embedded video.                    |
| loop        | Enables (`1`) or Disables (`0`) automatic looping for the video, replaying it as it ends. |
| muted       | Mute video and generally allow it to autoplay.                                            |
[/div]

---

## Taxonomy Example

> Path: grav-learn/pages/02.content/08.taxonomy/docs.md


With **Grav**, the ability to group or tag pages is baked right into the system with **Taxonomy**.

> **Taxonomy (general),** the practice and science (study) of classification of things or concepts, including the principles that underlie such classification.
>
> <cite>Wikipedia</cite>

There are a couple of key parts to using taxonomy in your site:

1. Define a list of Taxonomy types in your [`site.yaml`](../../basics/grav-configuration).
2. Assign your pages to the appropriate `taxonomy` types with values.

## Taxonomy Example

This concept is best explained with an example. Let's say you want to create a simple blog. In that blog, you will create posts that you might want to assign to certain tags to provide a **tag cloud** display. Also, you could have several authors, and you might want to assign each post to that author.

Accomplishing this in Grav is a simple procedure. Grav provides a default `site.yaml` file that is located in the `system/config` folder. By default that configuration defines two taxonomy types of `category` and `tag`:

```yaml
taxonomies: [category,tag]
```

As `tag` is already defined, you just need to add `authors`. To do this simply create a new `site.yaml` file in your `user/config` folder and add the following line:

```yaml
taxonomies: [category,tag,author]
```

This will override the taxonomies that Grav knows about so that pages can be assigned to any of these three taxonomies.

The next step is to create some pages that make use of these taxonomy types. For example, you could have a page that looks like this:

[prism classes="language-markdown line-numbers"]

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
[/prism]

...and another page that looks like:

[prism classes="language-markdown line-numbers"]

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
[/prism]


As you can see in the YAML configuration, each page is assigning **values** to the **taxonomy types** we defined in our user `site.yaml` configuration. This information is used by Grav when the pages are processed and creates an internal **taxonomy map** which can be used to find pages based on the taxonomy you defined.

!!!! Your pages do not have to use every taxonomy you define in your `site.yaml`, but you must define any taxonomy you use.

In your theme, you can easily display a list of pages that are written by `ksmith` by using `taxonomy.findTaxonomy()` to find them and iterate over them:

[prism classes="language-twig line-numbers"]
<h2>Kevin Smith's Posts</h2>
<ul>
{% for post in taxonomy.findTaxonomy({'author':'ksmith'}) %}
    <li>{{ post.title|e }}</li>
{% endfor %}
</ul>
[/prism]

You can also do sophisticated searches based on multiple taxonomies by using arrays/hashes, for example:

[prism classes="language-twig line-numbers"]
{% for post in taxonomy.findTaxonomy({'tag':['animal','cat'],'author':'jdoe'}) %}
[/prism]

This will find all posts with `tag` set to `animal` **and** `cat` **and** `author` set to `jdoe`. Basically, this will specifically find **Post 2**.

If you need a collection which includes one term **or** the other, just add the `'or'` parameter after the array, example:

[prism classes="language-twig line-numbers"]
{% for post in taxonomy.findTaxonomy({'tag':['dog','cat']},'or') %}
[/prism]

This will find all posts with `tag` set to `dog` **or** `cat`.


## Taxonomy based Collections

We covered this in an earlier chapter, but it is important to remember that you can also use taxonomies in the [page headers](../headers) to filter a collection of pages associated with a parent page. If you need a refresher on this subject, please refer back to that [chapter on taxonomy collection headers](../collections).

## Adding Custom Taxonomy Values in Default and Options

You can use the format below in blueprints to override the `Default` and/or `Options` taxonomies. An important note here is that if you are using this method to override both of these attributes, you should add `validate: type: commalist`, otherwise it may not function as desired.

[prism classes="language-yaml line-numbers"]
taxonomies:
  fields:
    header.taxonomy:
      default:
        category: ['blog','page']
        tag: ['test']
      options:
        category: ['grav']
      validate:
        type: commalist
[/prism]

---

## What are Modular Pages and what are they not?

> Path: grav-learn/pages/02.content/09.modular/docs.md


The concept of **Modular Pages** is a little tricky to get your head around at first, but when you do you'll see how convenient they are to use. A **Modular Page** is a collection of pages stacked on top of each other to create a unified, single page. This lets you create a complex page-structure by using the **LEGO building-brick**-approach, and who doesn't love LEGO?!

## What are Modular Pages and what are they not?

In Grav, [Pages](/content/content-pages) are a broad concept that captures almost any type of combination of elements that you can imagine going into a website. Importantly, Modular Pages are a subset of this concept but not the same as a regular Page. A regular Page is fairly standalone, in the sense that Grav will render and display it without depending on other content such as other pages or child-pages. A Modular page, however, does not have child-pages. This is illustrated by imagining a simple page-structure:

A regular Page found at _domain.com/books_ has some details about what books are for sale. Several child-pages exist for this Page, such as _domain.com/books/gullivers-travels_ and _domain.com/books/the-hobbit_. Their folders are named the same as the address that Grav renders: `/pages/books`, `/pages/books/gullivers-travels`, and `/pages/books/the-hobbit`. This structure would not work in a Modular Page.

A Modular Page does not have child-pages in the same sense, rather, it has **Modules** that make up the parts of the page. So, rather than various books located beneath the top-level page, the modular page displays its modules on **the same page**. Gulliver's Travels and The Hobbit both appear in _domain.com/books_, with the paths `/pages/books/_gullivers-travels` and `/pages/books/_the-hobbit`. Thus, Modular Pages are not directly compatible with regular Pages and have their own structure.

## Example Folder Structure

Using our **One-Page Skeleton** as an example, we will explain how Modular Pages work in greater detail.

The **Modular Page** itself is assembled from pages that exist in subfolders found under the page's primary folder. In the case of our One-Page Skeleton, this page is located in the `01.home` folder. Within this folder is a single `modular.md` file which tells Grav which subpages to pull in to assemble the Modular Page, and which order to display them in. The name of this file is important because it instructs Grav to use the `modular.html.twig`-template from the current theme to render the page.

These subpages are in folders with names that begin with an underscore (`_`). By using an underscore, you are telling Grav that these are **Modules**, not standalone pages. For example, subpage-folders can be named `_features` or `_showcase`. These pages are **not routable** - they cannot be pointed to directly in a browser, and they are **not visible** - they do not show up in a menu.

In the case of our One-Page Skeleton, we have created the folder structure pictured below.

![Listing Page](modular-explainer-2.jpg?classes=shadow)

Each subfolder contains a Markdown-file which acts as a page.

The data within these Module-folders - including Markdown-files, images, etc. - is then pulled and displayed on the Modular page. This is accomplished by creating a primary page, defining a [Page Collection](/content/collections) in the primary page's YAML FrontMatter, then iterating over this Collection in a Twig-template to generate the combined HTML page. A theme should already have a `modular.html.twig` template that will do this and is used when you create a Modular Page type. Here's a simple example from a `modular.html.twig`:

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% for module in page.collection() %}
    {{ module.content|raw }}
{% endfor %}
[/prism]
{% endverbatim %}

Here is an example of the resulting modular page, highlighting the different modular folders which are used.

![Listing Page](modular-explainer-1.jpg?classes=shadow)

## Setting Up the Primary Page

As you can see, each section pulls content from a different Module-folder. Determining which Module-folders are used, and in what order, happens in the primary Markdown-file in the parent folder of the Module. Here is the content of the `modular.md` file in the `01.home` folder.

[prism classes="language-yaml line-numbers"]
[/prism]

As you can see, there is no actual content in this file. Everything is handled in the YAML FrontMatter in the header. The page's **Title**, **Menu** assignment, and other settings you would find in a typical page are found here. The [Content](/content/headers#ordering-options) instructs Grav to create the content based on a Collection of modular pages, and even provides a custom manual order for them to render.

## Modules

![Listing Page](modular-explainer-3.jpg?classes=shadow)

The Markdown-file for each Module can have its own template, settings, etc. For all intents and purposes, it has most of the features and settings of a regular page, it just isn't rendered as one. We recommend page-wide settings, such as **taxonomy**, be placed in the main Markdown-file that controls the whole page.

The Modular Pages themselves are handled just like regular Pages. Here is an example using the `text.md` file in the `_callout` page which appears in the middle of the Modular page.

[prism classes="language-markdown line-numbers"]

## Content Unchained

No longer are you a _slave to your CMS_. Grav **empowers** you to create anything from a [simple one-page site](#), a [beautiful blog](#), a powerful and feature-rich [product site](#), or pretty much anything you can dream up!
[/prism]

As you can see, the header of the page contains basic information you might find on a regular page. It has its own title that can be referenced, and [custom page options](/content/headers#custom-page-headers), such as the alignment of the image can be set here, just as it would on any other page.

The template file for the `text.md` file should be located in the `/templates/modular`-folder of your theme, and should be named `text.html.twig`. This file, like any Twig-template file for any other page, defines the settings, as well as any styling-differences between it and the base page.

{% verbatim %}
[prism classes="language-twig line-numbers"]
<div class="modular-row callout">
    {% set image = page.media.images|first %}
    {% if image %}
        {{ image.cropResize(400,400).html('','','align-'~page.header.image_align)|raw }}
    {% endif %}
{{ content|raw }}
</div>
[/prism]
{% endverbatim %}

Generally, Modular Pages are very simple. You just have to get used to the idea that each section in your page is defined in a Module that has its own folder below the actual page. They are displayed all at once to your visitors, but organized slightly differently than regular pages. Feel free to experiment and discover just how much you can accomplish with a Modular Page in Grav.

---

## Page Level Route and Redirect Overrides

> Path: grav-learn/pages/02.content/10.routing/docs.md


As we already described in the opening [Page -> Folders section](../content-pages#folders), **routing** in Grav is primarily controlled by the folder structure you use when you build your site content.

There are certain scenarios where you need more flexibility and Grav comes packed with a variety of tools and configuration options to make your life simpler in this regard.

Imagine if you moved your site from some other CMS platform to Grav, you have several choices on how to set up your new site:

1. Try to replicate the URLs of your old site by building the folder structure to match.
2. Build your new site the way you want, and then have your web server 'rewrite' old URLs to redirect clients to the new locations.
3. Build your new site the way you want, and configure Grav to redirect clients from the old URLs to the new locations.

There are many other use cases where you may wish to have the Grav site respond to different URLs than the folder structure dictates, and Grav has the following capabilities to help you realize your objectives.

## Page Level Route and Redirect Overrides

As outlined in the [Headers -> Routes section](../headers#routes), you can provide explicit routing options for the **default route** as well as an array of **route aliases**:

[prism classes="language-yaml line-numbers"]
routes:
  default: '/my/example/page'
  canonical: '/canonical/url/alias'
  aliases:
    - '/some/other/route'
    - '/can-be-any-valid-slug'
[/prism]

These are processed and cached per-page, and are available along with what we call the **raw route** which is the route based on the **slugs** of the page hierarchy (which is how Grav works out a route by default).  So even if you provide custom page routes, the **raw route** is still always valid too.

Similar to page level routing, Grav also supports page level redirects by specifying the target page in the page header. See [Headers -> Redirect section](../headers#redirect) for more details.

[prism classes="language-yaml line-numbers"]
redirect: '/some/custom/route[303]'
[/prism]

## Site Level Routes and Redirects

Grav has a powerful regex-based mechanism for handling **route aliases** and **redirects** from one page to another. This feature is particularly useful when you migrate a site to Grav and want to ensure the old URLs will still work with the new site. This is often best accomplished via **rewrite rules** using your web server, but sometimes it's more convenient and flexible just to let Grav handle them.

These are handled via the [Site Configuration](../../basics/grav-configuration#site-configuration). Grav comes with a sample `system/config/site.yaml` but you can override or add any of your own settings by editing the `user/config/site.yaml` file.

!! All redirect rules apply on the slug-path beginning after the language part (if you use multi-language pages)

!!!! You must escape certain characters in any routes that you want to match. This is especially important to know if you are migrating an old site that used links containing legacy file extensions (e.g. `.php`) or URL parameters (`?foo=bar`). In these examples, the period and question mark **must be escaped** like `/index\.php\?foo=bar: '/new/location'`.

### Route Aliases

#### Simple Aliases

The most basic kind of alias is a direct one-to-one mapping. In the `routes:` section of the `site.yaml`, you can create a list of mappings to indicate the alias and the actual route that should be used.

!! It's important to note that these aliases are only used if no valid page is found with the route provided

[prism classes="language-yaml line-numbers"]
routes:
  /something/else: '/blog/focus-and-blur'
[/prism]

If you requested a URL `http://mysite.com/something/else` and that was not a valid page, the routes definition would actually serve you the page located at `/blog/focus-and-blur`, assuming it exists. This does not actually **redirect** the user to the provided page, it simply displays the page when you request the alias.

!! The indentation is key here, without it the route redirect will not work. 

#### Regex-Based Aliases

A more advanced type of alias redirect allows the use of a simple **regex** to map part of an alias to a route.  For example, if you had:

[prism classes="language-yaml line-numbers"]
routes:
   /another/(.*): '/blog/$1'
[/prism]

This would route the wildcard from the alias to the route, so `http://mysite.com/another/focus-and-blur` would actually display the page found at the `/blog/focus-and-blur` route. This is a powerful way to map one set of URLs to another. Great for moving your site from WordPress to Grav :)

You can also perform the match to capture any alias, and map that to a specific route:

[prism classes="language-yaml line-numbers"]
routes:
  /one-ring/(.*): '/blog/sunshine-in-the-hills'
[/prism]

With this route alias, any URL that confirms to the wildcard: `/one-ring/to-rule-them-all` or `/one-ring/is-mine.html` will both show the content from the page with the route `/blog/sunshine-in-the-hills`.

You can even get much more creative and map multiple items or use any regex syntax:

[prism classes="language-yaml line-numbers"]
routes:
  /complex/(category|section)/(.*): /blog/$1/folder/$2
[/prism]

This would match and rewrite the following:

[prism classes="language-text line-numbers"]
/complex/category/article-1      -> /blog/category/folder/article-1
/complex/section/article-2.html  -> /blog/section/folder/article-2.html
[/prism]

This route would not match anything that doesn't start with `complex/category` or `complex/section`.  For more information, [Regexr.com](http://regexr.com/) is a fantastic resource to learn about and test regular expressions.

### Redirects

The other corollary option to **route aliases** is provided by **redirects**. These are similar, but rather than keeping the URL and simply serving the content from the aliased route, Grav actually redirects the browser to the mapped page.

There are three system-level configuration options that affect Redirects:

[prism classes="language-yaml line-numbers"]
pages:
  redirect_default_route: false
  redirect_default_code: 302
  redirect_trailing_slash: true
[/prism]

* `redirect_default_route` enables Grav to automatically redirect to the page's default route.
* `redirect_default_code` allows you to set the default HTTP redirect codes:
    * **301**: Permanent redirect. Clients making subsequent requests for this resource should use the new URI. Clients should not follow the redirect automatically for POST/PUT/DELETE requests.
    * **302**: Redirect for undefined reason. Clients making subsequent requests for this resource should not use the new URI. Clients should not follow the redirect automatically for POST/PUT/DELETE requests.
    * **303**: Redirect for undefined reason. Typically, 'Operation has completed, continue elsewhere.' Clients making subsequent requests for this resource should not use the new URI. Clients should follow the redirect for POST/PUT/DELETE requests.
    * **307**: Temporary redirect. Resource may return to this location at a later point. Clients making subsequent requests for this resource should use the old URI. Clients should not follow the redirect automatically for POST/PUT/DELETE requests.
* `redirect_trailing_slash` option lets you redirect to a non-trailing slash version of the current URL

For example:

[prism classes="language-yaml line-numbers"]
redirects:
    /jungle: '/blog/the-urban-jungle'
[/prism]

You can also explicitly pass the redirect code between square brackets `[]` as part of the URL:

[prism classes="language-yaml line-numbers"]
redirects:
    /jungle: '/blog/the-urban-jungle[303]'
[/prism]

If you were to point your browser to `http://mysite.com/jungle`, you would actually get redirected and end up on the page: `http://mysite.com/blog/the-urban-jungle`.

The same regular expression capabilities that exist for Route Aliases, also exist for Redirects.  For example:

[prism classes="language-yaml line-numbers"]
redirects:
    /redirect-test/(.*): /$1
    /complex/(category|section)/(.*): /blog/$1/folder/$2
[/prism]

These look almost identical to the Route Alias version, but instead of transparently showing the new page, Grav actually redirects the browser and loads the new page specifically.

## Hiding the Home Route

When you set a certain page to be your site's home via the `system.yaml` file:

[prism classes="language-yaml line-numbers"]
home:
  alias: '/home'
[/prism]

You are effectively telling Grav to add a route of `/` as an alias for that page.  This means that when Grav is requesting the page for the `/` URL, it finds the page you have set.

However, Grav really doesn't do anything special for pages that are beneath this homepage.  So if you have a page called `/blog` that displays a list of your blog posts, and you set this to be your homepage, it will work as expected.  If however, you click on a blog post that sits beneath the `/blog` folder, the URL could be `/blog/my-blog-post`.  This is expected behavior, but it might not be what you intend.  There is a new option available via the `system.yaml` that let's you hide this top level `/blog` from the route if so enabled.

You can enable this behavior by toggling the following value:

[prism classes="language-yaml line-numbers"]
home:
  hide_in_urls: true
[/prism]

---

## Single language different than English

> Path: grav-learn/pages/02.content/11.multi-language/docs.md


Multi-Language support in Grav is a direct result of a great [community discussion](https://github.com/getgrav/grav/issues/170) on the subject. We will now break these down and provide examples on how you can setup your Grav site with multiple languages.

## Single language different than English

If you just use one language, enable translations and add your language code in the `user/config/system.yaml` file:

[prism classes="language-yaml line-numbers"]
languages:
  supported:
    - fr
[/prism]

or in the System configuration in the Admin:

![Admin Translations Settings](translations-settings.png)

This will make sure Grav uses the correct language strings in the frontend.
Also, if the theme supports it, it will add your language code to the HTML tag.

## Multi-Language Basics

As you should already be familiar with how Grav uses markdown files in folders to define architectural structure as well as setting important page options as well as content, we won't go into those mechanics directly.  However, be aware that by default Grav looks for a **single** `.md` file in a folder to represent the page.
If you are uncertain of being sufficiently familiar with this principle, please refer to section [Basic Tutorial](../../basics/basic-tutorial) before proceeding.
With multi-language support enabled, Grav will look for the appropriate language based file, for example `default.en.md` or `default.fr.md`.

### Language Configuration

For Grav to do this you must first setup some basic language configuration in your `user/config/system.yaml` file (with comments for better readability):

[prism classes="language-yaml line-numbers"]
languages:
  supported: # Supported languages:
    - en # English language
    - fr # French language
  default_lang: en # Set default language to English
  include_default_lang: true # If true, use /en/path instead of /path for default English language.
[version=17]  include_default_lang_file_extension: true # If true, use .en.md file extension instead of .md for default langauge.
  content_fallback:
    en: ['en'] # No fallback for English.
    fr: ['fr', 'en'] #  French falls back to English version of the page.
[/version]
[/prism]

By providing a `languages` block with a list of `supported` languages, you have effectively enabled multi-language support within Grav.

In this example you can see that two supported languages have been described (`en` and `fr`). These will allow you to support **English** and **French** languages.

If no language is explicitly asked for (via the URL or by code), Grav will use the order of the languages provided to select the correct language.  So in the example above, the **default** language is `en` or English. If you had `fr` first, French would be the default language.

[version=17]
By default, all languages fall back to default language. If you do not want to do that, you can override language fallbacks by using `content_fallback`, where key is the language and value is array of languages.
[/version]

!! You can of course provide as many languages as you like and you may even use locale type codes such as `en-GB`, `en-US` and `fr-FR`.  If you use this locale based naming, you will have to replace all the short language codes with the locale versions.

### Multiple Language Pages

By default in Grav, each page is represented by a markdown file, for example `default.md`. When you enable multi-language support, Grav will look for the appropriately named markdown file.  For example as English is our default language, it will first look for `default.en.md`.

[version=15]
If this file is not found, it will try the next language and look for `default.fr.md`.  If that file is not found, it will fall-back to the Grav default and look for `default.md` to provide information for the page.
[/version]
[version=16]
If this file is not found, it will try the next language and look for `default.fr.md`.  If that file is not found, it will fall-back to the Grav default and look for `default.md` to provide information for the page.
[/version]
[version=17]
If that file is not found, it will fall-back to the Grav default and look for `default.md` to provide information for the page.

!! This default behavior has changed in **Grav 1.7**. In the past Grav displayed non-existing English page in French, now all languages fall back only to default language if not specified otherwise in `content_fallback`. So if the page cannot be found in any fallback languages, **404 Error Page** is displayed instead.
[/version]

If we had the most basic of Grav sites, with a single `01.home/default.md` file, we could start by renaming `default.md` to `default.en.md`, and its contents might look like this:

[prism classes="language-markdown line-numbers"]

This is my Grav-powered homepage!
[/prism]

Then you could create a new page located in the same `01.home/` folder called `default.fr.md` with the contents:

[prism classes="language-markdown line-numbers"]

Ceci est ma page d'accueil gnre par Grav !
[/prism]

Now you have defined two pages for your current homepage in multiple languages.

[version=17]
! If you are converting existing site to use multi-language, you can alternatively set `include_default_lang_file_extension: false` to keep on using the plain `.md` file extension for your primary language. [Read More...](/content/multi-language#default-file-extension).
[/version]

### Active Language via URL

As English is the default language, if you were to point your browser without specifying a language you would get the content as described in the `default.en.md` file, but you could also explicitly request English by pointing your browser to

[prism classes="language-text line-numbers"]
http://yoursite.com/en
[/prism]

To access the French version, you would of course, use

[prism classes="language-text line-numbers"]
http://yoursite.com/fr
[/prism]

! If you prefer not to use language prefix for the default language, set `include_default_lang: false`. [Read More...](/content/multi-language#default-language-prefix).

### Active Language via Browser

Most browsers allow you to configure which languages you prefer to see content in. Grav has the ability to read this `http_accept_language` values and compare them to the current supported languages for the site, and if no specific language has been detected, show you content in your preferred language.

For this to function you must enable the option in your `user/system.yaml` file in the `languages:` section:

[prism classes="language-yaml line-numbers"]
languages:
  http_accept_language: true
[/prism]


### Session-Based Active Language

If you wish to remember the active language independently from the URL, you can activate **session-based** storage of the active language.  To enable this, you must ensure you have `session: enabled: true` in [the system.yaml](../../basics/grav-configuration).  Then you need to enable the language setting:

[prism classes="language-yaml line-numbers"]
languages:
  session_store_active: true
[/prism]

This will then store the active language in the session.

### Set Locale to the Active Language

The boolean setting will set the PHP `setlocale()` method that controls things such as monetary values, dates, string comparisons, character classifications and other locale-specific settings to that of the active language.  This defaults to `false`, and then it will use the system locale, if you set this value to `true` it will override the locale with the current active language.

[prism classes="language-yaml line-numbers"]
languages:
   override_locale: false
[/prism]

### Default Language Prefix

By default, the default language code is prefixed in all URLs.  For example if you have support for English and French (`en` and `fr`), and the default is English.  A page route might look like `/en/my-page` in English and `/fr/ma-page` in French. However it's often preferrable to have the default language without the prefix, so you can just set this option to `false` and the English page would appear as `/my-page`.

[prism classes="language-yaml line-numbers"]
languages:
    include_default_lang: false
[/prism]

[version=17]
### Default File Extension

If you are converting existing site to use multi-language, it may be daunting task to convert all the existing pages to use the new `.en.md` language file extension (if using English). In this case, you may want to disable language extension on your original language.

[prism classes="language-yaml line-numbers"]
languages:
    include_default_lang_file_extension: false
[/prism]
[/version]

### Multi-Language Routing

Grav typically uses the names of the folders to produce a URL route for a particular page.  This allows for the site architecture to be easily understood and implemented as a nested set of folders.  However with a multi-language site you may wish to use a URL that makes more sense in that particular language.

If we had the following folder structure:

[prism classes="language-yaml line-numbers"]
- 01.animals
  - 01.mammals
    - 01.bats
    - 02.bears
    - 03.foxes
    - 04.cats
  - 02.reptiles
  - 03.birds
  - 04.insets
  - 05.aquatic
[/prism]

This would produce URLs such as `http://yoursite.com/animals/mammals/bears`.  This is great for an English site, but if you wished to have a French version you would prefer these to be translated appropriately. The easiest way to achieve this is to add a custom [slug](../headers#slug) for each of the `fr.md` page files.  for example, the mammal page might look something like:

[prism classes="language-markdown line-numbers"]

Les mammifres (classe des Mammalia) forment un taxon inclus dans les vertbrs, traditionnellement une classe, dfinie ds la classification de Linn. Ce taxon est considr comme monophyltique...
[/prism]

This combined with appropriate **slug-overrides** in the other files should result in a URL of `http://yoursite.com/animaux/mammiferes/ours` which is much more French looking!

Another option is to make use of the [page-level routes](../headers#routes) support and provide a full route alias for the page.

### Language-Based Homepage

If you override the route/slug for the homepage, Grav won't be able to find the homepage as defined by your `home.alias` option in your `system.yaml`. It will be looking for `/homepage` and your French homepage might have a route of `/page-d-accueil`.

In order to support multi-language homepages Grav has a new option that can be used instead of `home.alias` and that is simple `home.aliases` and it could look something like this:

[prism classes="language-yaml line-numbers"]
home:
  aliases:
    en: /homepage
    fr: /page-d-accueil
[/prism]

This way Grav knows how to route your to the homepage if the active language is English or French.

### Language-Based Twig Templates

By default, Grav uses the markdown filename to determine the Twig template to use to render.  This works with multi-language the same way.  For example, `default.fr.md` would look for a Twig file called `default.html.twig` in the appropriate Twig template paths of the current theme and any plugins that register Twig template paths.  With multi-language, Grav also adds the current active language to the path structure.  What this means is that if you need to have a language-specific Twig file, you can just put those into a root level language folder.  For example if your current theme is using a template located at `templates/default.html.twig` you can create an `templates/fr/` folder, and put your French-specific Twig file in there: `templates/fr/default.html.twig`.

Another option which requires manual setup is to override the `template:` setting in the page headers. For example:

[prism classes="language-yaml line-numbers"]
template: default.fr
[/prism]

This will look for a template located at `templates/default.fr.html.twig`

This provides you with two options for providing language specific Twig overrides.

!! If no language-specific Twig template is provided, the default one will be used.



### Translation via Twig

The simplest way to use these translation strings in your Twig templates is to use the `|t` Twig filter.  You can also use the `t()` Twig function, but frankly the filter is cleaner and does the same thing:

[prism classes="language-twig line-numbers"]
<h1 id="site-name">{{ "SITE_NAME"|t|e }}</h1>
<section id="header">
    <h2>{{ "HEADER.MAIN_TEXT"|t|e }}</h2>
    <h3>{{ "HEADER.SUB_TEXT"|t|e }}</h3>
</section>
[/prism]

Using the Twig function `t()` the solution is similar:

[prism classes="language-twig line-numbers"]
<h1 id="site-name">{{ t("SITE_NAME")|e }}</h1>
<section id="header">
    <h2>{{ t("HEADER.MAIN_TEXT")|e }}</h2>
    <h3>{{ t("HEADER.SUB_TEXT")|e }}</h3>
</section>
[/prism]

Another new Twig filter/function allows you to translate from an array.  This is particularly useful if you have a list of values such as months of the year, or days of the week.  For example, say you have this translation:

[prism classes="language-yaml line-numbers"]
en:
  GRAV:
    MONTHS_OF_THE_YEAR: [January, February, March, April, May, June, July, August, September, October, November, December]
[/prism]

You could get the appropriate translation for a post's month with the following:

[prism classes="language-twig line-numbers"]
{{ 'GRAV.MONTHS_OF_THE_YEAR'|ta(post.date|date('n') - 1)|e }}
[/prism]

You can also use this as a Twig function with `ta()`.

### Translations with Variables

You can also use variables in your Twig translations by using [PHP's sprintf](https://php.net/sprintf) syntax:

[prism classes="language-yaml line-numbers"]
SIMPLE_TEXT: There are %d monkeys in the %s
[/prism]

And then you can populate those variables with the Twig:

[prism classes="language-twig line-numbers"]
{{ "SIMPLE_TEXT"|t(12, "London Zoo")|e }}
[/prism]

resulting in the translation:

[prism classes="language-text line-numbers"]
There are 12 monkeys in the London Zoo
[/prism]

### Complex Translations

Sometimes it's required to perform complex translations with replacement in specific languages.  You can utilize the full power of the Language objects `translate()` method with the `tl` filter/function.  For example:

[prism classes="language-twig line-numbers"]
{{ ["SIMPLE_TEXT", 12, 'London Zoo']|tl(['fr'])|e }}
[/prism]

Will translate the `SIMPLE_TEXT` string and replace the placeholders with `12` and `London Zoo` respectively.  Also there's an array passed with language translations to try in first-find-first-used order.  This will output the result in french:


[prism classes="language-text line-numbers"]
Il y a 12 singes dans le Zoo de Londres
[/prism]

### PHP Translations

As well as the Twig filter and functions you can use the same approach within your Grav plugin:

[prism classes="language-php line-numbers"]
$translation = $this->grav['language']->translate(['HEADER.MAIN_TEXT']);
[/prism]

You can also specify a language:

[prism classes="language-php line-numbers"]
$translation = $this->grav['language']->translate(['HEADER.MAIN_TEXT'], ['fr']);
[/prism]

To translate a specific item in an array use:

[prism classes="language-php line-numbers"]
$translation = $this->grav['language']->translateArray('GRAV.MONTHS_OF_THE_YEAR', 3);
[/prism]

### Plugin and Theme Language Translations

You can also provide your own translations in plugins and themes.  This is done by creating a `languages.yaml` file in the root of your plugin or theme (e.g. `/user/plugins/error/languages.yaml`, or `user/themes/antimatter/languages.yaml`), and should contain all the supported languages prefixed by the language or locale code:

[prism classes="language-yaml line-numbers"]
en:
  PLUGIN_ERROR:
    TITLE: Error Plugin
    DESCRIPTION: The error plugin provides a simple mechanism for handling error pages within Grav.
fr:
  PLUGIN_ERROR:
    TITLE: Plugin d'Erreur
    DESCRIPTION: Le plugin d'erreur fournit un mcanisme simple de manipulation des pages d'erreur au sein de Grav.
[/prism]

! The convention for plugins is to use PLUGIN_PLUGINNAME.* as a prefix for all language strings, to avoid any name conflict. Themes are less likely to introduce language strings conflicts, but it's a good idea to prefix strings added in themes with THEME_THEMENAME.*

### Translation Overrides

If you wish to override a particular translation, simply put the modified key/value pair in an appropriate language file in your `user/languages/` folder.  For example a file called `user/languages/en.yaml` could contain:

[prism classes="language-yaml line-numbers"]
PLUGIN_ERROR:
  TITLE: My Error Plugin
[/prism]

This will ensure that you can always override a translation string without messing around with the plugins or themes themselves, and also will avoid overwriting a custom translation when updating them.

## Advanced

### Environment-Based Language Handling

You can take advantage of [Grav's Environment Configuration](../../advanced/environment-config) to automatically route users to the correct version of your site based on URL.  For example, if you had a URL such as `http://french.mysite.com` that was an alias for your standard `http://www.mysite.com`, you could setup an environment configuration:

`/user/french.mysite.com/config/system.yaml`

[prism classes="language-yaml line-numbers"]
languages:
  supported:
    - fr
    - en
[/prism]

This uses an **inverted language order** so the default language is now `fr` so the French language will show by default.

### Language Alias Routes

Because each page can have its own custom route, it would be hard to switch between different language versions of the same page.  However, there is a new **Page.rawRoute()** method on the Page object that will get the same raw route for any of the various language translations of a single page.  All you would need to do is to put the lang code in front to get the proper route to a specific language version of a page.

For example, say you are on a page in English with a custom route of:

[prism classes="language-text line-numbers"]
/my-custom-english-page
[/prism]

The French page has the custom route of:

[prism classes="language-text line-numbers"]
/ma-page-francaise-personnalisee
[/prism]

You could get the raw page of the English page and that might be:

[prism classes="language-text line-numbers"]
/blog/custom/my-page
[/prism]

Then just add the language you want and that is your new URL;

[prism classes="language-text line-numbers"]
/fr/blog/custom/my-page
[/prism]

This will retrieve the same page as `/ma-page-francaise-personnalisee`.

## Translation Support

Grav provides a simple yet powerful mechanism for providing translations in Twig and also via PHP for use in themes and plugins. This is enabled by default, and will use `en` language if no languages are defined.  To manually enable or disable translations, there is a setting in your `system.yaml`:

[prism classes="language-yaml line-numbers"]
languages:
  translations: true
[/prism]

The translations use the same list of languages as defined by the `languages: supported:` in your `system.yaml`.

The translation system works in a similar fashion to Grav configuration and there are several places and ways you can provide translations.

The first place Grav looks for translation files is in the `system/languages` folder. Files are expected to be created in the format: `en.yaml`, `fr.yaml`, etc.  Each yaml file should contain an array or nested arrays of key/values pairs:

[prism classes="language-yaml line-numbers"]
SITE_NAME: My Blog Site
HEADER:
    MAIN_TEXT: Welcome to my new blog site
    SUB_TEXT: Check back daily for the latest news
[/prism]

For ease of identification, Grav prefers the use of capitalized language strings as this helps to determine untranslated strings and also makes it clearer when used in Twig templates.

Grav has the ability to fall-back through the supported languages to find a translation if one for the active language is not found.  This is enabled by default but can be disabled via the `translations_fallback` option:

[prism classes="language-yaml line-numbers"]
languages:
  translations_fallback: true
[/prism]

!!! Help Grav reach a wider community of users by providing translations in **your language**. We use the [Crowdin Translation Platform](https://crowdin.com/) to facilitate translating the [Grav Core](https://crowdin.com/project/grav-core) and [Grav Admin Plugin](https://crowdin.com/project/grav-admin). [Sign-up](https://crowdin.com/join) and get started translating today!

### Language Switcher

You can download a simple **Language Switching** plugin via the Admin plugin, or through the GPM with:

[prism classes="language-bash command-line"]
bin/gpm install langswitcher
[/prism]

The [documentation for configuration and implementation can be found on GitHub](https://github.com/getgrav/grav-plugin-langswitcher).


### Setup with Language Specific Domains

Configure your site with [Environment-Based Language Handling](#environment-based-language-handling) to assign default languages (the first language) to domains.


Make sure the option

[prism classes="language-yaml line-numbers"]
pages.redirect_default_route: true
[/prism]

is set to `true` in your `system.yaml`.

Add the following to your **.htaccess** file and adopt the language slugs and domain names to your needs:

[prism classes="language-htaccess line-numbers"]
# http://www.cheat-sheets.org/saved-copy/mod_rewrite_cheat_sheet.pdf
# http://www.workingwith.me.uk/articles/scripting/mod_rewrite

# handle top level e.g. http://grav-site.com/de
RewriteRule ^en/?$ "http://grav-site.com" [R=302,L]
RewriteRule ^de/?$ "http://grav-site.de" [R=302,L]

# handle sub pages, exclude admin path
RewriteCond %{REQUEST_URI} !(admin) [NC]
RewriteRule ^en/(.*)$ "http://grav-site.com/$1" [R=302,L]
RewriteCond %{REQUEST_URI} !(admin) [NC]
RewriteRule ^de/(.*)$ "http://grav-site.de/$1" [R=302,L]
[/prism]

If you know how to simplify the rewrite rules, please edit this page on GitHub by clicking the **Edit** link at the top of the page.

Here's a simplified version of the rule set:
[prism classes="language-htaccess line-numbers"]
# http://www.cheat-sheets.org/saved-copy/mod_rewrite_cheat_sheet.pdf
# http://www.workingwith.me.uk/articles/scripting/mod_rewrite

# Redirect top-level URLs
RewriteRule ^en/?$ "http://grav-site.com" [R=302,L]
RewriteRule ^de/?$ "http://grav-site.de" [R=302,L]

# Redirect sub-pages, excluding the admin path
RewriteCond %{REQUEST_URI} !^/admin [NC]
RewriteRule ^(en|de)/(.*)$ "http://grav-site.$1/$2" [R=302,L]
[/prism]
This simplified version combines the rewrite rules for redirecting sub-pages for "en" and "de" into a single rule using grouping. Additionally, it consolidates the RewriteCond for the admin path to reduce duplication.

! Make sure to add these rules before the default rules that come with Grav CMS.

### Language Logic in Twig Templates

There is often a need to access Language state and logic from Twig templates.  For example if you need to access a certain image file that is different for a particular language and is named differently (`myimage.en.jpg` and `myimage.fr.jpg`).

To display the correct version of the image you would need to know the current active language.  This is possible in Grav by accessing the `Language` object via the `Grav` object, and calling the appropriate method. In the example above this could be achieved with the following Twig code:

[prism classes="language-twig line-numbers"]
{{ page.media.images['myimage.'~grav.language.getActive~'.jpg'].html()|raw }}
[/prism]

The `getActive` call in the Twig is effectively calling `Language->getActive()` to return the current active language code.  A few useful Language methods include:

* `getLanguages()` - Returns an array of all supported languages
* `getLanguage()` - Returns current active, else returns default language
* `getActive()` - Returns current active language
* `getDefault()` - Returns the default (first) language

For a complete list of available methods, you can look in the `<grav root>/system/src/Grav/Common/Language/Language.php` file.

---

## Default Content Type

> Path: grav-learn/pages/02.content/12.content-types/docs.md


## Default Content Type

As is typical with most web platforms, Grav's default content type is **HTML**. This means that when a user requests a route in their browser, for example: `/blog/new-macbook-pros-soon`, because there is no file extension Grav assumes you are requesting an HTML page.  If your page was defined by a page with filename of  `blog-item.md`, Grav in turn looks for a Twig template called `blog-item.html.twig`  to render the page.

If the user requested the type explicitly via `/blog/new-macbook-pros-soon.html`, Grav would still look for that same `blog-item.html.twig` file.

## Other Content Types

Grav is a flexible platform however, and can actually serve up any content type you could wish for (`xml`, `rss`, `json`, `pdf`, etc.), you just have to provide a way to render it appropriately.

If you were to request a route with a `.xml` extension, for example: `/blog.xml`,  instead of using the regular `blog.html.twig` template to render it,
Grav looks for a template called `blog.xml.twig`.  You would need to ensure that template outputs the appropriate XML structure.

### Example with JSON files

A particular common way to access files is via a `.json` extension.  This allows data to be requested via JSON files that are easily processed by JavaScript.

Say you wanted the **frontmatter** and **content** of a particular page in JSON format, and that page was defined in a file called `item.md`.  All you would need to do is to provide a Twig template called `item.json.twig`.  You could put this in your theme's `templates/` folder, or if you were using a plugin to load custom templates, you could add it there.

The contents of this `item.json.twig` file could look something like:

[prism classes="language-twig line-numbers"]
{% set payload = {frontmatter: page.header, content: page.content}  %}
{{ payload|json_encode|raw }}
[/prism]

All this Twig file does is create an array with the page header as **frontmatter** and page **content**, then uses the Twig `json_encode` filter to encode it.

When a user requests the url `/blog/new-macbook-pros-soon.json`, this new Twig file would be used and the output sent would be in the format:

[prism classes="language-json line-numbers"]
{
   "frontmatter":{
      "title":"New Macbook Pros Arriving Soon",
      "date": "14:23 08/01/2016",
      "taxonomy":{
         "category":[
            "blog"
         ],
         "tag":[
            "apple",
            "mbpr",
            "laptops"
         ]
      }
   },
   "content":"<p>this has an -&gt; arrow here and <strong>bold</strong> here</p>\n<blockquote>\n<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec ultricies tristique nulla et mattis. Phasellus id massa eget nisl congue blandit sit amet id ligula. Praesent et nulla eu augue tempus sagittis. Mauris faucibus nibh et nibh cursus in vestibulum sapien egestas. Curabitur ut lectus tortor. Sed ipsum eros, egestas ut eleifend non, elementum vitae eros.\n-- <cite> Ronald Wade</cite></p>\n</blockquote>\n<p>Mauris felis diam, pellentesque vel lacinia ac, dictum a nunc. Mauris mattis nunc sed mi sagittis et facilisis tortor volutpat. Etiam tincidunt urna mattis erat placerat placerat ac eu tellus.</p>\n<p>This is a new paragraph</p>\n<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec ultricies tristique nulla et mattis.</p>"
}
[/prism]

This is valid JSON that can easily be parsed and processed by JavaScript.  Easy Peasy!

## Custom Content Types

In order to send the data with the appropriate content type, Grav needs to know the MIME type that the browser expects in order for it to render that content type.  Grav knows about most of the standard content types as defined in the `system/config/media.yaml` file.  If you wish to handle a content type that is not provided, you just need to add an entry to this file.

For example, if you wish to be able to render iCal calendar events, you would need to add this media type to the `media.yaml`:

[prism classes="language-yaml line-numbers"]
  ics:
    type: iCal
    thumb: media/thumb.png
    mime: text/calendar
[/prism]

This defines the `.ics` file extension as an `iCal` file with mime type: `text/calendar`.  Then all you need to do is provide the appropriate `.ics.twig` template to render any file you request of this type.

---

## Chapter 2

> Path: grav-learn/pages/02.content/chapter.md


### Chapter 2

# Content

In **Grav**, content is priority **#1**.  Find out how to create and organize your content quickly and intuitively.

---

## Content Pages & Twig Templates

> Path: grav-learn/pages/03.themes/01.theme-basics/docs.md


Themes in Grav are quite simple, and very flexible because they are built with the powerful [Twig Templating engine](https://twig.symfony.com/). Every theme is created with a combination of twig files (a mixture of twig-like PHP code and HTML), called templates, and CSS. We typically use [Sass CSS Extension](http://sass-lang.com) to generate our CSS files, but there is nothing stopping you from using [Less](http://lesscss.org/), or even regular CSS. It simply comes down to your own personal preferences.

## Content Pages & Twig Templates

The first thing to understand is the direct relationship between **pages** in Grav and the **Twig template files** that are provided in a theme.

Each page you create references a specific template file, either by the name of the page file, or by setting the template header variable for the page.  For simpler maintenance, we advise using the page name rather than overriding it with the header variable, whenever possible.

Let us work through a simple example.  If you have [installed the **Grav Base** package](../../basics/installation) you will notice that in the `user/pages/01.home` folder, you have a file called `default.md` which contains the markdown-based content for the page.  The name of this file, i.e. `default` tells Grav that this page should be rendered with the Twig template called `default.html.twig` which is located in the theme's `templates/` folder.

!! Page templates must be lowercase, like "default", "blog", etc.

If you were to have a page file called `blog.md`, Grav would try to render it with the Twig template: `<your_theme>/templates/blog.html.twig`.

!! The names of files in Grav do not appear on the frontend of Grav. Only the folder names do. Don't worry if all of your blog posts have the same file name. This is normal.

## Theme Organization

### Definition & Configuration

Each theme should have a definition file called `blueprints.yaml` which has some information about the theme.  It can optionally provide **form** definitions to be used in the [**Administration Panel**](../../admin-panel/introduction) to allow for editing of theme options.  The **Antimatter** theme has the following `blueprints.yaml` file:

[prism classes="language-yaml line-numbers"]
name: Antimatter
slug: antimatter
type: theme
version: 1.6.7
description: "Antimatter is the default theme included with **Grav**"
icon: empire
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-theme-antimatter
demo: https://demo.getgrav.org/blog-skeleton
keywords: antimatter, theme, core, modern, fast, responsive, html5, css3
bugs: https://github.com/getgrav/grav-theme-antimatter/issues
license: MIT

dependencies:
    - { name: grav, version: '>=1.6.0' }

form:
  validation: loose
  fields:
    dropdown.enabled:
        type: toggle
        label: Dropdown in navbar
        highlight: 1
        default: 1
        options:
          1: Enabled
          0: Disabled
        validate:
          type: bool
[/prism]

If you want to use theme configuration options you should provide default settings in a file called `<your_theme>.yaml`.  For example:

[prism classes="language-yaml line-numbers"]
enabled: true
color: blue
[/prism]

!! The `color: blue` configuration option does not actually do anything. It is merely used as an example of how to override a setting.

To know more about the available forms that you can create, refer to [chapter 6. Forms](../../forms). You should also provide a `300px` x `300px` image of your theme and call it `thumbnail.jpg` at the root of the theme. It will show up in the theme section of your admin panel.

### Templates

There are **no set rules** regarding the structure of a Grav theme except that there must be appropriate Twig templates provided in the `templates/` folder for each of the page types you use in your content.

!! Because of this tight coupling between page content and Twig templates in a theme, it often makes sense to develop themes in conjunction with the content they are intended to be used with.  A good way to create _general_ themes is to support the template types used by the Skeleton packages that are available on our [downloads page](https://getgrav.org/downloads). For example, support: **default**, **blog**, **error**, **item**, and **modular**.

Generally speaking, the root of the `templates/` folder should be used to house the primary templates that are supported, then create a sub-folder called `partials/` to contain parts, or smaller template _chunks_.

If you want to support **modular** templates in your theme, you should also create a sub-folder of templates called `modular/` and store your modular Twig template files in there.

The story for supporting **forms** is the same. Create another sub-folder called `forms/` and store any custom form templates in it.

### SCSS / LESS / CSS

Again, there is nothing set in stone here, but a solid practice is to have a sub-folder called `scss/` if you want to develop with Sass, or `less/` if you prefer Less along with a `css/` folder to put static CSS files, and a `css-compiled/` folder for any automatically generated files from your Sass or Less compilations.

How you organize your files here is completely up to you.  Feel free to follow our example in the default **antimatter** theme provided with the Grav Base package for some ideas.  We are using the **scss** variant of Sass which is more CSS-like, and frankly more natural to write.

To install Sass on your computer, simply [follow the instructions on the sass-lang.com](http://sass-lang.com/install) website.

1. Execute the simple provided scss shell script by typing `./scss.sh` from the root of the theme.
2. Running the command directly `scss --source-map --watch scss:css-compiled` which is the same thing.

By default, this will compile your scss files into the `css-compiled/` folder.  You can then reference the resulting css file in your theme.

### Blueprints

The `blueprints/` folder is used to define forms for options and configuration for each of the template files. These are used by the **Administration Panel** and are optional. The theme is 100% functional without these, but they will not be editable via the administration panel, unless provided.

### Theme and Plugin Events

Another powerful feature that is purely optional is the ability for a theme to interact with Grav via the **plugins** architecture. In short, during the initialization sequence of Grav, there are several points in the sequence where you can "hook" your own piece of code. This can be useful, for example, to define extra path shortcuts in your theme when Twig is initializing, so that you can use them in your Twig templates. These hooks are available to you through a set of "empty" functions with names predefined by the Grav system, which you can fill at your convenience. [Chapter 4. Plugins](../../plugins) has more information about the plugin system and the available event hooks. To make use of these hooks in your theme, simply create a file called `mytheme.php` and use the following format:

[prism classes="language-php line-numbers"]
<?php
namespace Grav\Theme;

use Grav\Common\Theme;

class MyTheme extends Theme
{

    public static function getSubscribedEvents(): array
    {
        return [
            'onThemeInitialized' => ['onThemeInitialized', 0]
        ];
    }

    public function onThemeInitialized(): void
    {
        if ($this->isAdmin()) {
            $this->active = false;
            return;
        }

        $this->enable([
            'onTwigSiteVariables' => ['onTwigSiteVariables', 0]
        ]);
    }

    public function onTwigSiteVariables(): void
    {
        $this->grav['assets']
            ->addCss('plugin://css/mytheme-core.css')
            ->addCss('plugin://css/mytheme-custom.css');

        $this->grav['assets']
            ->add('jquery', 101)
            ->addJs('theme://js/jquery.myscript.min.js');
    }
}
[/prism]

As you can observe, in order to use the event hooks you first need to register them in a list with the `getSubscribedEvents` function and then define them with your own code. If you subscribe an event for use, define it as well. Otherwise you will get an error.

### Other Folders

We recommend creating individual folders at the root of your theme for `images/`, `fonts/` and `js/` to contain your custom theme images, any custom web fonts, and javascript files required.

## Theme Example

Let us use the default **antimatter** theme as an example, below you can see the overall structure of this theme:

![Theme Folders](theme-folders.png)

In this example, the actual `css`, `css-compiled`, `fonts`, `images`, `js`, `scss`, and `templates` files have been ignored to make it more readable.  The important thing to note is the overall structure of the theme.


---

## Quark

> Path: grav-learn/pages/03.themes/02.theme-tutorial/docs.md


Often, the best way to learn a new thing is to use an example, and then try to build your own creation from it. We are going to use this same methodology for creating a new Grav theme.

## Quark

Grav comes with a clean and modern theme called **Quark** which uses the [Spectre.css framework](https://picturepan2.github.io/spectre/).

Spectre.css is a lightweight, responsive and modern CSS framework for faster and extensible development.

Spectre provides basic styles for typography and elements, flexbox based responsive layout system, pure CSS components and utilities with best practice coding and consistent design language.

However, it's often better to start from something even simpler.

## Pure.css

For the sake of this tutorial, we will create a theme that utilizes the popular [Pure.css framework](http://purecss.io/)  developed by Yahoo!

Pure is a small, fast, and responsive CSS framework that contains the basics to get you developing your site without the overhead of larger frameworks such as [Bootstrap](http://getbootstrap.com/css/) or [Foundation](http://foundation.zurb.com/). It contains several modules that can be used independently, but all together the resulting package is only **4.0KB minified and gzipped**!

You can read up on all the features Pure brings to the table on the [Pure.css project site](http://purecss.io/).

Also, you should read the [Important Theme Updates](https://getgrav.org/blog/important-theme-updates) blog article that outlines some key changes in Grav themes to provide the best plugin support going forward.

## Step 1 - Install DevTools Plugin

!! Previous versions of this tutorial required creating a base theme by default.  This whole process can be skipped thanks to our new **DevTools Plugin**

The first step in creating a new theme is to **install the DevTools Plugin**.  This can be done in two ways.

#### Install via CLI GPM

* Navigate in the command line to the root of your Grav installation.

[prism classes="language-bash command-line"]
bin/gpm install devtools
[/prism]

#### Install via Admin Plugin

* After logging in, simply navigate to the **Plugins** section from the sidebar.
* Click the <i class="fa fa-plus"></i> **Add** button in the top right.
* Find **DevTools** in the list and click the <i class="fa fa-plus"></i> **Install** button.

## Step 2 - Create Base Theme

For this next step you really do need to be in the [command line](/cli-console/command-line-intro) as the DevTools provide a couple of CLI commands to make the process of creating a new theme much easier!

From the root of your Grav installation enter the following command:

[prism classes="language-bash command-line"]
bin/plugin devtools new-theme
[/prism]

This process will ask you a few questions that are required to create the new theme:

! We're going to use **pure-blank** to create a new theme, but you can create a simple **inheritance** style template that inherits from another base theme

[prism classes="language-bash command-line" cl-output="2-15"]
bin/plugin devtools new-theme

Enter Theme Name: MyTheme
Enter Theme Description: My New Theme
Enter Developer Name: Acme Corp
Enter Developer Email: contact@acme.co
Please choose a template type
  [pure-blank ] Basic Theme using Pure.css
  [inheritance] Inherit from another theme
  [copy       ] Copy another theme
 > pure-blank

SUCCESS theme mytheme -> Created Successfully

Path: /www/user/themes/my-theme
[/prism]

The DevTools command tells you where this new template was created. This created template is fully functional but also very simple.  You will want to modify this to suit your needs.

In order to see your new theme in action, you will need to change the default theme from `quark` to `my-theme`, so edit your `user/config/system.yaml` and change it:

[prism classes="language-yaml line-numbers"]
...
pages:
    theme: my-theme
...
[/prism]

Reload your site in your browser and you should see the theme has now changed.

## Step 3 - Theme Basics

Now we've created a new basic theme that can be modified and developed, let's break it down and have a look at what makes up a theme.  If you look in the `user/themes/my-theme` folder you will see:

[prism classes="language-text"]
.
 CHANGELOG.md
 LICENSE
 README.md
 blueprints.yaml
 css
  custom.css
 fonts
 images
  logo.png
 js
 my-theme.php
 my-theme.yaml
 screenshot.jpg
 templates
  default.html.twig
  error.html.twig
  partials
      base.html.twig
      navigation.html.twig
 thumbnail.jpg
[/prism]

This is a sample structure but some things are required:

### Required Items to Function

These items are critical and your theme will not function reliably unless you include these in your theme.

* **`blueprints.yaml`** - The configuration file used by Grav to get information on your theme. It can also define a form that the admin can display when viewing the theme details.  This form will let you save settings for the theme. [This file is documented in the Forms chapter](/forms/blueprints).
* **`my-theme.php`** - This file will be named according to your theme, but can be used to house any logic your theme needs.  You can use any [plugin event hook](/plugins/event-hooks) except `onPluginsInitialized()`, however there is a theme specific `onThemeInitialized()` hook specific for themes that you can use instead.
* **`my-theme.yaml`** - This is the configuration used by the plugin to set options the theme might use.
* **`templates/`** - This is a folder that contains the Twig templates to render your pages.

### Required Items for Release

These items are required if you wish to release your theme via GPM.

* **`CHANGELOG.md`** - A file that follows the [Grav Changelog Format](/advanced/grav-development#changelog-format) to show changes in releases.
* **`LICENSE`** - a license file, should probably be MIT unless you have a specific need for something else.
* **`README.md`** - A 'Readme' that should contain any documentation for the theme.  How to install it, configure it, and use it.
* **`screenshot.jpg`** - 1009px x 1009px screenshot of the theme.
* **`thumbnail.jpg`** - 300px x 300px screenshot of the theme.


## Step 4 - Base Template

As you know from the [previous chapter](../theme-basics), each item of content in Grav has a particular filename, e.g. `default.md`, which instructs Grav to look for a rendering Twig template called `default.html.twig`.  It is possible to put everything you need to display a page in this one file, and it would work fine. However, there is a better solution.

Utilizing the Twig [Extends](https://twig.symfony.com/doc/1.x/tags/extends.html) tag you can define a base layout with [blocks](https://twig.symfony.com/doc/1.x/tags/block.html) that you define. This enables any twig template to **extend** the base template, and provides definitions for any **block** defined in the base.  So look at the `templates/default.html.twig` file and examine its content:

[prism classes="language-twig line-numbers"]
{% extends 'partials/base.html.twig' %}

{% block content %}
    {{ page.content|raw }}
{% endblock %}
[/prism]

There are really two things going on here.

First, the template extends a template located in `partials/base.html.twig`.

! You don't need to include `templates/` within Twig templates as Twig is already looking in `templates/` as the root level for any template.

Second, the `content` block is overridden from the base template, and the page's content is output in its place.

!! For consistency, it's a good idea to use the `templates/partials` folder to contain Twig templates that represent either little chunks of HTML, or are shared. We also use `templates/modular` for modular templates, and `templates/forms` for any forms.  You can create any sub-folders you like if you prefer to organize your templates differently.

If you look at the `templates/partials/base.html.twig` you will see the meat of the HTML layout:

[prism classes="language-twig line-numbers"]
{% set theme_config = attribute(config.themes, config.system.pages.theme) %}
<!DOCTYPE html>
<html lang="{{ (grav.language.getActive ?: theme_config.default_lang)|e }}">
<head>
{% block head %}
    <meta charset="utf-8" />
    <title>{% if header.title %}{{ header.title|e }} | {% endif %}{{ site.title|e }}</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% include 'partials/metadata.html.twig' %}

    <link rel="icon" type="image/png" href="{{ url('theme://images/logo.png')|e }}" />
    <link rel="canonical" href="{{ page.url(true, true)|e }}" />
{% endblock head %}

{% block stylesheets %}
    {% do assets.addCss('http://yui.yahooapis.com/pure/0.6.0/pure-min.css', 100) %}
    {% do assets.addCss('https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css', 99) %}
    {% do assets.addCss('theme://css/custom.css', 98) %}
{% endblock %}

{% block javascripts %}
    {% do assets.addJs('jquery', 100) %}
{% endblock %}

{% block assets deferred %}
    {{ assets.css()|raw }}
    {{ assets.js()|raw }}
{% endblock %}

</head>
<body id="top" class="{{ page.header.body_classes|e }}">

{% block header %}
    <div class="header">
        <div class="wrapper padding">
            <a class="logo left" href="{{ (base_url == '' ? '/' : base_url)|e }}">
                <i class="fa fa-rebel"></i>
                {{ config.site.title|e }}
            </a>
            {% block header_navigation %}
            <nav class="main-nav">
                {% include 'partials/navigation.html.twig' %}
            </nav>
            {% endblock %}
        </div>
    </div>
{% endblock %}

{% block body %}
    <section id="body">
        <div class="wrapper padding">
        {% block content %}{% endblock %}
        </div>
    </section>
{% endblock %}

{% block footer %}
    <div class="footer text-center">
        <div class="wrapper padding">
            <p><a href="https://getgrav.org">Grav</a> was <i class="fa fa-code"></i> with <i class="fa fa-heart"></i> by <a href="http://www.rockettheme.com">RocketTheme</a>.</p>
        </div>
    </div>
{% endblock %}

{% block bottom %}
    {{ assets.js('bottom')|raw }}
{% endblock %}

</body>
[/prism]

! **TIP:** If a variable is safe to render and contains HTML, always use the `|raw` filter to make the template work with `autoescape` turned on.

!! It is very important to either turn on the `autoescape` setting in [System Configuration](/basics/grav-configuration#twig) or to remember to escape every single variable in template files to make your site safe against [XSS attacks](https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting).

## Step 5 - Breaking it Down

Please read over the code in the `base.html.twig` file in order to better understand what is happening.  There are several key things to note:

1. A `theme_config` variable is set with the theme configuration.  Because Twig doesn't work well with dashes, to retrieve variables with dashes (e.g. `config.themes.my-theme`), we use the `attribute()` Twig function to dynamically retrieve the `my-theme` data from `config.themes`.

2. The `<html lang=...` item is set based on Grav's active language if enabled, else it uses the `default_lang` as set in the `theme_config`.

3. The `{% block head %}{% endblock head %}` syntax defines an area in the base Twig template. Note that the use of `head` in the `{% endblock head %}` tag is not required, but is used here for readability. In this block we put things that are typically located in the HTML `<head>` tag.

4. The `<title>` tag is dynamically set based on the page's `title` variable as set in the page header.  The `header.title` is a shortcut method but is equivalent to `page.header.title`.

5. After a couple of standard meta tags are set, there is a reference to include `partials/metadata.html.twig`.  This file is located in the `systems/templates/partials` folder and contains a loop that loops over the page's metadata.  This is actually a merge of metadata from `site.yaml` and any page-specific overrides.

6. The `<link rel="icon"...` entry is set by pointing to a theme-specific image.  In this case it's located in theme directory under `images/logo.png`.  The syntax for this is `{{ url('theme://images/logo.png') }}`.

7. The `<link rel="canonical"...` entry sets a canonical URL for the page that is always set to the full URL of the page via `{{ page.url(true, true) }}`.

8. Now we define a block called `stylesheets`, and in here we use the [Asset Manager](/themes/asset-manager) to add several assets.  The first one loads the Pure.css framework.  The second one loads [FontAwesome](http://fontawesome.io/) to provide useful icons.  The last entry points to a `custom.css` file in the theme's `css/` folder.  In here are a few useful styles to get you started, but you can add more here.  Also you can add other CSS file entries as needed.

9. The `{{ assets.css()|raw }}` call is what triggers the template to render all the CSS link tags.

10. The `javascripts` block, like the `stylesheets` block is a good place to put your JavaScript files.  In this example, we only add the 'jquery' library which is already bundled with Grav, so you don't need to provide a path to it.

11. The `{{ assets.js()|raw }}` will render all the JavaScript tags.

12. The `<body>` tag has a class attribute that will output anything you set in the `body_classes` variable of the page's frontmatter.

13. The `header` block has a few things that output the HTML header of the page.  One important thing to note is the logo is hyperlinked to the `base_url` with the logic: `{{ base_url == '' ? '/' : base_url }}`.  This is to ensure that if there is no subdirectory, the link is just `/`.

14. The title of the site is output as the logo in this example theme with `{{ config.site.title }}` but you could just replace this with a `<img>` tag to a logo if you wanted.

15. The `<nav>` tag actually contains a link to `partials/navigation.html.twig` that contains the logic to loop over any **visible** pages and display them as a menu.  By default it supports dropdown menus for nested pages, but this can be turned off via the theme's configuration.  Have a look in this navigation file to get an idea of how the menu is generated.

16. The use of `{% block content %}{% endblock %}` provides a placeholder that allows us to provide content from a template that extends this one. Remember we overrode this in `default.html.twig` to output the page's content.

17. The `footer` block contains a simple footer, you can easily modify this for your needs.

18. Similar to the content block, the `{% block bottom %}{% endblock %}` is intended as a placeholder for templates to add custom JavaScript initialization or analytic codes. In this example, we output any JavaScript that was added to the `bottom` Asset Group.  Read more about this in the [Asset Manager](/themes/asset-manager) documentation.


## Step 6 - Theme CSS

You might have noticed that in the `partials/base.html.twig` file we made reference to a custom theme css via Asset Manager: `do assets.add('theme://css/custom.css', 98)`.  This file will house any custom CSS we need to fill in the gaps not provided by the Pure.css framework.  As Pure is a very minimal framework, it provides the essentials but almost no styling.

1. In your `user/themes/my-theme/css` folder, take a look at `custom.css`:

[prism classes="language-css line-numbers"]
/* Core Styles */
* {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

body {
    font-size: 1rem;
    line-height: 1.7;
    color: #606d6e;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    color: #454B4D;
}

a {
    color: #1F8CD6;
    text-decoration: none;
}

a:hover {
    color: #175E91;
}

pre {
    background: #F0F0F0;
    margin: 1rem 0;
    border-radius: 2px;
}

blockquote {
    border-left: 10px solid #eee;
    margin: 0;
    padding: 0 2rem;
}

/* Utility Classes */
.wrapper {
    margin: 0 3rem;
}

.padding {
    padding: 3rem 1rem;
}

.left {
    float: left;
}

.right {
    float: right
}

.text-center {
    text-align: center;
}

.text-right {
    text-align: right;
}

.text-left {
    text-align: left;
}

/* Content Styling */
.header .padding {
    padding: 1rem 0;
}

.header {
    background-color: #1F8DD6;
    color: #eee;
}

.header a {
    color: #fff;
}

.header .logo {
    font-size: 1.7rem;
    text-transform: uppercase;
}

.footer {
    background-color: #eee;
}

/* Menu Settings */
.main-nav ul {
    text-align: center;
    letter-spacing: -1em;
    margin: 0;
    padding: 0;
}

.main-nav ul li {
    display: inline-block;
    letter-spacing: normal;
}

.main-nav ul li a {
    position: relative;
    display: block;
    line-height: 45px;
    color: #fff;
    padding: 0 20px;
    white-space: nowrap;
}

.main-nav > ul > li > a {
    border-radius: 2px;
}

/*Active dropdown nav item */
.main-nav ul li:hover > a {
    background-color: #175E91;
}

/* Selected Dropdown nav item */
.main-nav ul li.selected > a {
    background-color: #fff;
    color: #175E91;
}

/* Dropdown CSS */
.main-nav ul li {position: relative;}

.main-nav ul li ul {
    position: absolute;
    background-color: #1F8DD6;
    min-width: 100%;
    text-align: left;
    z-index: 999;

    display: none;
}
.main-nav ul li ul li {
    display: block;
}

/* Dropdown CSS */
.main-nav ul li ul ul {
    left: 100%;
    top: 0;
}

/* Active on Hover */
.main-nav li:hover > ul {
    display: block;
}

/* Child Indicator */
.main-nav .has-children > a {
    padding-right: 30px;
}
.main-nav .has-children > a:after {
    font-family: FontAwesome;
    content: '\f107';
    position: absolute;
    display: inline-block;
    right: 8px;
    top: 0;
}

.main-nav .has-children .has-children > a:after {
    content: '\f105';
}

[/prism]

This is pretty standard CSS that sets some basic margins, fonts, colors, and utility classes. There is some basic content styling and some more extensive styling required to render the drop-down menu.  Feel free to modify this file as you need, or even add new CSS files (just ensure you add a reference in the `head` block by following the example for `custom.css`).

## Step 7 - Testing

To see your theme in action, open your browser, and point it to your Grav site.  You should see something like this:

![](pure-theme.png?lightbox&resize=800,600)

Congratulations, you have created your first theme!

---

## How Does Twig Work?

> Path: grav-learn/pages/03.themes/03.twig-primer/docs.md


Twig is a quick, optimized template engine for PHP. It is designed from the ground up to make creating templates easier on both the developer and the designer.

Its easy-to-follow syntax and straightforward processes make it a natural fit for anyone familiar with Smarty, Django, Jinja, Liquid, or Stencil.

We use it for our Grav templates in part because of its flexibility and inherent security. The fact that it is also one of the fastest template engines for PHP out there made choosing it for use in Grav a no-brainer.

Twig compiles templates down to plain PHP. This cuts the amount of PHP overhead down to a minimum, resulting in a faster, more streamlined developer experience.

It is also a very flexible engine thanks to its *lexer* and *parser*. This enables the developer to create their own custom tags and filters. Twig's lexer and parser also enables it to create its own [domain-specific language](http://en.wikipedia.org/wiki/Domain-specific_language) (DSL).

When it comes to security, Twig doesn't cut any corners. It gives the developer a sandbox mode that enables them to examine any untrusted code. This gives you the ability to use Twig as a template language for applications while giving users the ability to modify the template design.

Basically, it is a powerful engine that gives you control over the user interface. When combined with YAML for configuration, it makes for a powerful and simple system for any developer or site manager to work with.

## How Does Twig Work?

Twig works by taking all the hocus pocus out of template design. Templates are basically just text files that contain *variables* or *expressions* that are replaced by values as the template is evaluated.

*Tags* are also an important part of a template file, as these control the logic of the template itself.

Twig has two primary language constraints.

* `{{ }}` prints the result of an expression evaluation;
* `{% %}` executes statements.

Here is a basic template created using Twig:

[prism classes="language-html line-numbers"]
<!DOCTYPE html>
<html>
    <head>
        <title>All About Cookies</title>
    </head>
    <body>
        My name is {{ name|e }} and I love cookies.
        My favorite flavors of cookies are:
        <ul>
        {% for cookie in cookies %}
            <li>{{ cookie.flavor|e }}</li>
		{% endfor %}
        </ul>
        <h1>Cookies are the best!</h1>
    </body>
</html>
[/prism]

In this example, we set the title of the site up as you would with any standard Web page. The difference is that we were able to use simple Twig syntax to present the author's name and create a dynamic list of types of items.

A template is first loaded, then passed through the **lexer** where its source code is tokenized and broken up into small pieces. At this point, the **parser** takes the tokens and turns them into the abstract syntax tree.

Once this is done, the compiler turns this into PHP code that can then be evaluated and displayed to the user.

Twig can also be extended to add additional tags, filters, tests, operators, global variables, and functions. More information about extending Twig can be found in its [official documentation](https://twig.symfony.com/doc/1.x/advanced.html).

## Twig Syntax

A Twig template has several key components that help it to understand what it is you would like to do. These include tags, filters, functions, and variables.

Let's take a closer look at these important tools and how they can help you build an incredible template.

### Tags

Tags tell Twig what it needs to do. It allows you to set which code Twig should handle, and which code it should ignore during evaluation.

There are several different kinds of tags, and each has its own specific syntax that sets them apart.

#### Comment Tags

Comment tags (`{# Insert Comment Here #}`) are used to set comments that exist within the Twig template file, but aren't actually seen by the end user. They are removed during evaluation, and are neither parsed nor output.

A good use of these tags is to explain what a specific line of code or command does so that another developer or designer on your team can quickly read and understand.

Here is an example of a comment tag as you would find it in a Twig template file:

[prism classes="language-twig"]
{# Chocolate Chip Cookies are great! Don't tell anyone! #}
[/prism]

#### Output Tags

Output tags (`{{ Insert Output Here }}`) will be evaluated and added to the generated output. This is where you would put anything you want to appear on the front end, or in some other generated content.

Here is an example of output tags being used in a Twig template:

[prism classes="language-twig"]
My name is {{ name|e }} and I love cookies.
[/prism]

The variable `name` has been inserted into this line and will appear to the end user as `My name is Jake and I love cookies.` as `Jake` was the value of the name variable.

!! It is very important to either turn on `autoescape` setting from your [System Configuration](/basics/grav-configuration#twig) or to remember to escape every single variable in template files by using `|e` filter to make your site safe against XSS attacks. For safe HTML content, use `|raw` filter.

#### Action Tags

Action tags are the go-getters of the Twig world. These tags actually do something, as opposed to the others which either pass something along or sit idly in the source code waiting for a designer to read it.

Action tags set variables, loop through arrays, and test conditionals. Your `for` and `if` statements are made using these tags.

This is what an action tag might look like in a Twig template:

[prism classes="language-twig line-numbers"]
{% set hour = now | date("G") %}
{% if hour >= 9 and hour < 17 %}
    <p>Time for cookies!</p>
{% else %}
    <p>Time to bake more cookies!</p>
{% endif %}
[/prism]

The initial action tag sets the hour as the current hour in a 24-hour clock. That value is then used to gauge whether it is between 9am and 5pm. If it is, `Time for cookies!` is displayed. If it isn't, `Time to bake more cookies!` is displayed, instead.

It is very important that tags not overlap one another. You can't put an output tag inside of an action tag, or vice versa.

### Filters

Filters are useful, especially when you are using the output tags to display data that might not be formatted the way you want it.

Let's say the value of the `name` variable might include unwanted SGML/XML tags. You can filter them out using the code below:

[prism classes="language-twig"]
{{ name|striptags|e }}
[/prism]

### Functions

Functions can generate content. They are typically followed by arguments, which appear within parenthesis placed directly after the function call. Even if no argument is present, the function will still have a `()` parenthesis placed directly after it.

[prism classes="language-twig line-numbers"]
{% if date(cookie.created_at) < date('-2days') %}
    {# Eat it! #}
{% endif %}
[/prism]

## Resources

* [Official Twig Documentation](https://twig.symfony.com/doc/1.x/)
* [Twig for Template Designers](https://twig.symfony.com/doc/1.x/templates.html)
* [Twig for Developers](https://twig.symfony.com/doc/1.x/api.html)
* [6 Minute Video Introduction to Twig](http://www.dev-metal.com/6min-video-introduction-twig-php-templating-engine/)
* [Introduction to Twig](http://www.slideshare.net/markstory/introduction-to-twig)
* [Twig: The Basics (free intro to paid course)](https://knpuniversity.com/screencast/twig/basics)

---

## `markdown`

> Path: grav-learn/pages/03.themes/04.twig-tags-filters-functions/01.tags/docs.md


Grav also provides a variety of custom Twig Tags that extend the already very capable Twig templating capabilities with some new tags that we've found useful.

### `markdown`

The Markdown tag provides a powerful new way to embed markdown in Twig template.  You could use a variable and render that variable with the `|markdown` filter, but the `{% markdown %}` syntax makes creating blocks of markdown text even simpler.

[prism classes="language-twig line-numbers"]
{% markdown %}
This is **bold** and this _underlined_

1. This is a bullet list
2. This is another item in that same list
{% endmarkdown %}
[/prism]

[version=17]
### `script`

The Script tag is really a convenience tag that keeps your Twig more readable compared to the usual `{% do assets...%}` approach.  It's purely an alternative way of writing things.

#### Script File

[prism classes="language-twig line-numbers"]
{% script 'theme://js/something.js' at 'bottom' priority: 20 with { defer: true, async: true } %}
[/prism]

Grav 1.7.28 adds also support for modules:

[prism classes="language-twig line-numbers"]
{% script module 'theme://js/module.mjs' %}
[/prism]


#### Inline Script

[prism classes="language-twig line-numbers"]
{% script at 'bottom' priority: 20 %}
    alert('Warning!');
{% endscript %}
[/prism]

### `style`

#### CSS File

[prism classes="language-twig line-numbers"]
{% style 'theme://css/foo.css' priority: 20 %}
[/prism]

#### Inline CSS

[prism classes="language-twig line-numbers"]
{% style priority: 20 with { media: 'screen' } %}
    a { color: red; }
{% endstyle %}
[/prism]
[/version]

### `link`

[prism classes="language-twig line-numbers"]
{% link icon 'theme://images/favicon.png' priority: 20 with { type: 'image/png' } %}
{% link modulepreload 'plugin://grav-plugin/build/js/vendor.js' %}
[/prism]

### `switch`

In most programming language, using a `switch` statement is a common way to make a bunch of `if else` statements cleaner and more readabile.  Also they may prove to be marginally faster.  We just provide a simple way of creating these as they were missing in the base Twig functionality.

[prism classes="language-twig line-numbers"]
{% switch type %}
  {% case 'foo' %}
     {{ my_data.foo }}
  {% case 'bar' %}
     {{ my_data.bar }}
  {% default %}
     {{ my_data.default }}
{% endswitch %}
[/prism]

[version=16,17]
### `deferred`

With traditional blocks, once the block has been rendered, it cannot be manipulated.  Take the example of a `{% block scripts %}` that might hold some entries for JavaScript includes.  If you have a child Twig template, and you extend a base template where this block is defined, you can extend the block, and add your own custom JavaScript entries.  However, partial twig templates that are included from this page, cannot reach or interact with the block.

The deferred attribute on the block which is powered by the [Deferred Extension](https://github.com/rybakit/twig-deferred-extension), means that you can define this block in any Twig template, but it's rendering is deferred, so that it renders after everything else.  This means that you can add JavaScript references via the `{% do assets.addJs() %}` call from anywhere in your page, and because the rendering is deferred, the output will contain all the assets that Grav knows about, no matter when you added them.

[prism classes="language-twig line-numbers"]
{% block myblock deferred %}
    This will be rendered after everything else.
{% endblock %}
[/prism]

It is also possible to merge the content of the parent block with the deferred block using `{{ parent() }}`. This can be especially useful for themes if additional css or javascript files are added.

[prism classes="language-twig line-numbers"]
{% block stylesheets %}
    <!-- Additional css library -->
    {% do assets.addCss('theme://libraries/leaflet/dist/leaflet.css') %}
    {{ parent() }}
{% endblock %}
[/prism]

### `throw`

There are certain situations where you need to manually throw an exception, so we have a tag for that too.

[prism classes="language-twig line-numbers"]
{% throw 404 'Not Found' %}
[/prism]

### `try` & `catch`

Also it's useful to have more powerful PHP-style error handling in your Twig templates so we have a new `try/catch` tag.

[prism classes="language-twig line-numbers"]
{% try %}
   <li>{{ user.get('name') }}</li>
{% catch %}
   User Error: {{ e.message }}
{% endcatch %}
[/prism]

### `render`

Flex Objects are slowly making their way into more and more elements of Grav.  These are self-aware objects that have an associated Twig template structure, so they know how to render themselves.  In order to use these, we have implemented a new `render` tag that takes an optional layout which in turn controls which of the template layouts the object should be rendered with.

[prism classes="language-twig line-numbers"]
{% render collection layout: 'list' %}
{% render object layout: 'default' with { variable: 'value' } %}
[/prism]

### `cache`

Sometimes you may need to cache parts of the page, which take a lot of time to render. You can do this with `cache` tag.

[prism classes="language-twig line-numbers"]
{% cache 600 %}
  {{ some_complex_work() }}
{% endcache %}
[/prism]

In the example `600` is an optional lifetime in seconds. If the parameter isn't passed, default cache lifetime will be used.

[/version]

---

## `absolute_url`

> Path: grav-learn/pages/03.themes/04.twig-tags-filters-functions/02.filters/docs.md


Twig filters are applied to Twig variables by using the `|` character followed by the filter name.  Parameters can be passed in just like Twig functions using parenthesis.

### `absolute_url`

Takes an HTML snippet containing a `src` or `href` attribute which uses a relative path. Converts the path string to an absolute URL format including hostname.

`'<img src="/some/path/to/image.jpg" />'|absolute_url` <i class="fa fa-long-arrow-right"></i> &lt;img src=&quot;https://learn.getgrav.org/some/path/to/image.jpg&quot;&gt;

### `array_unique`

Wrapper for PHP `array_unique()` that removes duplicates from an array.

`['foo', 'bar', 'foo', 'baz']|array_unique` <i class="fa fa-long-arrow-right"></i> **{{ print_r(['foo', 'bar', 'foo', 'baz']|array_unique) }}**

### `base32_encode`

Performs a base32 encoding on variable
`'some variable here'|base32_encode` <i class="fa fa-long-arrow-right"></i> **{{ 'some variable here'|base32_encode }}**

### `base32_decode`

Performs a base32 decoding on variable
`'ONXW2ZJAOZQXE2LBMJWGKIDIMVZGK'|base32_decode` <i class="fa fa-long-arrow-right"></i> **{{ 'ONXW2ZJAOZQXE2LBMJWGKIDIMVZGK'|base32_decode }}**

### `base64_encode`

Performs a base64 encoding on variable
`'some variable here'|base64_encode` <i class="fa fa-long-arrow-right"></i> **{{ 'some variable here'|base64_encode }}**

### `base64_decode`

Performs a base64 decoding on variable
`'c29tZSB2YXJpYWJsZSBoZXJl'|base64_decode` <i class="fa fa-long-arrow-right"></i> **{{ 'c29tZSB2YXJpYWJsZSBoZXJl'|base64_decode }}**

### `basename`

Return the basename of a path.

`'/etc/sudoers.d'|basename` <i class="fa fa-long-arrow-right"></i> **{{ '/etc/sudoers.d'|basename }}**

### `camelize`

Converts a string into "CamelCase" format

`'send_email'|camelize` <i class="fa fa-long-arrow-right"></i> **{{ 'send_email'|camelize }}**

[version=16,17]
### `chunk_split`

Splits a string into smaller chunks of a certain sizeOf

`'ONXW2ZJAOZQXE2LBMJWGKIDIMVZGKA'|chunk_split(6, '-')` <i class="fa fa-long-arrow-right"></i> **{{ 'ONXW2ZJAOZQXE2LBMJWGKIDIMVZGKA'|chunk_split(6, '-') }}**
[/version]

### `contains`

Determine if a particular string contains another string

`'some string with things in it'|contains('things')` <i class="fa fa-long-arrow-right"></i> **{{ 'some string with things in it'|contains('things') }}**

#### Casting Values

PHP 7 is getting more strict type checks, which means that passing a value of wrong type may now throw an exception. To avoid this, you should use filters which ensure that the value passed to a method is valid:

### `string`

Use `|string` to cast value to string.

### `int`

Use `|int` to cast value to integer.

### `bool`

Use `|bool` to cast value to boolean.

### `float`

Use `|float` to cast value to floating point number.

### `array`

Use `|array` to cast value to an array.

### `defined`

Sometimes you want to check if some variable is defined, and if it's not, provide a default value.  For example:

`set header_image_width  = page.header.header_image_width|defined(900)`

This will set the variable `header_image_width` to the value `900` if it's not defined in the page header.

### `dirname`

Return the dirname of a path.

`'/etc/sudoers.d'|dirname` <i class="fa fa-long-arrow-right"></i> **{{ '/etc/sudoers.d'|dirname }}**


### `ends_with`

Takes a needle and a haystack and determines if the haystack ends with the needle.  Also now works with an array of needles and will return `true` if **any** haystack ends with the needle.

`'the quick brown fox'|ends_with('fox')` <i class="fa fa-long-arrow-right"></i> {{  'the quick brown fox'|ends_with('fox') ? 'true' : 'false' }}

### `fieldName`

Filters field name by changing dot notation into array notation

`'field.name'|fieldName` <i class="fa fa-long-arrow-right"></i> **{{ 'field.name'|fieldName }}**


[version=16,17]
### `get_type`

Gets the type of a variable:

`page|get_type` <i class="fa fa-long-arrow-right"></i> **{{ page|get_type }}**
[/version]

### `humanize`

Converts a string into a more "human readable" format

`'something_text_to_read'|humanize` <i class="fa fa-long-arrow-right"></i> **{{ 'something_text_to_read'|humanize }}**

### `hyphenize`

Converts a string into a hyphenated version.

`'Something Text to Read'|hyphenize` <i class="fa fa-long-arrow-right"></i> **{{ 'Something Text to Read'|hyphenize }}**

### `json_decode`

You can decode JSON by simply applying this filter:

`array|json_decode` {% verbatim %}
[prism classes="language-twig line-numbers"]
{% set array = '{"first_name": "Guido", "last_name":"Rossum"}'|json_decode %}
{{ print_r(array) }}
[/prism]
{% endverbatim %}

{% set array = '{"first_name": "Guido", "last_name":"Rossum"}'|json_decode %}
[prism classes="language-text"]
{{ print_r(array) }}
[/prism]

### `ksort`

Sort an array map by each key

`array|ksort` {% verbatim %}
[prism classes="language-twig line-numbers"]
{% set items = {'orange':1, 'apple':2, 'peach':3}|ksort %}
{{ print_r(items) }}
[/prism]
{% endverbatim %}

{% set items = {'orange':1, 'apple':2, 'peach':3}|ksort %}
[prism classes="language-text"]
{{ print_r(items) }}
[/prism]

### `ltrim`

`'/strip/leading/slash/'|ltrim('/')` <i class="fa fa-long-arrow-right"></i> {{ '/strip/leading/slash/'|ltrim('/') }}

Left trim removes trailing spaces at the beginning of a string. It can also remove other characters by setting the character mask (see [https://php.net/manual/en/function.ltrim.php](https://php.net/manual/en/function.ltrim.php))

### `markdown`

Take an arbitrary string containing markdown and convert it to HTML using the markdown parser of Grav. Optional `boolean` parameter:

* `true` (default): process as block (text mode, content will be wrapped in `<p>` tags)
* `false`: process as line (content will not be wrapped)

```
string|markdown($is_block)
```

{% verbatim %}
[prism classes="language-twig line-numbers"]
<div class="div">
{{ 'A paragraph with **markdown** and [a link](http://www.cnn.com)'|markdown }}
</div>

<p class="paragraph">{{'A line with **markdown** and [a link](http://www.cnn.com)'|markdown(false) }}</p>
[/prism]
{% endverbatim %}

{% set var %}
<div class="div">
{{ 'A paragraph with **markdown** and [a link](http://www.cnn.com)'|markdown }}
</div>

<p class="paragraph">{{'A line with **markdown** and [a link](http://www.cnn.com)'|markdown(false) }}</p>
{% endset %}
[prism classes="language-text"]
{{ var|e }}
[/prism]

### `md5`

Creates an md5 hash for the string

`'anything'|md5` <i class="fa fa-long-arrow-right"></i> **{{ 'anything'|md5 }}**

### `modulus`

Performs the same functionality as the Modulus `%` symbol in PHP. It operates on a number by passing in a numeric divider and an optional array of items to select from.

`7|modulus(3, ['red', 'blue', 'green'])` <i class="fa fa-long-arrow-right"></i> **{{ 7|modulus(3, ['red', 'blue', 'green']) }}**

### `monthize`

Converts an integer number of days into the number of months

`'181'|monthize` <i class="fa fa-long-arrow-right"></i> **{{ '181'|monthize }}**

[version=16,17]

### `nicecron`

Gets a human readable output for cron syntax

`"2 * * * *"|nicecron` <i class="fa fa-long-arrow-right"></i> **{{ '2 * * * *'|nicecron }}**

### `nicefilesize`

Output a file size in a human readable nice size format

`612394|nicefilesize` <i class="fa fa-long-arrow-right"></i> **{{ 612394|nicefilesize }}**

### `nicenumber`

Output a number in a human readable nice number format

`12430|nicenumber` <i class="fa fa-long-arrow-right"></i> **{{ 12430|nicenumber }}**
[/version]

### `nicetime`

Output a date in a human readable nice time format

`page.date|nicetime(false)` <i class="fa fa-long-arrow-right"></i> **{{ page.date|nicetime(false) }}**

The first argument specifies whether to use a full format date description. It's `true` by default.

You can provide a second argument of `false` if you want to remove the time relative descriptor (like 'ago' or 'from now' in your language) from the result.

[version=16,17]

### `of_type`

Checks the type of a variable to the param:

`page|of_type('string')` <i class="fa fa-long-arrow-right"></i> **{{ page|of_type('string') ? 'true' : 'false' }}**
[/version]

### `ordinalize`

Adds an ordinal to the integer (such as 1st, 2nd, 3rd, 4th)

`'10'|ordinalize` <i class="fa fa-long-arrow-right"></i> **{{ '10'|ordinalize }}**

### `pad`

Pads a string to a certain length with another character. This is a wrapper for the PHP [str_pad()](https://php.net/manual/en/function.str-pad.php) function.

`'foobar'|pad(10, '-')` <i class="fa fa-long-arrow-right"></i> **{{ 'foobar'|pad(10, '-') }}**

### `pluralize`

Converts a string to the English plural version

`'person'|pluralize` <i class="fa fa-long-arrow-right"></i> **{{ 'person'|pluralize }}**

`pluralize` also takes an optional numeric parameter which you can pass in when you don't know in advance how many items the noun will refer to. It defaults to 2, so will provide the plural form if omitted. For example:

{% verbatim %}
[prism classes="language-twig "]
<p>We have {{ num_vacancies }} {{ 'vacancy'|pluralize(num_vacancies) }} right now.</p>
[/prism]
{% endverbatim %}

[version=16,17]

### `print_r`

Prints human-readable information about a variable

`page.header|print_r`

[prism classes="language-text"]
{{ page.header|print_r }}
[/prism]
[/version]

### `randomize`

Randomizes the list provided.  If a value is provided as a parameter, it will skip first n values and keep them in order.

`array|randomize` {% verbatim %}
[prism classes="language-twig line-numbers"]
{% set ritems = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten']|randomize(2) %}
{{ print_r(ritems) }}
[/prism]
{% endverbatim %}

{% set ritems = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten']|randomize(2) %}
[prism classes="language-text"]
{{ print_r(ritems) }}
[/prism]

### `regex_replace`

A helpful wrapper for the PHP [preg_replace()](https://php.net/manual/en/function.preg-replace.php) method, you can perform complex Regex replacements on text via this filter:

`'The quick brown fox jumps over the lazy dog.'|regex_replace(['/quick/','/brown/','/fox/','/dog/'], ['slow','black','bear','turtle'])` <i class="fa fa-long-arrow-right"></i> **{{ 'The quick brown fox jumps over the lazy dog.'|regex_replace(['/quick/','/brown/','/fox/','/dog/'], ['slow','black','bear','turtle']) }}**

! Use the `~`-delimiter rather than the `/`-delimiter where possible. Otherwise you'll most likely have to [double-escape certain characters](https://github.com/getgrav/grav/issues/833). Eg. `~\/\#.*~` rather than `'/\\/\\#.*/'`, which conforms more closely to the [PCRE-syntax](https://www.php.net/manual/en/regexp.reference.delimiters.php) used by PHP.

### `rtrim`

`'/strip/trailing/slash/'|rtrim('/')` <i class="fa fa-long-arrow-right"></i> {{ '/strip/trailing/slash/'|rtrim('/') }}

Removes trailing spaces at the end of a string. It can also remove other characters by setting the character mask (see [https://php.net/manual/en/function.rtrim.php](https://php.net/manual/en/function.rtrim.php))

### `singularize`

Converts a string to the English singular version

`'shoes'|singularize` <i class="fa fa-long-arrow-right"></i> **{{ 'shoes'|singularize }}**

### `safe_email`

The safe email filter converts an email address into ASCII characters to make it harder for email spam bots to recognize and capture.

`"someone@domain.com"|safe_email` <i class="fa fa-long-arrow-right"></i> **{{ "someone@domain.com"|safe_email }}**

Usage example with a mailto link:

{% verbatim %}
[prism classes="language-html line-numbers"]
<a href="mailto:{{ 'your.email@server.com'|safe_email }}">
  Email me
</a>
[/prism]
{% endverbatim %}

You might not notice a difference at first, but examining the page source (not using the Browser Developer Tools, the actual page source) will reveal the underlying characters encoding.

### `sort_by_key`

Sort an array map by a particular key

`array|sort_by_key` {% verbatim %}
[prism classes="language-twig line-numbers"]
{% set people = [{'email':'fred@yahoo.com', 'id':34}, {'email':'tim@exchange.com', 'id':21}, {'email':'john@apple.com', 'id':2}]|sort_by_key('id') %}
{% for person in people %}{{ person.email }}:{{ person.id }}, {% endfor %}
[/prism]
{% endverbatim %}

<strong>
{% set people = [{'email':'fred@yahoo.com', 'id':34}, {'email':'tim@exchange.com', 'id':21}, {'email':'john@apple.com', 'id':2}]|sort_by_key('id') %}
{% for person in people %}{{ person.email }}:{{ person.id }}, {% endfor %}
</strong>

### `starts_with`

Takes a needle and a haystack and determines if the haystack starts with the needle.  Also now works with an array of needles and will return `true` if **any** haystack starts with the needle.

`'the quick brown fox'|starts_with('the')` <i class="fa fa-long-arrow-right"></i> **{{ 'the quick brown fox'|starts_with('the') ? 'true' : 'false' }}**

### `titleize`

Converts a string to "Title Case" format

`'welcome page'|titleize` <i class="fa fa-long-arrow-right"></i> **{{ 'welcome page'|titleize }}**


### `t`

Translate a string into the current language

`'MY_LANGUAGE_KEY_STRING'|t` <i class="fa fa-long-arrow-right"></i> **'Some Text in English'**

This assumes you have these language strings translated in your site and have enabled 
-language support.  Please refer to the [multi-language documentation](../../../content/multi-language) for more detailed information.

### `tu`

Translate a string into the current language set in the admin interface user preferences

`'MY_LANGUAGE_KEY_STRING'|tu` <i class="fa fa-long-arrow-right"></i> **'Some Text in English'**

This uses the language field set in the user yaml.

### `ta`

Translates an array with a language use the `|ta` filter. See the [multi-language documentation](../../../content/multi-language) for a detailed example.

`'MONTHS_OF_THE_YEAR'|ta(post.date|date('n') - 1)` <i class="fa fa-long-arrow-right"></i> **{{ now|date('F') }}**

### `tl`

Translates a string in a specific language. For more details check out the [multi-language documentation](../../../content/multi-language#complex-translations).

`'SIMPLE_TEXT'|tl(['fr'])`

### `truncate`

You can easily generate a shortened, truncated, version of a string by using this filter.  It takes a number of characters as the only required field, but has some other options:

`'one sentence. two sentences'|truncate(5)|raw` <i class="fa fa-long-arrow-right"></i> **{{ 'one sentence. two sentences'|truncate(5)|raw }}**

Simply truncates to 5 characters.

`'one sentence. two sentences'|truncate(5, true)|raw` <i class="fa fa-long-arrow-right"></i> **{{ 'one sentence. two sentences'|truncate(5, true)|raw }}**

!! The `|raw` Twig filter should be used with the default `&hellip;` (elipsis) padding element in order for it to render with Twig auto-escaping

Truncates to closest sentence-end after 5 characters.

You can also truncate HTML text, but should first use the `|striptags` filter to remove any HTML formatting that could get broken if you end between tags:

`'<span>one <strong>sentence</strong>. two sentences</span>'
|raw|striptags|truncate(25)` <i class="fa fa-long-arrow-right"></i> **{{ '<span>one <strong>sentence</strong>. two sentences</span>'|raw|striptags|truncate(25) }}**


#### Specialized versions:

### `safe_truncate`

Use `|safe_truncate` to truncate text by number of characters in a "word-safe" manner.

### `truncate_html`

Use `|truncate_html` to truncate HTML by number of characters. not "word-safe"!

### `safe_truncate_html`

Use `|safe_truncate_html` to truncate HTML by number of characters in a "word-safe" manner.

### `underscorize`

Converts a string into "under_scored" format

`'CamelCased'|underscorize` <i class="fa fa-long-arrow-right"></i> **{{ 'CamelCased'|underscorize }}**

[version=16,17]
### `yaml_encode`

Dump/Encode a variable into YAML syntax

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set array = {foo: [0, 1, 2, 3], baz: 'qux' } %}
{{ array|yaml_encode }}
[/prism]
{% endverbatim %}

{% set array = {foo: [0, 1, 2, 3], baz: 'qux' } %}
[prism classes="language-yaml"]
{{ array|yaml_encode|e }}
[/prism]

### `yaml_decode`

Decode/Parse a variable from YAML syntax

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set yaml = "foo: [0, 1, 2, 3]\nbaz: qux" %}
{{ yaml|yaml_decode|var_dump }}
[/prism]
{% endverbatim %}

{% set yaml = "foo: [0, 1, 2, 3]\nbaz: qux" %}
[prism]
{{ yaml|yaml_decode|var_dump }}
[/prism]
[/version]

---

## `array`

> Path: grav-learn/pages/03.themes/04.twig-tags-filters-functions/03.functions/docs.md


Twig functions are called directly with any parameters being passed in via parenthesis.

### `array`

Cast a value to array

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set value = array(value) %}
[/prism]
{% endverbatim %}

### `array_diff`

Computes the difference of arrays.

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set diff = array_diff(array1, array2...) %}
[/prism]
{% endverbatim %}

### `array_key_value`

The `array_key_value` function allows you to add a key/value pair to an associate array

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set my_array = {fruit: 'apple'} %}
{% set my_array = array_key_value('meat','steak', my_array) %}
{{ print_r(my_array)}}
[/prism]
{% endverbatim %}

{% set my_array = {fruit: 'apple'} %}
{% set my_array = array_key_value('meat','steak', my_array) %}
outputs: ** {{ print_r(my_array) }} **

### `array_key_exists`

Wrapper for PHP's `array_key_exists` function that returns whether or not a key exists in an associative array.

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set my_array = {fruit: 'apple', meat: 'steak'} %}
{{ array_key_exists('meat', my_array) }}
[/prism]
{% endverbatim %}

{% set my_array = {fruit: 'apple', meat: 'steak'} %}
outputs: **{{ array_key_exists('meat', my_array) }}**

### `array_intersect`

The `array_intersect` function provides the intersection of two arrays or Grav collections.

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set array_1 = {fruit: 'apple', meat: 'steak'} %}
{% set array_2 = {fish: 'tuna', meat: 'steak'} %}
{{ print_r(array_intersect(array_1, array_2)) }}
[/prism]
{% endverbatim %}

{% set array_1 = {fruit: 'apple', meat: 'steak'} %}
{% set array_2 = {fish: 'tuna', meat: 'steak'} %}

outputs: **{{ print_r(array_intersect(array_1, array_2)) }}**

### `array_unique`

Wrapper for PHP `array_unique()` that removes duplicates from an array.

`array_unique(['foo', 'bar', 'foo', 'baz'])` <i class="fa fa-long-arrow-right"></i> **{{ print_r(array_unique(['foo', 'bar', 'foo', 'baz'])) }}**

### `authorize`

Authorizes an authenticated user to see a resource. Accepts a single permission string or an array of permission strings.

`authorize(['admin.statistics', 'admin.super'])`

[version=16,17]
### `body_class`

Takes an array of classes, and if they are not set on `body_classes` look to see if they are set in current theme configuration.

`set body_classes = body_class(['header-fixed', 'header-animated', 'header-dark', 'header-transparent', 'sticky-footer'])`

### `cron`

Create a "Cron" object from cron syntax

`cron("3 * * * *").getNextRunDate()|date(config.date_format.default)`

[/version]


### `dump`

Takes a valid Twig variable and dumps it out into the [Grav debugger panel](../../../advanced/debugging).  The debugger must be **enabled** to see the values in the messages tab.

`dump(page.header)`

### `debug`

Same as `dump()`

### `evaluate`

The evaluate function can be used to evaluate a string as Twig:

`evaluate('grav.language.getLanguage')`

### `evaluate_twig`

Similar to evaluate, but will evaluate and process with Twig

{% verbatim %}
`evaluate_twig('This is a twig variable: {{ foo }}', {foo: 'bar'})`)  <i class="fa fa-long-arrow-right"></i> **This is a twig variable: bar**
{% endverbatim %}

### `exif`

Output the EXIF data from an image based on its filepath. This requires that `media: auto_metadata_exif: true` is set in `system.yaml`. For example, in a Twig-template:

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set image = page.media['sample-image.jpg'] %}
{% set exif = exif(image.filepath, true) %}
{{ exif.MaxApertureValue }}
[/prism]
{% endverbatim %}

This would write the `MaxApertureValue`-value set in the camera, for example "40/10". You can always use {% verbatim %}`{{ dump(exif) }}`{% endverbatim %} to show all the available data in the debugger.

### `get_cookie`

Retrieve the value of a cookie with this function:

`get_cookie('your_cookie_key')`

[version=16,17]
### `get_type`

Gets the type of a variable:

`get_type(page)` <i class="fa fa-long-arrow-right"></i> **{{ get_type(page) }}**
[/version]

### `gist`

Takes a Github Gist ID and creates appropriate Gist embed code

`gist('bc448ff158df4bc56217')` <i class="fa fa-long-arrow-right"></i> **{{ gist('bc448ff158df4bc56217')|e }}**

### `header_var`
`header_var($variable, $pages = null)`

Returns `page.header.<variable>`.

! **NOTE:** Deprecated since Grav 1.7. `theme_var` should be used.

! The logic of finding the variable has changed, which might lead to unexptected results:
! - If an array of lookup pages is provided as second parameter, only the first page will be used.
! - If `<variable>` is not defined in het header of the page, Grav will search for the variable in the tree of parents of the page.
! - If still not found, Grav will search for the variable in the config file of the theme

Given frontmatter of
```
```

`header_var('title')` <i class="fa fa-long-arrow-right"></i> **Home**

[version=16,17]
### `http_response_code`

If response_code is provided, then the previous status code will be returned. If response_code is not provided, then the current status code will be returned. Both of these values will default to a 200 status code if used in a web server environment.

`http_response_code(404)`
[/version]

### `isajaxrequest`

the `isajaxrequest()` function can be used to check if `HTTP_X_REQUESTED_WITH` header option is set:


### `json_decode`

You can decode JSON by simply applying this filter:

`json_decode({"first_name": "Guido", "last_name":"Rossum"})`

### `media_directory`

Returns a media object for an arbitrary directory.  Once obtained you can manipulate images in a similar fashion to pages.

`media_directory('theme://images')['some-image.jpg'].cropResize(200,200).html`

[version=16,17]
### `nicefilesize`

Output a file size in a human readable nice size format

`nicefilesize(612394)` <i class="fa fa-long-arrow-right"></i> **{{ nicefilesize(612394) }}**

### `nicenumber`

Output a number in a human readable nice number format

`nicenumber(12430)` <i class="fa fa-long-arrow-right"></i> **{{ nicenumber(12430)}}**

### `nicetime`

Output a date in a human readable nice time format

`nicetime(page.date)` <i class="fa fa-long-arrow-right"></i> **{{ nicetime(page.date) }}**
[/version]

### `nonce_field`

Generate a Grav security nonce field for a form with a required `action`:

`nonce_field('action')` <i class="fa fa-long-arrow-right"></i> **{{ nonce_field('action')|e }}**

[version=16,17]
### `of_type`

Checks the type of a variable to the param:

`of_type(page, 'string')` <i class="fa fa-long-arrow-right"></i> **{{ of_type(page, 'string') ? 'true' : 'false' }}**
[/version]

### `pathinfo`

Parses a path into an array.

{% verbatim %}
[prism classes="language-twig"]
{% set parts = pathinfo('/www/htdocs/inc/lib.inc.php') %}
{{ print_r(parts) }}
[/prism]
{% endverbatim %}

{% set parts = pathinfo('/www/htdocs/inc/lib.inc.php') %}

outputs: **{{ print_r(parts) }}**

[version=16,17]
### `print_r`

Prints a variable in a readable format

`print_r(page.header)`

[prism classes="language-text"]
{{ print_r(page.header) }}
[/prism]

[/version]

### `random_string`

Will generate a random string of the required number of characters.  Particularly useful in creating a unique id or key.

`random_string(10)` <i class="fa fa-long-arrow-right"></i> **{{ random_string(10) }}**

### `unique_id`

Generates a random string with configurable length, prefix and suffix. Unlike the built-in PHP `uniqid()` function and the `random_string` utils, this string will be generated truly unique and non-conflicting.


`unique_id(9)` <i class="fa fa-long-arrow-right"></i> **{{ unique_id(9) }}**
`unique_id(11, { prefix: 'user_' })` <i class="fa fa-long-arrow-right"></i> **unique_id(11, { prefix: 'user_' }) }}**
`unique_id(13, { suffix: '.json' })` <i class="fa fa-long-arrow-right"></i> **unique_id(13, { suffix: '.json' }) }}**

### `range`

Generates an array containing a range of elements, optionally stepped

`range(25, 300, 50)` <i class="fa fa-long-arrow-right"></i> **{{ print_r(range(25, 300, 50)) }}**

[version=16,17]
### `read_file`

Simple function to read a file based on a filepath and output it.

`read_file('plugins://admin/README.md')|markdown`

[prism classes="language-markdown line-numbers"]
# Grav Standard Administration Panel Plugin

This **admin plugin** for [Grav](https://github.com/getgrav/grav) is an HTML user interface that provides a convenient way to configure Grav and easily create and modify pages...
[/prism]

[/version]

### `redirect_me`

Redirects to a URL of your choosing

`redirect_me('http://google.com', 304)`

[version=16,17]
### `regex_filter`

Performs a `preg_grep` on an array with a regex pattern

`regex_filter(['pasta', 'fish', 'steak', 'potatoes'], "/p.*/")`

{% set var = regex_filter(['pasta', 'fish', 'steak', 'potatoes'], "/p.*/") %}
[prism classes="language-text"]
{{ print_r(var) }}
[/prism]

### `regex_replace`

A helpful wrapper for the PHP [preg_replace()](https://php.net/manual/en/function.preg-replace.php) method, you can perform complex Regex replacements on text via this filter:

{% verbatim %}
`regex_replace('The quick brown fox jumps over the lazy dog.', ['/quick/','/brown/','/fox/','/dog/'], ['slow','black','bear','turtle'])`
{% endverbatim %}

{% set var = regex_replace('The quick brown fox jumps over the lazy dog.', ['/quick/','/brown/','/fox/','/dog/'], ['slow','black','bear','turtle']) %}
[prism classes="language-text"]
{{ var }}
[/prism]

[/version]

[version=17]
### `regex_match`

A helpful wrapper for the PHP [preg_match()](https://php.net/manual/en/function.preg-match.php) method, you can perform complex regular expression match on text via this filter:

{% verbatim %}
`regex_match('http://www.php.net/index.html', '@^(?:http://)?([^/]+)@i')`
{% endverbatim %}

{% set var = regex_match('http://www.php.net/index.html', '@^(?:http://)?([^/]+)@i') %}
[prism classes="language-text"]
{{ print_r(var) }}
[/prism]

### `regex_split`

A helpful wrapper for the PHP [preg_split()](https://php.net/manual/en/function.preg-split.php) method. Split string by a regular expression on text via this filter:

{% verbatim %}
`regex_split('hypertext language, programming', '/\\s*,\\s*/u')`
{% endverbatim %}

{% set var = regex_split('hypertext language    ,    programming', '/\\s*,\\s*/u') %}
[prism classes="language-text"]
{{ print_r(var) }}
[/prism]

[/version]

### `repeat`

Will repeat whatever is passed in a certain amount of times.

`repeat('blah ', 10)` <i class="fa fa-long-arrow-right"></i> **{{ repeat('blah ', 10) }}**

### `string`

Returns a string from a value. If the value is array, return it json encoded

`string(23)` => **"23"**

`string(['test' => 'x'])` => **{"test":"x"}**

[version=17]
### `svg_image`

Returns the content of an SVG image and adds extra classes as needed. Provides the benefits of inline svg without having to paste the code directly on the page. Useful for reusable images such as social media icons.

{% verbatim %}
`{{ svg_image(path, classes, strip_style) }}`
{% endverbatim %}

strip_style = remove the svg inline styling - useful for styling with css classes.

example:

{% verbatim %}
`{{ svg_image('theme://images/something.svg', 'my-class-here mb-10', true) }}`
{% endverbatim %}


[/version]

[version=16,17]
### `theme_var`
`theme_var($variable, $default = null, $page = null)`

Get a theme variable from the page's header, or, if not found, from its parent(s), the theme's config file, or the default value if provided:

`theme_var('grid-size')`

This will first try `page.header.grid-size`, if not set, it will traverse the tree of parents. If still not found, it will try `theme.grid-size` from the theme's configuration file.

It can optionally take a default value as fallback:

`theme_var('grid-size', 1024)`
[/version]

### `t`

Translate a string, as the [`|t`](../filters#t) filter.

`t('SITE_NAME')` <i class="fa fa-long-arrow-right"></i> **Site Name**

### `ta`

Functions the same way the [`|ta`](../filters#ta) filter does.

### `tl`

Translates a string in a specific language. For more details check out the [multi-language documentation](../../content/multi-language#complex-translations).

`tl('SIMPLE_TEXT', ['fr'])`

### `url`

Will create a URL and convert any PHP URL streams into a valid HTML resources. A default value can be passed in in case the URL cannot be resolved.

`url('theme://images/logo.png')|default('http://www.placehold.it/150x100/f4f4f4')` <i class="fa fa-long-arrow-right"></i> **{{ url('theme://images/logo.png')|default('http://www.placehold.it/150x100/f4f4f4') }}**

### `vardump`

The `vardump()` function outputs the current variable to the screen (rather than in the debugger as with `dump()`)

{% verbatim %}
[prism classes="language-twig line-numbers"]
{% set my_array = {foo: 'bar', baz: 'qux'} %}
{{ vardump(my_array) }}
[/prism]
{% endverbatim %}

{% set my_array = {foo: 'bar', baz: 'qux'} %}

[prism classes="language-twig"]
[
  "foo" => "bar"
  "baz" => "qux"
]
[/prism]

[version=16,17]
### `xss`

Allow a manual check of a string for XSS vulnerabilities

`xss('this string contains a <script>alert("hello");</script> XSS vulnerability')` <i class="fa fa-long-arrow-right"></i> **{{ xss('this string contains a <script>alert("hello");</script> XSS vulnerability') }}**

[/version]

---

## Tags

> Path: grav-learn/pages/03.themes/04.twig-tags-filters-functions/docs.md


Although Twig already provides an extensive list of [filters, functions, and tags](https://twig.symfony.com/doc/1.x/#reference), Grav also provides a selection of useful additions to make the process of theming easier.

!! For information about developing your own custom Twig Filters, check out the [Custom Twig Filter/Function](/cookbook/twig-recipes/#custom-twig-filter-function) example in the **Twig Recipes** section of the **Cookbook** chapter.

## Tags

A tag provides high-level Twig functionality.  Examples of built-in tags include constructs such as `include`, `block`, `for`, `if` and many more. Tags are identified in Twig by the use of the {% verbatim %}`{% tagname %}`{% endverbatim %} syntax.  Also, most tags are closed with an {% verbatim %}`{% endtagname %}`{% endverbatim %}.

Grav includes several useful custom tags that provide functionality such as `cache`, `markdown`, `script`, `style`, `switch`, and more.

[Grav Twig Tags <i class="fa fa-arrow-right"></i>](tags?classes=button,button-primary)

## Filters

Twig filters allow to you to apply functionality to the variable that appears on the left side of the pipe (`|`) symbol.  They are particularly useful when dealing with manipulating text or variables.  The first argument to the filter is always the item on the left, but subsequent arguments can be passed in parentheses. Filters have some special capabilities including the ability to be context and environment aware.

Examples of built in Twig filters include `date`, `escape`, `join`, `lower`, `slice`, and many more. An example would be:

{% verbatim %}
```twig
{% set foo = "one,two,three,four,five"|split(',', 3) %}
```
{% endverbatim %}

Grav includes several useful custom filters that provide functionality such as `hyphenize`, `nicetime`, `starts_with`, `contains`, `base64_decode`, and many more.

[Grav Twig Filters <i class="fa fa-arrow-right"></i>](filters?classes=button,button-primary)

## Functions

Twig functions are another way to implement functionality in Twig. They are similar to filters, however rather than acting on a variable via a `|` you would call these functions directly and pass in any attributes they support between the parentheses after the function name.  Frequently, Grav provides both a filter and a function for the same logic and leaves it up to the user to choose the method they prefer.  

Examples of built in Twig filters include `block`, `dump`, `parent`, `random`, `range`, and more. An example would be:

{% verbatim %}
```twig
{{ random(['apple', 'orange', 'citrus']) }}
```
{% endverbatim %}

Grav includes several useful custom functions that provide functionality such as `authorize`, `debug`, `evaluate`, `regex_filter`, `media`, and many more.

[Grav Twig Functions <i class="fa fa-arrow-right"></i>](functions?classes=button,button-primary)





---

## Accessing Theme Blueprint Information

> Path: grav-learn/pages/03.themes/05.theme-configuration/docs.md


In Grav you can easily access theme configuration and blueprint information from your Twig and PHP files.

## Accessing Theme Blueprint Information

Information from the currently active theme's `blueprints.yaml` file can be had from the `theme` object. Let's use the following `blueprints.yaml` file as an example:

[prism classes="language-yaml line-numbers"]
name: Antimatter
slug: antimatter
type: theme
version: 1.7.0
description: "Antimatter is the default theme included with **Grav**"
icon: empire
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-theme-antimatter
demo: http://demo.getgrav.org/blog-skeleton
keywords: antimatter, theme, core, modern, fast, responsive, html5, css3
bugs: https://github.com/getgrav/grav-theme-antimatter/issues
license: MIT
[/prism]

You can reach any of these items via `grav.theme` by using the standard **dot-syntax**:

[prism classes="language-twig line-numbers"]
Author Email: {{ grav.theme.author.email }}
Theme License: {{ grav.theme.license }}
[/prism]

You can also reach these same values from a Grav plugin with PHP syntax:

[prism classes="language-php line-numbers"]
$theme_author_email = $this->grav['theme']['author']['email'];
$theme_license = $this->grav['theme']['license'];
[/prism]

## Accessing Theme Configuration

Themes have configuration files, too. A theme's configuration file is named `<themename>.yaml`. The default file lives in the theme's root folder (`user/themes/<themename>`).

It is **strongly** recommended not to actually change the theme's default YAML file but to override the settings in the `user/config/themes` folder. This will ensure that the theme's original settings remain intact, allowing you to quickly access the changes and/or revert back whenever necessary.

For example, let us consider the Antimatter theme.  By default, there is a file called `antimatter.yaml` in the theme's root folder. The contents of this configuration file look like this:

[prism classes="language-yaml line-numbers"]
enabled: true
color: blue
[/prism]

This is a simple file, but it provides you an idea of what you can do with theme configuration settings. Let us override these settings and add a new one.

So, create a file in the following location: `user/config/themes/antimatter.yaml`.  In this file put the following contents:

> *I note that `enabled` is not repeated here. If the config files are merged and not simply replaced, then that should be explicitly stated.*

[prism classes="language-yaml line-numbers"]
color: red
info: Grav is awesome!
[/prism]

Then in your theme templates you can access these variables using the `grav.theme.config` object:

```
<h1 style="color:{{ grav.theme.config.color|e }}">{{ grav.theme.config.info|e }}</h1>
```

This should render out as:

<h1 style="color:red">Grav is awesome!</h1>

In PHP you can access the current theme's configuration with:

[prism classes="language-php line-numbers"]
$color = $this->grav['theme']->config()['color'];
$info = $this->grav['theme']->config()['info'];
[/prism]

Simple! The sky is the limit regarding the configuration of your themes.  You can use them for whatever you like! :)

### Alternative Notation

The following aliases also work:

[prism classes="language-twig line-numbers"]
Theme Color Option: {{ config.theme.color_option|e }}
   or
Theme Color Option: {{ theme_var(color_option)|e }}
   or
Theme Color Option: {{ grav.themes.antimatter.color_option|e }} [AVOID!]
[/prism]

**Even though `grav.themes.<themename>` is supported, it should be avoided because it makes it impossible to inherit the theme properly.**

---

## Core Objects

> Path: grav-learn/pages/03.themes/06.theme-vars/docs.md


When you are designing a theme, Grav gives you access to all sorts of objects and variables from within your Twig templates.  The Twig templating framework provides powerful ways to read and manipulate these objects and variables.  This is [fully explained in their own documentation](https://twig.symfony.com/doc/1.x/templates.html) as well as [summarized succinctly in our own documentation](../twig-primer).

!!!! In Twig, you can call methods that take no parameters by just calling the method name, and omitting the parentheses `()`.  If you need to pass parameters, you also need to provide those after the method name.  `page.content` is equivalent to `page.content()`

## Core Objects

There are several **core objects** that are available to a Twig template, and each object has a set of **variables** and **functions**.

### base_dir variable

The `{{ base_dir }}` variable returns the base file directory of the Grav installation.

### base_url variable

The `{{ base_url }}` returns the base URL to the Grav site, whether or not this shows the full URL is dependent on the `absolute_urls` [option in the system configuration](../../basics/grav-configuration#system-configuration).

### base_url_relative variable

The `{{ base_url_relative }}` returns the base URL to the Grav site, without the host information.

### base_url_absolute variable

The `{{ base_url_absolute }}` returns the base URL to the Grav site, including the host information.

### base_url_simple variable

The `{{ base_url_simple }}` returns the base URL to the Grav site, without the language code.

### home_url variable

The `{{ home_url }}` is particularly useful to use to link back to the homepage of your site. It is similar to [`base_url`](#base-url-variable) but takes the currently active language into account.

### html_lang variable

This will return the current active language if provided, else use the `site.default_lang` configured option, else fall back to `en`.

### theme_dir variable

The `{{ theme_dir }}` variable returns the file directory folder of the current theme.

### theme_url variable

The `{{ theme_url }}` returns the relative URL to the current theme.

!! When linking to assets like images or JavaScript and CSS files, it's recommended to use the `url()` function in combination with the `theme://` stream as described on the [Twig Filters & Functions](/themes/twig-filters-functions#url) page. For JavaScript and CSS, the [Asset Manager](/themes/asset-manager) is even easier to use but in some cases like dynamic or conditional loading of assets, it will not work.

### html_lang variable

The `{{ html_lang }}` returns the active language.

### language_codes variable

The `{{ language_codes }}` returns list of available languages of the site.

[version=16,17]
### assets object

**Asset Manager** adds an easy way to manage CSS and JavaScript in your site.

[prism classes="language-twig"]
{% do assets.addCss('theme://css/foo.css') %}
{% do assets.addInlineCss('a { color: red; }') %}
{% do assets.addJs('theme://js/something.js') %}
{% do assets.addInlineJs('alert("Warming!");') %}
[/prism]

Read more about [Asset Manager](/themes/asset-manager).

! **TIP:** It is recommended to use **[styles tag](/themes/twig-tags#css-styles)** and **[script tag](/themes/twig-tags#scripts)** instead.
[/version]

### config object

You can access any Grav configuration setting set in the YAML-files in `/user/config` via the `config`-object. For example:

[prism classes="language-twig"]
{{ config.system.pages.theme }}{# returns the currently configured theme #}
[/prism]

### site object

An alias to the `config.site` object. This represents the configuration as set in the `site.yaml` file.

### system object

An alias to the `config.system` object. This represents the configuration in the main `system.yaml` file.

### theme object

An alias to the `config.theme` object. This represents the configuration for the current active theme. Plugin settings are available through `config.plugins`.

### page object

Because Grav is built using the structure defined in the `pages/` folder, each page is represented by a **page object**.

The **page object** is probably _the_ most important object you will work with as it contains all the information about the current page you are currently on.

!! The whole list of the Page object methods is available on the [API site](https://learn.getgrav.org/api#class-gravcommonpagepage). Here's a list of the methods you'll find most useful.

##### summary([size])

This returns a truncated or shortened version of your content.  You can provide an optional `size` parameter to specify the maximum length of the summary, in characters.  Alternatively, if no size is provided, the value can be obtained via the site-wide variable `summary.size` from your `site.yaml` configuration.

[prism classes="language-twig"]
{{ page.summary|raw }}
[/prism]

or

[prism classes="language-twig"]
{{ page.summary(50)|raw }}
[/prism]

A third option is to use a manual delimiter of `===` in your content.  Anything before the delimiter will be used for the summary.

##### content()

This returns the entire HTML content of your page.

[prism classes="language-twig"]
{{ page.content|raw }}
[/prism]

##### header()

This returns the page headers as defined in the YAML front-matter of the page.  For example a page with the following headers:

[prism classes="language-yaml line-numbers"]
title: My Page
author: Joe Bloggs
[/prism]

could be used:

[prism classes="language-twig"]
The author of this page is: {{ page.header.author|e }}
[/prism]

##### media()

This returns a **Media** object containing all the media associated with a page. These include **images**, **videos**, and other **files**.  You can access media methods as described in the [media documentation](../../content/media) for content. Because it acts as an array, Twig filters and functions can be used. Note: SVG images are treated as files, not images, because they can not be manipulated using twig image filters.

Get a specific file or image:

[prism classes="language-twig"]
{% set my_pdf = page.media['myfile.pdf'] %}
[/prism]

Get the first image:

[prism classes="language-twig"]
{% set first_image = page.media.images|first %}
[/prism]

Loop over all images and output the HTML tag to display it:

[prism classes="language-twig"]
{% for image in page.media.images %}
   {{ image.html|raw }}
{% endfor %}
[/prism]

##### title()

This returns the title of the page as set in the `title` variable of the YAML headers for the page itself.

[prism classes="language-yaml"]
title: My Page
[/prism]

##### menu()

This returns the value of the `menu` variable of the YAML headers of the page.  If none is provided, it defaults to the `title`.

[prism classes="language-yaml line-numbers"]
title: My Page
menu: my-page
[/prism]

##### visible()

This returns whether or not the page is visible.  By default pages with numeric value followed by a period are visible by default (`01.somefolder1`) while those without (`subfolder2`) are not considered visible. This can be overridden in the page headers:

[prism classes="language-yaml line-numbers"]
title: My Page
visible: true
[/prism]

##### routable()

This returns whether or not a page is routable by Grav.  This means if you can point your browser to the page and receive content back.  Non-routable pages can be used in templates, plugins, etc, but cannot be reached directly. This can be set in the page headers:

[prism classes="language-yaml line-numbers"]
title: My Page
routable: true
[/prism]

##### slug()

This returns the direct name as displayed in the URL for this page, for example `my-blog-post`.

##### url([include_host = false])

This returns the URL to the page, for example:

[prism classes="language-twig"]
{{ page.url|e }} {# could return /my-section/my-category/my-blog-post #}
[/prism]

or

[prism classes="language-twig"]
{{ page.url(true)|e }} {# could return http://mysite.com/my-section/my-category/my-blog-post #}
[/prism]

##### permalink()

This returns the URL with host information. Particularly useful when needing a quick link that can be accessed from anywhere.

##### canonical()

This returns the URL that is the 'preferred' version or link to a particular page.  This value will default to the regular URL unless the page has overridden the `canonical:` page header option.

##### route()

This returns the internal routing for a page.  This is primarily used for internal routing and dispatching of pages.

##### home()

This returns `true` or `false` based on whether or not this page is configured as the **home** page.  This setting is found in the `system.yaml` file.

##### root()

This returns `true` or `false` based on whether or not this page is the root page of the tree hierarchy.

##### active()

This returns `true` or `false` based on whether or not this page is currently the page your browser is accessing.  This is particularly useful in navigation to know if the page you are on is the active page.

##### modular()

This returns `true` or `false` based on whether or not this page is modular.

##### activeChild()

This returns whether or not this URI's URL contains the URL of the active page. Or in other words, is this page's URL in the current URL. Again this is useful when building your navigation and you wish to know if the page you are iterating over is the parent of an active child page.

##### find(url)

This returns a page object as specified by a route URL.

[prism classes="language-twig"]
{% include 'modular/author-detail.html.twig' with {'page': page.find('/authors/billy-bloggs')} %}
[/prism]

##### collection()

This returns the collection of pages for this context as determined by the [collection page headers](../../content/collections).

[prism classes="language-twig line-numbers"]
{% for child in page.collection %}
    {% include 'partials/blog_item.html.twig' with {'page':child, 'truncate':true} %}
{% endfor %}
[/prism]

##### currentPosition()

This returns the index of the current page in relation to its siblings.

##### isFirst()

This returns `true` or `false` based on whether this page is the first of its siblings.

##### isLast()

This returns `true` or `false` based on whether this page is the last of its siblings.

##### nextSibling()

This returns the next page from the array of siblings based on the current position.

##### prevSibling()

This returns the previous page from the array of siblings based on the current position.

!! nextSibling() and prevSibling() order pages in a stack-like structure. It works best in a blog situation, where the first blog post has nextSibling null and prevSibling is the previous blog post. If this ordering direction confuses you, we suggest using page.adjacentSibling(-1) to point to the next page instead of page.nextSibling() to reduce the confusion that the terminology might make. You can also define a constant in the theme and use that for better readability, like page.adjacentSibling(NEXT_PAGE)

##### children()

This returns an array of child pages for the page as defined in the pages content structure.

##### orderBy()

This returns the order type for any sorted children of the page. Values typically include: `default`, `title`, `date` and `folder`. This value is typically configured in page headers.

##### orderDir()

This returns the order direction for any sorted children of the page.  Values can be either `asc` for ascending or `desc` for descending. This value is typically configured in page headers.

##### orderManual()

This returns an array of manual page ordering for any children of the page. This value is typically configured in page headers.

##### maxCount()

This returns the maximum number of children pages that are allowed to be returned. This value is typically configured in page headers.

##### children.count()

This returns the number of child pages of the page.

##### children.current()

This returns the current child item.  Can be used while iterating over the children.

##### children.next()

This returns the next child in the array of children.

##### children.prev()

This returns the previous child in the array of children.

##### children.nth(position)

This returns the child identified by the `position` which is an integer from `0` to `children.count() - 1` in the array of children.

##### children.sort(orderBy, orderDir)

Reorders the children based on an **orderBy** (`default`, `title`, `date` and `folder`) and **orderDir** (`asc` or `desc`)

##### parent()

This returns the parent page object for this page. This is very useful when you need to navigate back up the nested tree structure of pages.



##### isPage()

This returns `true` or `false` based on whether this page has an actual `.md` file associated with it rather than just a folder for routing.

##### isDir()

This returns `true` or `false` based on whether this page is only a folder for routing.

##### id()

This returns a unique identifier for the page.

##### modified()

This returns a timestamp of when the page was last modified.

##### date()

This returns the date timestamp for the page.  Typically this is set in the headers to represent the date of a page or post.  If no value is defined explicitly, the file modified timestamp is used.

##### template()

This returns the name of the page template without the `.md` extension. For example `default`

##### filePath()

This returns the full file path of the page. For example `/Users/yourname/sites/grav/user/pages/01.home/default.md`

##### filePathClean()

This returns the relative path from the root of the Grav site.  For example `user/pages/01.home/default.md`

##### path()

This returns the full path to the directory containing the page.  For example `/Users/yourname/sites/grav/user/pages/01.home`

##### folder()

This returns the name of the folder for the page.  For example `01.home`

##### taxonomy()

This returns an array of the taxonomy associated with a page.  These can be iterated over. This is particularly useful for displaying items such as tags:

[prism classes="language-twig line-numbers"]
{% for tag in page.taxonomy.tag %}
    <a href="search/tag:{{ tag }}">{{ tag }}</a>
{% endfor %}
[/prism]

### pages object

The **pages** object is the root page which represents a nested tree of every **page** object that Grav knows about. This is particularly useful for creating a sitemap, navigation, or if you wish to find a particular **page**.

!! This object is not the same as `grav.pages` which is an instance of `Pages` class.

##### children method

This returns the immediate child pages as an array of **page objects**. As the pages object represents the entire tree, you can fully recurse over every page in the Grav pages/ folder.

Get the top-level pages for a simple menu:

[prism classes="language-twig line-numbers"]
<ul class="navigation">
    {% for page in pages.children %}
        {% if page.visible %}
            <li><a href="{{ page.url }}">{{ page.menu }}</a></li>
        {% endif %}
    {% endfor %}
</ul>
[/prism]

### media object

There is a new object that allows you to access [media](../../content/media) that is outside of Page objects via PHP streams from Twig. This works in a similar manner to [image linking in content](../../content/image-linking#php-streams) by using streams to access images, and media processing to manipulate theme.

[prism classes="language-twig"]
{{ media['user://media/bird.png'].resize(50, 50).rotate(90).html()|raw }}
[/prism]

### uri object

!! The whole list of the Uri object methods is available on the [API site](https://learn.getgrav.org/api#class-gravcommonuri). Here's a list of the methods you'll find most useful.

The Uri object has several methods to access parts of the current URI. For the full URL `http://mysite.com/grav/section/category/page.json/param1:foo/param2:bar/?query1=baz&query2=qux`:

##### path()

This returns the path portion of the URL: (e.g. `uri.path` = `/section/category/page`)

##### paths()

This returns the array of path elements: (e.g. `uri.paths` = `[section, category, page]`)

##### route([absolute = false][, domain = false])

This returns the route as either an absolute or relative URL.  (e.g. `uri.route(true)` = `http://mysite.com/grav/section/category/page` or `uri.route()` = `/section/category/page`)

##### params()

This returns the params portion of the URL: (e.g. `uri.params` = `/param1:foo/param2:bar`)

##### param(id)

This returns the value of a particular param.  (e.g. `uri.param('param1')` = `foo`)

##### query()

This returns the query portion of the URL: (e.g. `uri.query` = `query1=bar&query2=qux`)

##### query(id)

You can also retrieve specific query items: (e.g. `uri.query('query1')` = `bar`)

##### url([include_host = true])

This returns the full URL with or without the host.  (e.g. `uri.url(false)` = `grav/section/category/page/param:foo?query=bar`)

##### extension()

This returns the extension, or will return `html` if not provided: (e.g. `uri.extension` = `json`)

##### host()

This returns the host portion of the URL. (e.g. `uri.host` = `mysite.com`)

##### base()

This returns the base portion of the URL. (e.g. `uri.base` = `http://mysite.com`)

##### rootUrl([include_host = false])

This returns the root url to the grav instance.  (e.g. `uri.rootUrl()` = `http://mysite.com/grav`)

##### referrer()

This returns the referrer information for this page.

### header object

The header object is an alias for `page.header()` of the original page.  It's a convenient way to access the original page headers when you are looping through other `page` objects of child pages or collections.

### content string

The content object is an alias for the `page.content()` of the original page.

To display page content you should:

[prism classes="language-twig"]
{{ content|raw }}
[/prism]

### taxonomy object

The global Taxonomy object that contains all the taxonomy information for the site. For more information, see [Taxonomy](/content/taxonomy).

### browser object

!! The whole list of the Browser object methods is available on the [API site](https://learn.getgrav.org/api#class-grav-common-browser). Here's a list of the methods you'll find most useful.

Grav has built-in support for programmatically determining the platform, browser, and version of the user.

[prism classes="language-twig"]
{{ browser.platform|e }}   # macintosh
{{ browser.browser|e }}    # chrome
{{ browser.version|e }}    # 41
[/prism]

### user object

You can access the current logged in user object indirectly via the Grav object.  This allows you to access such data as `username`, `fullname`, `title`, and `email`:

[prism classes="language-twig"]
{{ grav.user.username|e }}  # admin
{{ grav.user.fullname|e }}  # Billy Bloggs
{{ grav.user.title|e }}     # Administrator
{{ grav.user.email|e }}     # billy@bloggs.com
[/prism]

## Adding Custom Variables

You can easily add custom variables in a variety of ways.  If the variable is a site-wide variable, you can put the variable in your `user/config/site.yaml` file and then access it via:

[prism classes="language-twig"]
{{ site.my_variable|e }}
[/prism]

Alternatively, if the variable is only needed for a particular page, you can add the variable to your page's YAML front-matter, and access it via the `page.header` object.  For example:

[prism classes="language-twig"]
title: My Page
author: Joe Bloggs
[/prism]

could be used as:

[prism classes="language-twig"]
The author of this page is: {{ page.header.author|e }}
[/prism]

## Adding Custom Objects

An advanced way to add custom objects is to use a plugin to add objects to the Twig object.  This is an advanced topic and is covered in more detail in the [plugins chapter](../../plugins/event-hooks).

---

## Configuration

> Path: grav-learn/pages/03.themes/07.asset-manager/docs.15.md


A new feature introduced in Grav 0.9.0 was the **Asset Manager** to unify the interface throughout Grav for adding and managing **CSS** and **JavaScript**.  The primary purpose of the Asset Manager is to simplify the process of adding assets from themes and plugins while providing enhanced capabilities such as ordering, and providing an **Asset Pipeline** that can be used to **minify**, **compress** and **inline** assets to reduce the number of browser requests, and also the overall size of the assets.

The Asset Manager is just a class that is available throughout Grav via the plugin event hooks, but also directly in themes via Twig calls.

## Configuration

The Grav Asset Manager has a simple set of configuration options.  The default values are located in the system `system.yaml` file, but you can override any or all of them in your `user/config/system.yaml` file:

[prism classes="language-yaml line-numbers"]
assets:                                # Configuration for Assets Manager (JS, CSS)
  css_pipeline: false                  # If true, enables the CSS pipeline, combining multiple CSS resources into one
  css_pipeline_include_externals: true # Include external CSS resources from the pipeline
  css_pipeline_before_excludes: true   # Renders pipelined CSS resources before non-pipelined CSS resources
  css_minify: true                     # Minify the CSS during pipelining
  css_minify_windows: true             # If false, blocks minifying on Windows servers
  css_rewrite: true                    # Rewrite any CSS relative URLs during pipelining
  js_pipeline: false                   # If true, enables the JS pipeline, combining multiple JS resources into one
  js_pipeline_include_externals: true  # Include external JS resources from the pipeline
  js_pipeline_before_excludes: true    # Renders pipelined JS resources before non-pipelined JS resources
  js_minify: true                      # Minify the JS during pipelining
  enable_asset_timestamp: false        # If true, adds a URL query parameter to each asset link for cache invalidation
[/prism]

## Assets in Themes

### Overview

In general, you add CSS assets one by one using `assets.add*()` calls, then render those assets via `assets.css()`. Options controlling ordering, pipelining or inlining can be specified per asset when adding it, or at rendering time for a group of assets.

JS assets are handled likewise.

The Asset Manager also supports
* adding assets to named groups in order to render such groups at different places and/or with different sets of options,
* configuring named asset collections, which can be added in one `assets.add*()` call.

### Example

An example of how you can add CSS files in your theme can be found in the default **antimatter** theme that comes bundled with Grav. If you have a look at the `base.html.twig` partial and specifically the [stylesheets block](https://github.com/getgrav/grav-theme-antimatter/blob/develop/templates/partials/base.html.twig#L12-L28) you will see the following:

[prism classes="language-twig line-numbers"]
{% block stylesheets %}
    {% do assets.addCss('theme://css/pure-0.5.0/grids-min.css', 103) %}
    {% do assets.addCss('theme://css-compiled/nucleus.css',102) %}
    {% do assets.addCss('theme://css-compiled/template.css',101) %}
    {% do assets.addCss('theme://css/custom.css',100) %}
    {% do assets.addCss('theme://css/font-awesome.min.css',100) %}
    {% do assets.addCss('theme://css/slidebars.min.css') %}

    {% if browser.getBrowser == 'msie' and browser.getVersion == 10 %}
        {% do assets.addCss('theme://css/nucleus-ie10.css') %}
    {% endif %}
    {% if browser.getBrowser == 'msie' and browser.getVersion >= 8 and browser.getVersion <= 9 %}
        {% do assets.addCss('theme://css/nucleus-ie9.css') %}
        {% do assets.addJs('theme://js/html5shiv-printshiv.min.js') %}
    {% endif %}
{% endblock %}
{{ assets.css()|raw }}
[/prism]

The `block` twig tag just defines a region that can be replaced or appended to in templates that extend the one. Within the block, you will see a number of `do assets.addCss()` calls.

The `{% do %}` tag is actually [one built in to Twig](https://twig.symfony.com/doc/1.x/tags/do.html) itself, and it lets you manipulate variables without generating any output.

The `addCss()` method adds CSS assets to the Asset Manager. If you specify a second numeric parameter, that sets the priority of the stylesheet. In this case we want `grids-min.css` to be first as it has the highest priority value.  You will notice the use of a **PHP stream wrapper** `theme://` to provide an easy way for Grav to determine the current theme's relative path.

The `assets.css()` call renders the CSS assets out as HTML tags.

JavaScript assets are very similar:

[prism classes="language-js line-numbers"]
{% block javascripts %}
    {% do assets.addJs('jquery',101) %}
    {% do assets.addJs('theme://js/modernizr.custom.71422.js',100) %}
    {% do assets.addJs('theme://js/antimatter.js') %}
    {% do assets.addJs('theme://js/slidebars.min.js') %}
    {% do assets.addInlineJs('alert(\'This is inline!\')') %}
{% endblock %}
{{ assets.js()|raw }}
[/prism]

## Adding Assets

#### add(asset, [options])

The add method does its best attempt to match an asset based on file extension.  It is a convenience method, it's better to call one of the direct methods for CSS or JS.  See the direct methods for details.

!! The options array is the preferred approach for passing multiple options. However as in the previous examples, you can use a shortcut and pass in an integer for the **second argument** in the method if all you wish to set is the **priority**.

#### addCss(asset, [options])

This method will add assets to the list of CSS assets.  The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.  The `pipeline` option controls whether or not this asset should be included in the combination/minify pipeline. If not pipelined, the `loading` option controls whether the asset should be rendered as a link to an external stylesheet or whether its contents should be inlined inside an inline style tag.

#### addDirCss(directory)

Add an entire directory of CSS assets in one go. The order will be alphabetical. This method does not provide the control of the individual methods and is generally not the preferred approach.

#### addInlineCss(css, [options])

Lets you add a string of CSS inside an inline style tag. Useful for initialization or anything dynamic.  To inline a regular asset file's content, see the `{'loading': 'inline'}` option of the `addCss()` and `css()` methods.

#### addJs(asset, [options])

This method will add assets to the list of JavaScript assets.  The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.  The `pipeline` option controls whether or not this asset should be included in the combination/minify pipeline. If not pipelined, the `loading` option controls whether the asset should be rendered as a link to an external script file or whether its contents should be inlined inside an inline script tag.

#### addInlineJs(javascript, [options])

Lets you add a string of JavaScript inside an inline script tag. Useful for initialization or anything dynamic.  To inline a regular asset file's content, see the `{'loading': 'inline'}` option of the `addJs()` and `js()` methods.

#### addDirJs(directory)

Add an entire directory of JavaScript assets in one go. The order will be alphabetical. This method does not provide the control of the individual methods and is generally not the preferred approach.

#### registerCollection(name, array)

Allows you to register an array of CSS and JavaScript assets with a name for later use by the `add()` method. Particularly useful if you want to register a collection that may be used by multiple themes or plugins, such as jQuery or Bootstrap.

## Options

Where appropriate, you can pass in an array of asset options. Those options are

#### For CSS

* **priority**: Integer value (default value is `10`)

* **pipeline**: `false` if this asset should **not** be included in pipeline (default is `true`)

* **loading**: `inline` if this asset should be inlined (default: referenced via a stylesheet link)

    effective only if `pipeline` is set to `false`, as pipeline inlining is controlled via the `loading` option of the `css()` rendering method

* **media**: a media query such as `only screen and (min-width: 640px)`

#### For JS

* **priority**: Integer value (default value is `10`)

* **pipeline**: `false` if this asset should **not** be included in pipeline (default is `true`)

* **loading**: supports empty, `async`, `defer`, `async defer` or `inline`

    effective only if `pipeline` is set to `false`, as pipeline inlining is controlled via the `loading` option of the `js()` rendering method

* **group**: string to specify a unique group name for asset (default is `head`)

for example:

[prism classes="language-twig"]
{% do assets.addJs('theme://js/example.js', {'priority':102, 'pipeline':false, 'loading':'async', 'group':'bottom'}) %}
[/prism]

## Rendering Assets

The following allow you to render the current state of the CSS and JavaScript assets.

#### css([group, [options]])

Renders CSS assets that have been added to an Asset Manager's group (default is `head`). Options are

* **loading**: `inline` if **all** assets in this group should be inlined (default: render each asset according to its `loading` option and do not inline the pipeline, if present)

* **_link attributes_**, see below (default: `{'type': 'text/css', 'rel': 'stylesheet'}`)

    effective only if `inline` is **not** used as this group's rendering option

If pipelining is turned **off** in the configuration, the group's assets are rendered individually, ordered by asset priority (high to low), followed by the order in which assets were added.

If pipelining is turned **on** in the configuration, assets not excluded from pipelining are combined in the order in which assets were added, then processed according to the pipeline configuration. The combined pipeline result is then rendered before or after non-pipelined assets depending on the setting of `css_pipeline_before_excludes`.

Each asset is rendered either as a stylesheet link or inline, depending on the asset's `loading` option and whether `{'loading': 'inline'}` is used for this group's rendering. Note that the only way to inline a CSS pipeline is to use inline loading as an option of the `css()` method.

CSS added by addInlineCss() is always rendered last.

#### js([group, [options]])

Renders JavaScript assets that have been added to an Asset Manager's group (default is `head`). Options are

* **loading**: `inline` if **all** assets in this group should be inlined (default: render each asset according to its `loading` option and do not inline the pipeline, if present)

* **_script attributes_**, see below (default: `{'type': 'text/javascript'}`)

    effective only if `inline` is **not** used as this group's rendering option

If pipelining is turned **off** in the configuration, the group's assets are rendered individually, ordered by asset priority (high to low), followed by the order in which assets were added.

If pipelining is turned **on** in the configuration, assets not excluded from pipelining are combined in the order in which assets were added, then processed according to the pipeline configuration. The combined pipeline result is then rendered before or after non-pipelined assets depending on the setting of `js_pipeline_before_excludes`.

Each asset is rendered either as a script link or inline, depending on the asset's `loading` option and whether `{'loading': 'inline'}` is used for this group's rendering. Note that the only way to inline a JS pipeline is to use inline loading as an option of the `js()` method.

JavaScript added by addInlineJs() is always rendered last.

## Named Assets

Grav now has a powerful feature called **named assets** that allows you to register a collection of CSS and JavaScript assets with a name.  Then you can simply **add** those assets to the Asset Manager via the name you registered the collection with.  Grav comes preconfigured with **jQuery** but has the ability to define custom collections in the `system.yaml` to be used by any theme or plugin:

[prism classes="language-yaml line-numbers"]
assets:
  collections:
    jquery: system://assets/jquery/jquery-2.1.3.min.js
    bootstrap:
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js
[/prism]

You can also use the `registerCollection()` method programmatically.

[prism classes="language-yaml line-numbers"]
$assets = $this->grav['assets'];
$bootstrapper_bits = ['https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css',
                      'https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css',
                      'https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js'];
$assets->registerCollection('bootstrap', $bootstrap_bits);
$assets->add('bootstrap', 100);
[/prism]

An example of this action can be found in the [**bootstrapper** plugin](https://github.com/getgrav/grav-plugin-bootstrapper/blob/develop/bootstrapper.php#L51-L71).

## Grouped Assets

A new feature was added in Grav **0.9.43** that lets you pass an optional `group` as part of an options array when adding assets.  This is useful for CSS, but especially for  JavaScript where you may need to have some JS files or Inline JS referenced in the header, and some at the bottom of the page.  Prior to this Grav release, this was not possible using the Asset manager, but it is now.

To take advantage of this capability you must specify the group when adding the asset, and should use the options syntax:

[prism classes="language-twig line-numbers"]
{% do assets.addJs('theme://js/example.js', {'priority':102, 'group':'bottom'}) %}
[/prism]

Then for these assets in the bottom group to render, you must add the following to your theme:

[prism classes="language-twig"]
{{ assets.js('bottom') }}
[/prism]

If no group is defined for an asset, then `head` is the default group.  If no group is set for rendering, the `head` group will be rendered. This ensures the new functionality is 100% backwards compatible with existing themes.

The same goes for CSS files:

[prism classes="language-twig"]
{% do assets.addCss('theme://css/ie8.css', {'group':'ie'}) %}
[/prism]

and to render:


[prism classes="language-twig"]
{{ assets.css('ie') }}
[/prism]

## Change attribute of the rendered CSS/JS assets

CSS is by default added using the `rel="stylesheet"` attribute, and `type="text/css"` , while JS has `type="text/javascript"`.

To change the defaults, or to add new attributes, you need to create a new group of assets, and tell Grav to render it with that attribute.

Example of editing the `rel` attribute on a group of assets:

[prism classes="language-twig"]
{% do assets.addCSS('theme://whatever.css', {'group':'my-alternate-group'}) %}
...
{{ assets.css('my-alternate-group', {'rel': 'alternate'}) }}
[/prism]

## Inlining Assets

The ability to inline CSS and JS assets was added in Grav **1.2.1**. Placing critical CSS (and JS) code directly into the HTML document enables the browser to render a page immediately without waiting for external stylesheet or script downloads. This can improve site performance noticeably for users, particularly over mobile networks. Details can be found in [this article on optimizing CSS delivery](https://developers.google.com/speed/docs/insights/OptimizeCSSDelivery).

However, directly inserting CSS or JavaScript code into a page template is not always feasible, for example, where Sass-complied CSS is used. Keeping CSS and JS assets in separate files also simplifies maintenance. Using the Asset Manager's inline capability enables you to optimize for speed without changing the way your assets are stored. Even entire pipelines can be inlined.

To inline an asset file's content, use the option `{'loading': 'inline'}` with `addCss()` or `addJs()`. You can also inline all assets when rendering a group with `js()` or `css()`, which provide the same option.

Example of using `system.yaml` to define asset collections named according to asset loading requirements, with `app.css` being a [Sass](http://sass-lang.com/)-generated CSS file:

[prism classes="language-yaml line-numbers"]
assets:
  collections:
    css-inline:
      - 'http://fonts.googleapis.com/css?family=Ubuntu:400|Open+Sans:400,400i,700'
      - 'theme://css-compiled/app.css'
    js-inline:
      - 'https://use.fontawesome.com/<embedcode>.js'
    js-async:
      - 'theme://foundation/dist/assets/js/app.js'
      - 'theme://js/header-display.js'
[/prism]

The template inserts each collection into its corresponding group, namely `head` and `head-link` for CSS, `head` and `head-async` for JS. The default group `head` is used for inline loading in each case:

[prism classes="language-twig line-numbers"]
        {% block stylesheets %}
            {% do assets.addCss('css-inline') %}
            {% do assets.addCss('css-link', {'group': 'head-link'}) %}
        {% endblock %}
        {{ assets.css('head-link') }}
        {{ assets.css('head', {'loading': 'inline'}) }}
        {% block javascripts %}
            {% do assets.addJs('js-inline') %}
            {% do assets.addJs('js-async', {'group': 'head-async'}) %}
        {% endblock %}
        {{ assets.js('head-async', {'loading': 'async'}) }}
        {{ assets.js('head', {'loading': 'inline'}) }}
[/prism]

## Static Assets

Sometimes there is a need to reference assets without using the Asset Manager.  There is a `url()` helper method available to achieve this.  An example of this could be if you wanted to reference an image from the theme. The syntax for this is:

[prism classes="language-twig"]
<img src="{{ url("theme://" ~ widget.image) }}" alt="{{ widget.text|e }}" />
[/prism]

The `url()` method takes an optional second parameter of `true` or `false` to enable the URL to include the schema and domain. By default this value is assumed `false` resulting in just the relative URL.  For example:

[prism classes="language-twig"]
url("theme://some/extra.css", true)
[/prism]

---

## Configuration

> Path: grav-learn/pages/03.themes/07.asset-manager/docs.16.md


In Grav 1.6, the **Asset Manager** has been completely rewritten to provide a more flexible mechanism for managing **CSS** and **JavaScript** assets in themes. The primary purpose of the Asset Manager is to simplify the process of adding assets from themes and plugins while providing enhanced capabilities such as priority, and providing an **Asset Pipeline** that can be used to **minify**, **compress** and **inline** assets to reduce the number of browser requests, and also the overall size of the assets.

It's much more flexible and more reliable than before. Also it's considerably 'cleaner' and easier to follow if you start poking through the code. The Asset Manager is available throughout Grav and can be accessed in plugin event hooks, but also directly in themes via Twig calls.

! **Technical Details**: The primary Assets class has been greatly simplified and reduced. Much of the logic has been broken out into 3 traits. A _testing trait_ which contains functions primarily used in our test suite, a _utils trait_ which contains methods that are shared between regular asset types (js, inline_js, css, inline_css) and the assets pipeline which can minify and compress, and lastly a _legacy trait_ which contains methods that are shortcuts or workarounds, and should generally not be used going forward.

!!! The Asset manager is fully backwards compatible with syntax used in versions prior to Grav 1.6, however, the documentation below will cover the new **preferred syntax**.

## Configuration

The Grav Asset Manager has a simple set of configuration options.  The default values are located in the system `system.yaml` file, but you can override any or all of them in your `user/config/system.yaml` file:

[prism classes="language-yaml line-numbers"]
assets:                                        # Configuration for Assets Manager (JS, CSS)
  css_pipeline: false                          # The CSS pipeline is the unification of multiple CSS resources into one file
  css_pipeline_include_externals: true         # Include external URLs in the pipeline by default
  css_pipeline_before_excludes: true           # Render the pipeline before any excluded files
  css_minify: true                             # Minify the CSS during pipelining
  css_minify_windows: false                    # Minify Override for Windows platforms, also applies to js. False by default due to ThreadStackSize
  css_rewrite: true                            # Rewrite any CSS relative URLs during pipelining
  js_pipeline: false                           # The JS pipeline is the unification of multiple JS resources into one file
  js_pipeline_include_externals: true          # Include external URLs in the pipeline by default
  js_pipeline_before_excludes: true            # Render the pipeline before any excluded files
  js_module_pipeline: false                    # The JS Module pipeline is the unification of multiple JS Module resources into one file
  js_module_pipeline_include_externals: true   # Include external URLs in the pipeline by default
  js_module_pipeline_before_excludes: true     # Render the pipeline before any excluded files
  js_minify: true                              # Minify the JS during pipelining
  enable_asset_timestamp: false                # Enable asset timestamps
  collections:
    jquery: system://assets/jquery/jquery-2.x.min.js
[/prism]

## Structure

There are multiple levels of positioning control as outlined in the diagram below.  In order of scope they are:

* **Group** - allows the grouping of assets such as `head`(default) and `bottom`
* **Position** - `before`, `pipeline`(default), and `after`.  Basically this allows you to specify where in the group the asset should be loaded.
* **Priority** - This controls the **order**, where larger integers (e.g. `100`) will be output before lower integers. `10` is default.

[prism classes="language-text"]
 CSS

 Group (head)          
        
 Position                       priority 100        
                    CSS        
                              priority 99         
      before            
                              priority 1         
                inline CSS    
                              priority 0         
     pipeline           
                     
  
                     
       after       
                   





JS

 Group (head)          
        
 Position                       priority 100        
                     JS        
                              priority 99         
      before            
                              priority 1         
                inline JS     
                              priority 0         
     pipeline           
                     
  
                     
       after       
                   






JS Module

 Group (head)          
        
 Position                       priority 100        
                     JS Module        
                              priority 99         
      before            
                              priority 1         
                inline JS Module     
                              priority 0         
     pipeline           
                     
  
                     
       after       
                   



[/prism]

By defaults, `CSS`, `JS` and `JS Module` default to display in the `pipeline` position when they are output.  While `InlineCSS`, `InlineJS` and `Inline JS Module` default to be in the `after` position.  This is configurable though, and you can set any asset to be in any position.

## Assets in Themes

### Overview

In general, you add CSS assets one by one using `assets.addCss()` or `assets.addInlineCss()` calls, then render those assets via `assets.css()`. Options controlling priority, pipelining or inlining can be specified per asset when adding it, or at rendering time for a group of assets.

JS assets are handled similarly with `assets.addJs()` and `assets.addInlineJs()` calls. There is also a generic `assets.add()` method that tries to guess the type of asset you are adding, but it is recommended to use the more specific method calls.

Since version 1.7.27, Grav's Assets Manager also supports JS Modules. These assets work exactly like JS assets but their type is `type="module"` and they are handled with `assets.addJsModule()` and `assets.addInlineJsModule()` calls. The generic `assets.add()` method will only fallback to JS Module if the extension detected is `.mjs`. Otherwise, any `.js` file will be treated as regular JS.

! To learn more about JS Modules
! * [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules?target=_blank)
! * [https://v8.dev/features/modules](https://v8.dev/features/modules?target=_blank)
! * [https://javascript.info/modules-intro](https://javascript.info/modules-intro?target=_blank)

The Asset Manager also supports:

* adding assets to named groups in order to render such groups at different places and/or with different sets of options,
* configuring named asset collections, which can be added in a single `assets.add*()` call.

### Example

An example of how you can add CSS files in your theme can be found in the default **quark** theme that comes bundled with Grav. If you have a look at the [`templates/partials/base.html.twig`](https://github.com/getgrav/grav-theme-quark/blob/develop/templates/partials/base.html.twig) partial, you will see something similar to the following:

[prism classes="language-twig line-numbers"]
<!DOCTYPE html>
<html>
    <head>
    ...

    {% block stylesheets %}
        {% do assets.addCss('theme://css-compiled/spectre.css') %}
        {% do assets.addCss('theme://css-compiled/theme.css') %}
        {% do assets.addCss('theme://css/custom.css') %}
        {% do assets.addCss('theme://css/line-awesome.min.css') %}
    {% endblock %}

    {% block javascripts %}
        {% do assets.addJs('jquery', 101) %}
        {% do assets.addJs('theme://js/jquery.treemenu.js', { group: 'bottom' }) %}
        {% do assets.addJs('theme://js/site.js', { group: 'bottom' }) %}
        {% do assets.addJsModule('plugin://my_plugin/app/main.js', { group: 'bottom' }) %}
    {% endblock %}

    {% block assets deferred %}
        {{ assets.css()|raw }}
        {{ assets.js()|raw }}
    {% endblock %}
    </head>

    <body>
    ...

    {% block bottom %}
        {{ assets.js('bottom')|raw }}
    {% endblock %}
    </body>
</html>
[/prism]

The `block stylesheets` twig tag just defines a region that can be replaced or appended to in templates that extend the one. Within the block, you will see a number of `do assets.addCss()` calls.

The `{% do %}` tag is actually [one built in to Twig](https://twig.symfony.com/doc/1.x/tags/do.html) itself, and it lets you manipulate variables without generating any output.

The `addCss()` method adds CSS assets to the Asset Manager. If you specify a second numeric parameter, that sets the priority of the stylesheet. If you do not specify a priority, the priority that the assets are added will dictate the order they are rendered.  You will notice the use of a **PHP stream wrapper** `theme://` to provide an easy way for Grav to determine the current theme's relative path.

!! The `assets.addJs('jquery', 101)` will include the `jquery` collection defined in the global Assets configuration. The optional param here of `101` sets the priority to be quite high to ensure it renderes first.  The default priority when not provided is a value of `10`. A more flexible way of writing this would be `assets.addJs('jquery', {priority: 101})`.  This allows you to add other parameters alongside the priority.

The `assets.css()|raw` call renders the CSS assets as HTML tags. As there is no parameter supplied to this method, the group is by default set to `head`. Note how this is wrapped in an `assets deferred` block.  This is a new feature in Grav 1.6 that allows you to add assets from other Twig templates that are included further down the page (or anywhere really), and still ensure that they can render in this `head` block if required.

The `bottom` block at the very end of your theme output, renders JavaScript that has been assigned to the `bottom` group.

## Adding Assets

#### add(asset, [options])

The add method does its best attempt to match an asset based on file extension.  It is a convenience method, it's better to call one of the direct methods for CSS, Link, JS and JS Module.  See the direct methods for details.

!! The options array is the preferred approach for passing multiple options. However, as in the previous example with `jquery`, you can use a shortcut and pass in an integer for the **second argument** in the method if all you wish to set is the **priority**.

#### addCss(asset, [options])

This method will add assets to the list of CSS assets.  The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.  The `pipeline` option controls whether this asset should be included in the combination/minify pipeline. If not pipelined, the `loading` option controls whether the asset should be rendered as a link to an external stylesheet or whether its contents should be inlined inside an inline style tag.

#### addLink($asset, [options])

This method will add assets to the of Link assets, in the form of `<link>` tag. It is useful for adding link tags to the head from anywhere in your site that are not CSS files. The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.

Differently than the other methods for adding assets, `link()` does not support pipelining, nor does support `inline`.

#### addInlineCss(css, [options])

Lets you add a string of CSS inside an inline style tag. Useful for initialization or anything dynamic.  To inline a regular asset file's content, see the `{ 'loading': 'inline' }` option of the `addCss()` and `css()` methods.

#### addJs(asset, [options])

This method will add assets to the list of JavaScript assets.  The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.  The `pipeline` option controls whether this asset should be included in the combination/minify pipeline. If not pipelined, the `loading` option controls whether the asset should be rendered as a link to an external script file or whether its contents should be inlined inside an inline script tag.

#### addInlineJs(javascript, [options])

Lets you add a string of JavaScript inside an inline script tag. Useful for initialization or anything dynamic.  To inline a regular asset file's content, see the `{ 'loading': 'inline' }` option of the `addJs()` and `js()` methods.

#### addJsModule(asset, [options])

This method will add assets to the list of JavaScript Modules assets.  The priority defaults to 10 if not provided.  A higher number means it will display before lower priority assets.  The `pipeline` option controls whether this asset should be included in the combination/minify pipeline. If not pipelined, the `loading` option controls whether the asset should be rendered as a link to an external script file or whether its contents should be inlined inside an inline script tag.

#### addInlineJsModule(javascript, [options])

Lets you add a string of JavaScript inside an inline module script tag.  To inline a regular asset file's content, see the `{ 'loading': 'inline' }` option of the `addJsModule()` and `js()` methods.


#### registerCollection(name, array)

Allows you to register an array of CSS and JavaScript assets with a name for later use by the `add()` method. Particularly useful if you want to register a collection that may be used by multiple themes or plugins, such as jQuery or Bootstrap.

## Options

Where appropriate, you can pass in an array of asset options. The core options are:

#### For CSS

* **priority**: Integer value (default value is `10`)

* **position**: `pipeline` is default but can also be `before` or `after` the assets in `pipeline` position.

* **loading**: `inline` if this asset should be output inline rather (default: referenced via a link to the stylesheet). Should be used in conjunction with `position: before` or `position: after` as it will have no effect with `position: pipeline` (default).

* **group**: string to specify a unique group name for asset (default is `head`)

#### For JS and JS Module

* **priority**: Integer value (default value is `10`)

* **position**: `pipeline` is default but can also be `before` or `after` the assets in `pipeline` position.

* **loading**: supports any loading type such as, `async`, `defer`, `async defer` or `inline`. Should be used in conjunction with `position: before` or `position: after` as it will have no effect with `position: pipeline` (default).

* **group**: string to specify a unique group name for asset (default is `head`)

#### Other Attributes

You can also pass anything else you like in the options array, and if they are not these standard types, they will simply be rendered as attributes such as `{id: 'custom-id'}` will render as `id="custom-id"` in the HTML tag. This can be also used to include structured data such as json-ld via `addInlineJs()` by using `{type: 'application/ld+json'}`.

#### Examples

For example:

[prism classes="language-twig"]
{% do assets.addCss('page://01.blog/assets-test/example.css?foo=bar', { priority: 20, loading: 'inline', position: 'before'}) %}
[/prism]

Will render as:

[prism classes="language-html line-numbers"]
<style>
h1.blinking {
    text-decoration: underline;
}
</style>
<link.....
[/prism]

Another example:

[prism classes="language-twig"]
{% do assets.addJs('page://01.blog/assets-test/example.js', {loading: 'async', id: 'custom-css'}) %}
[/prism]

Will render as:

[prism classes="language-html"]
<script src="/grav/user/pages/01.blog/assets-test/example.js" async id="custom-css"></script>
[/prism]

A Link example:

[prism classes="language-twig"]
{% do assets.addLink('theme://images/favicon.png', { rel: 'icon', type: 'image/png' }) %}
{% do assets.addLink('plugin://grav-plugin/build/js/vendor.js', { rel: 'modulepreload' }) %}
[/prism]

Wil render as:

[prism classes="language-html"]
<link rel="icon" type="image/png" href="/user/themes/quark/images/favicon.png">
<link href="/user/plugins/grav-plugin/build/js/vendor.js" rel="modulepreload">
[/prism]

## Rendering Assets

The following allow you to render the current state of the CSS and JavaScript assets.

#### css(group, [options], include_link = true)

Renders CSS assets that have been added to an Asset Manager's group (default is `head`). Options are

* **loading**: `inline` if **all** assets in this group should be inlined (default: render each asset according to its `position` option)

* **_link attributes_**, see below (default: `{'type': 'text/css', 'rel': 'stylesheet'}`). Effective only if `inline` is **not** used as this group's rendering option

When `include_link` is enabled, which it is by default, calling `css()` will also propagate to calling `link()`.

If pipelining is turned **off** in the configuration, the group's assets are rendered individually, ordered by asset priority (high to low), followed by the order in which assets were added.

If pipelining is turned **on** in the configuration, assets in the pipeline position are combined in the order in which assets were added, then processed according to the pipeline configuration.

Each asset is rendered either as a stylesheet link or inline, depending on the asset's `loading` option and whether `{'loading': 'inline'}` is used for this group's rendering. CSS added by `addInlineCss()` will be rendered in the `after` position by default, but you can configure it to render before the pipelined output with `position: before`

#### link(group, [options])

Renders Link assets that have been added to an Asset Manager's group (default is `head`). It is not recommended using a group different from `head`, this is where the browser expect the tag to be found and processed.

Differently than the other methods for adding assets, `link()` does not support pipelining, nor does support `inline`.

#### js(group, [options], include_js_module = true)

Renders JavaScript assets that have been added to an Asset Manager's group (default is `head`). Options are

* **loading**: `inline` if **all** assets in this group should be inlined (default: render each asset according to its `position` option)

* **_script attributes_**, see below (default: `{'type': 'text/javascript'}`). Effective only if `inline` is **not** used as this group's rendering option

When `include_js_module` is enabled, which it is by default, calling `js()` will also propagate to calling `jsModule()`.

If pipelining is turned **off** in the configuration, the group's assets are rendered individually, ordered by asset priority (high to low), followed by the order in which assets were added.

If pipelining is turned **on** in the configuration, assets in the pipeline position are combined in the order in which assets were added, then processed according to the pipeline configuration. The combined pipeline result is then rendered before or after non-pipelined assets depending on the setting of `js_pipeline_before_excludes`.

Each asset is rendered either as a script link or inline, depending on the asset's `loading` option and whether `{'loading': 'inline'}` is used for this group's rendering. Note that the only way to inline a JS pipeline is to use inline loading as an option of the `js()` method. JS added by `addInlineJs()` will be rendered in the `after` position by default, but you can configure it to render before the pipelined output with `position: before`


#### jsModule(group, [options])

Works exactly like the `js()` renderer, but for JavaScript modules. The default script type attribute is `type="module"`, even when rendering `inline`.

#### all(group, [options])

Renders every asset above in the order: `css()`, `link()`, `js()`, `jsModule()`

This is the recommended way of including deferred assets into your main twig file (usually `base.html.twig`).

```twig
{% block assets deferred %}
  {{ assets.all()|raw }}
{% endblock %}
```

## Named Assets and Collections

Grav now has a powerful feature called **named assets** that allows you to register a collection of CSS and JavaScript assets with a name.  Then you can simply **add** those assets to the Asset Manager via the name you registered the collection with.  Grav comes preconfigured with **jQuery** but has the ability to define custom collections in the `system.yaml` to be used by any theme or plugin:

[prism classes="language-yaml line-numbers"]
assets:
  collections:
    jquery: system://assets/jquery/jquery-2.1.3.min.js
    bootstrap:
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css
        - https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js
[/prism]

You can also use the `registerCollection()` method programmatically.

[prism classes="language-yaml line-numbers"]
$assets = $this->grav['assets'];
$bootstrapper_bits = [https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css,
                      https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css,
                      https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js];
$assets->registerCollection('bootstrap', $bootstrap_bits);
$assets->add('bootstrap', 100);
[/prism]

An example of this action can be found in the [**bootstrapper** plugin](https://github.com/getgrav/grav-plugin-bootstrapper/blob/develop/bootstrapper.php#L51-L71).

##### Collections with attributes
Sometimes you might want to specify custom and/or different attributes to specific items in a collection, for example if you are loading assets from a remote CDN, and you wish to include the integrity check (SRI). This is possible by treating the value of the named asset as an array where the key is the asset location, and the value is the list of additional attributes. For example:

[prism classes="language-yaml line-numbers"]
assets:
  collections:
    jquery_and_ui:
        https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js:
            integrity: 'sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=='
            group: 'bottom'
        https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js:
            integrity: 'sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA=='
            group: 'bottom'
[/prism]

Then, after you add the JS in your twig via `{% do assets.addJs('jquery_and_ui', { defer: true }) %}`, the assets will load as:

[prism classes="language-html"]
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" defer="1" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" defer="1" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA=="></script>
[/prism]

Note that `defer` was defined at the twig level and it was applied to all the assets in the collection. This is because Grav will merge together the attributes from both the twig and the yaml definition, giving priority to the ones in the yaml definition.

If the `jquery-ui.min.js` asset included also an attribute `defer: null` then it would have taken precedence over the twig `defer: 1` and it would have not been rendered.

## Grouped Assets

The Asset manager lets you pass an optional `group` as part of an options array when adding assets.  While this is of marginal use for CSS, it is especially useful for JavaScript where you may need to have some JS files or Inline JS referenced in the header, and some at the bottom of the page.

To take advantage of this capability you must specify the group when adding the asset, and should use the options syntax:

[prism classes="language-twig"]
{% do assets.addJs('theme://js/example.js', {'priority':102, 'group':'bottom'}) %}
[/prism]

Then for these assets in the bottom group to render, you must add the following to your theme:

[prism classes="language-twig"]
{{ assets.js('bottom')|raw }}
[/prism]

If no group is defined for an asset, then `head` is the default group.  If no group is set for rendering, the `head` group will be rendered. This ensures the new functionality is 100% backwards compatible with existing themes.

The same goes for CSS files:

[prism classes="language-twig"]
{% do assets.addCss('theme://css/ie8.css', {'group':'ie'}) %}
[/prism]

and to render:


[prism classes="language-twig"]
{{ assets.css('ie')|raw }}
[/prism]

## Change attribute of the rendered CSS/JS assets

CSS is by default added using the `rel="stylesheet"` attribute, and `type="text/css"` , while JS has `type="text/javascript"`.

To change the defaults, or to add new attributes, you need to create a new group of assets, and tell Grav to render it with that attribute.

Example of editing the `rel` attribute on a group of assets:

[prism classes="language-twig line-numbers"]
{% do assets.addCSS('theme://whatever.css', {'group':'my-alternate-group'}) %}
...
{{ assets.css('my-alternate-group', {'rel': 'alternate'})|raw }}
[/prism]

## Inlining Assets

Inlining allows the placing critical CSS (and JS) code directly into the HTML document enables the browser to render a page immediately without waiting for external stylesheet or script downloads. This can improve site performance noticeably for users, particularly over mobile networks. Details can be found in [this article on optimizing CSS delivery](https://developers.google.com/speed/docs/insights/OptimizeCSSDelivery).

However, directly inserting CSS or JavaScript code into a page template is not always feasible, for example, where Sass-complied CSS is used. Keeping CSS and JS assets in separate files also simplifies maintenance. Using the Asset Manager's inline capability enables you to optimize for speed without changing the way your assets are stored. Even entire pipelines can be inlined.

To inline an asset file's content, use the option `{'loading': 'inline'}` with `addCss()` or `addJs()`. You can also inline all assets when rendering a group with `js()` or `css()`, which provide the same option.

Example of using `system.yaml` to define asset collections named according to asset loading requirements, with `app.css` being a [Sass](http://sass-lang.com/)-generated CSS file:

[prism classes="language-yaml line-numbers"]
assets:
  collections:
    css-inline:
      - 'http://fonts.googleapis.com/css?family=Ubuntu:400|Open+Sans:400,400i,700'
      - 'theme://css-compiled/app.css'
    js-inline:
      - 'https://use.fontawesome.com/<embedcode>.js'
    js-async:
      - 'theme://foundation/dist/assets/js/app.js'
      - 'theme://js/header-display.js'
[/prism]

The template inserts each collection into its corresponding group, namely `head` and `head-link` for CSS, `head` and `head-async` for JS. The default group `head` is used for inline loading in each case:

[prism classes="language-twig line-numbers"]
{% block stylesheets %}
    {% do assets.addCss('css-inline') %}
    {% do assets.addCss('css-link', {'group': 'head-link'}) %}
{% endblock %}
{{ assets.css('head-link')|raw }}
{{ assets.css('head', {'loading': 'inline'})|raw }}
{% block javascripts %}
    {% do assets.addJs('js-inline') %}
    {% do assets.addJs('js-async', {'group': 'head-async'}) %}
{% endblock %}
{{ assets.js('head-async', {'loading': 'async'})|raw }}
{{ assets.js('head', {'loading': 'inline'})|raw }}
[/prism]


## Static Assets

Sometimes there is a need to reference assets without using the Asset Manager.  There is a `url()` helper method available to achieve this.  An example of this could be if you wanted to reference an image from the theme. The syntax for this is:

[prism classes="language-twig"]
<img src="{{ url("theme://" ~ widget.image)|e }}" alt="{{ widget.text|e }}" />
[/prism]

The `url()` method takes an optional second parameter of `true` or `false` to enable the URL to include the schema and domain. By default this value is assumed `false` resulting in just the relative URL.  For example:

[prism classes="language-twig"]
<script src="{{ url('theme://some/extra.css', true)|e }}"></script>
[/prism]

---

## Custom CSS

> Path: grav-learn/pages/03.themes/08.customization/docs.md


There are many ways to customize a theme, and Grav really doesn't limit your creativity regarding this. However, there are several features and some functionality that Grav provides to make this process easier.

## Custom CSS

The simplest way to customize a theme is to provide your own `custom.css` file. The **Quark** default theme provides a reference to a `css/custom.css` file via the **Asset Manager**. Luckily, the **Asset Manager** handles this for us, and if the file is not found, the reference is not added to the HTML.

However, if you do provide a file called `custom.css` in Quark's `css/` folder, this will get picked up and referenced. You just need to ensure that you provide CSS elements with enough [specificity](http://www.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/) to override the default CSS. For example:

**custom.css**

[prism classes="language-css line-numbers"]
body a {
    color: #CC0000;
}
[/prism]

This will override the default link color and use a **red** color instead.

## Custom SCSS/LESS

The next step up from providing a custom CSS file is to use a `_custom.scss` file. Quark is written using [SCSS](http://sass-lang.com/), which is a CSS compatible preprocessor that enables you to write CSS more efficiently via the use of [variables, nested structures, partials, imports, operators and mix-ins](http://sass-lang.com/guide).

This may sound a little daunting at first, but you can use as much or as little SCSS as you like, and once you start, you will have trouble going back to traditional CSS. Promise!

The Quark theme has an `scss/` folder that contains a variety of `.scss` files. These should be compiled into the `css-compiled/` folder.

You can create a file called `scss/theme/_custom.scss` and import it to the `theme.scss` file at the bottom using `@import 'theme/custom';`. There are several great benefits of putting your code in this file:

1. The resulting changes will be compiled into the `css-compiled/theme.min.css` file along with all the other CSS.
2. You have access to all the variables and mix-ins that are available to any of the other SCSS used in the theme.
3. You have access to all the standard SCSS features and functionality to make development easier.

An example of this file would be:

**_custom.scss**

[prism classes="language-css line-numbers"]
body {
    a {
        color: darken($core-accent, 30%);
    }
}
[/prism]

The downside to this approach is that this file is overwritten during any *theme upgrade*, so you should ensure you create a backup of any custom work you do.  This issue is resolved by using theme inheritance as described below.

## Wellington SCSS

[Wellington](https://github.com/wellington/wellington) is a native wrapper for [libsass](http://libsass.org/) available for both Linux and MacOS. It provides a much faster solution for compiling SCSS than the default Ruby-based scss compiler.  By faster we mean about **20X faster!**. It's super easy to install (via brew):

[prism classes="language-bash command-line"]
brew install wellington
[/prism]

To take advantage of it to compile an `scss` folder into a `css-compiled` folder as in the example above you can [use this gist](https://gist.github.com/rhukster/bcfe030e419028422d5e7cdc9b8f75a8).

!! Wellington is what we have been using for all _Team Grav_ themes and it's been working great!


## Theme Inheritance

This is the preferred approach to modifying or customizing a theme, but it does require a little bit more setup.

The basic concept is that you define a theme as the **base-theme** that you are inheriting from, and provide **only the bits you wish to modify** and let the base theme handle the rest. The great benefit to this is that you can more easily keep the base theme updated and current without directly impacting your customized inherited theme.

There are two ways to inherit from an existing theme:

1. Using the Command Line Interface (CLI) with the DevTools plugin.
2. Manually.

### Inheriting using the CLI

As discussed in the [Theme Tutorial](https://learn.getgrav.org/16/themes/theme-tutorial), you can create a new theme using the DevTools plugin. But you can also inherit from an existing theme. The procedure is simple.

1. [Install the DevTools plugin](https://learn.getgrav.org/16/themes/theme-tutorial#step-1-install-devtools-plugin) if it is not already done.
2. Then follow the [Create Base Theme](https://learn.getgrav.org/16/themes/theme-tutorial#step-2-create-base-theme) procedure, but when asked to `Please choose a template type`, type `inheritance`. If Quark is the only theme, it will be displayed as option 0. So type `0` to inherit from Quark. Your new inherited theme will be created.
3. Copy all the options from the theme YAML file you are inheriting from (or from the `user/config/themes` folder if you have customized it) at the top of the newly created YAML configuration file of your theme: `/user/themes/mytheme/mytheme.yaml`.
4. Copy the form section from `/user/themes/quark/blueprints.yaml` file into `/user/themes/mytheme/blueprints.yaml` in order to include the customizable elements of the theme in the admin. (Or simply replace the file and edit its content.)
5. Change your default theme to use your new **mytheme** by editing the `pages: theme:` option in your `user/config/system.yaml` configuration file:

   [prism classes="language-yaml line-numbers"]
   pages:
     theme: mytheme
   [/prism]

### Inheriting manually

To achieve this you need to follow these steps:

1. Create a new folder: `user/themes/mytheme` to house your new theme.
2. Copy the theme YAML file from the theme you're inheriting (or from the `user/config/themes` folder if you have customized it) to `/user/themes/mytheme/mytheme.yaml` and add the following content (replacing `user/themes/quark` with the name of the theme you are inheriting):

   [prism classes="language-yaml line-numbers"]
   
   streams:
     schemes:
       theme:
         type: ReadOnlyStream
         prefixes:
           '':
             - 'user://themes/mytheme'
             - 'user://themes/quark'

   [/prism]
   
   NOTE: Your `mytheme.yaml` must single quote the prefixes in 1.7. Older documentation shows no single-quotes sunch as `- user/themes/mytheme
         - user/themes/quark`. The incorrect quoting in the `mytheme.yaml` may result in a fatal error upon activating your new theme `Template "@images/grav-logo.svg" is not defined in "partials/logo.html.twig" at line 7.`
   
4. Copy the `/user/themes/quark/blueprints.yaml` file into `/user/themes/mytheme/blueprints.yaml` in order to include the customizable elements of the theme in the admin.

5. Change your default theme to use your new **mytheme** by editing the `pages: theme:` option in your `user/config/system.yaml` configuration file:

   [prism classes="language-yaml line-numbers"]
   pages:
     theme: mytheme
   [/prism]

6. Create a new theme Class file that can be used to add advanced event-driven functionality. Create a `user/themes/mytheme/mytheme.php` file:

   [prism classes="language-php line-numbers"]
   <?php
   namespace Grav\Theme;

   class Mytheme extends Quark
   {
       // Some new methods, properties etc.
   }
   ?>
   [/prism]

You have now created a new theme called **mytheme** and set up the streams so that it will first look in the **mytheme** theme first, then try **quark**.  So in essence, Quark is the base-theme for this new theme.

You can then provide just the files you need, including **JS**, **CSS**, or even modifications to **Twig template files** if you wish.

### Using SCSS

In order to modify specific **SCSS** files, we need to use a little configuration so it knows to look in your new `mytheme` location first, then `quark` second. This requires a couple of things.

1. First, you need to copy over the main SCSS file from quark that contains all the `@import` calls for various sub files. So, copy the `theme.scss` file from `quark/scss/` to `mytheme/scss/` folder.
2. While inside the `theme.scss` file, change the beginning of all the import lines to `@import '../../quark/scss/theme/';` so it will know to use the files from the quark theme. So, for example the first line will be `@import '../../quark/scss/theme/variables';`.
3. Add `@import 'theme/custom';` at the very bottom of the `theme.scss` file.
4. The next step is to create a file located at `mytheme/scss/theme/_custom.scss`. This is where your modifications will go.
5. Copy the `gulpfile.js` and `package.json` files into the base folder of the new theme.

In order to compile the new scss for the **mytheme** you will need to open up terminal and navigate to the theme folder. Quark uses gulp to compile the sass so you will need those installed and yarn for the dependencies. Run `npm install -g gulp`, `yarn install`, and then `gulp watch`. Now, any changes made to the files will be recompiled.

---

## Chapter 3

> Path: grav-learn/pages/03.themes/chapter.md


### Chapter 3

# Themes

The way your **Grav** site looks is controlled by the **Theme**.  Find out how themes work and how to easily edit or create your own.

---

## Powerful!

> Path: grav-learn/pages/04.plugins/01.plugin-basics/docs.md


Grav was designed to be **simple** and **focused**, dealing with pages only.  The idea is that Grav itself is **super-lean**, providing just enough functionality to do the basics: routing, Markdown to HTML compiling, Twig templating, and caching.

However, we knew that we wanted to ensure Grav could grow and provide powerful functionality when required, so we built **event hooks** throughout the system so that everything could be extended with **plugins**.

## Powerful!

All the key objects in Grav are accessible through a powerful [Dependency Injection Container](http://en.wikipedia.org/wiki/Dependency_injection).  With Grav's event hooks throughout the entire life cycle, you can access anything that Grav knows about, and manipulate it as you need.  With this system you have complete control to add as much functionality as you need.

The plugins have proved so easy to write, and so flexible and powerful, that we can not stop creating them! We already have [over 300 freely downloadable plugins](https://getgrav.org/downloads/plugins#extras) that do everything from displaying a **sitemap**, providing **breadcrumbs**, displaying blog **archives**, a simple **search engine**, to providing a fully-functional JavaScript-powered **shopping cart**!

The best way to learn what can be done with plugins is to download some of these and look at what they are doing, and how they are doing it. In the next chapter we will [create a simple plugin from scratch](../plugin-tutorial)!

## Essentials

All plugins are located in your `user/plugins` folder.  With the base Grav install, there are only two plugins provided: `error` and `problems`.

The `error` plugin is used to handle HTTP errors, like **404 Page Not Found**.

The `problems` plugin is useful for new Grav installations because it detects any issues with your **hosting setup**, **missing folders**, or **permissions** that could cause problems with Grav.  Only the `error` plugin is really essential for proper operation.

Every plugin in the `user/plugins` folder should have a unique name, and that name should closely define the function of the plugin.  Please do not use spaces, underscores, or capital letters in the plugin name.

## Accessing Plugin Configuration Values via Twig

To access plugin configuration settings via Twig (i.e. within a Theme), the general format is:

[prism classes="language-twig"]
config.plugins.pluginname.pluginproperty
[/prism]

If plugin name contains dashes you should refer to its properties using :

[prism classes="language-twig"]
config.plugins['plugin-name'].pluginproperty
[/prism]

## Using Flex in plugins

The recommended way to start using flex in a plugin is to use the devtools and create a plugin with Flex basic support generated for you:
https://learn.getgrav.org/17/basics/installation#option-1-install-from-zip-package

See [Flex plugin section](../06.plugin-flex/)

---

## Installation

> Path: grav-learn/pages/04.plugins/02.plugin-install/docs.md


## Installation

Installing a plugin can be done in one of three ways:

- The **GPM** (Grav Package Manager) installation method lets you quickly install the plugin with a simple terminal command.
- The **manual** method lets you do so via a zip file.
- The **admin** method lets you do so via the Admin Plugin.

The plugin should let you know the **_NAME_ to be used** in the following steps.

### GPM Installation (Preferred)

To install the plugin via the [GPM](https://learn.getgrav.org/17/cli-console/grav-cli-gpm), through your systems terminal (also called the command line), navigate to the root of your Grav-installation, and enter:

[prism classes="language-sh"]
bin/gpm install NAME
[/prism]

This will install the plugin into your `/user/plugins` directory within Grav. Its files can be found under `user/plugins/NAME`.

### Manual Installation

To install the plugin manually, download the zip-version of this repository and unzip it under `user/plugins/`. Then rename the folder to `NAME`.

You should now have all the plugin files under `user/plugins/NAME`.

> NOTE: This plugin is a modular component for Grav which may require other plugins to operate, please see the file `user/plugins/NAME/blueprints.yaml` for more.

### Admin Plugin

If you use the [Admin Plugin](https://github.com/getgrav/grav-plugin-admin) and the plugin is registered in Grav repository, you can install the plugin directly by browsing the `Plugins` menu and clicking on the `Add` button.

---

## Randomizer Plugin Overview

> Path: grav-learn/pages/04.plugins/03.plugin-tutorial/docs.md


Plugins are usually developed because there is a task that can not be completed with Grav's core functionality.

In this tutorial, we will create a plugin that helps Grav to deliver a random page to the user.  You have probably seen similar functionality on blog sites as a way to provide a random blog-post when you click a button.

! Because there is already a plugin that performs this job named `Random`, we'll call this test plugin `Randomizer`.

This feature is not possible **out-of-the-box**, but is **easily** provided via a plugin.  As is the case with a great many aspects of Grav, there is no _one-way_ to do this. Instead, you have many options.  We will cover just one approach...

## Randomizer Plugin Overview

For our plugin we will take the following approach:

1. Activate the plugin if a URI matches our configured 'trigger route'. (e.g. `/random`)

2. Create a filter so that only configured taxonomies are in the pool of random pages.  (e.g. `category: blog`)

3. Find a random page from our filtered pool, and tell Grav to use it for the page content.

OK! This sounds simple enough, right? So, let us get cracking!


## Step 1 - Install DevTools plugin

!! Previous versions of this tutorial required creating a plugin manually.  This whole process can be skipped thanks to our new **DevTools Plugin**

The first step in creating a new plugin is to **install the DevTools Plugin**.  This can be done in two ways.

#### Install via CLI GPM

* Navigate in the command line to the root of your Grav installation

[prism classes="language-bash command-line"]
bin/gpm install devtools
[/prism]

#### Install via Admin plugin

* After logging in, simply navigate to the **Plugins** section from the sidebar.
* Click the <i class="fa fa-plus"></i> **Add** button in the top right.
* Find **DevTools** in the list and click the <i class="fa fa-plus"></i> **Install** button.

## Step 2 - Create Randomizer plugin

For this next step you really do need to be in the [command line](/cli-console/command-line-intro) as the DevTools provide a couple of CLI commands to make the process of creating a new plugin much easier!

From the root of your Grav installation enter the following command:

[prism classes="language-bash command-line"]
bin/plugin devtools new-plugin
[/prism]

This process will ask you a few questions that are required to create the new plugin:

[prism classes="language-bash command-line" cl-output="2-9"]
bin/plugin devtools new-plugin
Enter Plugin Name: Randomizer
Enter Plugin Description: Sends the user to a random page
Enter Developer Name: Acme Corp
Enter Developer Email: contact@acme.co

SUCCESS plugin Randomizer -> Created Successfully

Path: /www/user/plugins/randomizer

Make sure to run `composer update` to initialize the autoloader
[/prism]

! At this point you **need to run** `composer update` in the newly created plugin folder.

The DevTools command tells you where this new plugin was created. This created plugin is fully functional but will not automatically have the logic to perform the function we wish.  We will have to modify it to suit our needs.

## Step 3 - Plugin basics

Now we've created a new plugin that can be modified and developed. Let's break it down and have a look at what makes up a plugin.  If you look in the `user/plugins/randomizer` folder you will see:

[prism classes="language-text"]
.
 CHANGELOG.md
 LICENSE
 README.md
 blueprints.yaml
 randomizer.php
 randomizer.yaml
[/prism]

This is a sample structure but some things are required:

### Required items to function

These items are critical and your plugin will not function reliably unless you include these in your plugin.

* **`blueprints.yaml`** - The configuration file used by Grav to get information on your plugin. It can also define a form that the admin can display when viewing the plugin details.  This form will let you save settings for the plugin. [This file is documented in the Forms chapter](/forms/blueprints).
* **`randomizer.php`** - This file will be named according to your plugin, but can be used to house any logic your plugin needs.  You can use any [plugin event hook](/plugins/event-hooks) to perform logic at pretty much any point in [Grav's lifecycle](/plugins/grav-lifecycle).
* **`randomizer.yaml`** - This is the configuration used by the plugin to set options the plugin might use. This should be named in the same way as the `.php` file.

### Required items for release

These items are required if you wish to release your plugin via GPM.

* **`CHANGELOG.md`** - A file that follows the [Grav Changelog Format](/advanced/grav-development#changelog-format) to show changes in releases.
* **`LICENSE`** - a license file, should probably be MIT unless you have a specific need for something else.
* **`README.md`** - A 'Readme' that should contain any documentation for the plugin.  How to install it, configure it, and use it.

## Step 4 - Plugin configuration

As we described in the **Plugin Overview**, we need to have a few configuration options for our plugin, so the `randomizer.yaml` file should look something like this:

[prism classes="language-yaml line-numbers"]
enabled: true
active: true
route: /random
filters:
    category: blog
[/prism]

This allows us to have multiple filters if we wish, but for now, we just want all content with the taxonomy `category: blog` to be eligible for the random selection.

All plugins must have the `enabled` option. If this is `false` in the site-wide configuration, your plugin
will never be initialized by Grav. All plugins also have the `active` option. If this is `false` in the site-wide
configuration, each page will need to activate your plugin. Note that multiple plugins also support `enabled`/`active` in
page frontmatter by using `mergeConfig`, detailed below.

!!!! The Grav default install has taxonomy defined for `category` and `tag` by default.  This configuration can be modified in your `user/config/site.yaml` file.

Of course, as with all other configurations in Grav, it is advised not to touch this default configuration for day-to-day control. Rather, you should create an override in a file called `/user/config/plugins/randomizer.yaml` to house any custom settings.  This plugin-provided `randomizer.yaml` is really intended to set some sensible defaults for your plugin.

## Step 5 - Base plugin structure

The base plugin class structure will already look something like this:

[prism classes="language-php line-numbers"]
<?php
namespace Grav\Plugin;

use Composer\Autoload\ClassLoader;
use Grav\Common\Plugin;
use RocketTheme\Toolbox\Event\Event;

/**
 * Class RandomizerPlugin
 * @package Grav\Plugin
 */
class RandomizerPlugin extends Plugin
{
    /**
     * Composer autoload.
     *
     * @return ClassLoader
     */
    public function autoload(): ClassLoader
    {
        return require __DIR__ . '/vendor/autoload.php';
    }
}
[/prism]

We need to add a few `use` statements because we are going to use these classes in our plugin, and it saves space and makes the code more readable if we don't have to put the full namespace for each class inline.

Modify the `use` statements to look like this:

[prism classes="language-php line-numbers"]
use Composer\Autoload\ClassLoader;
use Grav\Common\Plugin;
use Grav\Common\Page\Collection;
use Grav\Common\Uri;
use Grav\Common\Taxonomy;
[/prism]

The two key parts of this class structure are:

1. Plugins need to have `namespace Grav\Plugin` at the top of the PHP file.
2. Plugins should be named in **titlecase** based on the name of the plugin with the string `Plugin` appended to the end, and should extend `Plugin`, hence the class name `RandomizerPlugin`.

## Step 6 - Subscribed events

Grav uses a sophisticated event system, and to ensure optimal performance, all plugins are inspected by Grav to determine which events the plugin is subscribed to.

[prism classes="language-php line-numbers"]
public static function getSubscribedEvents(): array
{
    return [
        'onPluginsInitialized' => [
            ['autoload', 100000], // TODO: Remove when plugin requires Grav >=1.7
            ['onPluginsInitialized', 0]
        ]
    ];
}
[/prism]

In this plugin we are going to tell Grav we're subscribing to the `onPluginsInitialized` event.  This way we can use that event (which is the first event available to plugins) to determine if we should subscribe to other events.

!!! **Note:** The first `autoload` event listener is only needed in Grav 1.6. Grav 1.7 automatically calls the method.

## Step 7 - Determine if the plugin should run

The next step is to add a method to our `RandomizerPlugin` class to handle the `onPluginsInitialized` event so it only activates when a user tries to go to the route we have configured in our `randomizer.yaml` file.  Replace the current 'sample' plugin logic with the following:


[prism classes="language-php line-numbers"]
public function onPluginsInitialized(): void
{
    // Don't proceed if we are in the admin plugin
    if ($this->isAdmin()) {
        return;
    }

    /** @var Uri $uri */
    $uri = $this->grav['uri'];
    $config = $this->config();

    $route = $config['route'] ?? null;
    if ($route && $route == $uri->path()) {
        $this->enable([
            'onPageInitialized' => ['onPageInitialized', 0]
        ]);
    }
}
[/prism]

First, we get the **Uri object** from the **Dependency Injection Container**.  This contains all the information about the current URI, including the route information.

The **config() method** is already part of the base **Plugin**, so we can simply use it to get the configuration value for our configured `route`.

Next, we compare the configured route to the current URI path. If they are equal, we instruct the dispatcher that our plugin will also listen to a new event: `onPageInitialized`.

By using this approach, we ensure we do not run through any extra code if we do not need to.  Practices like these will ensure your site runs as fast as possible.

## Step 8 - Display the random page

The last step of our plugin is to display the random page, and we can do that by adding the following method:

[prism classes="language-php line-numbers"]
/**
 * Send user to a random page
 */
public function onPageInitialized(): void
{
    /** @var Taxonomy $uri */
    $taxonomy_map = $this->grav['taxonomy'];
    $config = $this->config();

    $filters = (array)($config['filters'] ?? []);
    $operator = $config['filter_combinator'] ?? 'and';

    if (count($filters) > 0) {
        $collection = new Collection();
        $collection->append($taxonomy_map->findTaxonomy($filters, $operator)->toArray());
        if (count($collection) > 0) {
            unset($this->grav['page']);
            $this->grav['page'] = $collection->random()->current();
        }
    }
}
[/prism]

This method is a bit more complicated, so we'll go over what's going on:

1. First, we get the **Taxonomy object** from the **Grav DI Container** and assign it to a variable `$taxonomy_map`.

2. Then we retrieve the array of filters from our plugin configuration.  In our configuration this is an array with 1 item: ['category' => 'blog'].

3. Check to ensure we have filters, then create a new `Collection` in the `$collection` variable to store our pages.

4. Append all pages that match the filter to our `$collection` variable.

5. Unset the current `page` object that Grav knows about.

6. Set the current `page` to a random item in the collection.


## Step 9 - Cleanup

The example plugin that was created with the **DevTools** plugin, used an event called `onPageContentRaw()`. This event is not used in our new plugin, so we can safely remove the entire function.

## Step 10 - Final plugin class

And that is all there is to it! The plugin is now complete.  Your complete plugin class should look something like this:

[prism classes="language-php line-numbers"]
<?php
namespace Grav\Plugin;

use Composer\Autoload\ClassLoader;
use Grav\Common\Plugin;
use Grav\Common\Page\Collection;
use Grav\Common\Uri;
use Grav\Common\Taxonomy;

/**
 * Class RandomizerPlugin
 * @package Grav\Plugin
 */
class RandomizerPlugin extends Plugin
{
    /**
     * @return array
     *
     * The getSubscribedEvents() gives the core a list of events
     *     that the plugin wants to listen to. The key of each
     *     array section is the event that the plugin listens to
     *     and the value (in the form of an array) contains the
     *     callable (or function) as well as the priority. The
     *     higher the number the higher the priority.
     */
    public static function getSubscribedEvents(): array
    {
    return [
        'onPluginsInitialized' => [
            ['autoload', 100000], // TODO: Remove when plugin requires Grav >=1.7
            ['onPluginsInitialized', 0]
        ]
    ];
    }

    /**
     * Composer autoload.
     *
     * @return ClassLoader
     */
    public function autoload(): ClassLoader
    {
        return require __DIR__ . '/vendor/autoload.php';
    }

    public function onPluginsInitialized(): void
    {
        // Don't proceed if we are in the admin plugin
        if ($this->isAdmin()) {
            return;
        }

        /** @var Uri $uri */
        $uri = $this->grav['uri'];
        $config = $this->config();

        $route = $config['route'] ?? null;
        if ($route && $route == $uri->path()) {
            $this->enable([
                'onPageInitialized' => ['onPageInitialized', 0]
            ]);
        }
    }

    /**
     * Send user to a random page
     */
    public function onPageInitialized(): void
    {
        /** @var Taxonomy $uri */
        $taxonomy_map = $this->grav['taxonomy'];
        $config = $this->config();

        $filters = (array)($config['filters'] ?? []);
        $operator = $config['filter_combinator'] ?? 'and';

        if (count($filters) > 0) {
            $collection = new Collection();
            $collection->append($taxonomy_map->findTaxonomy($filters, $operator)->toArray());
            if (count($collection) > 0) {
                unset($this->grav['page']);
                $this->grav['page'] = $collection->random()->current();
            }
        }
    }
}
[/prism]

If you followed along, you should have a fully functional **Randomizer** plugin enabled for your site.  Just point your browser to the `http://yoursite.com/random`, and you should see a random page.  You can also download the original **Random**  plugin directly from the [Plugins Download](https://getgrav.org/downloads/plugins) section of the [getgrav.org](https://getgrav.org/downloads/plugins) site.

## Extending blueprints

If your plugin needs to extend blueprints, e.g. default.yaml from /system/blueprints/pages/default.yaml there's no need to register your blueprint via hooks if you respect the folder structure placing your extending blueprint inside of [your-plugin-directory]/blueprints/pages/default.yaml. Grav will merge your extended blueprint definitions while themes can do the same lateron.

> system inheritance if you create this folder structure inside your plugin
> > - blueprints
> > - - pages
> > - - - default.yaml

> admin inheritance if you create this folder structure inside your plugin
> > - blueprints
> > - - admin
>>  - - - pages
> > - - - - raw.yaml
> 
> From admin you have to inherit raw or others and theme blueprints extending default won't make it into your configuration.

If it's not pages, do it the same way for other inheritances...
This way you can keep extending changes at a minimum, that's what extending is all about :-).

## Merging Plugin and Page Configuration

One popular technique that is used in a variety of plugins is the concept of merging the plugin configuration (either default or overridden user config) with page-level configuration.  This means you can set **site-wide** configuration, and then have a specific configuration for a given page as needed.  This provides a lot of power and flexibility for your plugin.

In recent versions of Grav, a helper method was added to perform this functionality automatically rather than you having to code that logic yourself.  The **SmartyPants** plugin provides a good example of this functionality in action:

[prism classes="language-php line-numbers"]
public function onPageContentProcessed(Event $event): void
{
    $page = $event['page'];
    $config = $this->mergeConfig($page);

    if ($config->get('process_content')) {
        $page->setRawContent(\Michelf\SmartyPants::defaultTransform(
            $page->getRawContent(),
            $config->get('options')
        ));
    }
}
[/prism]

## Implementing CLI in your Plugin

Plugins have also the capability of integrating with the `bin/plugin` command line to execute tasks. You can follow the [plugin CLI documentation](/cli-console/grav-cli-plugin#developers-integrate-the-cli-in-plugin) if you desire to implement such functionality.

---

## Event Order

> Path: grav-learn/pages/04.plugins/04.event-hooks/docs.md


In the previous [Plugin Tutorial](../plugin-tutorial) chapter, you might have noticed that our plugin logic was encompassed in two methods.  Each of these methods `onPluginsInitialized` and `onPageInitialized` correspond to **event hooks** that are available throughout the Grav life cycle.

To fully harness the power of Grav plugins you need to know which event hooks are available, in what order are these hooks called, and what is available during these calls. The **event hooks** have a direct relationship to the overall [Grav Lifecycle](../../plugins/grav-lifecycle).

## Event Order

Most events within Grav fire in a specific order and it is important to understand this order if you are creating plugins:

1. [onFatalException](../event-hooks#onFatalException) _(no order, can occur anytime)_
2. `PluginsLoadedEvent` class (1.7)
3. `PluginsLoadedEvent` class (1.7)
4. [onPluginsInitialized](../event-hooks#onPluginsInitialized)
5. `FlexRegisterEvent` class (1.7)
6. onThemeInitialized
7. onRequestHandlerInit (1.6)
8. onTask (1.6)
  9. onTask.{task}
10. onAction (1.6)
  11. onAction.{action} (1.6)
12. onBackupsInitialized
13. onSchedulerInitialized (1.6)
14. [onAssetsInitialized](../event-hooks#onAssetsInitialized)
15. [onTwigTemplatePaths](../event-hooks#onTwigTemplatePaths)
16. [onTwigLoader](../event-hooks#onTwigLoader)
17. [onTwigInitialized](../event-hooks#onTwigInitialized)
18. [onTwigExtensions](../event-hooks#onTwigExtensions)
19. [onBuildPagesInitialized](../event-hooks#onBuildPagesInitialized) _(once when pages are reprocessed)_
  20. [onPageProcessed](../event-hooks#onPageProcessed) _(each page not cached yet)_
  21. onFormPageHeaderProcessed (1.6) _(each page not cached yet)_
  22. [onFolderProcessed](../event-hooks#onFolderProcessed) _(for each folder found)_
23. [onPagesInitialized](../event-hooks#onPagesInitialized)
24. [onPageInitialized](../event-hooks#onPageInitialized)
  25. [onPageContentRaw](../event-hooks#onPageContentRaw) _(each page not cached yet)_
  26. [onMarkdownInitialized](../event-hooks#onMarkdownInitialized)
  27. [onPageContentProcessed](../event-hooks#onPageContentProcessed) _(each page not cached yet)_
  28. onPageContent _(called first time Page::content() is called even when cached)_
29. [onPageNotFound](../event-hooks#onPageNotFound)
30. onPageAction (1.6)
  31. onPageAction.{action} (1.6)
32. onPageTask (1.6)
  33. onPageTask.{task} (1.6)
34. [onTwigPageVariables](../event-hooks#onTwigPageVariables) _(each page not cached yet)_
35. onHttpPostFilter (1.5.2)
36. [onTwigSiteVariables](../event-hooks#onTwigSiteVariables)
37. [onCollectionProcessed](../event-hooks#onCollectionProcessed) _(when collection is requested)_
38. [onOutputGenerated](../event-hooks#onOutputGenerated)
39. [onPageHeaders](../event-hooks#onPageHeaders)
40. [onOutputRendered](../event-hooks#onOutputRendered)
41. [onShutdown](../event-hooks#onShutdown)

Misc events:

1. [onBlueprintCreated](../event-hooks#onBlueprintCreated)
2. onTwigTemplateVariables
3. onTwigStringVariables
4. [onBeforeDownload](../event-hooks#onBeforeDownload)
5. [onPageFallBackUrl](../event-hooks#onPageFallBackUrl)
6. [onMediaLocate](../event-hooks#onMediaLocate)
7. [onGetPageBlueprints](../event-hooks#onGetPageBlueprints)
8. [onGetPageTemplates](../event-hooks#onGetPageTemplates)
9. onFlexObjectRender (1.6)
10. onFlexCollectionRender (1.6)
11. onBeforeCacheClear
12. onImageMediumSaved (ImageFile)
13. onAfterCacheClear (1.7)
14. onHttpPostFilter (1.7)
15. `PermissionsRegisterEvent`class (1.7)

## Core Grav Event Hooks

There are several core Grav event hooks that are triggered during the processing of a page:

<a name="onFatalException"></a>

#### onFatalException

This is an event that can be fired at any time if PHP throws a fatal exception. This is currently used by the `problems` plugin to handle displaying a list of potential reasons why Grav throws the fatal exception.

<a name="onPluginsInitialized"></a>

#### onPluginsInitialized

This is the first plugin event available. At this point the following objects have been initiated:

* Uri
* Config
* Debugger
* Cache
* Plugins

!!!! A plugin will not be loaded at all if the `enabled: false` configuration option has been set for that particular plugin.

<a name="onAssetsInitialized"></a>
#### onAssetsInitialized

The event indicates the assets manager has been initialized and is ready for assets to be added and managed.

<a name="onPagesInitialized"></a>
#### onPagesInitialized

This event signifies that all the pages in Grav's `user/pages` folder have been loaded as objects and are available in the **Pages object**.

<a name="onPageNotFound"></a>
#### onPageNotFound

This is an event that can be fired if an expected page is not found. This is currently used by the `error` plugin to display a pretty 404 error page.

<a name="onPageInitialized"></a>
#### onPageInitialized

The current page as requested by a URL has been loaded into the **Page object**.

<a name="onOutputGenerated"></a>
#### onOutputGenerated

The output has been processed by the **Twig templating engine** and is now just a string of HTML.

<a name="onPageHeaders"></a>
#### onPageHeaders

Allows the manipulation of the page headers object.

<a name="onOutputRendered"></a>
#### onOutputRendered

The output has been fully processed and sent to the display.

<a name="onShutdown"></a>
#### onShutdown

A new and very powerful event that lets you perform actions after Grav has finished processing and the connection to the client has been closed.  This is particularly useful for performing actions that don't need user interaction and potentially could impact performance.  Possible uses include user tracking and jobs processing.

<a name="onBeforeDownload"></a>
#### onBeforeDownload

This new event passes in an event object that contains a `file`.  This event can be used to perform logging, or grant/deny access to download said file.

#### onGetPageTemplates

This event enables plugins to provide their own templates in addition to the ones gathered from the theme's directory structure and core. This is especially useful if you wish the plugin to provide its own template.

**Example**

[prism classes="language-twig line-numbers"]
/**
 * Add page template types.
 */
public function onGetPageTemplates(Event $event)
{
    /** @var Types $types */
    $types = $event->types;
    $types->register('downloads');
}
[/prism]

This allows a plugin to register a template (that it might provide) so that it shows up in the dropdown list of page template types (like when editing a page). In the example above, a template type of `downloads` is added as there is a `downloads.html.twig` file in the `downloads` directory.

![](ongetpagetemplates.png)

#### onGetPageBlueprints

This event, like `onGetPageTemplates` enables the plugin to provide its own resources in addition to core and theme-specific ones. In this case, it's blueprints.

**Example**

[prism classes="language-twig line-numbers"]
$scanBlueprintsAndTemplates = function () use ($grav) {
    // Scan blueprints
    $event = new Event();
    $event->types = self::$types;
    $grav->fireEvent('onGetPageBlueprints', $event);

    self::$types->scanBlueprints('theme://blueprints/');

    // Scan templates
    $event = new Event();
    $event->types = self::$types;
    $grav->fireEvent('onGetPageTemplates', $event);

    self::$types->scanTemplates('theme://templates/');
};
[/prism]

In this example, we are using both the `onGetPageTemplates` and `onGetPageBlueprints` hooks to make these plugin-provided resources (templates and blueprints) available to Grav for inheritance and other uses.

## Twig Event Hooks

Twig has its own set of event hooks.

<a name="onTwigTemplatePaths"></a>
#### onTwigTemplatePaths

The base locations for template paths have been set on the **Twig object**.  If you need to add other locations where Twig will search for template paths, this is the event to use.

**Example**

[prism classes="language-twig line-numbers"]
/**
 * Add template directory to twig lookup path.
 */
 public function onTwigTemplatePaths()
 {
     $this->grav['twig']->twig_paths[] = __DIR__ . '/templates';
 }
[/prism]

<a name="onTwigInitialized"></a>
#### onTwigInitialized

The Twig templating engine is now initialized at this point.

<a name="onTwigExtensions"></a>
#### onTwigExtensions

The core Twig extensions have been loaded, but if you need to add [your own Twig extension](https://twig.symfony.com/doc/1.x/advanced.html#creating-an-extension), you can do so with this event hook.

<a name="onTwigPageVariables"></a>
#### onTwigPageVariables

Where Twig processes a page directly, i.e. when you set `process: twig: true` in a page's YAML headers. This is where you should add any variables to Twig that need to be available to Twig during this process.

<a name="onTwigSiteVariables"></a>
#### onTwigSiteVariables

Where Twig processes the full site template hierarchy.  This is where you should add any variables to Twig that need to be available to Twig during this process.

## Collection Event Hooks

<a name="onCollectionProcessed"></a>
#### onCollectionProcessed

If you need to manipulate a collection after it has been processed this is the time to do it.

## Page Event Hooks

<a name="onBuildPagesInitialized"></a>
#### onBuildPagesInitialized

This event is triggered once when pages are going to be reprocessed.  This typically happens if the cache has expired or needs refreshing.  This is a useful event to use for plugins that need to manipulate content and cache the results.

<a name="onBlueprintCreated"></a>
#### onBlueprintCreated

This is used for processing and handling forms.

<a name="onPageContentRaw"></a>
#### onPageContentRaw

After a page has been found, header processed, but content **not** processed.  This is fired for **every page** in the Grav system.  Performance is not a problem because this event will not run on a cached page, only when the cache is cleared or a cache-clearing event occurs.

<a name="onPageProcessed"></a>
#### onPageProcessed

After a page is parsed and processed.  This is fired for **every page** in the Grav system.  Performance is not a problem because this event will not run on a cached page, only when the cache is cleared or a cache-clearing event occurs.

<a name="onMarkdownInitialized"></a>
#### onMarkdownInitialized

Called when Markdown has been initialized. Allows to override the default Parsedown processing implementation. See [an usage example on the PR that introduced it](https://github.com/getgrav/grav/pull/747#issuecomment-206821370).

<a name="onPageContentProcessed"></a>
#### onPageContentProcessed

This event is fired after the page's `content()` method has processed the page content.  This is particularly useful if you want to perform actions on the post-processed content but ensure the results are cached.  Performance is not a problem because this event will not run on a cached page, only when the cache is cleared or a cache-clearing event occurs.

<a name="onFolderProcessed"></a>
#### onFolderProcessed

After a folder is parsed and processed.  This is fired for **every folder** in the Grav system.  Performance is not a problem because this event will not run on a cached page, only when the cache is cleared or a cache-clearing event occurs.

<a name="onPageFallBackUrl"></a>
#### onPageFallBackUrl

If a route is not recognized as a page, Grav tries to access a page media asset. The event is fired as soon as the procedure begins, so plugins can hook and provide additional functionality.

#### onMediaLocate

Adds support for custom media locations for excerpts.

#### onTwigLoader

Adds support for use of namespaces in conjunction with two new methods in Twig class: `Twig::addPath($path, $namespace)` and `Twig::prependPath($path, $namespace)`.

---

## index.php

> Path: grav-learn/pages/04.plugins/05.grav-lifecycle/docs.16.md


It is often useful to know how Grav processes in order to fully understand how best to extend Grav via plugins. This is the Grav lifecycle:

<div class="level level-1" markdown=1>
### index.php
1. Check PHP version to ensure we're running at least version **7.1.3**
2. Class loader initialization
3. Obtain Grav instance
    <div class="level level-2" markdown=1>
    ### Grav.php
    1. No instance exists, so call `load()`
    2. Add `loader`
    3. Add and initialize `debugger`
    4. Add `grav` (deprecated)
    5. Register Services
        1. Accounts Service Provider
            1. Add `accounts`
            2. Add `users` (deprecated)
        2. Assets Service Provider
            1. Add `assets`
        3. Backups Service Provider
            1. Add `backups`
        4. Config Service Provider
            1. Add `setup`
            2. Add `blueprints`
            3. Add `config`
            4. Add `languages`
            5. Add `language`
        5. Error Service Provider
            1. Add `error`
        6. Filesystem Service Provider
            1. Add `filesystem`
        7. Inflector Service Provider
            1. Add `inflector`
        8. Logger Service Provider
            1. Add `log`
        9. Output Service Provider
            1. Add `output`
        10. Pages Service Provider
            1. Add `pages`
            2. Add `page`
        11. Request Service Provider
            1. Add `request`
        12. Scheduler Service Provider
            1. Add `scheduler`
        13. Session Service Provider
            1. Add `session`
            2. Add `messages`
        14. Streams Service Provider
            1. Add `locator`
            2. Add `streams`
        15. Task Service Provider
            1. Add `task`
            2. Add `action`
        16. Other Service Providers
            1. Add `browser`
            2. Add `cache`
            3. Add `events`
            4. Add `exif`
            5. Add `plugins`
            6. Add `taxonomy`
            7. Add `themes`
            8. Add `twig`
            9. Add `uri`
    </div>
4. call `Grav::process()`
    <div class="level level-2" markdown="1">
    ### Grav.php
    1. Run Configuration Processor
        1. Initialize `$grav['config']`
        2. Load plugins and their configuration `$grav['plugins']`
    2. Run Logger Processor
        1. Initialize `$grav['log']`
    3. Run Errors Processor
        1. Initialize `$grav['errors']`
        2. Registers PHP error handlers
    4. Run Debugger Processor
        1. Initialize `$grav['debugger']`
    5. Run Initialize Processor
        1. Start output buffering
        2. Initialize the timezone
        3. Initialize `$grav['session']` if `system.session.initialize` is true
        4. Initialize `$grav['uri']`
            1. Add `$grav['base_url_absolute']`
            2. Add `$grav['base_url_relative']`
            3. Add `$grav['base_url']`
        5. Redirect if `system.pages.redirect_trailing_slash` is true and trailing slash in URL
    6. Run Plugins Processor
        1. Initialize `$grav['accounts']`
        2. Initialize `$grav['plugins']`
        3. Fire **onPluginsInitialized** event
    7. Run Themes Processor
        1. Initialize `$grav['themes']`
        2. Fire **onThemeInitialized** event
    8. Run Request Processor
        1. Initialize `$grav['request']`
        2. Fire **onRequestHandlerInit** event with [request, handler]
        3. If response is set inside the event, stop further processing and output the response
    9. Run Tasks Processor
        1. If request has attribute _controller.class_ and either _task_ or _action_:
            1. Run the controller
            2. If `NotFoundException`: continue (check task and action)
            3. If response code 418: continue (ignore task and action)
            4. Else: stop further processing and output the response
        2. If _task_:
            1. Fire **onTask** event
            2. Fire **onTask.[TASK]** event
        3. If _action_:
            1. Fire **onAction** event
            2. Fire **onAction.[ACTION]** event
    10. Run Backups Processor
        1. Initialize `$grav['backups']`
        2. Fire **onBackupsInitialized** event
    11. Run Scheduler Processor
        1. Initialize `$grav['scheduler']`
        2. Fire **onSchedulerInitialized** event
    12. Run Assets Processor
        1. Initialize `$grav['assets']`
        2. Fire **onAssetsInitialized** event
    13. Run Twig Processor
        1. Initialize `$grav['twig']`
            <div class="level level-3" markdown="1">
            ### Twig.php
            1. Set Twig template paths based on configuration
            2. Handle language templates if available
            3. Fire **onTwigTemplatePaths** event
            4. Fire **onTwigLoader** event
            5. Load Twig configuration and loader chain
            6. Fire **onTwigInitialized** event
            7. Load Twig extensions
            8. Fire **onTwigExtensions** event
            9. Set standard Twig variables (config, uri, taxonomy, assets, browser, etc)
            </div>
    14. Run Pages Processor
        1. Initialize `$grav['pages']`
            <div class="level level-3" markdown="1">
            ### Pages.php
            1. Call `buildPages()`
            2. Check if cache is good
            3. If **cache is good** load pages date from
            4. If **cache is not good** call `recurse()`
            5. Fire **onBuildPagesInitialized** event in `recurse()`
            6. If a `.md` file is found:
                <div class="level level-4" markdown="1">
                ### Page.php
                1. Call `init()` to load the file details
                2. Set the `filePath`, `modified`, `id`
                3. Call `header()` to initialize the header variables
                4. Call `slug()` to set the URL slug
                5. Call `visible()` to set visible state
                6. Set `modularTwig()` status based on if folder starts with `_`
                </div>
            7. Fire **onPageProcessed** event
            8. If a `folder` found `recurse()` the children
            9. Fire **onFolderProcessed** event
            10. Call `buildRoutes()`
            11. Initialize `taxonomy` for all pages
            12. Build `route` table for fast lookup
            </div>
        2. Fire **onPagesInitialized** event with [pages]
        3. Fire **onPageInitialized** event with [page]
        4. If page is not routable:
            1. Fire **onPageNotFount** event with [page]
        5. If _task_:
            1. Fire **onPageTask** event with [task, page]
            2. Fire **onPageTask.[TASK]** event with [task, page]
        6. If _action_:
            1. Fire **onPageAction** event with [action, page]
            2. Fire **onPageAction.[ACTION]** event with [action, page]
    15. Run Debugger Assets Processor
        1. Add the debugger CSS/JS to the assets
    16. Run Render Processor
        1. Initialize `$grav['output']`
        2. If `output` instanceof `ResponseInterface`:
            1. Stop further processing and output the response
        3. Else:
            1. Render page with Twig's `processSite()` method
                <div class="level level-3" markdown="1">
                ### Twig.php
                1. Fire **onTwigSiteVariables** event
                2. Get the page output
                3. Fire **onTwigPageVariables**, also called for each modular subpage
                4. If a page is not found or not routable, first fire the **onPageFallBackUrl** event to see if we have a fallback for a media asset and then fire **onPageNotFound** if not
                5. Set all Twig variables on the Twig object
                6. Set the template name based on file/header/extension information
                7. Call `render()` method
                8. Return resulting HTML
                </div>
            2. Fire **onOutputGenerated** event
            3. Echo the output into output buffer
            4. Fire **onOutputRendered** event
            5. Build _Response_ object
            6. Stop further processing and output the response
    17. Output HTTP header and body
    18. Render debugger (if enabled)
    19. Shutdown
        1. Close session
        2. Close connection to client
        3. Fire **onShutdown** event
    </div>
</div>
Whenever a page has its `content()` method called, the following lifecycle occurs:

<div class="level level-1" markdown="1">
### Page.php
1. If content is **NOT** cached:
    1. Fire **onPageContentRaw** event
    2. Process the page according to Markdown and Twig settings. Fire **onMarkdownInitialized** event
    3. Fire **onPageContentProcessed** event
2. Fire **onPageContent** event
</div>

---

## index.php

> Path: grav-learn/pages/04.plugins/05.grav-lifecycle/docs.17.md


It is often useful to know how Grav processes in order to fully understand how best to extend Grav via plugins. This is the Grav lifecycle:

<div class="level level-1" markdown=1>
### index.php
1. Check PHP version to ensure we're running at least version **7.1.3**
2. Class loader initialization
3. Obtain Grav instance
    <div class="level level-2" markdown=1>
    ### Grav.php
    1. No instance exists, so call `load()`
    2. Add `loader`
    3. Add and initialize `debugger`
    4. Add `grav` (deprecated)
    5. Register Default Services
    6. Register Service Providers
        1. Accounts Service Provider
            1. Add `permissions` (1.7)
            2. Add `accounts` (1.6)
            3. Add `user_groups` (1.7)
            4. Add `users` *(deprecated)*
        2. Assets Service Provider
            1. Add `assets`
        3. Backups Service Provider
            1. Add `backups` (1.6)
        4. Config Service Provider
            1. Add `setup`
            2. Add `blueprints`
            3. Add `config`
            4. Add `languages`
            5. Add `language`
        5. Error Service Provider
            1. Add `error`
        6. Filesystem Service Provider
            1. Add `filesystem`
        7. Flex Service Provider
            1. Add `flex` (1.7)
        8. Inflector Service Provider
            1. Add `inflector`
        9. Logger Service Provider
            1. Add `log`
        10. Output Service Provider
            1. Add `output`
        11. Pages Service Provider
            1. Add `pages`
            2. Add `page`
        12. Request Service Provider
            1. Add `request` (1.7)
        13. Scheduler Service Provider
            1. Add `scheduler` (1.6)
        14. Session Service Provider
            1. Add `session`
            2. Add `messages`
        15. Streams Service Provider
            1. Add `locator`
            2. Add `streams`
        16. Task Service Provider
            1. Add `task`
            2. Add `action`
        17. Simple Service Providers
            1. Add `browser`
            2. Add `cache`
            3. Add `events`
            4. Add `exif`
            5. Add `plugins`
            6. Add `taxonomy`
            7. Add `themes`
            8. Add `twig`
            9. Add `uri`
    </div>
4. call `Grav::process()`
    <div class="level level-2" markdown="1">
    ### Grav.php
    1. Run Initialize Processor
        1. Configuration
            1. Initialize `$grav['config']`
            2. Initialize `$grav['plugins']`
        2. Logger
            1. Initialize `$grav['log']`
        3. Errors
            1. Initialize `$grav['errors']`
            2. Registers PHP error handlers
        4. Debugger
            1. Initialize `$grav['debugger']`
        5. Handle debugger requests
        6. Start output buffering
        7. Localization
            1. Set the locale and timezone
        8. Plugins
            1. Initialize `$grav['plugins']`
        9. Pages
            1. Initialize `$grav['pages']`
        10. Uri
            1. Initialize `$grav['uri']`
            2. Add `$grav['base_url_absolute']`
            3. Add `$grav['base_url_relative']`
            4. Add `$grav['base_url']`
        11. Handle redirect
            1. Redirect if `system.pages.redirect_trailing_slash` is true and trailing slash in URL
        12. Accounts
            1. Initialize `$grav['accounts']`
        13. Session
            1. Initialize `$grav['session']` if If `system.session.initialize` is `true`
    2. Run Plugins Processor
        1. Fire **onPluginsInitialized** event
    3. Run Themes Processor
        1. Initialize `$grav['themes']`
        2. Fire **onThemeInitialized** event
    4. Run Request Processor
        1. Initialize `$grav['request']`
        2. Fire **onRequestHandlerInit** event with [request, handler]
        3. If response is set inside the event, stop further processing and output the response
    5. Run Tasks Processor
        1. If request has attribute _controller.class_ and either _task_ or _action_:
            1. Run the controller
            2. If `NotFoundException`: continue (check task and action)
            3. If response code 418: continue (ignore task and action)
            4. Else: stop further processing and output the response
        2. If _task_:
            1. Fire **onTask** event
            2. Fire **onTask.[TASK]** event
        3. If _action_:
            1. Fire **onAction** event
            2. Fire **onAction.[ACTION]** event
    6. Run Backups Processor
        1. Initialize `$grav['backups']`
        2. Fire **onBackupsInitialized** event
    7. Run Scheduler Processor
        1. Initialize `$grav['scheduler']`
        2. Fire **onSchedulerInitialized** event
    8. Run Assets Processor
        1. Initialize `$grav['assets']`
        2. Fire **onAssetsInitialized** event
    9. Run Twig Processor
        1. Initialize `$grav['twig']`
            <div class="level level-3" markdown="1">
            ### Twig.php
            1. Set Twig template paths based on configuration
            2. Handle language templates if available
            3. Fire **onTwigTemplatePaths** event
            4. Fire **onTwigLoader** event
            5. Load Twig configuration and loader chain
            6. Fire **onTwigInitialized** event
            7. Load Twig extensions
            8. Fire **onTwigExtensions** event
            9. Set standard Twig variables (config, uri, taxonomy, assets, browser, etc)
            </div>
    10. Run Pages Processor
        1. Initialize `$grav['pages']`
            <div class="level level-3" markdown="1">
            ### Pages.php
            1. Call `buildPages()`
            2. (logic differs somewhat for Flex Pages, but the idea is the same)
            3. Check if cache is good
            4. If **cache is good** load pages date from
            5. If **cache is not good** call `recurse()`
            6. Fire **onBuildPagesInitialized** event in `recurse()`
            7. If a `.md` file is found:
                <div class="level level-4" markdown="1">
                ### Page.php
                1. Call `init()` to load the file details
                2. Set the `filePath`, `modified`, `id`
                3. Call `header()` to initialize the header variables
                4. Call `slug()` to set the URL slug
                5. Call `visible()` to set visible state
                6. Set `modularTwig()` status based on if folder starts with `_`
                </div>
            8. Fire **onPageProcessed** event
            9. If a `folder` found `recurse()` the children
            10. Fire **onFolderProcessed** event
            11. Call `buildRoutes()`
            12. Initialize `taxonomy` for all pages
            13. Build `route` table for fast lookup
            </div>
        2. Fire **onPagesInitialized** event with [pages]
        3. Fire **onPageInitialized** event with [page]
        4. If page is not routable:
            1. Fire **onPageNotFound** event with [page]
        5. If _task_:
            1. Fire **onPageTask** event with [task, page]
            2. Fire **onPageTask.[TASK]** event with [task, page]
        6. If _action_:
            1. Fire **onPageAction** event with [action, page]
            2. Fire **onPageAction.[ACTION]** event with [action, page]
    11. Run Debugger Assets Processor
        1. Debugbar only: Add the debugger CSS/JS to the assets
    12. Run Render Processor
        1. Initialize `$grav['output']`
        2. If `output` instanceof `ResponseInterface`:
            1. Stop further processing and output the response
        3. Else:
            1. Render page with Twig's `processSite()` method
                <div class="level level-3" markdown="1">
                ### Twig.php
                1. Fire **onTwigSiteVariables** event
                2. Get the page output
                3. Fire **onTwigPageVariables**, also called for each modular subpage
                4. If a page is not found or not routable, first fire the **onPageFallBackUrl** event to see if we have a fallback for a media asset and then fire **onPageNotFound** if not
                5. Set all Twig variables on the Twig object
                6. Set the template name based on file/header/extension information
                7. Call `render()` method
                8. Return resulting HTML
                </div>
            2. Fire **onOutputGenerated** event
            3. Echo the output into output buffer
            4. Fire **onOutputRendered** event
            5. Build _Response_ object
            6. Stop further processing and output the response
    13. Fire **onPageHeaders** event to allow page header manipulation
    14. Output HTTP header and body
    15. Render debugger (if enabled)
    16. Shutdown
        1. Close session
        2. Close connection to client
        3. Fire **onShutdown** event
    </div>
</div>
Whenever a page has its `content()` method called, the following lifecycle occurs:

<div class="level level-1" markdown="1">
### Page.php
1. If content is **NOT** cached:
    1. Fire **onPageContentRaw** event
    2. Process the page according to Markdown and Twig settings. Fire **onMarkdownInitialized** event
    3. Fire **onPageContentProcessed** event
2. Fire **onPageContent** event
</div>

---

## index.php

> Path: grav-learn/pages/04.plugins/05.grav-lifecycle/docs.md


It is often useful to know how Grav processes in order to fully understand how best to extend Grav via plugins. This is the Grav lifecycle:

<div class="level level-1" markdown=1>
### index.php
1. Check PHP version to ensure we're running at least version **5.5.9**
2. Class loader initialization
3. Obtain Grav instances
    <div class="level level-2" markdown=1>
    ### Grav.php
    1. No instance exists, so call `load()`
    2. Add `grav`
    3. Initialize the debugger and add it to `debugger`
    4. Register the `log` handler
    5. Register the `error` handler
    6. Add `uri`
    7. Add `task`
    8. Add `events`
    9. Add `cache`
    10. Add `session`
    11. Add `plugins`
    12. Add `themes`
    13. Add `twig`
    14. Add `taxonomy`
    15. Add `language`
    16. Add `pages`
    17. Add `assets`
    18. Add `page`
    19. Add `output`
    20. Add `browser`
    21. Add `base_url_absolute`
    22. Add `base_url_relative`
    23. Add `base_url`
    24. Register the `stream` handler
    25. Register the `config` handler
    </div>
4. call `Grav::process()`
    <div class="level level-2" markdown=1>
    ### Grav.php
    1. Initialize the configuration
    2. Initialize the Session
    3. Initialize the Uri object
    4. Initialize the error handler
    5. Initialize the debugger
    6. Start output buffering
    7. Initialize the timezone
    8. Initialize the `plugins`
    9. Fire **onPluginsInitialized** event
    10. Initialize the theme
    11. Fire **onThemeInitialized** event
    12. Fire **onTask[TASK]** event
    13. Initialize `assets`
    14. Fire **onAssetsInitialized** event
    15. Initialize `twig`
        <div class="level level-3" markdown=1>
        ### Twig.php
        1. Set Twig template paths based on configuration
        2. Handle language templates if available
        3. Fire **onTwigTemplatePaths** event
        4. Load Twig configuration and loader chain
        5. Fire **onTwigInitialized** event
        6. Load Twig extensions
        7. Fire **onTwigExtensions** event
        8. Set standard Twig variables (config, uri, taxonomy, assets, browser, etc)
        </div>
    16. Initialize `pages`
        <div class="level level-3" markdown=1>
        ### Pages.php
        1. Call `buildPages()`
        2. Check if cache is good
        3. If **cache is good** load pages date from cache
        4. If **cache is not good** call `recurse()`
        5. Fire **onBuildPagesInitialized** event in `recurse()`
        6. If a `.md` file is found:
            <div class="level level-4" markdown=1>
            ### Page.php
            1. Call `init()` to load the file details
            2. Set the `filePath`, `modified`, `id`
            3. Call `header()` to initialize the header variables
            4. Call `slug()` to set the URL slug
            5. Call `visible()` to set visible state
            6. Set `modularTwig()` status based on if folder starts with `_`
            </div>
        7. Fire **onPageProcessed** event
        8. If a `folder` found `recurse()` the children
        9. Fire **onFolderProcessed** event
        10. Call `buildRoutes()`
        11. Initialize `taxonomy` for all pages
        12. Build `route` table for fast lookup
        </div>
    17. Fire **onPagesInitialized** event
    18. Fire **onPageInitialized** event
    19. Add the debugger CSS/JS to the assets
    20. Get Output with Twig's `processSite()` method
        <div class="level level-3" markdown=1>
        ### Twig.php
        1. Fire **onTwigSiteVariables** event
        2. Get the page output
        3. Fire **onTwigPageVariables**, also called for each modular subpage
        4. If a page is not found or not routable, first fire the **onPageFallBackUrl** event to see if we have a fallback for a media asset and then fire **onPageNotFound** if not
        5. Set all Twig variables on the Twig object
        6. Set the template name based on file/header/extension information
        7. Call `render()` method
        8. Return resulting HTML
        </div>
    21. Fire **onOutputGenerated** event
    22. Set the HTTP headers
    23. Echo the output
    24. Flush the output buffers to the page
    25. Fire **onOutputRendered** event
    26. Connection to client is closed
    27. Fire **onShutdown** event
    </div>
</div>

Whenever a page has its `content()` method called, the following lifecycle occurs:

<div class="level level-1" markdown="1">
### Page.php
1. If content is **NOT** cached:
    1. Fire **onPageContentRaw** event
    2. Process the page according to Markdown and Twig settings. Fire **onMarkdownInitialized** event
    3. Fire **onPageContentProcessed** event
2. Fire **onPageContent** event
</div>

---

## Introduction

> Path: grav-learn/pages/04.plugins/06.plugin-flex/docs.md


## Introduction

Flex usages, be in twig or in code, will be only covered for the purpose of this introduction. To understand the power and flexibily of Flex, please read our [dedicated Flex documentation](/advanced/flex).

Flex allows custom Objects CRUDS, as single object or collection, and provides an extensive APIs usable from your plugin code or templates.

Admin UI can be added easily, either using standard templates or your own customized listing or forms (or else).

## Requirements

Grav 1.7 or later is required. For the purpose of this documentation, we will be using the grav+admin installation, make sure you have it up and running to follow the steps below. See the [installation documentation](/basics/installation) to get it ready.

## Create your plugins

As it is possible to create a plugin, with or without flex from scratch, to ensure all latest changes are in place, we highly recommend to use the devtools to generate the skeleton and basic features for you:

To do so, we will use the devtools CLI:

[prism classes="language-shell command-line"]
bin/gpm install devtools
[/prism]

To [create a new plugin using the devtools](/plugins/plugin-tutorial), the following command is used, the plugin name is myflexplugin:

[prism classes="language-shell command-line"]
 grav-admin bin/plugin devtools new-plugin
[/prism]

and fill up the questions using the following answers, the important part is to choose a plugin prepared for flex:

[prism classes="language-shell command-line"]
 Enter Plugin Name:
 > myflexplugin

 Enter Plugin Description:
 > A little Flex plugin test

 Enter Developer Name:
 > grav@example.com

 Enter GitHub ID (can be blank):
 > gravcms

 Enter Developer Email:
 > grav@example.com

 Please choose an option:
  [blank] Basic Plugin
  [flex ] Basic Plugin prepared for custom Flex Objects
 > flex

 Enter Flex Object Name:
 > book

 Please choose a storage type:
  [simple] Basic Storage (1 file for all objects) - no media support
  [file  ] File Storage (1 file per object)
  [folder] Folder Storage (1 folder per object)
 > folder


SUCCESS plugin myflexplugin -> Created Successfully

Path: /home/pierre/project/grav/grav-admin/user/plugins/myflexplugin

Please run `cd /home/pierre/project/grav/grav-admin/user/plugins/myflexplugin` and `composer update` to initialize the autoloader
[/prism]

On success, we need now to install the dependencies, if any, for our new plugin:


[prism classes="language-shell command-line"]
cd /home/pierre/project/grav/grav-admin/user/plugins/myflexplugin
[/prism]
[prism classes="language-shell command-line"]
composer update
[/prism]

On success, the following output should be displayed:

[prism classes="language-shell command-line"]
Loading composer repositories with package information
Updating dependencies
Nothing to modify in lock file
Writing lock file
Installing dependencies from lock file (including require-dev)
Nothing to install, update or remove
Generating autoload files
No installed packages - skipping audit.
[/prism]

and go back to the root folder of the grav-admin install:


[prism classes="language-shell command-line"]
cd -
[/prism]

The devtools generated a very basic flex object, made of a name and a description, and its collection. The admin UI already allows one to list these books objects, create, edit or delete them, without having written a single line of code.

A new entry in the left side menu has been added:

![Admin book flex menu entry](admin_menu_book.png)

The default edit form looks like:

![Simple form edit](book_edit.png)


You should also see the various folders and files related to your plugin and its flex object 'book'.

## What is done where


The plugin folder should look like this:
[prism classes="language-bash line-numbers"]
../grav-admin/user/plugins/myflexplugin
 CHANGELOG.md
 LICENSE
 README.md
 blueprints
  flex-objects
      book.yaml
 blueprints.yaml
 classes
  Flex
      Types
          Book
              BookCollection.php
              BookObject.php
 composer.json
 composer.lock
 languages.yaml
 myflexplugin.php
 myflexplugin.yaml
 vendor
     autoload.php
     composer
         ClassLoader.php
         InstalledVersions.php
         LICENSE
         autoload_classmap.php
         autoload_namespaces.php
         autoload_psr4.php
         autoload_real.php
         autoload_static.php
         installed.json
         installed.php
         platform_check.php
[/prism]

### Flex Object definition
The key file is the [blueprints](advanced/flex/custom-types/blueprint) definition. It is where the schema of this flex object will be defined, along with the numerous options to customize pretty much anything about it.

In our plugin, the book blueprints can be found at user/plugins/myflexplugin/blueprints/flex-objects/book.yaml.

> **IMPORTANT** The blueprint for each flex object in your plugin (or main install /blueprints) must be in  blueprints/flex-objects/ folder or they won't be found.

The schema is defined using the Form section of this blueprints. Whether or not the admin UI forms will be used, this section defines the properties of this flex object.

We won't cover all options here, but focus on getting our book object implement. The [extensive Flex blueprints documentation](/advanced/flex/custom-types/blueprint) will guide you to go deeper and customize it.

The schema below defines the two properties:
[prism classes="language-yaml line-numbers"]
form:
    validation: loose
    fields:
        published:
            type: toggle
            label: Published
            highlight: 1
            default: 1
            options:
                1: PLUGIN_ADMIN.YES
                0: PLUGIN_ADMIN.NO
            validate:
                type: bool
                required: true
        name:
            type: text
            label: Name
            validate:
                required: true
        description:
            type: text
            label: Description
            validate:
                required: true
[/prism]

### plugin hooks

the myflexplugin.php is the usual core definition for the implementations of the pluging, hooks etc.

These parts are required to enable flex:

[prism classes="language-php line-numbers"]
    public $features = [
        'blueprints' => 0,
    ];

    /**
     * @return array
     *
     * The getSubscribedEvents() gives the core a list of events
     *     that the plugin wants to listen to. The key of each
     *     array section is the event that the plugin listens to
     *     and the value (in the form of an array) contains the
     *     callable (or function) as well as the priority. The
     *     higher the number the higher the priority.
     */
    public static function getSubscribedEvents(): array
    {
        return [
            'onPluginsInitialized' => [
                // Uncomment following line when plugin requires Grav < 1.7
                // ['autoload', 100000],
                ['onPluginsInitialized', 0]
            ],
            FlexRegisterEvent::class       => [['onRegisterFlex', 0]],
        ];
    }
[/prism]

The other files are standard and well documented in earlier sections of the plugins documentations. We won't cover them here.

The _classes_ folder contains the classes used for the book flex object and the book flex collection. These are the classes where you can add custom methods that would be available on every object or collection instances. See [add custom methods to a flex object](#add-custom-method-to-the-flex-object).

## Modify the flex object schema

Let add a field to our object, say a datetime field representing the publication's date of this book, it can be achieved by simply adding the pub_date fields to the blueprints:

[prism classes="language-yaml line-numbers"]
form:
    validation: loose
    fields:
        published:
            type: toggle
            label: Published
            highlight: 1
            default: 1
            options:
                1: PLUGIN_ADMIN.YES
                0: PLUGIN_ADMIN.NO
            validate:
                type: bool
                required: true
        name:
            type: text
            label: Name
            validate:
                required: true
        pub_date:
            type: datetime
            label: Description
            validate:
                required: true
[/prism]

The default edit form now shows the date input fields for the publication date:

![Simple form edit](pub_date_added.png)

The list of all fields types available can be found [here](/forms/blueprints/fields-available)

## Add custom method to the flex object<a href="#addcustommethod"></a>

The current flex book object, user/plugins/myflexplugin/classes/Flex/Types/Book/BookObject.php, only implements the GenericObject (using traits):

[prism classes="language-php line-numbers"]
<?php

declare(strict_types=1);

/**
 * @package    Grav\Common\Flex
 *
 * @copyright  Copyright (c) 2015 - 2021 Trilby Media, LLC. All rights reserved.
 * @license    MIT License; see LICENSE file for details.
 */

namespace Grav\Plugin\Myflexplugin\Flex\Types\Book;

use Grav\Common\Flex\Types\Generic\GenericObject;

/**
 * Class BookObject
 * @package Grav\Common\Flex\Generic
 *
 * @extends FlexObject<string,GenericObject>
*/
class BookObject extends GenericObject
{

}
[/prism]

Let add a method to get the summary of the book, using the site's delimiter for the summary:


[prism classes="language-php line-numbers"]
<?php

declare(strict_types=1);

/**
 * @package    Grav\Common\Flex
 *
 * @copyright  Copyright (c) 2015 - 2021 Trilby Media, LLC. All rights reserved.
 * @license    MIT License; see LICENSE file for details.
 */

namespace Grav\Plugin\Myflexplugin\Flex\Types\Book;

use Grav\Common\Flex\Types\Generic\GenericObject;

/**
 * Class BookObject
 * @package Grav\Common\Flex\Generic
 *
 * @extends FlexObject<string,GenericObject>
*/
class BookObject extends GenericObject
{
    public function getSummary() {
        $delimiter = \Grav\Common\Grav::instance()['config']['site']['summary']['delimiter'] ?? '===';
        $summary = explode($delimiter, $this->content);
        return $summary[0] ?? '';
    }
}
[/prism]

Now we can call this method anywhere where a book flex object is used, for example, in a template:


[prism classes="language-twig line-numbers"]
{% set books = grav.get('flex').collection('book') %}
{% for book in books  %}
    <h1>{{ book.header.title}}</h1>
    <p>{{ book.getSummary()}}</p>
{% endfor %}
[/prism]

The ::getSummary method can be used in any PHP code as well.

The same can be done in the collection class, user/plugins/myflexplugin/classes/Flex/Types/Book/BookCollection.php. For example to add friendly method to search using non trivial queries. Indeed the collection already provides all common collections methods. It can be handy to add some helpers if an object has many different fields were the standard collection methods could be error prone.
---

## Chapter 4

> Path: grav-learn/pages/04.plugins/chapter.md


### Chapter 4

# Plugins

**Grav** is fully extensible with a powerful **Plugin** architecture to allow you to extend the core functionality and add as much functionality as you like.

---

## Features

> Path: grav-learn/pages/05.admin-panel/01.introduction/docs.md


The **Administration Panel** plugin for [Grav](https://github.com/getgrav/grav) is a web GUI (graphical user interface) that provides a convenient way to configure Grav and easily create and modify pages.  This will remain a totally optional plugin, and is not in any way required or needed to use Grav effectively.  In fact, the admin interface provides an intentionally limited view to ensure it remains easy to use and not overwhelming.  Power users will still prefer to work with the configuration files directly.

![](admin-dashboard.png?width=2528&classes=shadow)

### Features

* User login with automatic password hashing
* Forgot password functionality
* Logged-in-user management
* One click Grav core updates
* Dashboard with maintenance status, site activity and latest page updates
* Ajax-powered backup capability
* Ajax-powered clear-cache capability
* System configuration management
* Site configuration management
* Normal and Expert modes which allow editing via forms or YAML
* Page listing with filtering and search
* Page creation, editing, moving, copying, and deleting
* Powerful syntax highlighting code editor with instant Grav-powered preview
* Editor features, hot keys, toolbar, and distraction-free fullscreen mode
* Drag-n-drop upload of page media files including drag-n-drop placement in the editor
* One click theme and plugin updates
* Plugin manager that allows listing and configuration of installed plugins
* Theme manager that allows listing and configuration of installed themes
* GPM-powered installation of new plugins and themes
* ACL for admin users access to features

### Support

The Adminstration Panel is quite an ambitious plugin with lots of functionality that will give you a lot of power and flexibility when building out your Grav sites. So if you have any questions, problems, suggestions or find one of those rare bugs in it, please use one of the following ways to get support from us.

For **live chatting**, please use the [Discord Chat Server](https://chat.getgrav.org) for discussions  related to the admin plugin.

For **bugs, features, improvements**, please ensure you [create issues in the admin plugin GitHub repository](https://github.com/getgrav/grav-plugin-admin).

### Installation

First ensure you are running the latest Grav version, **{{ grav_version }} or later**.  This is required for the admin plugin to run properly.  Check for and upgrade to new Grav versions like this (`-f` forces a refresh of the GPM index):

[prism classes="language-bash command-line"]
bin/gpm version -f
bin/gpm selfupgrade
[/prism]

The admin plugin actually requires the help of 3 other plugins, so to get the **admin** plugin to work you first need to install the **login**, **forms**, and **email** plugins.  These are available via GPM, and because the plugin has dependencies you just need to proceed and install the admin plugin, and agree when prompted to install the others:

[prism classes="language-bash command-line"]
bin/gpm install admin
[/prism]

You can also [install the plugin manually](../faq#manual-installation-of-admin) if you are unable to use GPM on your system.

### Creating a User

With the latest version of the Admin, you will be prompted to create an admin user account when you point your browser to your site.  You must complete this step to ensure straight away a valid admin user is under your control.

![](new-user.png?width=1654&classes=shadow)

Simply fill out the form and click the `Create User` button.

The user information is stored in the `user/accounts/` folder of your Grav installation.  You can edit the values manually or via the Admin plugin itself.  You can also create new users manually or via the `bin/plugin login newuser` CLI command.  More information is contained in the [Admin FAQ](../faq#adding-and-managing-users).

### Username and Password Complexity

Regex patterns for usernames and passwords are defined in `system/config/system.yaml`.

The default pattern for users (`system.username_regex`) is only lowercase characters, digits, dashes, and underscores. Usernames must be between 3 - 16 characters in length.

The default pattern for passwords (`system.pwd_regex`) is a minimum of eight (8) characters, with at least one number, one uppercase, and one lowercase letter.

### Usage

By default, you can access the admin by pointing your browser to `http://yoursite.com/admin`. You can simply log in with the `username` and `password` set in the YAML file you configured earlier.

> After logging in, your **plaintext password** will be removed and replaced by an **encrypted** one.

---

## Content

> Path: grav-learn/pages/05.admin-panel/02.dashboard/01.configuration-system/docs.md


![Admin Configuration](configuration.png?width=2530&classes=shadow)

The **Configuration** page gives you access to your site's **System** and **Site** configuration settings. Additionally, you can view a breakdown of your server's properties in a number of areas including PHP, server environment, and other various components that determine how your site operates.

!! The Configuration requires an `access.admin.super` or `access.admin.configuration` access level.

The **System** tab enables you to customize the settings found in the `/user/config/system.yaml` file. These settings affect how many of the primary system-related features of Grav operate. The site's home page, caching settings, and more can be configured here.

These settings are separated into several sections, each focusing on a specific aspect of Grav's operation.

Below is a breakdown of the different configuration sections that appear in the **System** tab.

### Content

![Admin Configuration](configuration-system-content.png?width=1594&classes=shadow)

This section is where you set the basic properties of content handling for your site. The home page, default theme, and various other content display options are set here.

[div class="table table-striped table-keycol"]
| Option                      | Description                                                                |
| :-----                      | :-----                                                                     |
| **Home Page**               | Select the page you wish to have appear as the home page for your site.    |
| **Default Theme**           | Sets the primary default theme used in your site.                          |
| **Process**                 | Control how pages are processed. Can be set per-page rather than globally. |
| **Timezone**                | Override the server's default timezone.                                    |
| **Short Date Format**       | Set the short date format that can be used by themes.                      |
| **Long Date Format**        | Set the long date format that can be used by themes.                       |
| **Default Ordering**        | Pages in a list will render using this order unless it is overridden.      |
| **Default Order Direction** | The direction of pages in a list.                                          |
| **Default Page Count**      | Default maximum pages count in a list.                                     |
| **Date-based Publishing**   | Automatically (un)publish posts based on their date.                       |
| **Events**                  | Enable or Disable specific events.  Disabling these can break plugins.     |
| **Redirect Default Route**  | Automatically redirect to a page's default route.                          |
[/div]

### Languages

![Admin Configuration](configuration-system-languages.png?width=1662&classes=shadow)

Multilanguage features are set in this section.

[div class="table table-striped table-keycol"]
| Option                             | Description                                                               |
| :-----                             | :-----                                                                    |
| **Supported**                      | Comma separated list of 2-letter language codes (for example 'en,fr,de'). |
| **Translations Enabled**           | Support translations in Grav, plugins and extensions.                     |
| **Translations Fallback**          | Fallback through supported translations if active language doesn't exist. |
| **Active Language in Section**     | Store the active language in the session.                                 |
| **Home Redirect Include Language** | Include language in home redirect (/en).                                  |
| **Home Redirect Include Route**    | Home redirect include route.                                              |
[/div]

### HTTP Headers

![Admin Configuration](configuration-system-http.png?width=1336&classes=shadow)

HTTP header options can be set in this section. This is useful for browser-based caching and optimization.

[div class="table table-striped table-keycol"]
| Option                   | Description                                                                     |
| :-----                   | :-----                                                                          |
| **Expires**              | Sets the expires header. The value is in seconds.                               |
| **Last Modified**        | Sets the last modified header that can help optimize proxy and browser caching. |
| **ETag**                 | Sets the etag header to help identify when a page has been modified.            |
| **Vary Accept Encoding** | Sets the *Vary: Accept Encoding* header to help with proxy and CDN caching.     |
[/div]

### Markdown

![Admin Configuration](configuration-system-markdown.png?width=932&classes=shadow)

Markdown makes up the bulk of Grav's page content. This section gives you options to enable Markdown Extra, as well as to set how Grav handles Markdown.

[div class="table table-striped table-keycol"]
| Option               | Description                                                                                   |
| :-----               | :-----                                                                                        |
| **Markdown Extra**   | Enable default support for [Markdown Extra](https://michelf.ca/projects/php-markdown/extra/). |
| **Auto Line Breaks** | Enable support for automatic line breaks in markdown.                                         |
| **Auto URL Links**   | Enable automatic conversion of URLs into HTML hyperlinks.                                     |
| **Escape Markup**    | Escape markup tags into HTML entities.                                                        |
[/div]

### Caching

![Admin Configuration](configuration-system-caching.png?width=1364&classes=shadow)

Grav's integrated caching feature helps make it one of the fastest flat-file CMS options out there. You can configure your site's primary caching functions in this section.

[div class="table table-striped table-keycol"]
| Option                 | Description                                                                                 |
| :-----                 | :-----                                                                                      |
| **Caching**            | Global ON/OFF switch to enable/disable Grav caching.                                        |
| **Cache Check Method** | Sets the cache check method. The options are **File**, **Folder**, and **None**.            |
| **Cache Driver**       | Choose which cache driver Grav should use. 'Auto Detect' attempts to find the best for you. |
| **Cache Prefix**       | An identifier for part of the Grav key.  Don't change unless you know what you're doing.    |
| **Lifetime**           | Sets the cache lifetime in seconds. 0 = infinite.                                           |
| **Gzip Compression**   | Enable GZip compression of the Grav page for increased performance.                         |
[/div]

### Twig Templating

![Admin Configuration](configuration-system-twig.png?width=906&classes=shadow)

This section focuses on Grav's Twig templating feature. You can set Twig caching, debug, and change detection settings here.

[div class="table table-striped table-keycol"]
| Option                   | Description                                                                                   |
| :-----                   | :-----                                                                                        |
| **Twig Caching**         | Control the Twig caching mechanism. Leave this enabled for best performance.                  |
| **Twig Debug**           | Allows the option of not loading the Twig Debugger extension.                                 |
| **Detect Changes**       | Twig will automatically recompile the Twig cache if it detects any changes in Twig templates. |
| **Autoescape Variables** | Autoescapes all variables. This will break your site most likely.                             |
[/div]

### Assets

![Admin Configuration](configuration-system-assets.png?width=1502&classes=shadow)

This section deals with assets handling, including CSS and JavaScript assets.

[div class="table table-striped table-keycol"]
| Option                          | Description                                                                     |
| :-----                          | :-----                                                                          |
| **CSS Pipeline**                | The CSS pipeline is the unification of multiple CSS resources into one file.    |
| **CSS Minify**                  | Minify the CSS during pipelining.                                               |
| **CSS Minify Windows Override** | Minify Override for Windows platforms. False by default due to ThreadStackSize. |
| **CSS Rewrite**                 | Rewrite any CSS relative URLs during pipelining.                                |
| **JavaScript Pipeline**         | The JS pipeline is the unification of multiple JS resources into one file.      |
| **JavaScript Minify**           | Minify the JS during pipelining.                                                |
| **Enable Timestamps on Assets** | Enable asset timestamps.                                                        |
| **Collections**                 | Add individual asset collections.                                               |
[/div]

### Error Handler

![Admin Configuration](configuration-system-error.png?width=1336&classes=shadow)

You can set how Grav handles error reporting and display here. This is a useful tool to have during site development.

[div class="table table-striped table-keycol"]
| Option            | Description                              |
| :-----            | :-----                                   |
| **Display Error** | Display full backtrace-style error page. |
| **Log Errors**    | Log errors to /logs folder.              |
[/div]

### Debugger

![Admin Configuration](configuration-system-debugger.png?width=950&classes=shadow)

Like error handling, Grav's integrated debugging tools give you the ability to locate and troubleshoot issues. This is especially useful during development.

[div class="table table-striped table-keycol"]
| Option                        | Description                                                            |
| :-----                        | :-----                                                                 |
| **Debugger**                  | Enable Grav debugger and following settings.                           |
| **Debug Twig**                | Enable debugging of Twig templates.                                    |
| **Shutdown Close Connection** | Close the connection before calling onShutdown(). false for debugging. |
[/div]

### Media

![Admin Configuration](configuration-system-media.png?width=1670&classes=shadow)

This section determines how Grav handles media content. Image quality and other media handling options are configured here.

[div class="table table-striped table-keycol"]
| Option                         | Description                                                                                               |
| :-----                         | :-----                                                                                                    |
| **Default Image Quality**      | Default image quality to use when resampling or caching images (85%).                                     |
| **Cache All Images**           | Run all images through Grav's cache system even if they have no media manipulations.                      |
| **Image Debug Watermark**      | Show an overlay over images indicating the pixel depth of the image when working with Retina for example. |
| **Enable Timestamps on Media** | Appends a timestamp based on last modified date to each media item.                                       |
[/div]

!! Caching images that have already been optimised (outside of Grav) could result in the output file being a much larger filesize than the original. This is due to a bug in the Gregwar image library and not directly related to Grav (see this [open issue](https://github.com/Gregwar/Image/issues/115) for more information). The alternative is to set "Cache All Images" to No

### Session

![Admin Configuration](configuration-system-session.png?width=1184&classes=shadow)

This section gives you the ability to enable session support, set timeout limits, and the name of the session cookie used to handle this information.

[div class="table table-striped table-keycol"]
| Option      | Description                                                                                                                                  |
| :-----      | :-----                                                                                                                                       |
| **Enable**  | Enable session support within Grav.                                                                                                          |
| **Timeout** | Sets the session timeout in seconds.                                                                                                         |
| **Name**    | An identifier used to form the name of the session cookie. Use alphanumeric, dashes or underscores only. Do not use dots in the session name |
[/div]

### Advanced

![Admin Configuration](configuration-system-advanced.png?width=1360&classes=shadow)

This section contains advanced system options.

[div class="table table-striped table-keycol"]
| Option                  | Description                                                                |
| :-----                  | :-----                                                                     |
| **Absolute URLs**       | Absolute or relative URLs for `base_url`.                                  |
| **Parameter Separator** | Separater for passed parameters that can be changed for Apache on Windows. |
[/div]

---

## Defaults

> Path: grav-learn/pages/05.admin-panel/02.dashboard/02.configuration-site/docs.md


![Admin Configuration](configuration-site.png?width=2532&classes=shadow)

The **Configuration** page gives you access to your site's **System** and **Site** configuration settings. Additionally, you can view a breakdown of your server's properties in a number of areas including PHP, SQL, server environment, and other various components that determine how your site operates.

!! The Configuration requires an `access.admin.super` or `access.admin.configuration` && `access.admin.configuration_site` access level.

The **Site** tab enables you to customize the settings found in the `/user/config/site.yaml` file. This tab gives you access to options and fields that determine site-related variables, such as the name, default author, and metadata used in your site.

Below is a breakdown of the different configuration sections that appear in the **Site** tab.

### Defaults

![Admin Configuration](configuration-site-defaults.png?width=1664&classes=shadow)

This section is where you set the basic properties of content handling for your site. The home page, default theme, and various other content display options are set here.

[div class="table table-striped table-keycol"]
| Option             | Description                                                           |
| :-----             | :-----                                                                |
| **Site Title**     | Default title for your site, often used by themes.                    |
| **Default Author** | A default author name, often used in themes or page content.          |
| **Default Email**  | A default email to reference in themes or pages.                      |
| **Taxonomy Types** | Taxonomy types must be defined here if you wish to use them in pages. |
[/div]

### Page Summary

![Admin Configuration](configuration-site-page.png?width=1034&classes=shadow)

Page summaries are a great way to give a small preview of a page's content. You can use a delimiter in the page to set a "cut off" point between the summary content, and the full body content of the page. These settings give you the ability to


[div class="table table-striped table-keycol"]
| Option           | Description                                                                                                                                                  |
| :-----           | :-----                                                                                                                                                       |
| **Enabled**      | Enable page summary (the summary returns the same as the page content)                                                                                       |
| **Summary Size** | The amount of characters of a page to use as a content summary                                                                                               |
| **Format**       | **short** = use the first occurrence of delimiter or size; **long** = summary delimiter will be ignored                                                      |
| **Delimiter**    | The summary delimiter (default '==='). You would typically place this after an opening paragraph, with everything prior to it appearing in the page summary. |
[/div]

### Metadata

![Admin Configuration](configuration-site-metadata.png?width=1896&classes=shadow)

Metadata is an important part of a page's behind-the-scenes makeup. It can improve SEO, how your links appear in various search engines and social feeds, and more. You can set various metadata properties here.

[div class="table table-striped table-keycol"]
| Option       | Description                                                                                 |
| :-----       | :-----                                                                                      |
| **Metadata** | Default metadata values that will be displayed on every page unless overridden by the page. |
[/div]

### Redirects and Routes

![Admin Configuration](configuration-site-redirects.png?width=1888&classes=shadow)

Redirects and routing have never been easier. Just set it all up in this section, and you're good to go.

[div class="table table-striped table-keycol"]
| Option               | Description                                                             |
| :-----               | :-----                                                                  |
| **Custom Redirects** | Routes to redirect to other pages. Standard Regex replacement is valid. |
| **Custom Routes**    | Routes to alias to other pages. Standard Regex replacement is valid.    |
[/div]

---

## Profile Photo

> Path: grav-learn/pages/05.admin-panel/02.dashboard/03.profile/docs.md


![Admin Profile](grav-profile.png?width=2030&classes=shadow)

The profile page in the admin enables you to view and update your individual profile settings. This is where your avatar, email address, name, language, and more are set. For administrators, this is also where you can adjust the groups and permission levels for individual users.

Accessing the profile page is simple. Once you are logged in to the admin, you can access your profile by selecting the area of the sidebar with your avatar image and name. This will take you directly to your own profile.

Additionally, administrators will enjoy the ease of jumping to another user's profile page by appending `admin/user/example` to their site's URL. Replacing `example` with the username of the user they wish to edit profile information and/or permissions for.

### Profile Photo

![Admin Profile](grav-profile2.png?width=1678&classes=shadow)

The **Profile** area of the admin gives you a quick, styled look at your avatar, name, and title. Your avatar is automatically generated through [Gravatar](http://en.gravatar.com/), a global avatar service that enables you to upload a single profile image and use it across multiple sites and services.

![Admin Profile](grav-profile2b.png?width=1670&classes=shadow)

If you don't have an image uploaded to Gravatar, or if you'd prefer to use an image of your choosing, you can upload an image here by dragging and dropping the image file into the **Drop Your Files Here or Click This Area** section of the page. You can also click the area to bring up a file chooser that will enable you to find, select, and upload an image file from your system.

Once you have a new image uploaded, simply select the **Save** button in the upper-right corner of the page.

### Account

![Admin Profile](grav-profile3.png?width=1660&classes=shadow)

The **Account** section of the profile page is where you can update your contact information, name, language, and more. You are not able to edit your **Username** here, as this is tied directly to where your user information is stored, but you can edit anything else you need to.

### 2-Factor Authentication

![Admin Profile](grav-profile5.png?width=918&classes=shadow)

**2-Factor Authentication** provides an extra layer of security for your website. Find out more about this feature in the [**Security**](../../security/2fa) area of this guide.

### Access Levels

![Admin Profile](grav-profile4.png?width=1814&classes=shadow)

Administrators will find the permissions area especially useful. This is where you can configure exactly what a user will be able to access and do within the administrator.

Here is a quick breakdown of the permissions options and what they enable someone to do.

[div class="table table-striped table-keycol"]
| Option                         | Description                                                                                                      |
| :-----                         | :-----                                                                                                           |
| **admin.super**                | Designates the user as a super admin, giving them the ability to see and configure all areas of the site.        |
| **admin.login**                | Enables the user to log in to the admin. This must be set to **Yes** to enable the user to log in.               |
| **admin.cache**                | Gives the user access to the cache reset buttons.                                                                |
| **admin.configuration**        | Gives the user access to the **Configuration** area of the admin. This does not include any tabs or subsections. |
| **admin.configuration_system** | Gives the user access to the **System** tab in the **Configuration** area of the admin.                          |
| **admin.configuration_site**   | Gives the user access to the **Site** tab in the **Configuration** area of the admin.                            |
| **admin.configuration_media**  | Gives the user access to the **Media** tab in the **Configuration** area of the admin.                           |
| **admin.configuration_info**   | Gives the user access to the **Info** tab in the **Configuration** area of the admin.                            |
| **admin.pages**                | Gives the user access to the **Pages** area of the admin.                                                        |
| **admin.maintenance**          | Gives the user the ability to access the **Maintenance** area of the **Dashboard**.                              |
| **admin.statistics**           | Gives the user the ability to access the **Statistics** area of the **Dashboard**.                               |
| **admin.plugins**              | Gives the user access to the **Plugins** area of the admin.                                                      |
| **admin.themes**               | Gives the user access to the **Themes** area of the admin.                                                       |
| **admin.users**                | Enables the user to access and edit other users' profile information. This does not include permissions.         |
| **site.login**                 | Enables the user to log in to the front end.                                                                     |
[/div]
---

## Cache and Updates Checking

> Path: grav-learn/pages/05.admin-panel/02.dashboard/docs.md


![Admin Dashboard](grav-dashboard.png?width=1264&classes=shadow)

The **Dashboard** serves as a hub of information for the **Administration Panel** plugin. From this one page, you can check traffic statistics, maintenance information, Grav updates, create new backups, see the latest page updates, as well as to quickly clear Grav's cache.

It's a starting point for your administrative experience.

!! The Dashboard content will change depending on the user permissions. For example, giving `access.admin.super` unlocks everything. If that access level is not granted, `access.admin.maintenance` allows cache clearing and updates. `access.admin.pages` allows access to pages. `access.admin.statistics` allows display of the site page view statistics.


### Cache and Updates Checking

![Admin Dashboard](grav-dashboard-cache.png?width=323px&classes=shadow)

Along the top of the Dashboard, you will find two buttons. The first of which initiates a clearing of the Grav cache. Clicking the main **Clear Cache** button will wipe the entire cache, including any caching of assets and images. Using the **drop-down** feature to the right, you can choose from specific types of cache clearing processes.

For example, if you only want to clear the **image cache** without disrupting any other cached data, you can do so here.

The second button initiates an update check for your site. This includes any supported plugins, themes, and Grav itself. If new updates are discovered, you receive a notification on the Dashboard. This isn't the only method Grav has for checking for new updates.

!! Update checks are also triggered whenever a new page in the admin is loaded, and cached for one day. If you clear all of Grav's cache and load a new page in the admin, an update check will automatically take place.

### Maintenance and Page View Statistics

![Admin Dashboard](grav-dashboard-maintenance.png?width=1007&classes=shadow)

The **Maintenance** and **Page View Statistics** sections give you quick access to important information about your site.

On the **Maintenance** side, you can see a percentage graph letting you know how many of Grav's bits and pieces are completely up-to-date.

![Admin Dashboard](grav-dashboard-maintenance-2.png?width=1009&classes=shadow)

If new updates are available, an <i class="fa fa-cloud-download"></i> **Update** button will appear that enables you to perform a one-click update for all plugins and themes. This button will not update Grav itself, which notifies you about a required update just above the Maintenance and Page View Statistics sections.

You can update Grav's core by selecting the **Update Grav Now** button in its notification bar.

There is also a graph indicating how long the site has gone without being backed up. Selecting the <i class="fa fa-database"></i> **Backup** button will generate a zip file you can download and store as a backup for your site's data.

!! Backups are also stored in the `backup/` folder of your Grav install.  You can grab them via FTP or web manager tools provided by your hosting company.

The **Page View Statistics** section displays simple, at-a-glance traffic data breaking down the number of page views the front end of the site has received in the past day, week, and month (30 days). Page View Statistics for the past week are displayed in a bar graph separated by days of the week.

### Latest Page Updates

![Admin Dashboard](grav-dashboard-latest.png?width=1006&classes=shadow)

The **Latest Page Updates** area of the admin gives you an at-a-glance view of the latest content changes made to pages in your Grav site. This list is sorted by most recently updated, and is generated each time you refresh the page. Selecting the title of a page in this list will take you directly to the page's editor in the admin.

The **Manage Pages** button takes you to the **Pages** administrative panel.

---

## User Profile

> Path: grav-learn/pages/05.admin-panel/03.accounts/01.users/docs.17.md


![User Listing](accounts-user1.png?width=2030&classes=shadow)

## User Profile

![User Profile](../../02.dashboard/03.profile/grav-profile.png?width=2030&classes=shadow)

The profile page in the admin enables you to view and update your individual profile settings. This is where your avatar, email address, name, language, and more are set. For administrators, this is also where you can adjust the groups and permission levels for individual users.

Accessing the profile page is simple. Once you are logged in to the admin, you can access your profile by selecting the area of the sidebar with your avatar image and name. This will take you directly to your own profile.

Additionally, administrators will enjoy the ease of jumping to another user's profile page by appending `admin/user/example` to their site's URL. Replacing `example` with the username of the user they wish to edit profile information and/or permissions for.

### General Tab

#### Profile Photo

![User Photo](../../02.dashboard/03.profile/grav-profile2.png?width=1678&classes=shadow)

The **Profile** area of the admin gives you a quick, styled look at your avatar, name, and title. Your avatar is automatically generated through [Gravatar](http://en.gravatar.com/), a global avatar service that enables you to upload a single profile image and use it across multiple sites and services.

![User Photo](../../02.dashboard/03.profile/grav-profile2b.png?width=1670&classes=shadow)

If you don't have an image uploaded to Gravatar, or if you'd prefer to use an image of your choosing, you can upload an image here by dragging and dropping the image file into the **Drop Your Files Here or Click This Area** section of the page. You can also click the area to bring up a file chooser that will enable you to find, select, and upload an image file from your system.

Once you have a new image uploaded, simply select the **Save** button in the upper-right corner of the page.

#### Account

![Account Section](../../02.dashboard/03.profile/grav-profile3.png?width=1660&classes=shadow)

The **Account** section of the profile page is where you can update your contact information, name, language, and more. You are not able to edit your **Username** here, as this is tied directly to where your user information is stored, but you can edit anything else you need to.

#### 2-Factor Authentication

![2-Factor Authentication](../../02.dashboard/03.profile/grav-profile5.png?width=918&classes=shadow)

**2-Factor Authentication** provides an extra layer of security for your website. Find out more about this feature in the [**Security**](../../security/2fa) area of this guide.

### Access Tab

![Access Tab](../../02.dashboard/03.profile/grav-profile4.png?width=1814&classes=shadow)

This tab is visible only for users who have permissions to manage users.

[div class="table table-striped table-keycol"]
| Option                                | Description                                                       |
| :-----                                | :-----                                                            |
| **Groups** | List of the [groups](/admin-panel/accounts/groups) user is part of. |
| **Permissions** | List of all permissions in your site. See [Group Permissions](/admin-panel/accounts/groups#permissions). |
[/div]

---

## User Group

> Path: grav-learn/pages/05.admin-panel/03.accounts/02.groups/docs.17.md


![Group Listing](accounts-groups1.png?width=2030&classes=shadow)

**User Groups** define common roles for the users. It is the preferred way to set permissions to the users as managing roles is easier than changing the rules individually for every **user account**.

After creating a User Group, you can assign it to user accounts from [Access Tab](/admin-panel/accounts/users#access-tab).

## User Group

![Edit Group](accounts-groups2.png?width=2030&classes=shadow)

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Group Name** | Group name is identifier for the group. It cannot be changed after creating the group. |
| **Display Name** | Display name is the visible name for the group. |
| **Description** |  |
| **Icon** |  |
| **Enabled** | If set to **Yes**, group has been enabled in your site. If **No**, permissions set by the group do not apply. |
| **Permissions** | List of all permissions in your site. [See below](/admin-panel/accounts/groups#permissions). |
[/div]

### Permissions

Administrators will find the permissions area especially useful. This is where you can configure exactly what a user will be able to access and do within the administrator.

Here is a quick breakdown of the permissions options and what they enable someone to do.

#### Site

![Site Permissions](accounts-groups3.png?width=2030&classes=shadow)

[div class="table table-striped table-keycol"]

| Option                                | Value                         | Description                                                       |
| :-----                                | :-----                        | :-----                                                            |
| **Login to Site**                     | *site.login*                  | Enables the user to log in to the front end. |

[/div]

#### Admin

![Admin Permissions](accounts-groups3b.png?width=2030&classes=shadow)

[div class="table table-striped table-keycol"]

| Option                                | Value                         | Description                                                       |
| :-----                                | :-----                        | :-----                                                            |
| **Login to Admin**                    | *admin.login*                 | Enables the user to log in to the admin. This must be set to **Yes** to enable the user to log in. |
| **Super User**                        | *admin.super*                 | Designates the user as a super admin, giving them the ability to see and configure all areas of the site. |
| **Clear Cache**                       | *admin.cache*                 | Gives the user access to the cache reset buttons.                |
| **Configuration**                     | *admin.configuration*         | Gives the user access to the **Configuration** area of the admin. |
| &nbsp; &nbsp; **Manage System Configuration** | *admin.configuration.system* | Gives the user access to the **System** tab in the **Configuration** area of the admin.             |
| &nbsp; &nbsp; **Manage Site Configuration**  | *admin.configuration.site*    | Gives the user access to the **Site** tab in the **Configuration** area of the admin.               |
| &nbsp; &nbsp; **Manage Media Configuration** | *admin.configuration.media*   | Gives the user access to the **Media** tab in the **Configuration** area of the admin.              |
| &nbsp; &nbsp; **See Server Information** | *admin.configuration.info* | Gives the user access to the **Info** tab in the **Configuration** area of the admin.               |
| &nbsp; &nbsp; **Pages Configuration** | *admin.configuration.pages*   | Gives the user access to the **Pages Configuration** found inside the [Pages](/admin-panel/page/configuration) area of the admin.  |
| &nbsp; &nbsp; **Accounts Configuration** | *admin.configuration.accounts*   | Gives the user access to the **Accounts Configuration** found inside the [Accounts](/admin-panel/accounts/configuration) area of the admin.  |
| **Pages**                             | *admin.pages*                 | Gives the user full access to the [Pages](/admin-panel/page) area of the admin.    |
| **Site Maintenance**                  | *admin.maintenance*           | Gives the user the ability to access the **Maintenance** area of the **Dashboard**.                              |
| **Site Statistics**                   | *admin.statistics*            | Gives the user the ability to access the **Statistics** area of the **Dashboard**.                               |
| **Manage Plugins**                    | *admin.plugins*               | Gives the user access to the **Plugins** area of the admin.                                                      |
| **Manage Themes**                     | *admin.themes*                | Gives the user access to the **Themes** area of the admin.                                                       |
| **Access to Tools**                   | *admin.tools*                 | Access to Admin Tools. |
| **User Accounts**                     | *admin.accounts*              | Gives the user full access to the [Accounts](/admin-panel/accounts) area of the admin.    |

[/div]


---

## docs.17

> Path: grav-learn/pages/05.admin-panel/03.accounts/03.configuration/docs.17.md


![Compatibility Tab](accounts-configuration1.png?width=2030&classes=shadow)

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Admin event compatibility** | Enables `onAdminSave` and `onAdminSaveAfter` events for plugins. Enabled by default. |
[/div]

![Caching Tab](accounts-configuration2.png?width=2030&classes=shadow)

For more information, see Flex Objects.

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Enable Index Caching** | Index caching speeds up searches by creating temporary lookup indexes for the queries. |
| **Index Cache Lifetime (seconds)** | Lifetime for index caching in seconds. |
| **Enable Object Caching** | Object caching speeds up loading the object data and images. |
| **Object Cache Lifetime (seconds)** | Lifetime for object caching in seconds. |
| **Enable Render Caching** | Render caching speeds up rendering the content by caching the resulting HTML. |
| **Render Cache Lifetime (seconds)** | Lifetime for render caching in seconds. |
[/div]

If the rendered HTML has dynamic content, render cache can be disabled from the Twig template by {% verbatim %}```{% do block.disableCache() %}```{% endverbatim %}.

---

## docs.17

> Path: grav-learn/pages/05.admin-panel/03.accounts/04.permissions/docs.17.md


![Accounts Permissions](accounts-permissions.png?width=2030&classes=shadow)

User and Group permissions for managing account related information are:

[div class="table table-striped table-keycol"]
| Option                                | Value                             | Description                                                       |
| :-----                                | :-----                            | :-----                                                            |
| **Configuration**                     | *admin.configuration*             | Gives the user access to the **Configuration** area of the admin. |
| &nbsp; &nbsp; **Accounts Configuration** | *admin.configuration.accounts*    | Gives the user access to the **Accounts Configuration** found inside the **Accounts** area of the admin.  |
| **Accounts**                          | *admin.accounts*                  | Gives the user full access to the **Accounts** area of the admin.    |
| &nbsp; &nbsp; **Create**              | *admin.accounts.create*           | Gives the user access to **Create** user accounts and groups.        |
| &nbsp; &nbsp; **Read**                | *admin.accounts.read*             | Gives the user access to **Read** user accounts and groups.          |
| &nbsp; &nbsp; **Update**              | *admin.accounts.update*           | Gives the user access to **Update** user accounts and groups.        |
| &nbsp; &nbsp; **Delete**              | *admin.accounts.delete*           | Gives the user access to **Delete** user accounts and groups.        |
| &nbsp; &nbsp; **List**                | *admin.accounts.list*             | Gives the user access to **Accounts** area of the admin.             |
[/div]

The possible values for the permissions are:

[div class="table table-striped table-keycol"]
| Option                                | Value                         | Description                                                                               |
| :-----                                | :-----                        | :-----                                                                                    |
| **Allowed**                           | `true`                        | **Allows** action to be performed if there is no **Denied** permission at the same level. |
| **Denied**                            | `false`                       | **Denies** action from being performed. If user has both **Allowed** and **Denied** set, **Denied** permission wins. |
| **Not set**                           | `null`                        | No effect, but acts as **Denied** if no other rules apply.                                |
[/div]

Permissions set specifically for the user account take precedence over the group permissions. If the permission has not been set in the user account, access check will be performed against all the user groups the user belongs to. If any of the user groups have **Denied** the action, user has no permission for the action. Otherwise, if any of the user groups have **Allowed** the action, permission will be granted. If permission has not been set in any of the user's groups, **Super User** permission acts as universal **Allowed**, otherwise **Denied** will be applied.

---

## docs.17

> Path: grav-learn/pages/05.admin-panel/03.accounts/docs.17.md


Accounts Manager is a new feature for Grav 1.7 Admin, which allows users to manage both user accounts and user groups.

![Users](./01.users/accounts-user1.png?width=2030&classes=shadow)
![Groups](./02.groups/accounts-groups1.png?width=2030&classes=shadow)
![Configuration](./03.configuration/accounts-configuration2.png?width=2030&classes=shadow)
![Permissions](./04.permissions/accounts-permissions.png?width=2030&classes=shadow)

---

## Controls

> Path: grav-learn/pages/05.admin-panel/03.page/01.editor/docs.md


![Admin Page Editor](page-editor.png?width=2532&classes=shadow)

The **Page Editor** in the admin is a powerful text editor and page manager that enables you to create your page's content (including media files), its publishing and taxonomy options, settings, overrides, and theme-specific options.

It's essentially a one-stop-shop for managing a specific page.

[version=15,16]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages` permission, see [Profile](/admin-panel/dashboard/profile)
[/version]
[version=17]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages.list` permission, see [User Accounts](/admin-panel/accounts/users) and [User Groups](/admin-panel/accounts/groups)
[/version]

Tabs that appear in the **Page Editor** are not universal. There are a default set of form fields that are commonly found in Grav themes, however these can vary between themes. The admin pulls form field information from a number of sources including the theme and the template used for the specific page.

!! The tabs and options represented in this documentation are by default. Theme developers have the ability to add their own options to these tabs, or even to do away with these tabs and replace them with something entirely different. We are documenting a common-case scenario based on the Antimatter theme to serve as an example.

In this page, we will go over the features and functionality found in the **Content** tab of the **Page Editor**.

### Controls

![Admin Page Editor](page-editor-1.png?width=2024&classes=shadow)

Along the top of the page, you will find the administrative controls that enable you to save, delete, copy, and move your page. Additionally, you can hit the **Back** button to get back to the main **Pages** area of the admin.

The **Save** and **Delete** buttons are pretty self-explanatory. They save and delete the currently-accessed page, respectively.

Selecting the **Move** button activates a popup that gives you the ability to assign a new parent to the page. You have the same option in the **Advanced** tab.

**Copy** creates a duplicate of your current page, appending a `-2` (or other numeric prefix if `-2` is already in use) to the end of the folder name. You can change both the folder name and title as you see fit.

### Title

![Admin Page Editor](page-editor-2.png?width=1920&classes=shadow)

The title of a page is typically set during that page's creation, however you can edit it after the fact here. Note that changing the page's title here will not have a direct impact on the folder name (which is used for navigation purposes) but it will change what people see on the front end.

### Page Editor Content

![Admin Page Editor](page-editor-3.png?width=1924&classes=shadow)

This is the heart of the Page Editor. It is where your page's content body is written and edited. It features many powerful tools typically only found in premium browser-based text editors.

For example, you can switch between edit and preview views using the <i class="fa fa-code"></i> and <i class="fa fa-eye"></i> buttons located in the upper-right area of the editor.

Because Grav's content is primarily based in markdown, the editing shortcuts automatically append markdown tags to your content. For example, highlighting a block of text and selecting the **B** icon surrounds the highlighted area with `**(selected area)**` bold tags.

Here is a breakdown of the tools found in the content editor:

[div class="table table-striped table-keycol"]
| Tool                                      | Description                                       |
| :-----                                    | :-----                                            |
| <i class="fa fa-fw fa-bold"></i>          | Adds **Bold** tags to your content.               |
| <i class="fa fa-fw fa-italic"></i>        | Adds *Italic* tags to your content.               |
| <i class="fa fa-fw fa-strikethrough"></i> | Adds ~~Strikethrough~~ tags to your content.      |
| <i class="fa fa-fw fa-link"></i>          | Adds [links](https://getgrav.org) to your content. |
| <i class="fa fa-fw fa-picture-o"></i>     | Adds media to your content.                       |
| <i class="fa fa-fw fa-quote-right"></i>   | Adds quote tags to your content.                  |
| <i class="fa fa-fw fa-list-ul"></i>       | Creates an unordered list.                        |
| <i class="fa fa-fw fa-list-ol"></i>       | Creates an ordered list.                           |
| <i class="fa fa-fw fa-code"></i>          | Activates the edit view.                          |
| <i class="fa fa-fw fa-eye"></i>           | Activates the content preview.                    |
| <i class="fa fa-fw fa-expand"></i>        | Toggles to a full-page edit or preview view.      |
[/div]

### Page Media

![Admin Page Editor](page-editor-4.png?width=1924&classes=shadow)

The **Page Media** section at the bottom of the **Content** tab is all about media files for your page. These files exist in the same folder as the page's markdown file. Uploading new media files is as simple as **dragging-and-dropping** a file, or **tapping** in the white area of the section. This will bring up a file selector that enables you to pick files for upload.

Already have media files you'd like to insert into your page? Just move your mouse cursor over the image thumbnail and **drag-and-drop** the image into the editor.

Alternatively you can select **Insert** option on the image thumbnail. This will insert the media directly into your page's content.

You can also delete media files by selecting **Delete**.

---

## Publishing

> Path: grav-learn/pages/05.admin-panel/03.page/02.options/docs.md


![Admin Page Editor](page-options.png?width=2532&classes=shadow)

The **Page Editor** in the admin is a powerful text editor and page manager that enables you to create your page's content (including media files), its publishing and taxonomy options, settings, overrides, and theme-specific options.

It's essentially a one-stop-shop for managing a specific page.

In this page, we will go over the features and functionality found in the **Options** tab of the **Page Editor**.

[version=15,16]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages` permission, see [Profile](/admin-panel/dashboard/profile)
[/version]
[version=17]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages.list` permission, see [User Accounts](/admin-panel/accounts/users) and [User Groups](/admin-panel/accounts/groups)
[/version]

! You might notice the check boxes to the left of some of the options in this area of the admin. These boxes indicate that you would like to override the default values for this page. Leaving them unchecked reverts to blank or default states.

### Publishing

![Admin Page Editor](page-options-publishing.png?width=1946&classes=shadow)

This section is all about controlling the way your content is published. You can publish (or unpublish) content, set published dates as well as dates and times to unpublish, and to create metadata values specific to the page.

[div class="table table-striped table-keycol"]
| Option           | Description                                                                                                                                              |
| :-----           | :-----                                                                                                                                                   |
| Published        | By default, a page is published unless you explicitly set published: false or via a `publish_date` being in the future, or `unpublish_date` in the past. |
| Date             | The date variable allows you to specifically set a date associated with this page.                                                                       |
| Published Date   | This serves as the official publishing date for the page. It can provide a date to automatically trigger publication.                                    |
| Unpublished Date | This is the date/time you would like to mark for the page to automatically trigger un-publication.                                                       |
| Metadata         | Default metadata values that will be displayed on every page unless overridden by the page.                                                              |
[/div]

### Taxonomies

![Admin Page Editor](page-options-taxonomies.png?width=1944&classes=shadow)

The Taxonomies area is where you can configure your page's organizational properties. What categorie(s) the page will appear in, its tags, and more can be configured here.

[div class="table table-striped table-keycol"]
| Option   | Description                                                                                                                                                             |
| :-----   | :-----                                                                                                                                                                  |
| Category | This field enables you to set one or more categories for the page. It is useful in content sorting and filtering.                                                       |
| Tag      | Tags are a great way to provide some back-end insight into what your page is about. It's useful for content-driven sites as a mechanism for organization and filtering. |
| Month    |                                                                                                                                                                         |
[/div]

### Sitemap

![Admin Page Editor](page-options-sitemap.png?width=1944&classes=shadow)

Having a good, clean sitemap is important for several reasons. Among them being user navigation and search engine optimization (SEO). Having a sitemap in place makes your site inherently more friendly to search engines, which can have a direct impact on ranking.

This area of the options page is only available if you install the [Sitemap plugin](https://github.com/getgrav/grav-plugin-sitemap).

[div class="table table-striped table-keycol"]
| Options                  | Description                                                                                                                                                                                                                     |
| :-----                   | :-----                                                                                                                                                                                                                          |
| Sitemap Change Frequency | This drop-down enables you to set a frequency by which the page's sitemap is updated. This can be any time a change is made, hourly, daily, weekly, monthly, yearly, or never. By default, the global sitemap options are used. |
| Sitemap Priority         | Sets the priority of this page in your sitemap.                                                                                                                                                                                 |
[/div]

---

## Settings

> Path: grav-learn/pages/05.admin-panel/03.page/03.advanced/docs.md


![Admin Page Editor](page-advanced.png?width=2528&classes=shadow)

The **Page Editor** in the admin is a powerful text editor and page manager that enables you to create your page's content (including media files), its publishing and taxonomy options, settings, overrides, and theme-specific options.

It's essentially a one-stop-shop for managing a specific page.

In this page, we will go over the features and functionality found in the **Advanced** tab of the **Page Editor**.

[version=15,16]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages` permission, see [Profile](/admin-panel/dashboard/profile)
[/version]
[version=17]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages.list` permission, see [User Accounts](/admin-panel/accounts/users) and [User Groups](/admin-panel/accounts/groups)
[/version]

! You might notice the check boxes to the left of some of the options in this area of the admin. These boxes indicate that you would like to override the default values for this page. Leaving them unchecked reverts to blank or default states.

### Settings

![Admin Page Editor](page-advanced-settings.png?width=974&classes=shadow)

The **Settings** area focuses on various critical options for your page. This is where you would go to change the name of the folder the page is stored in, its parent, and the template used when displaying the page.

[div class="table table-keycol"]
| Option                | Description                                                                                                                      |
| :-----                | :-----                                                                                                                           |
| Folder Numeric Prefix | Numeric prefix that provides manual ordering and implies visibility.                                                             |
| Folder Name           | Sets the name of the folder the page is contained in.                                                                            |
| Parent                | Sets the parent of the current page. This can be - Root- for top-level pages, or specific pages to have them appear as subpages. |
| Display Template      | Sets the template (provided by the theme) to be applied to the page. This has a direct effect on how the page looks.             |
| Body Classes          | Classes entered in this field are applied to the body of the page.                                                               |
[/div]

### Ordering

![Admin Page Editor](page-advanced-ordering.png?width=940&classes=shadow)

The **Ordering** section gives you the ability to configuring page ordering of non-numbered folders.

[div class="table table-keycol"]
| Option     | Description                                         |
| :-----     | :-----                                              |
| Page Order | Enables you to configure the ordering for the page. |
[/div]

### Overrides

![Admin Page Editor](page-advanced-overrides.png?width=1946&classes=shadow)

Overrides are those options that give your page extra functionality, set its slug to something different than the default one based on the folder name, caching settings, navigation visibility, and make a page unreachable via a direct URL.

You can also use this area to turn on and off various processes for the page, such as Twig which enables you to inject Twig into your page content and have it render.

[div class="table table-keycol"]
| Options                | Description                                                                                                        |
| :-----                 | :-----                                                                                                             |
| Menu                   | The string to be used in a menu.  If not set, <b>Title</b> will be used.                                           |
| Slug                   | The slug variable allows you to specifically set the page's portion of the URL.                                    |
| Process                | Processes you would like to have run, and made available in the page's content.                                    |
| Default Child Template | Sets a default page type for child pages.                                                                          |
| Routable               | Sets whether or not this page is reachable by a URL. If disabled, the page will not be reachable on the front end. |
| Caching                | Enables or disables caching for the page.                                                                          |
| Visible                | Determines if a page is visible in the navigation.                                                                 |
[/div]

### Route Overrides

![Admin Page Editor](page-advanced-route.png?width=940&classes=shadow)

[div class="table table-keycol"]
| Options         | Description                                             |
| :-----          | :-----                                                  |
| Default Route   | Enter a new default route.                              |
| Canonical Route | Enter a new value for to use for the canonical routing. |
| Route Aliases   | Create route aliases.                                   |
[/div]

### Admin Specific Overrides

![Admin Page Editor](page-advanced-admin.png?width=1946&classes=shadow)

[div class="table table-keycol"]
| Options                | Description                                                                                   |
| :-----                 | :-----                                                                                        |
| Children Display Order | Set the order children are displayed in. You can choose folder name or collection definition. |
[/div]

---

## docs.17

> Path: grav-learn/pages/05.admin-panel/03.page/04.security/docs.17.md


![Security Tab > Page Access](page-security.png?width=2030&classes=shadow)

This section defines frontend access to the page.

[div class="table table-striped table-keycol"]
| Option                                | Description |
| :-----                                | :----- |
| **Menu Visibility Requires Access**   | Set to Yes if page should be shown in menus only if user can access them. |
| **Page Access**                       | User with following access permissions can access the page. |
[/div]

![Security Tab > Page Permissions](page-security.png?width=2030&classes=shadow)

This section defines administration access to the page.

Page specific CRUD ACL works by using user groups only. In addition, it has two special groups named `authors` and `defaults`, which give special access to page owners, and a default fallback to all logged in users.

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Inherit Permissions**       | Inherit ACL from parent page. |
| **Page Authors**              | Members of Page Authors have owner level access to this page defined in special 'Authors' page group. |
| **Page Groups**               | Members of Page Groups have special access to this page. |
[/div]

For more information how the CRUD permissions work, please check [Page Permissions](/admin-panel/page/permissions).

---

## docs.17

> Path: grav-learn/pages/05.admin-panel/03.page/05.configuration/docs.17.md


![Compatibility Tab](page-configuration.png?width=2030&classes=shadow)

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Admin event compatibility** | Enables `onAdminSave` and `onAdminSaveAfter` events for plugins. Enabled by default. |
[/div]

![Caching Tab](page-configuration.png?width=2030&classes=shadow)

For more information, see Flex Objects.

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Enable Index Caching** | Index caching speeds up searches by creating temporary lookup indexes for the queries. |
| **Index Cache Lifetime (seconds)** | Lifetime for index caching in seconds. |
| **Enable Object Caching** | Object caching speeds up loading the object data and images. |
| **Object Cache Lifetime (seconds)** | Lifetime for object caching in seconds. |
| **Enable Render Caching** | Render caching speeds up rendering the content by caching the resulting HTML. |
| **Render Cache Lifetime (seconds)** | Lifetime for render caching in seconds. |
[/div]

If the rendered HTML has dynamic content, render cache can be disabled from the Twig template by {% verbatim %}```{% do block.disableCache() %}```{% endverbatim %}.

---

## Page CRUD Access Check Workflow

> Path: grav-learn/pages/05.admin-panel/03.page/06.permissions/docs.17.md


![Pages Permissions](page-permissions.png?width=2030&classes=shadow)

User / Group permissions for Pages are:

[div class="table table-striped table-keycol"]
| Option                                | Value                         | Description                                                       |
| :-----                                | :-----                        | :-----                                                            |
| **Configuration**                     | *admin.configuration*         | Gives the user access to the **Configuration** area of the admin. |
| &nbsp; &nbsp; **Pages Configuration** | *admin.configuration.pages*   | Gives the user access to the **Pages Configuration** found inside the **Pages** area of the admin.  |
| **Pages**                             | *admin.pages*                 | Gives the user full access to the **Pages** area of the admin.    |
| &nbsp; &nbsp; **Create**              | *admin.pages.create*          | Gives the user access to **Create** pages.                        |
| &nbsp; &nbsp; **Read**                | *admin.pages.read*            | Gives the user access to **Read** pages.                          |
| &nbsp; &nbsp; **Update**              | *admin.pages.update*          | Gives the user access to **Update** pages.                        |
| &nbsp; &nbsp; **Delete**              | *admin.pages.delete*          | Gives the user access to **Delete** pages.                        |
| &nbsp; &nbsp; **List**                | *admin.pages.list*            | Gives the user access to **Pages** area of the admin.             |
[/div]

!! **WARNING:** All actions in Grav are only checked against a single permission type. If you prevent user from listing or reading pages in admin, but still allow users to perform create, update and delete, they can perform those actions. This means that even if users cannot see the `Pages` in admin, they can visit the edit page directly and perform those actions from there.

!!! **TIP:** Starting from Grav 1.7, you can and should restrict the **CRUD** access for the individual pages and their children directly from the pages themselves.

The possible values for the permissions are:

[div class="table table-striped table-keycol"]
| Option                                | Value                         | Description                                                                               |
| :-----                                | :-----                        | :-----                                                                                    |
| **Allowed**                           | `true`                        | **Allows** action to be performed if there is no **Denied** permission at the same level. |
| **Denied**                            | `false`                       | **Denies** action from being performed. If user has both **Allowed** and **Denied** set, **Denied** permission wins. |
| **Not set**                           | `null`                        | No effect, but acts as **Denied** if no other rules apply.                                |
[/div]

Permissions set specifically for the user account take precedence over the group permissions. If the permission has not been set in the user account, access check will be performed against all the user groups the user belongs to. If any of the user groups have **Denied** the action, user has no permission for the action. Otherwise, if any of the user groups have **Allowed** the action, permission will be granted. If permission has not been set in any of the user's groups, **Super User** permission acts as universal **Allowed**, otherwise **Denied** will be applied.

Permissions set for the user accounts and user groups act as default permissions for managing the pages. All of these rules can be overridden inside any page [Security](/admin-panel/page/security) tab.

### Page CRUD Access Check Workflow

CRUD authorization check workflow for an individual page is following:

1. Set **action** = `Create`, `Read`, `Update`, `Delete` or `List`
2. Go through all `Page Groups` from the current page
  - **match** special `authors` group if the user is listed in `Page Authors`
  - **match** special `defaults` group if the user is logged in
  - **match** the group if the user also has the group
  - if **match**
     - if **action** authorize returns `Deny`: stop immediately and *return* `false`
     - if **action** authorize returns `Allow`: set **allow flag** = `true`
  - continue to the next group
1. After going through all the groups, check if user has permission for the action
  - if **allow flag** is `true`: return `true`
1. Check user's global Pages administration permissions (only once)
  - if **action** authorize returns `Deny`: *return* `false`
  - if **action** authorize returns `Allow`: *return* `true`
1. Check if page inherits parent permissions
  - if `Inherit Permissions` = `Yes`, do the same checks with the parent page
  - else *return* `null`

### Root Page

![Root Page](page-permissions.png?width=2030&classes=shadow)

Root page is a special page in Grav 1.7+ which allows site admins to set default permissions for all the pages. It can only be seen by **Super User** or a user who has **Pages Configuration** rights.

The root page will be saved into `user/pages/root.md` file and does not contain any content as the page is currently unreachable (this may change in the future).

---

## Adding New Pages

> Path: grav-learn/pages/05.admin-panel/03.page/docs.md


![Admin Pages](pages.png?width=2520&classes=shadow)

The **Pages** page gives you quick editorial access to your site's content. This is where you can access a page's editor, delete pages, create new pages, and find out if a page is visible at a glance.

[version=15,16]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages` permission, see [Profile](/admin-panel/dashboard/profile)
[/version]
[version=17]
!! Accessing the Pages functionality requires an `access.admin.super` or `access.admin.pages.list` permission, see [User Accounts](/admin-panel/accounts/users) and [User Groups](/admin-panel/accounts/groups)
[/version]

If you frequently create or modify content on your site, this area of the admin will become very familiar to you.

### Adding New Pages

![Admin Pages](add.png?width=2024&classes=shadow)

Three buttons line the top of the **Pages** administrative panel. The **Back** button sends you back to the **Dashboard**, while the **Add Page** and **Add Modular** buttons initiate the creation of new pages for your site.

Below, we break down the options available when you select these buttons.

#### Add Page

![Admin Pages](add2.png?width=1382&classes=shadow)

The **Add Page** button creates a non-modular page for your site. Once selected, a popup will appear enabling you to enter a **Title** and **Folder Name**, assign a **Parent Page** and **Display Template**, as well as to set whether the page should be visible or hidden.

[div class="table table-keycol"]
| Option           | Description                                                                                                                                                                                                                                                                             |
| :-----           | :-----                                                                                                                                                                                                                                                                                  |
| Page Title       | This is where you enter the title of the page you are creating.                                                                                                                                                                                                                         |
| Folder Name      | You can set a custom folder name for the page, or keep the automatically-generated one based on the title.                                                                                                                                                                              |
| Parent Page      | This sets the parent page for the new page. Can be a child of another page (such as home or blog) or set to the root of your site. By setting the value of the `child_type` option in the frontmatter of a parent page a default `Display Template` will be automatically selected.                                                                                                                                                    |
| Display Template | You can choose which theme-provided template you wish to have applied to the page.                                                                                                                                                                                                      |
| Visible          | Sets whether or not you want the page to be visible in navigation. Can be set to **Auto** to have this be determined for you. In the auto setting, if there is another sibling page that uses a numeric prefix, it uses one and is therefore visible. Otherwise, it doesn't display it. |
[/div]

Once you have filled out this information, selecting **Continue** will take you to the new page's editor. We will cover the Page Editor in more detail in [a following guide](../page-editor).

!! Whether a page is visible or not in these settings only has an effect on navigation. A page's ability to be visited by a browser is determined by the page's [publishing settings](../../content/headers#published).

#### Add Modular Page

![Admin Pages](add3.png?width=1386&classes=shadow)

The second button along the top of the **Pages** area of the admin allows you to add a modular subpage to your site. Modular pages are different from regular pages because they are actually a collection of pages, arranged and displayed as one page. This button specifically lets you create subpages and assign them to a parent modular page.

Here is a breakdown of the fields and options that appear in the **Add Modular Page** button's popup.

[div class="table table-keycol"]
| Option           | Description                                                                                                        |
| :-----           | :-----                                                                                                             |
| Page Title       | Sets a title for the modular page.                                                                                 |
| Folder Name      | You can set a custom folder name for the page, or keep the automatically-generated one based on the title.         |
| Page             | Sets the parent page for the new modular subpage. This is the page your new modular page's content will appear on. |
| Modular Template | Displays a list of templates provided by the theme for modular pages you can choose from for the new page.         |
[/div]

Once you have filled out this information, selecting **Continue** will take you to the new page's editor. We will cover the Page Editor in more detail in [a following guide](../page-editor).

### Pages List

![Admin Pages](pages2.png?width=1942&classes=shadow)

The pages list that appears in this area gives you quick access to all of your current pages, as well as an at-a-glance method for seeing whether or not the pages are visible.

Selecting the title of any page will take you directly to that page's editor. The big **X** icon to the right of each page lets you delete the page.

If you hover over the icon directly to the left of a page, it will tell you its current status. For example, it may say **Page  Routable  Visible** if a page is routable (visible via the URL) and visible (appears in navigation menus).

You can **filter** and **search** your pages to make it easy to find the exact page you're looking for. For example, using the **Add Filters** option, you can filter pages by type so that only **Modular**, **Visible**, and/or **Routable** pages appear in the list.

If you have a specific page title (or part of a title) in mind, you can use the search bar to quickly find the specific page you're looking for.

---

## Plugin Information

> Path: grav-learn/pages/05.admin-panel/04.plugins/01.options/docs.md


![Admin Options](grav-options1.png?width=2546&classes=shadow)

The Admin Panel plugin has a set of options of its own accessible in the **Plugins** area of the admin. To reach them, simply navigate to **Plugins > Admin Panel** and select the title link for the plugin called **Admin Panel**. This will open a page filled with useful options to help you customize your experience with the Admin.

### Plugin Information

![Admin Options](grav-options2.png?width=1964&classes=shadow)

The top of the Admin Panel options page gives you some information about the Admin Panel plugin. This includes the plugin author, homepage, and license, in addition to other links and information to help you find additional information and report any bugs.

This is a pretty standard feature in any plugin's options page.

### Basics

![Admin Options](grav-options3.png?width=1416&classes=shadow)

The **Basics** section of this page gives you a set of options to help you define your experience within the Admin. This includes being able to change the text that appears at the top of the sidebar, create a custom path to the administrator, and more.

We've broken down these options, and what they do, below.

[div class="table table-keycol"]
| Option                          | Description                                                                                                                                 |
| :-----                          | :-----                                                                                                                                      |
| Enable Admin Caching            | Caching in the admin can be **Enabled** or **Disabled** here. This allows you to disable admin caching without affecting front end caching. |
| Administrator Path              | Changing the path to the administrator is done here. The default path is `/admin`, but you can make it whatever you'd like from this field. |
| Logo Text                       | This is where you define the text that appears at the top of the administrator's sidebar.                                                   |
| Body Classes                    | Want to give the body of your admin a different look? You can add body class(es) here. Separate multiple classes with a space.              |
| Sidebar Activation              | Choose between **Tab** and **Hover** methods of expanding the sidebar.                                                                      |
| Hover Delay                     | Set the delay time your cursor needs to hover over the compressed sidebar to expand in **Hover** mode.                                      |
| Sidebar Size                    | Choose between **Automatic** and **Small** as your default sidebar size.                                                                    |
| Edit Mode                       | Choose your default content editor. By default, the options are **Normal** and **Expert**.                                                  |
| Use Google Fonts                | Use Google custom fonts.  Disable this to use Helvetica. Useful when using Cyrillic and other languages with unsupported characters.        |
| Show GitHub Link                | **Enable** or **Disable** display of the "Found an issue? Please report it on GitHub." message.                                             |
| Automatically Check for Updates | Choose to automatically check for updates to the **Admin Panel** plugin.                                                                    |
| Session Timeout                 | Set the session timeout (in seconds) here.                                                                                                  |
[/div]

### Dashboard

![Admin Options](grav-options4.png?width=1068&classes=shadow)

This section of the page lets you customize the items that appear in the main dashboard of the admin. Not a fan of the News Feed and want to get rid of it? Want to streamline your dashboard down to one or two sections you love? This is where you can do that.

[div class="table table-keycol"]
| Option                    | Description                                                                                                  |
| :-----                    | :-----                                                                                                       |
| Maintenance Widget        | **Enable** or **Disable** the display of the **Maintenance** area of the main Dashboard page in the Admin.   |
| Statistics Widget         | **Enable** or **Disable** the display of the **Statistics** area of the main Dashboard page in the Admin.    |
| Notifications Feed Widget | **Enable** or **Disable** the display of the **Notifications** area of the main Dashboard page in the Admin. |
| News Feed Widget          | **Enable** or **Disable** the display of the **News Feed** area of the main Dashboard page in the Admin.     |
| Latest Pages Widget       | **Enable** or **Disable** the display of the **Latest Pages** area of the main Dashboard page in the Admin.  |
[/div]

### Notifications

![Admin Options](grav-options5.png?width=1062&classes=shadow)

You can enable or disable specific types of notifications from this section. You can turn off feed update notifications, as well as notifications for plugins and/or themes.

[div class="table table-keycol"]
| Option                  | Description                                                           |
| :-----                  | :-----                                                                |
| Feed Notifications      | **Enable** or **Disable** feed-based notifications in the admin.      |
| Dashboard Notifications | **Enable** or **Disable** dashboard-based notifications in the admin. |
| Plugins Notifications   | **Enable** or **Disable** plugins-based notifications in the admin.   |
| Themes Notifications    | **Enable** or **Disable** themes-based notifications in the admin.    |
[/div]

### Popularity

![Admin Options](grav-options6.png?width=1928&classes=shadow)

One of the Admin's great features is its ability to track and display traffic information from the Admin's dashboard. This section of the Admin plugin's options gives you the ability to enable or disable traffic tracking, and configure how that data is displayed.

[div class="table table-keycol"]
| Option           | Description                                                                                        |
| :-----           | :-----                                                                                             |
| Visitor tracking | You can **Enable** or **Disable** the visitor tracking feature here.                               |
| Days of stats    | This field lets you set the number of days of visitor data kept in the graph before being dropped. |
| Ignore           | Ignore traffic to specific URLs in your site. For example `/test` or `/modular`                    |
[/div]

---

## Controls

> Path: grav-learn/pages/05.admin-panel/04.plugins/docs.md


![Admin Plugins](plugins.png?width=2532&classes=shadow)

The **Plugins** area of the admin is where you can go to manage your plugins, add new ones, remove existing ones, and quickly access links to documentation and other information.

In this page, we will explore this area of the admin in detail, including how to activate and deactivate installed plugins, and add new ones with ease.

!! Accessing the Plugins functionality requires an `access.admin.super` or `access.admin.plugins` permission.

### Controls

![Admin Plugins](plugins-1.png?width=2024&classes=shadow)

The **Controls** area at the top of the page gives you the ability to add new plugins, as well as check for updates for existing ones.

![Admin Plugins](plugins-2.png?width=2014&classes=shadow)

The <i class="fa fa-plus"></i> Add button takes you to a page listing all of the currently available Grav plugins, enabling you to view their information and install them by selecting the <i class="fa fa-plus"></i> Install button to the right of the plugin.

! The <span color="purple"><i class="fa fa-check-circle"></i></span> icon indicates that the plugin is created and supported by the Grav team. Plugins without this icon were created by third-party developers.

### Installed Plugins

![Admin Plugins](plugins-4.png?width=2014&classes=shadow)

This area of the Plugins administrator shows you, at a glance, which plugins are presently installed on your Grav site. Additionally, you can enable and disable these plugins by selecting the <i class="fa fa-fw fa-toggle-on"></i> toggle icon to the right of each plugin.

![Admin Plugins](plugins-3.png?width=1970&classes=shadow)

Selecting the <i class="fa fa-chevron-down"></i> chevron icon will give you more information about the plugin, including its author, project home page and bug tracker, as well as its license and a brief description. You can also quickly access the plugin's readme file for additional information and usage guide.

You can also click the plugin's name to go to a more-detailed page including the plugin's settings area where you can configure the plugin.

---

## Controls

> Path: grav-learn/pages/05.admin-panel/05.themes/docs.md


![Admin Themes](themes.png?width=1009&classes=shadow)

The **Themes** in the admin is where you can go to add and manage your site's themes.

In this page, we will explore how to manage existing themes, and add a new one to your site.

!! Accessing the Themes functionality requires an `access.admin.super` or `access.admin.themes` permission.

### Controls

![Admin Themes](themes1.png?width=1009&classes=shadow)

Along the top of the **Themes** area of the admin, you will find the <i class="fa fa-reply"></i> **Back**, <i class="fa fa-plus"></i> **Add**, and <i class="fa fa-refresh"></i> **Check for Updates** buttons.

<i class="fa fa-reply"></i> **Back** simply takes you back to either the **Dashboard** or to the main **Themes** page if you are deeper into that area of the admin.

<i class="fa fa-refresh"></i> **Check for Updates** checks your presently-installed themes for any updates.

#### Adding a New Theme

![Admin Themes](themes2.png?width=1009&classes=shadow)

<i class="fa fa-plus"></i> **Add** pulls up a display of currently-available Grav themes you can add to your site. This is a quick and easy way to install a new theme. Simply select the <i class="fa fa-plus"></i> **Install** button to install the theme.

![Admin Themes](themes3.png?width=1009&classes=shadow)

Doing so will take you to the new theme's **Information** panel which contains more detailed information about the theme, as well as any options set in its *blueprints* file. Once you are satisfied with any settings changes, simply select the <i class="fa fa-check"></i> **Save** button to save your changes.

You can also delete the theme from your site by selecting the red <i class="fa fa-fw fa-warning"></i> **Remove Theme** button in the bottom-right area of the panel.

### Installed Themes

![Admin Themes](themes4.png?width=1009&classes=shadow)

The **Installed Themes** section displays your currently-installed themes. Selecting the thumbnail of a theme takes you to the information page for that theme, while the gray **Activate** button at the bottom of each thumbnail gives you the ability to set that theme as the active default theme for your site.

The currently-active theme is indicated by the <i class="fa fa-star"></i> **Active Theme** icon.

At the top of each thumbnail you will see the name and current version number of each theme. The purple <i class="fa fa-check-circle"></i> check icon indicates that a theme was created by the Grav team. Themes without that icon are created and maintained by third-party developers.

---

## How to Set it Up

> Path: grav-learn/pages/05.admin-panel/06.security/01.2fa/docs.md


![Admin Profile](auth3.gif?classes=shadow)

2-factor authentication (2FA) is an excellent security measure that uses a rolling-clock style authentication method that generates six-digit codes you can use in addition to your username and password to access the Admin.

To take advantage of this feature, you'll want to download a 2FA-supporting app such as [Authy](https://authy.com/) or [Google Authenticator](https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en). This app will act as a virtual key ring for authentication codes.

## How to Set it Up

![](2fa_1.jpeg?classes=shadow)

Setting 2-factor authentication up in Grav is easy. All you need to do is navigate to **Plugins > Admin Panel > Basics** in the Admin.

Here, you will find 2-Factor Authentication. You can choose to turn this feature on by selecting **Yes**. This will enable users to set up 2-factor authentication on their accounts.

![](2fa_2.jpeg?classes=shadow)

Now, you can select your avatar image to access your user profile settings. Next, you will want to set the **2FA Enabled** option to **Yes**.

A QR code will appear along with a 2FA secret key. Write the key down and put it somewhere safe.

![](2fa_4.png?width=1009&classes=shadow)

Using your authenticator app of choice, scan the QR code or enter the secret key to register your 2FA key. Save your profile page to lock in your 2FA settings.

![](2fa_5.png?width=1009&classes=shadow)

A purple 2FA badge will now appear next to your name in the sidebar. This badge lets you know that 2FA is active on the account.

You can now log out and log back in. You will be greeted with the same username and password fields, but once you enter this information, you will be asked to provide an additional six-digit code. This code is in your authenticator app. It resets every 30 seconds, so the code is only good during that short period. A new code will generate to replace it.

That's it! You now have a more secure Grav site!

Oh, and if you want to change your 2FA key, all you need to do is hit the big red **Regenerate** button.

## Frequently Asked Questions

#### What Happens if I lose access to my 2FA device?

Don't worry! All is not lost.

Your 2FA status and hashed key are stored in your site's file system on your user YAML file. For example, if your user account is `admin`, navigate to **ROOT/user/accounts/admin.yaml** and look for these two lines:

[prism classes="language-yaml line-numbers"]
twofa_enabled: true
twofa_secret: RQX46XTTBK7QMMB6VR4RAUNWOYVXXTSR
[/prism]

Simply set **twofa_enabled** to `false` and save. You should now be able to access your site using just your username and password. Alternatively, you can use the **twofa_secret** to register your account on your authenticator app of choice.

#### What if my 2FA secret is compromised?

If you believe your 2FA secret may be compromised, you can generate a new key and invalidate the old one by selecting the big red **Regenerate** button in your user profile settings from the Admin.

---

## What You'll Need

> Path: grav-learn/pages/05.admin-panel/06.security/02.rate-limiting/docs.md


![](login.gif?classes=shadow)

Brute force attacks are a popular choice for website intruders. It could come in the form of someone you know trying to guess your password over and over until they are finally successful or a bot flooding your site with login attempts until eventually the password has been discovered.

Grav's flood protection (also known as rate limiting) feature makes these kinds of attacks exceptionally difficult. It allows you to set a number of failed login attempts within a specific amount of time before the account gets temporarily locked out. Additionally, you can restrict the amount of password reset requests applied to accounts before locking this feature out.

## What You'll Need

This feature is managed through the [**Login** plugin](https://github.com/getgrav/grav-plugin-login), which should already be installed and enabled if you're using Admin Panel.

## How to Set it Up

![](2fa_3.jpeg?classes=shadow)

The settings for Grav's flood protection are found in the Login plugin. Simply navigate to **Admin > Plugins > Login** and select the **Security** tab.

Here, you can set the following:

* Maximum number of password resets before lockout
* Password reset maximum interval
* Maximum failed logins before lockout
* Maximum failed logins interval

This will enable you to determine how many failed password resets or logins are allowed in a set amount of time before lockout occurs. This log out is temporary and lasts as long as your set interval.


---

## docs

> Path: grav-learn/pages/05.admin-panel/06.security/docs.md


Grav offers some extra powerful protection for your Administration Area, such as 2-Factor Authentication and Flood Protection.
---

## Uploading

> Path: grav-learn/pages/05.admin-panel/07.tools/docs.md


![Admin Tools](tools.png)

There are instances where you may want to upload a theme or plugin package that isn't currently in the main Grav plugins directory. Perhaps you have a premium theme that is made available in a zip file, or you're developing a plugin and want to upload your latest build to your Grav install for testing. In any case, you can do this by way of FTP, but the Admin gives you an even simpler solution.

Using the **Direct Install** tool, you can upload a zipped package directly to your Grav install and have it available for use in seconds. This isn't just limited to plugins and themes. You can even upload Grav itself this way and upgrade (or downgrade) doing this, as well. This is especially useful for Grav contributors that want to test their work easily.

As with any installation process, we recommend having a recent backup of your Grav install before using this tool - especially if you plan on using it to change your entire Grav install.

### Uploading

![Admin Tools](tools1.png)

The first method of direct install available is a file upload. You can upload a zip package directly to Grav using this tool. Simply select the **Choose File** button (or drag your zip package to the button with some browsers) and select your local package file. Once you have your file selected, simply hit **Upload and Install** to install your package.

![Admin Tools](tools1b.png)

Once your package has been successfully installed, you will be greeted with an alert letting you know. That's all there is to it!

#### Remote Location

![Admin Tools](tools2.png)

The second method involves linking directly to a package file. For example, if you have a package hosted on a remote server, you can enter the URL of that package in the field. GPM friendly download links such as `https://getgrav.org/download/themes/bootstrap/1.6.0` should work fine.

By default, these uploads are limited to official GPM repository links. But, you can go to **Configuration > System** and toggle the **Official GPM Only** option to **No** to unlock this field and enable direct zip package links that are not official GPM repositories. For example: `http://example.com/mypackage.zip`. This is an advanced feature and should only be used in cases where you have properly vetted the package as safe.

---

## Available Admin Event Hooks

> Path: grav-learn/pages/05.admin-panel/08.extending/01.admin-events/docs.md


The Admin plugin has multiple event hooks that can be used during the [Grav Lifecycle](/plugins/grav-lifecycle).  See the general plugin documentation for using event hooks in the [Plugins](/plugins) chapter.

## Available Admin Event Hooks
* [onAdminTaskExecute](../admin-events#onAdminTaskExecute)
* [onAdminCreatePageFrontmatter](../admin-events#onAdminCreatePageFrontmatter)
* [onAdminSave](../admin-events#onAdminSave)
* [onAdminAfterSave](../admin-events#onAdminAfterSave)
* [onAdminAfterSaveAs](../admin-events#onAdminAfterSaveAs)
* [onAdminAfterDelete](../admin-events#onAdminAfterDelete)
* [onAdminAfterAddMedia](../admin-events#onAdminAfterAddMedia)
* [onAdminAfterDelMedia](../admin-events#onAdminAfterDelMedia)


## Enabling an Admin Event Hook
Admin event hooks are called the [same way](/plugins/plugin-tutorial#step-6-determine-if-the-plugin-should-run) that the core event hooks are called.


* * *

<a name="onAdminTaskExecute"></a>
### onAdminTaskExecute

The Admin plugin fires various tasks, depending on user interaction.  Tasks might include logout, login, save, 2faverify, etc.  After the task completes, this event hook fires.

<a name="onAdminCreatePageFrontmatter"></a>
### onAdminCreatePageFrontmatter

While creating a new page, this event is fired after the header data is initially set to allow plugins to programmatically manipulate the frontmatter.

<a name="onAdminSave"></a>
### onAdminSave

Use admin event `onAdminSave()` to manipulate the page object data `$object` before it is saved to the filesystem.

<a name="onAdminAfterSave"></a>
### onAdminAfterSave

After saving the page in the administration panel, this event is fired.

<a name="onAdminAfterSaveAs"></a>
### onAdminAfterSaveAs

When creating a folder via the panel, this event fires immediately after creating the new folder and performing a standard cache clear.

<a name="onAdminAfterDelete"></a>
### onAdminAfterDelete

Fires after a page or folder is deleted.  It is immediately followed by a standard cache clear.

<a name="onAdminAfterAddMedia"></a>
### onAdminAfterAddMedia

Fires after an add media task completes, but before the confirmation message is displayed.

<a name="onAdminAfterDelMedia"></a>
### onAdminAfterDelMedia

Fires after a delete media task completes, but before the confirmation message is displayed.

---

## Understanding Admin Themes

> Path: grav-learn/pages/05.admin-panel/08.extending/docs.md


This page provides guides for how to extend the Administration Panel, as well as best practices when doing so.

### Understanding Admin Themes

Just like when you are extending or modifying a regular Grav Theme, you will be overriding templates to change the structure and appearance of the Admin Plugin. This means that the templates your plugin declares to be used instead of the default ones should mirror the structure of the Admin Theme exactly. For example, if we wanted to change the avatar in the left-side navigation, we would change `nav-user-avatar.html.twig`.

In the Admin plugin, the path to templates is: `user/plugins/admin/themes/grav/templates`, hereafter referred to as *ADMIN_TEMPLATES*. The file we are looking for is `ADMIN_TEMPLATES/partials/nav-user-avatar.html.twig`, which contains `<img src="https://www.gravatar.com/avatar/{{ admin.user.email|md5 }}?s=47" />`.

In your plugin, the path to templates should be: `user/plugins/myadminplugin/admin/themes/grav/templates`, hereafter referred to as *PLUGIN_TEMPLATES*. The corresponding file should then be `PLUGIN_TEMPLATES/partials/nav-user-avatar.html.twig`, which would contain something like `<img src="{{ myadminplugin_avatar_image_path }}" />`.

Thus we are overriding the path to the template, but non-destructively. We target only the relevant template, in a way that does not override any unnecessary templates or hinder other admin themes from registering their alternate templates for the same use. To do this, we register the path in our plugin like this:

[prism classes="language-php line-numbers"]
public static function getSubscribedEvents(): array
{
    return [
        'onAdminTwigTemplatePaths' => ['onAdminTwigTemplatePaths', 0]
    ];
}

public function onAdminTwigTemplatePaths($event): void
{
    $paths = $event['paths'];
    $paths[] = __DIR__ . '/admin/themes/grav/templates';
    $event['paths'] = $paths;
}
[/prism]

It is important to remember that the theme used in the Admin plugin is sensitive to the templates available. As a general rule, you should only modify templates with *low impact*, that is, make changes that will not break the interface for any user who installs your plugin. In this sense it is better to override `nav-user-avatar.html.twig` than `nav.html.twig`, as the latter contains much more functionality but uses `{% include 'partials/nav-user-details.html.twig' %}` to include the former.

! **TIP:** Admin template files have autoescaping turned on. You do not need to add `|e` filters to escape HTML content, but you do need to add `|raw` if your input is valid HTML.

### Adding a custom field

To create a custom field, we will add it to `PLUGIN_TEMPLATES/forms/fields/myfield`. In the *myfield*-folder we need a Twig-template which declares how the field will operate. The easiest way to add a field is to find a similar field in `ADMIN_TEMPLATES/forms/fields` and copy that, to see how they are structured. For example, to add a HTML range-slider we create `PLUGIN_TEMPLATES/forms/fields/range/range.html.twig`. In this file, we add:

[prism classes="language-twig line-numbers"]
{% extends "forms/field.html.twig" %}

{% block input_attributes %}
    type="range"
    {% if field.validate.min %}min="{{ field.validate.min }}"{% endif %}
    {% if field.validate.max %}max="{{ field.validate.max }}"{% endif %}
    {% if field.validate.step %}step="{{ field.validate.step }}"{% endif %}
    {{ parent() }}
{% endblock %}
[/prism]

This adds a field-type called "range", with the type *range*, that allows the user to select a value by [sliding a button](http://www.html5tutorial.info/html5-range.php). To use the new field in a blueprint, we would simply add this in [*blueprints.yaml*](/plugins/plugin-tutorial#required-items-to-function):

[prism classes="language-yaml line-numbers"]
form:
  fields:
    radius:
      type: range
      label: Radius
      id: radius
      default: 100
      validate:
        min: 0
        max: 100
        step: 10
[/prism]

Which gives us a slider with a default value of 100, where accepted values are between 0 and 100, and each value increments by 10 as we slide it.

We could extend this further by using the `prepend` or `append` blocks available, by for example adding a visual indicator of the selected value. We change `range.html.twig` to contain this:

[prism classes="language-twig line-numbers"]
{% extends "forms/field.html.twig" %}

{% block input_attributes %}
    type="range"
    style="display: inline-block;vertical-align: middle;"
    {% if field.id is defined %}
        oninput="{{ field.id }}_output.value = {{ field.id }}.value"
    {% endif %}
    {% if field.validate.min %}min="{{ field.validate.min }}"{% endif %}
    {% if field.validate.max %}max="{{ field.validate.max }}"{% endif %}
    {% if field.validate.step %}step="{{ field.validate.step }}"{% endif %}
    {{ parent() }}
{% endblock %}
{% block append %}
  {% if field.id is defined %}
    <output
        name="{{ (scope ~ field.name)|fieldName }}"
        id="{{ field.id }}_output"
        style="display: inline-block;vertical-align: baseline;padding: 0 0.5em 5px 0.5em;"
    >
    {{ value|join(', ')|e('html_attr') }}
    </output>
  {% endif %}
{% endblock append %}
[/prism]

Thus we append an `<output>`-tag which will hold the selected value, and add to it and the field itself simple styling to align them properly. We also add an `oninput`-attribute to the field, so that changing values automatically updates the `<output>`-tag with the value. This requires that each field using the range-slider has an unique `id`-property, like the `id: radius` we declared above, which should be something like `id: myadminplugin_radius` to avoid conflicts.

!! If this new template will be shared between frontend and Admin Panel (e.g. using `PLUGIN_TEMPLATES` folder), you need to escape all variables with `|e`. Alternatively you can just go to `Configuration` > `Twig Templating` > `Autoescape variables` and turn it to `Yes`.

### Creating custom page templates

As mentioned in [Theme Basics](/themes/theme-basics#content-pages-twig-templa), there is a direct relationship between **pages** in Grav and the **Twig template files** provided in a theme/ plugin.
To create a custom page template, you will need a blueprint file to define the fields for the Admin plugin and a template file for rendering the content.

#### Adding a custom page template to a theme/ plugin
In the root of the theme/ plugin folder, create a folder named `templates`.  Inside this folder, create a new mypage.html.twig file.  This will be the Twig template for the new page template "mypage".

Example mypage.html.twig:

[prism classes="language-twig line-numbers"]
{% extends 'partials/base.html.twig' %}

{% block content %}
    {{ page.header.newTextField|e }}
    {{ page.content|raw }}
{% endblock %}
[/prism]

There is more information about Twig theming in the [Twig Primer](/themes/twig-primer) section.

Themes automatically find template files within the theme's `templates` folder.  If the template is being added via a plugin, you'll need to add the template via the event `onTwigTemplatePaths`:

[prism classes="language-php line-numbers"]
public function onPluginsInitialized(): void
{
    // If in an Admin page.
    if ($this->isAdmin()) {
        return;
    }
    // If not in an Admin page.
    $this->enable([
        'onTwigTemplatePaths' => ['onTwigTemplatePaths', 1],
    ]);
}

/**
 * Add templates directory to twig lookup paths.
 */
public function onTwigTemplatePaths(): void
{
    $this->grav['twig']->twig_paths[] = __DIR__ . '/templates';
}
[/prism]


#### Adding a custom page blueprint to a theme/ plugin

In order for the Admin plugin to provide a new `mypage` page option, create a folder named `blueprints` in the root of the theme/ plugin. Inside this folder, create a new mypage.yaml file.  This is where you will define custom fields for the Admin plugin to display when creating a new page.  Available form fields can be found in the [Forms](/forms) chapter.

The example blueprint `mypage.yaml` below extends the default page template, and then adds header.newTextField under the content tab.:

[prism classes="language-yaml line-numbers"]
title: My Page Blueprint
'@extends':
    type: default
    context: blueprints://pages

form:
  fields:
    tabs:
      type: tabs
      active: 1
      fields:
        content:
          type: tab
          fields:
             header.newTextField:
              type: text
              label: 'New Text Field'

[/prism]

Similarly to the `templates` folder, a theme will automatically add any blueprint yaml files found within the `blueprints` folder.  If the blueprint is being added via a plugin, you'll need to add the blueprint via the event `onGetPageTemplates`:

[prism classes="language-php line-numbers"]
public function onPluginsInitialized(): void
{
    // If in an Admin page.
    if ($this->isAdmin()) {
        $this->enable([
            'onGetPageBlueprints' => ['onGetPageBlueprints', 0],
            'onGetPageTemplates' => ['onGetPageTemplates', 0],
        ]);
    }
}

/**
 * Add blueprint directory.
 */
public function onGetPageBlueprints(Event $event): void
{
    $types = $event->types;
    $types->scanBlueprints('plugin://' . $this->name . '/blueprints');
}

/**
 * Add templates directory.
 */
public function onGetPageTemplates(Event $event): void
{
    $types = $event->types;
    $types->scanTemplates('plugin://' . $this->name . '/templates');
}
[/prism]

#### Creating a new page

After defining the blueprint and template files, create a new page within the admin panel by clicking on **Add** and then selecting "Mypage":
![myPage.jpg](myPage.jpg)

The Admin edit form now displays the new custom field "New Text Field":
![myPage-customField.jpg](myPage-customField.jpg)

---

## Manual Installation of Admin

> Path: grav-learn/pages/05.admin-panel/09.faq/docs.md


This FAQ is intended to provide useful tutorials, tips, and tricks to help you get the most out of the Admin plugin.

### Manual Installation of Admin

Manual installation is not the recommended method of installation, however, it is still possible to install the admin plugin manually. Basically, you need to download each of the following plugins individually:

* [admin](https://github.com/getgrav/grav-plugin-admin/archive/master.zip)
* [login](https://github.com/getgrav/grav-plugin-login/archive/master.zip)
* [form](https://github.com/getgrav/grav-plugin-form/archive/master.zip)
* [email](https://github.com/getgrav/grav-plugin-email/archive/master.zip)

Extract each archive file into your `user/plugins` folder, then ensure the folders are renamed to just `admin/`, `login/`, `form/`, and `email/`.  Then proceed with the **Usage instructions below**.

### Adding and Managing Users

When you first install the Admin plugin, you will be prompted to create an admin user when you point your browser at your site. This is a simple web form that ensures at least one admin user has been created.

![New User](../introduction/new-user.png?width=1009&classes=shadow)

You can easily add other users but it requires a bit of work in the terminal/command prompt to do. From your terminal, access the root of the Grav site you'd like to add users to, and type the following command:

[prism classes="language-bash command-line"]
bin/plugin login newuser
[/prism]

![Admin FAQ](faq_1.png?width=1009&classes=shadow)

This will initiate a series of prompts to guide you through the creation of a new user. These include creating a user name, password, email address, and setting the new user's permissions level.

!!!! You will need to have a user name consisting of between 3 and 16 characters which can include lowercase letters, numbers, underscores, and hyphens. Uppercase letters, spaces, and special characters are not allowed for the user name.

At one point during the creation process you will be asked to choose a set of permissions for the new user. There are currently three options:

[div class="table table-keycol"]
| Role(s)        | Description                                                                                                       |
| :-----         | :-----                                                                                                            |
| Admin          | Gives the user access to the Admin back end. This role does not include front end access to protected pages. |
| Site           | Gives user access to all pages in the front end. This is the equivalent of a logged-in user.                      |
| Admin and Site | Gives user access to the entire site, front and back end.                                                         |
[/div]

User data is stored in `SITE_ROOT/user/accounts/` and each user is given a **YAML** file containing that user's login information and other details. Here is an example of the data contained within a user account file. For example this could be the content of `SITE_ROOT/user/accounts/tester.yaml`.

!! The filename `tester.yaml` dictates the username is `tester`

[prism classes="language-yaml line-numbers"]
email: test@rockettheme.com
access:
  admin:
    login: true
    super: true
  site:
    login: true
fullname: 'Tester McTesting'
title: Admin
hashed_password: $2y$10$5RAUI6ZCISWR.4f0D6FILu3efYq3078ZX/.9vtAnZbjxS/4PXN/WW
[/prism]

You can edit this information directly to the user's YAML file, or by selecting your user avatar from the sidebar of the admin. This will take you to a page where you can easily manage user information.

![Admin FAQ](faq_2.png?width=1009&classes=shadow)

!! Avatar photos are automatically generated by [Gravatar](https://gravatar.com), based on the user's email address.

For security reasons, user passwords are stored as a hash. If you would like to change your password, we recommend doing so from within the admin.

### Managing ACL

Every user yaml file has an `access` property. By setting this property appropriately, you can grant a specific user access to just a specific part of the admin.

Here are the currently supported access levels explained:

- `admin.login`: allows a user to login to the admin
- `admin.super`: grants a user super admin powers, allowing access to all the admin interface and functionality ignoring other access properties except `admin.login`
- `admin.pages`: allows a user to view pages, edit them and add new ones
- `admin.maintenance`: allows a user to update Grav from the admin side, check for updates and clear the cache
- `admin.plugins`: allows a user to access the plugins functionality, edit the plugins settings, disable plugins or add new ones
- `admin.themes`: allows a user to access the themes functionality, edit theme settings, change themes and add new ones
- `admin.statistics`: allows a user to see the site statistics
- `admin.cache`: allows a user to clear the cache
- `admin.configuration`: allows a user to access the configuration of the instance. Permission for the individual parts have to be given separately via the variables listed below. Only enabling the "sub-variables" without enabling this variable will not enable the configuration menu for the user.
  - `admin.configuration_system`: allows a user to change the system settings
  - `admin.configuration_site`: allows a user to change the site settings
  - `admin.configuration_media`: allows a user to edit the available media types
  - `admin.configuration_info`: allows a user to view the info about this instance
- other access levels, which have not yet been explained are:
  - `admin.tools`
  - `admin.settings`
  - `admin.users`

!! Changes made to a user.yaml file while that user is logged-in will only take effect after they log out and back in again.

### Custom Admin URL

One way to help keep your admin panel secure is to hide its location. To do this would be to change the URL from

[prism classes="language-text"]
http://yourwebsite.com/admin
[/prism]

to something more ambiguous that is going to be harder for someone to guess.  To do this you need to locate `admin.yaml` which can be found in `user/plugins/admin/` folder and **copy this** to `user/config/plugins/admin.yaml`.

Then change the line `route: '/admin'` to something more ambiguous, for example `route: '/myspecialplace'`, this way if you need to access the admin panel for your grav site you will enter

[prism classes="language-text"]
http://yourwebsite.com/myspecialplace
[/prism]

### Offline Mode

![Offline](offline.png?width=1028&classes=shadow)

In the event that your server loses its connection to the Internet, the Grav Admin automatically enters into an Offline Mode. This mode is indicated by a notice below the low in the upper-left corner of the admin.

When in Offline Mode, the admin will not attempt to retrieve updates to the CMS, plugins, or themes. This prevents hangups and other issues that would otherwise result from being unable to reach the update servers.

Once an Internet connection is re-established, the notice will disappear and Offline Mode will end, automatically.

---

## Chapter 5

> Path: grav-learn/pages/05.admin-panel/chapter.md


### Chapter 5

# Administration Panel

The **Grav Administration Panel** is a dynamic administrative interface that makes managing your site, creating new content, and updating its components a breeze.

---

## Available Form Fields for Use in the Admin

> Path: grav-learn/pages/06.forms/01.blueprints/01.fields-available/docs.md


## Available Form Fields for Use in the Admin

Admin-side forms can be created with a variety of fields. This document provides a complete reference of the properties of each field, and provides usage examples.

In addition to the fields listed below, reserved for usage in the Admin, you can also use all the fields available in the frontend forms described in [the Frontend Forms Fields Reference](/forms/forms/fields-available).

### Special Form Fields Available Exclusively in the Admin

[div class="table table-keycol"]
| Field                                             | Description                                                                                                                                                                                                 |
| :-----                                            | :-----                                                                                                                                                                                                      |
| **[Array](#array-field)**                         | used to create key-value arrays                                                                                                                                                                             |
| **BackupHistory**                                 |                                                                                                                                                                                                             |
| **Blueprint**                                     |                                                                                                                                                                                                             |
| **[Colorpicker](#colorpicker-field)**             | show a color picker                                                                                                                                                                                         |
| **[Columns](#columns-column-fields)**             | used to break the form into multiple columns                                                                                                                                                                |
| **[Column](#columns-column-fields)**              | used to show a single column (used with the `Columns` field)                                                                                                                                                |
| **Cron**                                          |                                                                                                                                                                                                             |
| **CronStatus**                                    |                                                                                                                                                                                                             |
| **[Dateformat](#dateformat-field)**               | a special select that renders the current date/time in the passed formats                                                                                                                                   |
| **[Datetime](#datetime-field)**                   | a date and time selection field                                                                                                                                                                             |
| **[Editor](#editor-field)**                       | show a markdown editor                                                                                                                                                                                      |
| **[Elements](#elements-field)**                   | a conditional, and organizational, field to show/hide children based on the selected value of the "trigger". This is extremely useful to keep the clutter down when there are a lot of options to display                                                                                                                                                                                    |
| **[Fieldset](#fieldset-field)**                   | group a set of fields inside a collapsible accordion                                                                                                                                                        |
| **[File](#file-field)**                           | in Admin, **File** is specialized to be used in plugin and theme configurations (blueprints). Handles uploading a file to a location and deleting it, and removing it from the theme / plugin configuration |
| **[Filepicker](#filepicker-field)**               | **Filepicker** allows to choose files from a location in the web server filesystem.                                                                                                                         |
| **Frontmatter**                                   |                                                                                                                                                                                                             |
| **IconPicker**                                    |                                                                                                                                                                                                             |
| **[List](#list-field)**                           | used to create collections of fields                                                                                                                                                                        |
| **Markdown**                                      |                                                                                                                                                                                                             |
| **MediaPicker**                                   |                                                                                                                                                                                                             |
| **Multilevel**                                    |                                                                                                                                                                                                             |
| **Order**                                         |                                                                                                                                                                                                             |
| **PageMedia**                                     |                                                                                                                                                                                                             |
| **[PageMediaSelect](#pagemediaselect-field)**     | shows a select with all the page media. Used in Pages blueprints to let the user choose a media file to be assigned to a field.                                                                             |
| **[Pages](#pages-field)**                         | shows a list of the site pages                                                                                                                                                                              |
| **Parents**                                       |                                                                                                                                                                                                             |
| **Permissions**                                   |                                                                                                                                                                                                             |
| **Range**                                         |                                                                                                                                                                                                             |
| **[Section](#section-field)**                     | used to divide a setting page into sections; each section comes with a title                                                                                                                                |
| **[Selectize](#selectize-field)**                 | a hybrid of a text box and a select box. Mostly useful for tagging and other element picking fields.                                                                                                        |
| **SelectUnique**                                  |                                                                                                                                                                                                             |
| **[Taxonomy](#taxonomy-field)**                   | a special select preconfigured to select one or more taxonomies                                                                                                                                             |
| **ThemeSelect**                                   |                                                                                                                                                                                                             |
| **UserInfo**                                      |                                                                                                                                                                                                             |
| **Xss**                                           |                                                                                                                                                                                                             |
[/div]

### Common Fields Attributes

Every field accepts a list of attributes you can use. Each field could share these common attributes, but particular fields might ignore them. The best way to check which attributes are allowed on a field is to check the field description in this page, and see which attributes are mentioned.

This list provides a common ground so there's no need to repeat the description of a common field.

[div class="table table-keycol"]
| Attribute           | Description                                                                                                                                                                                                     |
| :-----              | :-----                                                                                                                                                                                                          |
| `autocomplete`      | accepts `on` or `off`                                                                                                                                                                                           |
| `autofocus`         | if enabled, autofocus on that field                                                                                                                                                                             |
| `classes`           | accepts a string with one or more CSS classes to add                                                                                                                                                            |
| `default`           | sets the field default value. This ensures you will always get back either a user-specified value _or_ this default value.  See also `placeholder`.                                                             |
| `disabled`          | sets the field disabled state                                                                                                                                                                                   |
| `help`              | Adds a tooltip to the field                                                                                                                                                                                     |
| `id`                | sets the field id as well as the `for` attribute on the label                                                                                                                                                   |
| `label`             | sets the field label                                                                                                                                                                                            |
| `name`              | sets the field name                                                                                                                                                                                             |
| `novalidate`        | sets the field novalidate state                                                                                                                                                                                 |
| `placeholder`       | sets the field placeholder value. This is to set a value the user can see as a prompt for their own value, but it does not influence what value ultimately gets written.  See also `default`.                   |
| `readonly`          | sets the field read-only state                                                                                                                                                                                  |
| `size`              | sets the field size, which in turn adds a class to its container. Valid values are `large`, `x-small`, `medium`, `long`, `small`. You can of course add more in the template you see, when used in the frontend |
| `style`             | sets the field style. If set to `vertical`, the field is able to appear full width. This is an easy way to clean up the form.                                                                                   |
| `title`             | sets the field title value                                                                                                                                                                                      |
| `toggleable`        | add a checkbox that will toggle the enabled/disabled attribute of the field                                                                                                                                     |
| `validate.required` | if set to a positive value, sets the field as required                                                                                                                                                          |
| `validate.pattern`  | sets a validation pattern                                                                                                                                                                                       |
| `validate.message`  | sets the message shown if the validation fails                                                                                                                                                                  |
| `validate.type`     | sets the field type used during validation                                                                                                                                                                      |
[/div]

### Know more about fields

You can read how the fields are built from the source: [Fields added by the Form Plugin](https://github.com/getgrav/grav-plugin-form/tree/master/templates/forms) and [Fields only available in Admin](https://github.com/getgrav/grav-plugin-admin/tree/master/themes/grav/templates/forms).

### Validation

Most of the fields allow validation.

[prism classes="language-yaml line-numbers"]
validate:
    required: true
[/prism]

will cause the field to be marked as required.

[prism classes="language-yaml line-numbers"]
validate:
    message: 'Some message'
[/prism]

will show the defined message when the field is not correctly filled.

[prism classes="language-yaml line-numbers"]
validate:
    pattern: 'Some pattern'
[/prism]

will validate the field value against the passed regex pattern. Examples: `pattern: "[1-9][0-9]*"`, `pattern: '[A-Za-z0-9-]+'`, `pattern: '[a-z0-9-]+'`, ` pattern: '^[a-z0-9_-]{3,16}$'`, `pattern: '(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}'`

#### validate.type

`validate.type` indicates which type should it validate against.

Some examples:

An editor will result in a `textarea`:

[prism classes="language-yaml line-numbers"]
content:
    type: editor
    validate:
      type: textarea
[/prism]

A selectize will be a `commalist`:

[prism classes="language-yaml line-numbers"]
taxonomies:
    type: selectize
    size: large
    label: PLUGIN_ADMIN.TAXONOMY_TYPES
    classes: fancy
    help: PLUGIN_ADMIN.TAXONOMY_TYPES_HELP
    validate:
        type: commalist

filters.category:
  type: selectize
  label: Category filter
  help: Comma separated list of category names
  validate:
    type: commalist
[/prism]

Validate an email address:

[prism classes="language-yaml line-numbers"]
author.email:
    type: text
    size: large
    label: PLUGIN_ADMIN.DEFAULT_EMAIL
    help: PLUGIN_ADMIN.DEFAULT_EMAIL_HELP
    validate:
        type: email
[/prism]

Make sure a value is a bool:

[prism classes="language-yaml line-numbers"]
summary.enabled:
    type: toggle
    label: PLUGIN_ADMIN.ENABLED
    highlight: 1
    help: PLUGIN_ADMIN.ENABLED_HELP
    options:
        1: PLUGIN_ADMIN.YES
        0: PLUGIN_ADMIN.NO
    validate:
        type: bool
[/prism]

Make sure a value is an integer between 0 and 65536:

[prism classes="language-yaml line-numbers"]
summary.size:
    type: text
    size: x-small
    label: PLUGIN_ADMIN.SUMMARY_SIZE
    help: PLUGIN_ADMIN.SUMMARY_SIZE_HELP
    validate:
        type: int
        min: 0
        max: 65536
[/prism]

Make sure a value is a number > 1:

[prism classes="language-yaml line-numbers"]
pages.list.count:
    type: text
    size: x-small
    label: PLUGIN_ADMIN.DEFAULT_PAGE_COUNT
    help: PLUGIN_ADMIN.DEFAULT_PAGE_COUNT_HELP
    validate:
        type: number
        min: 1
[/prism]

Validate a taxonomy type as an array:

[prism classes="language-yaml line-numbers"]
header.taxonomy:
  type: taxonomy
  label: PLUGIN_ADMIN.TAXONOMY
  multiple: true
  validate:
    type: array
[/prism]

Validate a text field as a slug:

[prism classes="language-yaml line-numbers"]
folder:
  type: text
  label: PLUGIN_ADMIN.FOLDER_NAME
  validate:
    type: slug
[/prism]

### Array Field

![Array](array_field_bp.gif)

The `array` field type is used to create a simple list of key - values objects, or just a list of values if you use the `value_only` option.

Example:

[prism classes="language-yaml line-numbers"]
metadata:
   type: array
   label: PLUGIN_ADMIN.METADATA
   help: PLUGIN_ADMIN.METADATA_HELP
   placeholder_key: PLUGIN_ADMIN.METADATA_KEY
   placeholder_value: PLUGIN_ADMIN.METADATA_VALUE
   required: true
[/prism]

[div class="table table-keycol"]
| Attribute           | Description |
| :-----              | :-----      |
| `placeholder_key`   |             |
| `placeholder_value` |             |
| `value_only`        | Do not require or store array keys, just store a simple array of values. |
| `value_type`        | Set to `textarea` to display a [textarea field](/forms/forms/fields-available#textarea-field) for entering array values rather than the smaller [text field](/forms/forms/fields-available#text-field). |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]

### Colorpicker Field

![Colorpicker](colorpicker_field.png)

The `colorpicker` field type is used to display a color picker field

Example:

[prism classes="language-yaml line-numbers"]
color:
   type: colorpicker
   label: Choose a color
   default: '#FFFFFF'
[/prism]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autocomplete](#common-fields-attributes)      |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [placeholder](#common-fields-attributes)       |
| [style](#common-fields-attributes)             |
| [title](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.message](#common-fields-attributes)  |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]

### Columns / column Fields

![Columns](columns_field_bp.gif)

The `columns` and `column` field types are used to divide the contained form fields in columns

Example:

[prism classes="language-yaml line-numbers"]
columns:
  type: columns
  fields:
    column1:
      type: column
      fields:

        # .... subfields

    column2:
      type: column
      fields:

        # .... other subfields
[/prism]

[div class="table table-keycol"]
| Attribute | Description                    |
| :-----    | :-----                         |
| `fields`  | The columns / column subfields |
[/div]

### Dateformat Field

![DateFormat](dateformat_field_bp.gif)

The `dateformat` field type is used to

Example:

[prism classes="language-yaml line-numbers"]
pages.dateformat.short:
    type: dateformat
    size: medium
    classes: fancy
    label: PLUGIN_ADMIN.SHORT_DATE_FORMAT
    help: PLUGIN_ADMIN.SHORT_DATE_FORMAT_HELP
    default: "jS M Y"
    options:
        "F jS \\a\\t g:ia": Date1
        "l jS \\of F g:i A": Date2
        "D, d M Y G:i:s": Date3
        "d-m-y G:i": Date4
        "jS M Y": Date5
[/prism]


[div class="table table-keycol"]
| Attribute   | Description                                             |
| :-----      | :-----                                                  |
| `options`   | The field available key-value options                   |
| `multiple`  | boolean. If positive, the field accepts multiple values |
| `selectize` |                                                         |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]

### Datetime Field

![DateTime](datetime_field.gif)

The `datetime` field type is used to store and present a date and time field.

Example:

[prism classes="language-yaml line-numbers"]
header.date:
  type: datetime
  label: PLUGIN_ADMIN.DATE
  toggleable: true
  help: PLUGIN_ADMIN.DATE_HELP
[/prism]


[div class="table table-keycol"]
| Attribute      | Description           |
| :-----         | :-----                |
| `format`       | A datetime format value, you may use any of the [PHP datetime formats](https://www.php.net/manual/en/datetime.format.php) avaliable. |
| `validate.min` | A minimum valid value |
| `validate.max` | A maximum valid value |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]

### Editor Field

![Editor Field](editor_field_bp.gif)

The `editor` field type is used to present the Codemirror editor

Example:

[prism classes="language-yaml line-numbers"]
frontmatter:
  classes: frontmatter
  type: editor
  label: PLUGIN_ADMIN.FRONTMATTER
  autofocus: true
  codemirror:
    mode: 'yaml'
    indentUnit: 4
    autofocus: true
    indentWithTabs: false
    lineNumbers: true
    styleActiveLine: true
    gutters: ['CodeMirror-lint-markers']
    lint: true
[/prism]


[div class="table table-keycol"]
| Attribute    | Description                                                                              |
| :-----       | :-----                                                                                   |
| `codemirror` | A set of values to be set on the [codemirror editor](https://codemirror.net/doc/manual.html#config). By default uses mode: gfm (github flavored markdown) |
| `resizer`    | If positive, enables the resizer. Otherwise the editor is fixed                          |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [id](#common-fields-attributes)                |
| [novalidate](#common-fields-attributes)        |
| [placeholder](#common-fields-attributes)       |
| [readonly](#common-fields-attributes)          |
[/div]

### Elements Field

![Elements](elements_field.gif)

This field is only organizational and allows grouping items within a named group that will only be showed if the selected element value matches the group.

Example:

[prism classes="language-yaml line-numbers"]
header.elements-demo.type:
  type: elements
  label: 'Elements Demo'
  size: small
  default: gelato
  options:
    gelato: Gelato Flavors
    color: Color
    planets: Planets
  fields:
    gelato:
      type: element
      fields:
        .flavours:
          type: array
          default:
            pistacchio: Pistacchio
            vanilla: Vanilla
            chocolate: Chocolate
            stracciatella: Stracciatella
    color:
      type: element
      fields:
        .description:
          type: textarea
          rows: 10
          default: Color (American English) or colour (Commonwealth English) is the visual perceptual property corresponding in humans to the categories called blue, green, red, etc. Color derives from the spectrum of light (distribution of light power versus wavelength) interacting in the eye with the spectral sensitivities of the light receptors. Color categories and physical specifications of color are also associated with objects or materials based on their physical properties such as light absorption, reflection, or emission spectra. By defining a color space colors can be identified numerically by their coordinates.
    planets:
      type: element
      fields:
        .favorites:
          type: text
          placeholder: What are your favorite planets?
          markdown: true
          description: 'Find a list of planets from [Wikipedia](https://en.wikipedia.org/wiki/Planet)'
[/prism]

### Fieldset Field

![Fieldset Field](fieldset-gif.gif)
The `fieldset` groups a set of fields inside a collapsible box.


Example:

[prism classes="language-yaml line-numbers"]
header.fieldset:
  type: fieldset
  title: Your title
  help: Help text
  info: Info text
  text: Text inside fieldset and before other fields
  icon: comments       # Fork Awesome icons system (see : forkaweso.me).
  collapsed: true      # Initial state of fieldset (see collapsible option)
  collapsible: true    # Whether one can expand the fieldset or not
  fields:
    header.fieldset.an_example_text:
      type: text
      label: text
    header.fieldset.an_example_textarea:
      type: textarea
      label: textarea
[/prism]

!Fieldsets have to be saved in the frontmatter too, with `header.`, in order for their sub-field states to be correctly remembered!

!! **Known issue :** if fields in a fieldset use a `toggleable:`, their state won't be memorized if the fieldset named isn't prefixed with `header.`. Here's an example of a valid structure with a modification of the *pagination* option :

[prism classes="language-yaml line-numbers"]
header.fieldset:
  type: fieldset
  ... etc...
  fields:
    header.content.pagination:
      type: toggle
      toggleable: true
      label: "Activate Pagination ?"
      highlight: 1
      default: 0
      options:
        1: Yes
        0: No
      validate:
        type: bool
[/prism]

#### Icon of the fieldset

You can use an icon to place in the header of the fieldset. The icon system used is [Fork Awesome](https://forkaweso.me).

[div class="table table-keycol"]
| Attribute     | Description                                                                                                |
| :-----        | :-----                                                                                                     |
| `icon`        | An icon for the box                                                                                        |
| `collapsed`   | If `true`, the list is opened collapsed. By default it's expanded                                          |
| `collapsible` | Whether one can expand the fieldset or not                                                                 |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
[/div]

### File Field

![File Field](file_field_bp.gif)

!! The `file` field is intended to be used by **configuration**, **theme**, and **plugins** blueprints, **NOT page blueprints**.  For pages, you should use the existing `pagemedia` field and then utilize the [filepicker](#filepicker-field) field to select the files.

!! The `file` field does not currently work as expected in a list field. Use a single `pagemedia` field separate from the list with one or more `filepicker` fields in the list.

! More details can be found in the dedicated [How To: Add a File Upload](../how-to-add-file-upload) section. Also note that displaying an image uploaded in a file field is not done the same way as with a filepicker field. More details about how to access images uploaded in a file field can be found on this [cookbook entry](https://learn.getgrav.org/cookbook/twig-recipes#displaying-an-image-uploaded-in-a-file-field).

Example:

[prism classes="language-yaml line-numbers"]
custom_logo_login_screen:
  type: file
  label: Custom Logo Login Screen
  destination: 'plugins://admin/assets'
  accept:
    - image/*
[/prism]

[prism classes="language-yaml line-numbers"]
custom_file:
  type: file
  label: A Label
  destination: 'theme://assets'
  multiple: true
  limit: 5
  filesize: 1
  accept:
    - image/*
[/prism]

[div class="table table-keycol"]
| Attribute           | Description                                                                                                |
| :-----              | :-----                                                                                                     |
| `destination`       | The folder where the files will be stored, using a stream or relative to the Grav root. E.g. `plugins://my-plugin/assets` |
| `multiple`          | Whether or not to allow more than one file per field                                                       |
| `limit`             | When `multiple` is enabled, allows to constrain the amount of files permitted to be uploaded               |
| `filesize`          | The size in MB each file is allowed                                                                        |
| `accept`            | Add a list of accepted page mime types and extensions. E.g. `["image/*", '.mp3']`                          |
| `random_name`       | Uses a random filename for each file                                                                       |
| `avoid_overwriting` | Will append a timestamp before each filename if a conflict would occur                                     |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]


### Filepicker Field

![Filepicker Field](filepicker_field.png)

The `filepicker` field type can be used in pages, plugin and theme configurations (blueprints). Handles selecting a file from a location and saving it to the page headers or theme / plugin configuration.

Example:

[prism classes="language-yaml line-numbers"]
picked_image:
  type: filepicker
  folder: 'theme://images/pages'
  label: Select a file
  preview_images: true
  accept:
    - .png
    - .jpg
[/prism]

[prism classes="language-yaml line-numbers"]
header.a_file:
  type: filepicker
  folder: 'self@'
  preview_images: true
  label: Select a file
[/prism]

[div class="table table-keycol"]
| Attribute     | Description                                                                                                |
| :-----        | :-----                                                                                                     |
| `folder` | The folder where the files will be looked up, using a stream or relative to the Grav root. Accepts any value in the [file field destination format](/forms/blueprints/how-to-add-file-upload#destination). |
| `accept` | A list of accepted file extensions                                                          |
| `preview_images` | If enabled, image files will have a little preview |
| `on_demand` | If enabled, will only load the files and images when the filepicker is focused. This is useful for reducing admin edit page load times when there is large media or many filepicker fields |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
[/div]


### Honeypot Field

The `honeypot` field type creates a hidden field that, when filled out, will return with an error. This is a useful way to prevent bots from filling out and submitting a form.

Example:

[prism classes="language-yaml line-numbers"]
fields:
    - name: honeypot
      type: honeypot
[/prism]

This is a simple text field which does not appear on the front end. Bots, which detect fields in the code and fill them out automatically, will likely fill the field out. The error prevents that form from being properly submitted. The error comes back next to the form element, rather than on the top in a message block.

A honeypot field is a popular alternative to captcha fields.


### List Field

![List Field](list_field_bp.gif)

The `list` field type is used to create collections of fields. The field accepts a `fields` attribute that will host subfields, and there will be an "Add item" button to allow the user to add more items to the collection.

Example:

[prism classes="language-yaml line-numbers"]
header.buttons:
  name: buttons
  type: list
  style: vertical
  label: Buttons
  fields:
    .text:
      type: text
      label: Text
    .url:
      type: text
      label: URL
    .primary:
      type: toggle
      label: Primary
      highlight: 1
      default: 1
      options:
          1: 'Yes'
          0: 'No'
      validate:
          type: bool
[/prism]

This example will generate this Admin interface:

![](field_list_1.png)

When saving the page, we'll see the following YAML added to the page frontmatter:

[prism classes="language-yaml line-numbers"]
buttons:
    -
        text: 'Some text'
        url: 'https://getgrav.org'
        primary: false
    -
        text: 'Another text'
        url: 'https://another-url.com'
        primary: true
[/prism]

This will be used in the Theme Twig to output the list in some nice way.

Another example of this field definition is this list of Features, used by Antimatter's Features Modular child page. Every feature has an icon, a header and some text:

[prism classes="language-yaml line-numbers"]
header.features:
  name: features
  type: list
  label: Features

  fields:
    .icon:
      type: text
      label: Icon
    .header:
      type: text
      label: Header
    .text:
      type: text
      label: Text
[/prism]

Accessing and displaying the data of a `list` field is done with a simple twig for loop, like in the example below:

[prism classes="language-twig line-numbers"]
{% for feature in page.header.features %}
    {{ feature.icon }}
    {{ feature.header }}
    {{ feature.text }}
{% endfor %}
[/prism]

[div class="table table-keycol"]
| Attribute   | Description                                              |
| :-----      | :-----                                                   |
| `fields`    | The subfields                                            |
| `collapsed` | If `true`, the list is opened collapsed. By default it's expanded |
| `style`     | Can be set to `vertical` to conserve horizontal space    |
| `btnLabel`  | The "add new item" label text                            |
| `sort`      | Boolean. If negative, disables the ability to sort items |
| `controls`  | Decides where the "Add Item" button will be placed. Can be set to `[top|bottom|both]`. Defaults to `bottom`.  |
| `placement` | Decides where the added item will be placed. Can be set to `[top|bottom|position]`. Defaults to `bottom`. If `placement` value is `top` or `bottom`, both buttons add item to top or bottom respectively. If `placement` value is `position`, item is added depending on a clicked button position - if top button is clicked, item will be added to top and if bottom button - to bottom.  |
| `min`       | Minimum number of items allowed in the list.             |
| `max`       | Maximum number of items allowed in the list. 'Add item' button won't function past this number |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
| [size](#common-fields-attributes)              |
[/div]


### PageMediaSelect Field

The `pagemediaselect` field type is used to allow the users to choose a media from one of the page media already uploaded through FTP or using the page media manager.

Example

[prism classes="language-yaml line-numbers"]
header.img_link:
  label: Choose media
  type: pagemediaselect
[/prism]

[div class="table table-keycol"]
| Attribute  | Description           |
| :-----     | :-----                |
| `multiple` | Select multiple files |
[/div]

[div class="table table-keycol"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [id](#common-fields-attributes)                |
| [novalidate](#common-fields-attributes)        |
| [size](#common-fields-attributes)              |
[/div]


### Pages Field

![Pages Field](pages_field_bp.gif)

The `pages` field type shows a list of the site pages.

Example

[prism classes="language-yaml line-numbers"]
home.alias:
    type: pages
    size: medium
    classes: fancy
    label: PLUGIN_ADMIN.HOME_PAGE
    start_route: '/some_page'
    show_all: false
    show_modular: false
    show_root: false
    help: PLUGIN_ADMIN.HOME_PAGE_HELP
[/prism]

[div class="table table-keycol"]
| Attribute       | Description                            |
| :-----          | :-----                                 |
| `start_route`   | Choose a root route for the list       |
| `show_fullpath` | Show page path instead of title        |
| `show_slug`     | Show slug                              |
| `show_all`      | Shows all pages                        |
| `show_modular`  | Shows modular pages                    |
| `show_root`     | Shows root page                        |
| `options`       | An optional list of additional choices |
| `multiple`      | Select multiple pages                  |
| `limit_levels`  | How many levels to show                |
| `selectize`     |                                        |
[/div]

If you set `multiple` to true, you need to add `validate.type: array`. Otherwise the array of selected pages will not be saved correctly.

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [novalidate](#common-fields-attributes)        |
| [size](#common-fields-attributes)              |
[/div]


### Section Field

The `Section` field type is used to divide a setting page into sections.

Example:

[prism classes="language-yaml line-numbers"]
content:
    type: section
    title: PLUGIN_ADMIN.DEFAULTS
    underline: true

    fields:

        #..... subfields
[/prism]

[div class="table table-keycol"]
| Attribute     | Description                                                    |
| :-----        | :-----                                                         |
| `title`       | A heading title                                                |
| `underline`   | Add an underline after the title                               |
| `text`        | A text to show beneath                                         |
| `security`    | An array of credentials a user needs to visualize this section |
[/div]


### Selectize Field

![Selectize](selectize_field_bp.gif)

The `selectize` field type is used to show a hybrid of a text box and a select box. Mostly useful for tagging and other element picking fields.

Example:

[prism classes="language-yaml line-numbers"]
taxonomies:
    type: selectize
    selectize:
        options:
            - text: "test"
              value: "real value 1"
            - text: "test-2"
              value: "real value 2"
            - text: "test-3"
              value: "real value 3"
    size: large
    label: PLUGIN_ADMIN.TAXONOMY_TYPES
    classes: fancy
    help: PLUGIN_ADMIN.TAXONOMY_TYPES_HELP
    validate:
        type: commalist
[/prism]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
[/div]

[div class="table"]
| Common Attributes IN INPUT BLOCK              |
| :-----                                        |
| [autocomplete](#common-fields-attributes)     |
| [autofocus](#common-fields-attributes)        |
| [classes](#common-fields-attributes)          |
| [disabled](#common-fields-attributes)         |
| [id](#common-fields-attributes)               |
| [novalidate](#common-fields-attributes)       |
| [placeholder](#common-fields-attributes)      |
| [readonly](#common-fields-attributes)         |
| [size](#common-fields-attributes)             |
| [title](#common-fields-attributes)            |
| [validate.pattern](#common-fields-attributes) |
| [validate.message](#common-fields-attributes) |
[/div]


### Taxonomy Field

![Taxonomy](taxonomy_field_bp.gif)

The `taxonomy` field type is a special select preconfigured to select one or more taxonomy values.

Example:

[prism classes="language-yaml line-numbers"]
header.taxonomy:
  type: taxonomy
  label: PLUGIN_ADMIN.TAXONOMY
  multiple: true
  validate:
    type: array
[/prism]

[div class="table table-keycol"]
| Attribute  | Description                                             |
| :-----     | :-----                                                  |
| `multiple` | boolean. If positive, the field accepts multiple values |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [outerclasses](#common-fields-attributes)      |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]

---

## docs

> Path: grav-learn/pages/06.forms/01.blueprints/02.example-plugin-blueprint/docs.md


A Plugin's blueprint gives Grav insight into what a plugin is, its source, support and author information, dependencies, and form fields used to administer the plugin in the Grav Admin.

As an example, here's the Blueprint for a plugin:

[prism classes="language-yaml line-numbers"]
name: Assets
slug: assets
type: plugin
version: 1.0.4
description: "This plugin provides a convenient way to add CSS and JS assets directly from your pages."
icon: list-alt
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-plugin-assets
demo: https://learn.getgrav.org
keywords: assets, javascript, css, inline
bugs: https://github.com/getgrav/grav-plugin-assets/issues
license: MIT

dependencies:
  - { name: afterburner2 }
  - { name: github }
  - { name: email, version: '~2.0' }
[/prism]

There are different properties that you can use to give your resource an identity. Some are **required**, others are _optional_.

[div class="table"]
| property         | description                                                                                                                                                                                                                                                                                                                                                                                                      |
| :-----           | :-----                                                                                                                                                                                                                                                                                                                                                                                                           |
| __name*__        | This is the name of the resource. Avoid appending Plugin or Theme, there is no need for that.                                                                                                                                                                                                                                                                                                                    |
| __slug*__        | This is the unique identifier for the resource, it's also used to determine the name of the folder where the resource is stored, e.g. `user/plugins/__slug__` |
| __type*__        | This is the type of the resource, it should be either `plugin` or `theme` |
| __version*__     | The version of the resource. This value should always change on each release, incrementally. You should follow the [semver](http://semver.org/) standard, too.                                                                                                                                                                                                                                                   |
| __description*__ | The description of your resource. Please don't exceed **200** characters. A description should be short and straight to the point. You can use markdown syntax if needed. It's also a good idea to wrap your description in quotation marks.                                                                                                                                                                     |
| __icon*__        | Icon is what will be used on [getgrav.org](https://getgrav.org). At this stage, we are using [Font Awesome](https://fontawesome.com/icons) icons library, so if you are developing a new plugin or theme, it should be your job to ensure the icon you picked is not already used. Otherwise we will have to change it for you.                                                                |
| _screenshot_     | _(optional)_ Screenshot is only ever evaluated for _Themes_ and completely ignored for _Plugins_. For _Themes_, this would be the filename of the screenshot that comes with the theme (default: `screenshot.jpg`). If you have a _screenshot.jpg_ image at the root of your theme, then you can avoid using this property. Our repository will automatically pick it up.                                        |
| __author.name*__ | The developer full name                                                                                                                                                                                                                                                                                                                                                                                          |
| _author.email_   | _(optional)_ The developer email.                                                                                                                                                                                                                                                                                                                                                                                |
| _author.url_     | _(optional)_ The developer homepage.                                                                                                                                                                                                                                                                                                                                                                             |
| _homepage_       | _(optional)_ If you have a dedicated homepage for your resource, this would be the place for it.                                                                                                                                                                                                                                                                                                                 |
| _docs_           | _(optional)_ If you have written documentation for your resource, you can link them here.                                                                                                                                                                                                                                                                                                                        |
| _demo_           | _(optional)_ If you have a demo up and running about your resource, link it here.                                                                                                                                                                                                                                                                                                                                |
| _guide_          | _(optional)_ If you have tutorials or how-to guides for your resource, link it here.                                                                                                                                                                                                                                                                                                                             |
| _keywords_       | _(optional)_ Although there is no real use of keywords yet, you can list keywords relative to your resource here, comma separated.                                                                                                                                                                                                                                                                               |
| _bugs_           | _(optional)_ The URL where bugs can be reported, usually this would be the [GitHub issues](https://guides.github.com/features/issues/) link.                                                                                                                                                                                                                                                                     |
| _license_        | _(optional)_ The type of license your resource is (MIT, GPL, etc). It is advised that you always provide a `LICENSE` file with your resource.                                                                                                                                                                                                                                                                    |
| _dependencies_   | _(optional)_ A list of dependencies that the plugin/theme requires.  The default process is to use GPM to install them, however, if an optional GIT repository URL is provided, installing direct from the repository will be an option also. Also if you use an array, you can define a name and a version explicitly using [Composer-style package versions](https://getcomposer.org/doc/articles/versions.md) |
| _gpm_            | _(optional)_ Whether to get updates from the GPM. Set to `false` to disable GPM updates for non-GPM resources. |
[/div]

Here is an example of the identity portion of the [GitHub plugin](https://github.com/getgrav/grav-plugin-github) blueprints:

[prism classes="language-yaml line-numbers"]
name: GitHub
slug: github
type: plugin
version: 1.0.1
description: "This plugin wraps the [GitHub v3 API](https://developer.github.com/v3/) and uses the [php-github-api](https://github.com/KnpLabs/php-github-api/) library to add a nice GitHub touch to your Grav pages."
icon: github
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-plugin-github
keywords: github, plugin, api
bugs: https://github.com/getgrav/grav-plugin-github/issues
license: MIT
[/prism]

Theme blueprints work in very much the same way as plugins.

---

## docs

> Path: grav-learn/pages/06.forms/01.blueprints/03.example-plugin-configuration/docs.md


We saw in [the previous example](../example-plugin-blueprint) how to define a blueprint for a plugin and/or theme.

Now, let's see how to offer configuration options for a plugin or theme, that will be shown by the Admin Plugin.

If you want your plugin (or theme) to have options directly configurable from the admin interface, you need to fill the blueprints.yaml file with forms.

For example, here is the **Archives** plugin's **archives.yaml** file:

[prism classes="language-yaml line-numbers"]
enabled: true
built_in_css: true
date_display_format: 'F Y'
show_count: true
limit: 12
order:
    by: date
    dir: desc
filter_combinator: and
filters:
    category: blog
[/prism]

Those are the default settings of the plugin. Without the Admin plugin to configure those settings, the user needs to copy this file in the `/user/config/plugins/` folder and them there.

By providing a correctly-formatted **blueprints.yaml** file, you can allow the user to change the settings from the Admin interface. When the settings are saved, they're automatically written to `/user/config/plugins/archives.yaml` (or under config/themes, if it's a theme). The structure starts as follows:

[prism classes="language-yaml line-numbers"]
name: Archives
version: 1.3.0
description: The **Archives** plugin creates links for pages grouped by month/year
icon: university
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-plugin-archives
demo: http://demo.getgrav.org/blog-skeleton
keywords: archives, plugin, blog, month, year, date, navigation, history
bugs: https://github.com/getgrav/grav-plugin-archives/issues
license: MIT

form:
  validation: strict
  fields:
[/prism]

Here comes the part that we need. Every field in the **archives.yaml** file needs a corresponding form element, for example:

**Toggle**

[prism classes="language-yaml line-numbers"]
enabled:
  type: toggle
  label: Plugin status
  highlight: 1
  default: 1
  options:
      1: Enabled
      0: Disabled
  validate:
       type: bool
[/prism]

**Select**

[prism classes="language-yaml line-numbers"]
date_display_format:
  type: select
  size: medium
  classes: fancy
  label: Date Format
  default: 'jS M Y'
  options:
    'F jS Y': "January 1st 2014"
    'l jS of F': "Monday 1st of January"
    'D, m M Y': "Mon, 01 Jan 2014"
    'd-m-y': "01-01-14"
    'jS M Y': "10th Feb 2014"
[/prism]

**Text**

[prism classes="language-yaml line-numbers"]
limit:
  type: text
  size: x-small
  label: Count Limit
  validate:
    type: number
    min: 1
[/prism]

The root element (in those examples `enabled`, `date_display_format`, `limit`) is the name of the option. The additional components of each field determines how this field is displayed. For example, its type (`type`), its size (`size`), the label shown (`label`) and an optional helpful tooltip that appears on hover (`help`). `default` and `placeholder` let you create some defaults and improve how the fields renders to the user.

The rest of the fields can change depending on the field type. For example the `select` field type requires and `options` list.

Nested options are reachable via dot notation (e.g. `order.dir`)

[prism classes="language-yaml line-numbers"]
order.dir:
  type: toggle
  label: Order Direction
  highlight: asc
  default: desc
  options:
    asc: Ascending
    desc: Descending
[/prism]

The Admin plugin defines many other field types that can be used, in `plugins/admin/themes/grav/templates/forms/fields`.

It's important to note that when `form.validation` is set to `strict`, like in the **Archives** plugin example, you need to add form blueprints for _all_ the options, otherwise an error will pop up on save.
If you instead want to just allow to customize a couple of fields to the Admin interface, not all of them, set `form.validation` as `loose`.

---

## A first example

> Path: grav-learn/pages/06.forms/01.blueprints/04.example-page-blueprint/docs.md


**Page Blueprints** extend from the default page, and give you the ability to add options. Basically, custom pages can come to life by using page blueprints. With a page blueprint, you can 100% configure the editing form for a page as it appears in the Admin.

### A first example

If you want to use the default page form, and just add a couple of select boxes for example, you can extend from the default page.

This will use the default page form, and append a text field to the **Advanced** tab, under the **Overrides** section:

[prism classes="language-yaml line-numbers"]
title: Gallery
extends@:
    type: default
    context: blueprints://pages

form:
  fields:
    tabs:
      type: tabs
      active: 1

      fields:
        advanced:
          fields:
            overrides:
              fields:
                header.an_example_text_field:
                  type: text
                  label: Add a number
                  default: 5
                  validate:
                    required: true
                    type: int
[/prism]

This will instead add a new tab, called **Gallery**, with some fields in it.

[prism classes="language-yaml line-numbers"]
title: Gallery
'@extends':
    type: default
    context: blueprints://pages

form:
  fields:
    tabs:
      type: tabs
      active: 1

      fields:
        gallery:
          type: tab
          title: Gallery

          fields:
            header.an_example_text_field:
              type: text
              label: Add a number
              default: 5
              validate:
                required: true
                type: int

            header.an_example_select_box:
              type: select
              label: Select one of the following
              default: one
              options:
                one: One
                two: Two
                three: Three
[/prism]

The fields types you can add are listed in [Available form fields for use in the admin](../fields-available)

### How to name fields

It's important that fields use the `header.*` structure, so field content is saved to the **Page Header** when saved.

### Create a completely custom page form

You can avoid extending from the default form, and create a page form that is completely unique.

For example:

[version=15,16]
[prism classes="language-yaml line-numbers"]
title: Gallery

form:
  fields:
    tabs:
      type: tabs
      active: 1

      fields:
        gallery:
          type: tab
          title: Gallery

          fields:
            header.an_example_text_field:
              type: text
              label: Add a number
              default: 5
              validate:
                required: true
                type: int

            header.an_example_select_box:
              type: select
              label: Select one of the following
              default: one
              options:
                one: One
                two: Two
                three: Three

            route:
              type: select
              label: PLUGIN_ADMIN.PARENT
              classes: fancy
              '@data-options': '\Grav\Common\Page\Pages::parents'
              '@data-default': '\Grav\Plugin\admin::route'
              options:
                '/': PLUGIN_ADMIN.DEFAULT_OPTION_ROOT

[/prism]
[/version]

[version=17]
[prism classes="language-yaml line-numbers"]
title: Gallery

form:
  fields:
    tabs:
      type: tabs
      active: 1

      fields:
        gallery:
          type: tab
          title: Gallery

          fields:
            header.an_example_text_field:
              type: text
              label: Add a number
              default: 5
              validate:
                required: true
                type: int

            header.an_example_select_box:
              type: select
              label: Select one of the following
              default: one
              options:
                one: One
                two: Two
                three: Three

            route:
              type: parents
              label: PLUGIN_ADMIN.PARENT
              classes: fancy

[/prism]

!! **WARNING:** `route` field has changed in Grav 1.7. Please update your existing blueprints to use the new `type: parents`.
[/version]

### A note for Expert mode

When editing pages in **Expert** mode, the **Blueprint** is not read, and the page form is the same across all pages. This is because in Expert mode you edit the page fields directly in the **Frontmatter** field, and there is no need to have a customized presentation.

### Where to put the Page Blueprints

In order for the Admin Plugin to pick up the blueprints, and thus show the new Page types, you need to put the blueprints in the correct place.

#### In the User Blueprints folder

Put them in `user/blueprints/pages/`. This is a good place to put them when you simply want your blueprints to be present in your site.

#### In the Theme

Put them in `user/themes/YOURTHEME/blueprints/`. This is best when you also intend to distribute your theme: the theme will provide the page blueprints and it will be easier to use.

#### In the Data folder

If you are using a Gantry5 based theme, the best location is `user/data/gantry5/themes/YOURTHEME/blueprints/`, otherwise your files may be lost during a theme update.

#### In a Plugin

Put them in `user/plugins/YOURPLUGIN/blueprints/`. This is the place where to put them if you define and add custom pages in the plugin.

Then subscribe to the `onGetPageBlueprints` event and add them to Grav. The following example adds the blueprints from the `blueprints/` folder.

[prism classes="language-php line-numbers"]
public static function getSubscribedEvents()
{
  return [
    'onGetPageBlueprints' => ['onGetPageBlueprints', 0]

  ];
}

public function onGetPageBlueprints($event)
{
  $types = $event->types;
  $types->scanBlueprints('plugins://' . $this->name . '/blueprints');
}
[/prism]

---

## docs

> Path: grav-learn/pages/06.forms/01.blueprints/05.example-config-blueprints/docs.md


It's common to add some configuration options to site.yaml, to be shown in the site content.

To make those options configurable via Admin panel, add some fields to `user/blueprints/config/site.yaml`. For example:


[prism classes="language-yaml line-numbers"]
extends@:
    '@parent'

form:
    fields:
        content:

            fields:
                myfield:
                    type: text
                    label: My Field
[/prism]

Will add the 'My Field' input type, appending it to the Content section of the Site configuration.

You can add entire new sections too, for example:

[prism classes="language-yaml line-numbers"]
extends@:
    '@parent'

form:
    fields:
        anothersection:
            type: section
            title: Another Section
            underline: true

            fields:
                myfield:
                    type: text
                    label: A label
                    size: large
[/prism]

---

## File Uploads

> Path: grav-learn/pages/06.forms/01.blueprints/06.how-to-add-file-upload/docs.md


### File Uploads

You can add file upload functionality in Pages, Config, Plugins and Themes blueprints. File uploads are always Ajax based and allow Drag & Drop from the desktop or picking them as regular file fields. Every time a file is added to the field, it's automatically uploaded to a temporary folder, and will only be stored when the Save (or Submit) action takes place.

Example of usage:

[prism classes="language-yaml line-numbers"]
custom_file:
  name: myfile
  type: file
  label: A Label
  destination: 'plugins://my-plugin/assets'
  multiple: true
  autofocus: false
  accept:
    - image/*
[/prism]

! In order to add a file upload, you must have a bottom javascript render command in your base Twig template.  `{{ assets.js('bottom') }}`

## Options

A file field has multiple options available, from the accepted MIME type or extension, to the file size allowed:

#### Defaults

[prism classes="language-yaml line-numbers"]
custom_file:
  type: file
  label: A Label
  multiple: false
  destination: 'self@'
  random_name: false
  avoid_overwriting: false
  limit: 10
  accept:
    - image/*
[/prism]

#### `multiple`

[prism classes="language-yaml"]
multiple: false # [false | true]
[/prism]

Like a regular HTML5 file field, when the `multiple` option is enabled, it allows to upload more than a single file. This setting is also tied to the [`limit`](#limit) option, which determines how many of the multiple files are allowed for the field.

#### `destination`

``` yaml
destination: 'self@' # [<path> | <stream> | self@ | page@:<path>]
```

Destination is the location where uploaded files should be stored. This can be either a regular `path` (relative to the root of Grav), a `stream` (such as `theme://images`), `self@` or the special  `page@:` prefix. You can also reference a subfolder relative to the current page with `self@/path`. 

!! `self@` is not allowed outside the Pages or Flex Objects scope, an error will be thrown. If you use a file field outside a Page or Flex Object, you should always change the `destination` setting.

##### Examples

1. If it's desired to upload files to a plugin `testing` folder (`user/plugins/testing`), destination would be:

  [prism classes="language-yaml"]
  destination: 'plugins://testing'
  [/prism]

2. Assuming we have a blog item at the route `/blog/ajax-upload` (physical location being `user/pages/02.blog/ajax-upload`), with the `page@:` prefix the destination would be:

  [prism classes="language-yaml"]
  destination: 'page@:/blog/ajax-upload'
  [/prism]
3. Assuming the current theme is `antimatter` and we want to upload to the assets folder (physical location being `user/themes/antimatter/assets`), with the `theme` stream the destination would be:

   [prism classes="language-yaml"]
   destination: 'theme://assets'
   [/prism]

#### `random_name`

[prism classes="language-yaml"]
random_name: false # [false | true]
[/prism]

When the `random_name` is enabled, the uploaded file will get renamed with a random string **15** characters long. This is helpful if you wish to hash your uploaded files or if you are looking for a way to reduce names collision.

##### Example
[prism classes="language-php"]
'my_file.jpg' => 'y5bqsGmE1plNTF2.jpg'
[/prism]

#### `avoid_overwriting`

[prism classes="language-yaml"]
avoid_overwriting: false # [false | true]
[/prism]

When the `avoid_overwriting` is enabled and a file with the same name of the uploaded one already exists in `destination`, it will be renamed. The newly uploaded file will be prefixed with the current date and time, concatenated by a dash.

##### Example
[prism classes="language-php"]
'my_file.jpg' => '20160901130509-my_file.jpg'
[/prism]

#### `limit`

[prism classes="language-yaml"]
limit: 10 # [1...X | 0 (unlimited)]
[/prism]

When the [`multiple`](#multiple) setting is enabled, `limit` allows to constrain the number of allowed files for an individual field. If `multiple` is not enabled (not enabled by default), `limit` automatically falls back to **1**.

When `limit` is set to **0**, it means that there are no restrictions on the amount of allowed files that can be uploaded.

!! It is good practice to always ensure you have a set limit of allowed files that can be uploaded. This way you have more control over your server resources utilizations.

#### `accept`

[prism classes="language-yaml line-numbers"]
accept:
  - 'image/*' # Array of MIME types and/or extensions. ['*'] for allowing any file.
[/prism]

The `accept` setting allows an array of MIME type as well as extensions definitions. All of the extensions need to be starting with the `.` (dot) plus the extension itself.

In addition you can also allow any file by simply using the __*__ (star) notation `accept: ['*']`.

##### Examples

1. To only allow `yaml` and `json` files:
   [prism classes="language-yaml line-numbers"]
     accept:
       - .yaml
       - .json
   [/prism]
2. To only allow images and videos:
   [prism classes="language-yaml line-numbers"]
     accept:
       - 'image/*'
       - 'video/*'
   [/prism]
3. To allow any image, any video and only mp3 files:
   [prism classes="language-yaml line-numbers"]
     accept:
       - 'image/*'
       - 'video/*'
       - .mp3
   [/prism]
4. To allow any file:
   [prism classes="language-yaml line-numbers"]
     accept:
       - '*'
   [/prism]

#### `filesize`

The max file size is limited by:

1. field level  `filesize:`, then ...

2. Form plugin level configuration `user/plugins/form.yaml` setting `files: filesize:`, then if neither of those are limiting...

3. PHP level configuration for `upload_max_filesize` for individual files that are uploaded, and `post_max_size` for the max form post total size.

##### Examples

1. To limit a specific field to `5M`
   [prism classes="language-yaml line-numbers"]
   custom_file:
     name: myfile
     type: file
     label: A Label
     destination: 'plugins://my-plugin/assets'
     filesize: 5
     accept:
       - image/*
   [/prism]

2. To limit all file fields to `5M`, edit your `user/config/form.yaml` file:
   [prism classes="language-yaml line-numbers"]
   files:
     multiple: false
     limit: 10
     destination: 'self@'
     avoid_overwriting: false
     random_name: false
     filesize: 5
     accept:
       - 'image/*
   [/prism]

   ### Legacy File Upload Processing and Manual Control

   For basic file handling, all you need is the field defintion. The files get uploaded to a temporary location via the Dropzone widget via an XHR call to the server.  On form submission, the files are moved from their temporary location to their final location automatically.  You can however use the `upload: true` action in the `process:` block to manually trigger where in the workflow you want those files to be moved.

   ##### Example:

[prism classes="language-yaml line-numbers"]
process:
    upload: true
    message: 'Thank you for your files'
    reset: true 
[/prism]

---

## Defining Validation Rules

> Path: grav-learn/pages/06.forms/01.blueprints/07.advanced-features/docs.md


There are advanced features in the blueprints which allow you to extend them and to have dynamic fields.

## Defining Validation Rules

If you need the same validation rules multiple times, you can create your own custom rule for it.

[prism classes="language-yaml line-numbers"]
rules:
  slug:
    pattern: "[a-z][a-z0-9_\-]+"
    min: 2
    max: 80
form:
  fields:
    folder:
      type: text
      label: Folder Name
      validate:
        rule: slug
[/prism]

Above example creates rule `slug`, which is then used in the folder field of the form.

## Extending Base Type (extends@)

You can extend existing blueprint, which allows you to add new fields as well as modify existing ones from the base blueprint.

[prism classes="language-yaml line-numbers"]
extends@: default
[/prism]

In the extended format you can specify a lookup context for your base file:

[prism classes="language-yaml line-numbers"]
extends@:
  type: default
  context: blueprints://pages
[/prism]

You can also extend the blueprint itself, if there are multiple versions of the same blueprint.

[prism classes="language-yaml line-numbers"]
extends@: parent@
[/prism]

There is no limit on how many blueprints you can extend. Fields defined in the first blueprint will be replaced by any later blueprints in the list.

[prism classes="language-yaml line-numbers"]
extends@:
  - parent@
  - type: default
    context: blueprints://pages
[/prism]

### Understanding the type- and context-properties

In the examples above, `type` is referencing a file and `context` a path. The `context`-property uses [Streams](https://learn.getgrav.org/advanced/multisite-setup#streams), which means that it resolves to a physical location.

`context: blueprints://` by default will yield `/user/plugins/admin/blueprints`, Admin's blueprints-folder. `type: default` will yield `default.yaml`, when looking up files. Because these two properties are used together, they yield a full path that Grav can understand: `/user/plugins/admin/blueprints/default.yaml`.

Whenever you see the `://`-syntax in these docs, you can be pretty sure it's referring to a stream. And when using `context`, this stream must resolve to an existing folder to work.

## Embedding Form (import@)

Sometimes you may want to share some fields or sub-forms between multiple forms.

Let's create `blueprints://partials/gallery.yaml` which we want to embed to our form:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    gallery.images:
      type: list
      label: Images
      fields:
        .src:
          type: text
          label: Image
[/prism]

Our form then has a section where we would like to embed the gallery images:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    images:
        type: section
        title: Images
        underline: true
        import@:
          type: partials/gallery
          context: blueprints://
[/prism]

While YAML does not allow using the same `import@` key multiple times, you can still import multiple blueprints by appending a unique number after `@`, e.g. `import@1`, `import@2` and so on. The number has no other meaning than preventing YAML parser from erroring out:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    images:
        type: section
        title: Images
        underline: true
        import@1:
          type: partials/gallery
          context: blueprints://
        import@2:
          type: partials/another-gallery
          context: blueprints://
[/prism]

## Removing Fields / Properties (unset-*@)

If you want to remove a field, you can add `unset@: true` inside of it.
If you want to remove a property of field, you just append property name, eg: `unset-options@` removes all options.

## Replacing Fields / Properties (replace-*@)

By default blueprints use deep merging of its properties. Sometimes instead of merging the content of the field, you want to start from a clean table.
If you want to replace the whole field, your new field needs to start with `replace@`:

[prism classes="language-yaml line-numbers"]
author.name:
  replace@: true
  type: text
  label: Author name
[/prism]


As the result `author.name` will have only two properties: `type` and `label` regardless of what the form had before.
You can do the same for individual properties:

[prism classes="language-yaml line-numbers"]
summary.enabled:
  replace-options@: true
  options:
    0: Yeah
    1: Nope
    2: Do not care
[/prism]

Note: `replace-*@` is alias for `unset-*@`.

## Using Configuration (config-*@)

There are times when you might want to get default value from Grav configuration. For example you may want to have author field to default to author of the site:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    author:
      type: text
      label: Author
      config-default@: site.author.name
[/prism]

If your site author name is `John Doe`, the form is equivalent to:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    author:
      type: text
      label: Author
      default: "John Doe"
[/prism]

You can use `config-*@` for any field; for example if you want to change the field `type`, you can just have `config-type@: site.forms.author.type` to allow you to change the input field type from your configuration.

## Using Function Calls (data-*@)

You can make function calls with parameters from your blueprints to dynamically fetch a value for any property in your field. You can do this by using `data-*@:` notation as the key, where `*` is the field name you want to fill with the result of the function call.

As an example we are editing a page and we want to have a field that allows us to change its parent or in another words move page into another location. For that we need default value that points to the current location as well as a list of options which consists of all possible locations. For that we need a way to ask Grav

[prism classes="language-yaml line-numbers"]
form:
  fields:
    route:
      type: select
      label: Parent
      classes: fancy
      data-default@: '\Grav\Plugin\Admin::route'
      data-options@: '\Grav\Common\Page\Pages::parentsRawRoutes'
      options:
        '/': '- Root -'
[/prism]

If you were editing team member page, resulting form would look something like this:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    route:
      type: select
      label: Parent
      classes: fancy
      default: /team
      options:
        '/': '- Root -'
        '/home': 'Home'
        '/team': 'Team'
        '/team/ceo': '  Meet Our CEO'
        ...
[/prism]

While `data-default@:` and `data-options@:` are likely the most used dynamic field properties, you are not limited to those. There are no limits on which properties you can fetch, including `type`, `label`, `validation` and even `fields` under the current field.

Additionally you can pass parameters to the function call just by using array where the first value is the function name and parameters follow:

[prism classes="language-yaml line-numbers"]
  data-default@: ['\Grav\Theme\ImaginaryClass::getMyDefault', 'default', false]
[/prism]

## Changing field ordering

When you extend a blueprint or import a file, by default the new fields are added to the end of the list. Sometimes this is not what you want to do, you may want to add item as the first or after some existing field.

If you want to create a field, you can state its ordering using the `ordering@` property. This field can contain either a field name or an integer (-1 = first item).

Here is an example:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    route:
      ordering@: -1
      type: select
      label: Parent
      classes: fancy
      default: /team
      options:
        '/': '- Root -'
        '/home': 'Home'
        '/team': 'Team'
        '/team/ceo': '  Meet Our CEO'
        ...
[/prism]

Doing this ensures that the route field will be the first field to appear in the form. This makes it easy to import and/or extend an existing field and place your additional fields where you would like them to go.

Here is another example:

[prism classes="language-yaml line-numbers"]
form:
  fields:
    author:
      ordering@: header.title
      type: text
      label: Author
      default: "John Doe"
[/prism]

In the example above, we used the name of another field to set the ordering. In this example, we have set it up so that the `author` field appears after the `title` field in the form.

!! When ordering fields in a page blueprint, you still need to reference the field names prefixed with `header.`, eg: `header.title` for the ordering to work.

## Creating new form field type

If you create a special form field type, which needs a special handling in blueprints, there is a plugin function that you can use.

[prism classes="language-php line-numbers"]
    /**
     * Get list of form field types specified in this plugin. Only special types needs to be listed.
     *
     * @return array
     */
    public function getFormFieldTypes()
    {
        return [
            'display' => [
                'input@' => false
            ],
            'spacer' => [
                'input@' => false
            ]
        ];
    }
[/prism]

You do not need to register this function as it's not really an event, but gets fired when plugin object gets constructed.
The purpose of this function is to give extra instructions how to handle the field, for example above code makes display and spacer types to be virtual, meaning that they won't exist in real data.

You can add any `key: value` pairs including dynamic properties like `data-options@` which will automatically get appended to the fields.

## onBlueprintCreated or accessing blueprint data

Because of blueprints consist of fields with dots, getting nested field from blueprint uses `/` notation instead of `.` notation.

[prism classes="language-php"]
$tabs = $blueprint->get('form/fields/tabs');
[/prism]

This makes it possible to access special data fields, like:

[prism classes="language-php"]
$name = $blueprint->get('form/fields/content.name');
$name = $blueprint->get('form/fields/content/fields/.name');
[/prism]

For backwards compatibility, you can specify divider in the last (3rd) parameter of `set()` and `get()`

[prism classes="language-php"]
$tabs = $blueprint->get('form/fields/tabs', null, '/');
[/prism]

---

## What is a Blueprint?

> Path: grav-learn/pages/06.forms/01.blueprints/docs.md


## What is a Blueprint?

Blueprints are an important aspect of Grav. They are essentially the foundation of a theme or plugin's interaction with the Grav admin. They tell Grav what a theme or plugin is, its name, where it can be found on GitHub, etc. It also generates the configuration options for that theme or plugin in the Grav admin. 

A Blueprint is defined in a YAML file, and can generally host properties as well as form definitions.

The vast majority of Grav users will never have to work with Blueprints. Simply put, they determine how plugins and themes appear in the back-end of the site. For most users, this is where they pick up, configuring their themes and plugins using the Grav admin or manipulating options within the theme or plugin's primary YAML file.

The folks that will work the most with Blueprints are developers that are creating new themes and plugins and customizing a resource's options in the back end. They're a powerful tool that defines what your resource is, where Grav can find updates for it, and what configuration options you should be able to set in the back end.

## Types of Blueprints

Grav uses Blueprints to:

- define themes and plugins information.
- define theme/plugin configuration options to be shown in the Admin.
- define the Pages forms in the Admin.
- define the options shown in the Configuration Admin section.
- define flex directories/objects.

At this point, we will break down additional details about how Blueprints work in Grav.

#### Themes and Plugins

When used with themes and plugins, the convention is to put a **blueprints.yaml** in the package. Doing this tells Grav the metadata of that resource, which introduces it to the Grav admin.

A **blueprints.yaml** file is an important part of any theme and plugin. It's essential for the GPM (Grav Package Manager) system. GPM uses the information stored in the blueprint to make the plugin available to users.

In our [example plugin blueprint](example-plugin-blueprint), we dive into the blueprint of the **Assets** plugin. This blueprint sets the name, author information, keywords, home page, bug report link, and other metadata that not only tells Grav where it can locate updates for the plugin, but to provide a useful resource to the user accessible from the Grav Admin.

Once this information is given, further down in the Blueprint's page, you find forms information. This information creates the Admin Forms that are accessible by the user in the backend of Grav. For example, if you wanted to add a toggle that enables or disables a particular feature of that plugin, you would add it here.

![Admin Forms](blueprints_1.png?classes=shadow)

The **blueprints.yaml** file works with the plugin's named YAML file (example: **assets.yaml**). The blueprint sets what the configurable options are, and the resource's self-named named YAML file sets their values. It's this named YAML file that is then duplicated to the Grav instance's `user/config` section to override these defaults either manually or through the Grav admin.

So essentially, when it comes to any configuration option for a theme or plugin, the **blueprints.yaml** file defines it, and the named YAML file for that resource tells you what it is set at.

#### Pages

Grav Pages can really be anything. A page can be a blog listing, a blog post, a product page, an image gallery, etc.

What determines what a page should do and how it should appear is the **Page Blueprint**.

Grav provides some basic Page Blueprints: Default and Modular. Those are the two main building blocks of Grav.

Additional page Blueprints are added and set up by the theme, which might decide to add as many page Blueprints as possible, or focus on some particular Page blueprints focused on what it needs to do.

A Grav theme is much more flexible and powerful than what you might be used to on other platforms.

This allows themes to be application specific. For example, a theme might specialize in one of those goals:

- building a documentation site, like the one you are reading now.
- building an e-commerce site.
- build a blog.
- build a portfolio site.

A theme can also allow its users to build all of them, but usually a fine-tuned theme created for a single purpose can satisfy that goal better than a generic theme.

A page file is used by a page by setting its markdown file name, e.g. `blog.md`, `default.md` or `form.md`.

Each of those files will use a different page file. You can also change the file type by [using the template header property](https://learn.getgrav.org/content/headers#template).

The template used by a page not only determines the "look and feel" in the frontend, but also determines how the Admin Plugin will render it, allowing you to add options, select boxes, custom inputs and toggles.

How to do it: in your theme, add a `blueprints/` folder and add a YAML file with the name of the page template you added. For example if you add a `blog` page template, add a `blueprints/blog.yaml` file. You can find an [example of this directory in the **Antimatter** theme](https://github.com/getgrav/grav-theme-antimatter/tree/develop/blueprints).

## Components of a Blueprint

There are two sets of information presented in a **blueprints.yaml** file. The first set of metadata information is the identity of the resource itself, the second set is about the forms. All this information is stored in a single **blueprints.yaml** file stored at the root of each plugin and theme.

Here is an example of the metadata portion of a **blueprints.yaml** file:

```yaml
name: GitHub
slug: github
type: plugin
version: 1.0.1
description: "This plugin wraps the [GitHub v3 API](https://developer.github.com/v3/) and uses the [php-github-api](https://github.com/KnpLabs/php-github-api/) library to add a nice GitHub touch to your Grav pages."
icon: github
author:
  name: Team Grav
  email: devs@getgrav.org
  url: https://getgrav.org
homepage: https://github.com/getgrav/grav-plugin-github
keywords: github, plugin, api
bugs: https://github.com/getgrav/grav-plugin-github/issues
license: MIT
```

As you can see here, this area contains a lot of general identifying information about the plugin, including its name, version number, description, author information, license, keywords, and URLs where you can find more information or report bugs. You can see this section in action in the screenshot taken from the Grav Admin below.

![Admin Forms](blueprints_2.png?classes=shadow)

The next section is the forms area, which is just a couple spaces below the data listed above. This area of the blueprint generates forms and fields used to configure the plugin from the Grav Admin. Here is a quick example of this area of the **blueprints.yaml** file.

```yaml
form:
  validation: strict
  fields:
    enabled:
        type: toggle
        label: Plugin status
        highlight: 1
        default: 1
        options:
            1: Enabled
            0: Disabled
        validate:
            type: bool
```

This area of the file creates any administrative options accessible in the Grav Admin. In this particular instance, we have created a simple **Plugin Status** toggle which lets the user enable or disable the plugin from the admin (pictured below).

![Admin Forms](blueprints_3.png?classes=shadow)

## Debugging Blueprints

Errors in Blueprint files may cause unexpected results.

!!! **TIP:** You can run **CLI command** `bin/grav yamllinter` to get a report on an errors in yaml files. This can be an invaluable when modifiying yaml files.


---

## Name

> Path: grav-learn/pages/06.forms/02.forms/01.form-options/docs.md



### Name

There are no required options for forms.  However as outlined in the [Frontend Forms](../../forms) overview, it is highly recommend to at least have a form name:

[prism classes="language-yaml line-numbers"]
form:
    name: my-form
[/prism]

This **must be unique** for your Grav site. This is because the form's name serves as a unique identifier for this form through the system.  A form can be referenced by this name from any other page.

### Method

This option allows you to control if the form should be submitted via `POST` or `GET`.  The default is `POST`.  Also note, if you have a `file` field in your form, the method will also get `enctype="multipart/form-data"` appended:

[prism classes="language-yaml line-numbers"]
form:
    method: GET
[/prism]


### Action

The action by default is going to be the route as the current page.  This makes sense most of the time because the form needs to be processed by the same page that houses the form.  There are times when you want to override the action however to either specify a different file extension (`.json` perhaps) or even target a specific page anchor:

[prism classes="language-yaml line-numbers"]
form:
    action: '/contact-us#contact-form'
[/prism]

You can even process the form on another page if that page is where you want to handle the results.  This can also be used as a technique to alter the template of the response from the one used in the original form:

[prism classes="language-yaml line-numbers"]
form:
    action: /contact-us/ajax-process
[/prism]

Where you have a page file called `form-messages.html.twig` that returns just the message data.  Alternatively you can use the approach below...

### Template

Usually the page's Twig template that displays the form is perfectly capable of handling any success/failure messages or in-line validation responses.  However sometimes it's useful to send the form response back using a different Twig template.  A good example of this is when you want to process your form via Ajax.  You probably only want the HTML for the success/failure messages to be returned by the template, so these can be injected back into the page by JavaScript:

[prism classes="language-yaml line-numbers"]
form:
    template: form-messages
[/prism]

### ID

The ability to set a form-level CSS `id` field. If not provided the form's name is used.

[prism classes="language-yaml line-numbers"]
form:
    id: my-form-id
[/prism]

### Classes

You can also set explicit classes on the form.  There are no default values here.

[prism classes="language-yaml line-numbers"]
form:
    classes: 'form-style form-surround'
[/prism]

### Attributes

Adding custom attributes to the form element. Using the example below, replace `key` with your attribute and `value` with the attribute's value.

[prism classes="language-yaml line-numbers"]
form:
    attributes:
        key: value
[/prism]

### Inline Errors

Setting Inline Errors in the form's markdown file or definition enables the display of in-line errors, an important troubleshooting tool.

[prism classes="language-yaml line-numbers"]
form:
    inline_errors: true
[/prism]

### Client-side Validation

Turning client-side validation off will enable you to see in-line errors and detailed server-side validation that go beyond the HTML5 client-side validation. You can disable client-side validation through form.yaml or in the form definition.

[prism classes="language-yaml line-numbers"]
form:
    client_side_validation: false
[/prism]

[version=17]
### XSS Checks

By default, Grav 1.7 and later versions enable various XSS checks in all the forms. The default settings can be found from [Security Configuration](/basics/grav-configuration#security). However you can override these settings per form or per field, for example you can disable XSS checks in the whole form by:

[prism classes="language-yaml line-numbers"]
form:
    xss_check: false
[/prism]

!! **WARNING** It is not recommended to disable all the XSS checks, but to override specific rules per field basis. All the examples here will also work inside a form field.

You can enable or disable individual rules by overriding the main configuration. The rules which are not overridden will fall back to use security configuration:

[prism classes="language-yaml line-numbers"]
form:
    xss_check:
        enabled_rules:
            on_events: false
            invalid_protocols: false
            moz_binding: false
            html_inline_styles: false
            dangerous_tags: false
[/prism]

Even better, you can also allow specific protocols and tags:

[prism classes="language-yaml line-numbers"]
form:
    xss_check:
        safe_protocols:
            - javascript
        safe_tags:
            - iframe
[/prism]

[/version]

### Keep Alive

You can ensure your forms do not fail to submit when your session expires, by enabling the `keep_alive` option on the form.  By enabling this, an AJAX request will be made to Grav before your session expires to keep it 'fresh':

[prism classes="language-yaml line-numbers"]
form:
    keep_alive: true
[/prism]

### Fieldsets

You can set up `<fieldset></fieldset>` tags for the fields in your form using the `fieldset:` designation in the form.

[prism classes="language-yaml line-numbers"]
form:
    name: Example Form
    fields:
        example:
            type: fieldset
            id: my-fieldset
            legend: 'Test Fieldset'
            fields:
                first_field: { type: text, label: 'First Field' }
                second_field: { type: text, label: 'Second Field' }
[/prism]

The above form outputs as follows:

[prism classes="language-html line-numbers"]
<form action="/grav/example/forms" class="" id="my-example-form" method="post" name="Example Form">
  <fieldset id="my-fieldset">
    <legend>Test Fieldset</legend>
    <div class="form-group">
      <div class="form-label-wrapper">
        <label class="form-label">First Field</label>
      </div>
      <div class="form-data" data-grav-default="null" data-grav-disabled="true" data-grav-field="text">
        <div class="form-input-wrapper">
          <input class="form-input" name="data[first_field]" type="text" value="">
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="form-label-wrapper">
        <label class="form-label">Second Field</label>
      </div>
      <div class="form-data" data-grav-default="null" data-grav-disabled="true" data-grav-field="text">
        <div class="form-input-wrapper">
          <input class="form-input" name="data[second_field]" type="text" value="">
        </div>
      </div>
    </div>
  </fieldset>
</form>
[/prism]

In the above example, the fields appear within the `my-fieldset` fieldset. You'll also notice that the `<legend></legend>` tags are supported through the `legend:` option.

---

## Common Field Attributes

> Path: grav-learn/pages/06.forms/02.forms/02.fields-available/docs.md


## Common Field Attributes

Every field accepts a list of attributes you can use. Each field could share these common attributes, but particular fields might ignore them. The best way to check which attributes are allowed on a field is to check the field description in this page and see which attributes are mentioned.

This list provides a common ground so there's no need to repeat the description of a common field.

[div class="table table-keycol"]
| Attribute           | Description                                                                                                                                                                                                    |
| :-----              | :-----                                                                                                                                                                                                         |
| `autocomplete`      | Accepts `on` or `off`                                                                                                                                                                                          |
| `autofocus`         | if enabled, autofocus on that field                                                                                                                                                                            |
| `classes`           | accepts a string with one or more CSS classes to add                                                                                                                                                           |
| `default`           | sets the field default value                                                                                                                                                                                   |
| `disabled`          | sets the field disabled state                                                                                                                                                                                  |
| `help`              | Adds a tooltip to the field                                                                                                                                                                                    |
| `id`                | sets the field id. Also sets the `for` attribute on the label                                                                                                                                                  |
| `label`             | sets the field label                                                                                                                                                                                           |
| `display_label`     | Accepts `true` or `false`                                                                                                                                                                                           |
| `labelclasses`      | accepts a string with one or more CSS classes to add                                                                                                                                                            |
| `sublabel`             | sets the field sublabel                                                                                                                                                                                           |
| `sublabelclasses`      | accepts a string with one or more CSS classes to add                                                                                                                                                            |
| `name`              | sets the field name                                                                                                                                                                                            |
| `novalidate`        | sets the field novalidate state                                                                                                                                                                                |
| `outerclasses`      | Classes added to the div that includes the label and the field                                                                                                                                                 |
| `wrapper_classes`      | Classes added to the wrapper that includes the description and the field                                                                                                                                                 |
| `placeholder`       | sets the field placeholder value                                                                                                                                                                               |
| `readonly`          | sets the field readonly state                                                                                                                                                                                  |
| `size`              | sets the field size, which in turn adds a class to its container. Valid values are `large`, `x-small`, `medium`, `long`, `small`. You can ofcourse add more in the template you see, when used in the frontend |
| `style`             | sets the field style                                                                                                                                                                                           |
| `title`             | sets the field title value                                                                                                                                                                                     |
| `type`              | sets the field type                                                                                                                                                                                            |
| `validate.required` | if set to a positive value, sets the field as required.                                                                                                                                                        |
| `validate.pattern`  | sets a validation pattern                                                                                                                                                                                      |
| `validate.message`  | sets the message shown if the validation fails                                                                                                                                                                 |
[/div]

To add custom attributes, you can use:
```
attributes:
  key: value
```

To add custom data-* values, you can use:
```
datasets:
  key: value
```

The above shown `attributes` and `datasets` definitions lead to the following field definition:
```
<input name="data[name]" value="" type="text" class="form-input " key="value" data-key="value">
```

!!! NOTE: You can set positive values in multiple ways: `'on'`, `true`, `1`. Other values are interpreted as negative.


### Checkbox Field

![Checkbox Field](checkbox_field.gif)

The `checkbox` field type is used to add a single checkbox to your form.

Example:

[prism classes="language-yaml line-numbers"]
agree_to_terms:
  type: checkbox
  label: "Agree to the terms and conditions"
  validate:
      required: true
[/prism]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [outerclasses](#common-fields-attributes)      |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]

### Conditional Field


The `conditional` field type is used to conditionally display some other fields base on a condition.

Examples:

If your conditional already returns a `true` or `false` then you can simply use this simplified format:

[prism classes="language-yaml line-numbers"]
my_conditional:
  type: conditional
  condition: config.plugins.yourplugin.enabled
  fields: # The field(s) below will be displayed only if the plugin named yourplugin is enabled
    header.mytextfield:
      type: text
      label: A text field
[/prism]

However, if you require more complex conditions, you can perform some logic that returns `'true'` or `'false'` as strings, and the field will understand that too.

[prism classes="language-yaml line-numbers"]
my_conditional:
  type: conditional
  condition: "config.site.something == 'custom'"
  fields: # The field(s) below will be displayed only if the `site` configuration option `something` equals `custom`
    header.mytextfield:
        type: text
        label: A text field
[/prism]

[div class="table table-keycol"]
| Attribute   | Description                                                                       |
| :-----      | :-----                                                                            |
| `condition` | The condition evaluated by twig. Any variable accessible by twig can be evaluated |
[/div]

[div class="table"]
| Common Attributes Allowed             |
| :-----                                |
| [disabled](#common-fields-attributes) |
| [id](#common-fields-attributes)       |
| [label](#common-fields-attributes)    |
| [name](#common-fields-attributes)     |
[/div]


### Display Field

![Display Field](display_field.jpg)

The `display` field type is used to show some text or instructions inside the form. Can accept markdown content

Example:


[prism classes="language-yaml line-numbers"]
test:
    type: display
    size: large
    label: Instructions
    markdown: true
    content: "This is a test of **bold** and _italic_ in a text/display field\n\nanother paragraph...."
[/prism]

[div class="table table-keycol"]
| Attribute  | Description                                                         |
| :-----     | :-----                                                              |
| `markdown` | boolean value that enables markdown processing on the content field |
| `content`  | the textual content to show                                         |
[/div]

[div class="table"]
| Common Attributes Allowed                 |
| :-----                                    |
| [help](#common-fields-attributes)         |
| [id](#common-fields-attributes)        |
| [label](#common-fields-attributes)        |
| [name](#common-fields-attributes)         |
| [id](#common-fields-attributes)           |
| [outerclasses](#common-fields-attributes) |
| [size](#common-fields-attributes)         |
| [style](#common-fields-attributes)        |
[/div]


### File Field

With the `file` field type, you can let users upload files through the form. The field by default allows **one file** only, of type **image** and will get uploaded to the **current** page where the form has been declared.

[prism classes="language-yaml line-numbers"]
# Default settings
my_files:
  type: file
  multiple: false
  destination: 'self@'
  accept:
    - image/*
[/prism]

[div class="table table-keycol"]
| Attribute     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| :-----        | :-----                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `multiple`    | Can be `true` or `false`, when set to **true**, multiple files can be selected at the same time                                                                                                                                                                                                                                                                                                                                                                                          |
| `destination` | Can be either **@self**, **@page:/route**, **local/rel/path/**, or a PHP stream.<br> Set to **@self**, the files will be uploaded where the form has been declared (current .md). <br>Using **@page:/route** will upload to the specified route of a page, if exists (e.g., **@page:/blog/a-blog-post**).<br> Set to **'local/rel/path'**: Can be any path relative to the Grav instance. For instance, `user/images/uploads`. If the path doesn't exist, it will get created, so make sure it is writable.<br> You can also set the value to any valid PHP stream recognized by Grav like `user-data://my-form` or `theme://media/uploads`. |
| `accept`      | Takes an array of MIME types that are allowed. For instance to allow only gifs and mp4 files: `accept: ['image/gif', 'video/mp4']`                                                                                                                                                                                                                                                                                                                                                       |
[/div]

!!! The File field in the admin is a bit different, allowing also to delete a file uploaded to a form, because the use-case in admin is to upload and then associate a file to a field.

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [outerclasses](#common-fields-attributes)      |
[/div]

By default, in Admin the `file` field will overwrite an uploaded file that has the same name of a newer one, contained in the same folder you want to upload it, unless you set `avoid_overwriting` to `true` in the field definition.


### Honeypot Field

The `honeypot` field type creates a hidden field that, when filled out, will return with an error. This is a useful way to prevent bots from filling out and submitting a form.

Example:

[prism classes="language-yaml line-numbers"]
fields:
    honeypot:
      type: honeypot
[/prism]

This is a simple text field which does not appear on the front end. Bots, which detect fields in the code and fill them out automatically, will likely fill the field out. The error prevents that form from being properly submitted. The error comes back next to the form element, rather than on the top in a message block.

A honeypot field is a popular alternative to captcha fields.


### Number Field

The `number` field type is used to present a text input field that accepts numbers only, using the [number HTML5 input](http://html5doctor.com/html5-forms-input-types/#input-number).

Example:
[prism classes="language-yaml line-numbers"]
header.count:
  type: number
  label: 'How Much?'
  validate:
    min: 10
    max: 360
    step: 10
[/prism]

[div class="table table-keycol"]
| Attribute | Description                                       |
| :-----    | :-----                                            |
| `validate.min` | minimum value |
| `validate.max`  | maximum value  |
| `validate.step`  | which increments to step up  |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [outerclasses](#common-fields-attributes)      |
| [readonly](#common-fields-attributes)          |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [title](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]


### Radio Field

![Radio Field](radio_field.gif)

The `radio` field type is used to present a set of radio fields

Example:
[prism classes="language-yaml line-numbers"]
my_choice:
  type: radio
  label: Choice
  default: markdown
  options:
      markdown: Markdown
      twig: Twig
[/prism]

[div class="table table-keycol"]
| Attribute | Description                                         |
| :-----    | :-----                                              |
| `options` | An array of key-value options that will be allowed. |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [outerclasses](#common-fields-attributes)      |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]


### Section Field

The `Section` field type is used to divide a setting page into sections.

Example:

[prism classes="language-yaml line-numbers"]
content:
    type: section
    title: PLUGIN_ADMIN.DEFAULTS
    underline: true

    fields:

        #..... subfields
[/prism]

[div class="table table-keycol"]
| Attribute     | Description                                                    |
| :-----        | :-----                                                         |
| `title`       | A heading title                                                |
| `text`        | A text to show beneath                                         |
| `security`    | An array of credentials a user needs to visualize this section |
| `title_level` | Set a custom headline tag. Default: `h3`                       |
[/div]


### Select Optgroup Field

![Select Optgroup Field](select_optgroup_field.gif)

The `select_optgroup` field type is used to present a select field with groupings.

Example:
[prism classes="language-yaml line-numbers"]
header.newField:
    type: select_optgroup
    label: Test Optgroup Select Field
    options:
      - OptGroup1:
        - Option1
        - Option2
      - OptGroup2:
        - Option3
        - Option4
[/prism]

[div class="table table-keycol"]
| Attribute  | Description                                         |
| :-----     | :-----                                              |
| `options`  | An array of key-value options that will be allowed. |
| `multiple` | Allow the form to accept multiple values.           |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [outerclasses](#common-fields-attributes)      |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]


### Tabs / Tab Fields

![Tabs](tabs_field_bp.gif)

The `tabs` and `tab` field types are used to divide the contained form fields in tabs.

Example:

[prism classes="language-yaml line-numbers"]
tabs:
  type: tabs
  active: 1

  fields:
    content:
      type: tab
      title: PLUGIN_ADMIN.CONTENT

      fields:

        # .... other subfields

    options:
      type: tab
      title: PLUGIN_ADMIN.OPTIONS

      fields:

        # .... other subfields
[/prism]


[div class="table table-keycol"]
| Attribute | Description           |
| :-----    | :-----                |
| `active`  | The active tab number |
[/div]


### Text Field

![Text Field](text_field.gif)

The `text` field is used to present a text input field.

Example:

[prism classes="language-yaml line-numbers"]
header.title:
  type: text
  autofocus: true
  label: PLUGIN_ADMIN.TITLE
  minlength: 10
  maxlength: 255
[/prism]

[div class="table table-keycol"]
| Attribute | Description                                       |
| :-----    | :-----                                            |
| `prepend` | prepend some text or HTML to the front of a field |
| `append`  | append some text or HTML to the end of a field  |
| `minlength` | minimum text length |
| `maxlength`  | maximum text length  |
| `validate.min` | same as minlength |
| `validate.max`  | same as maxlength  |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [autofocus](#common-fields-attributes)         |
| [classes](#common-fields-attributes)           |
| [default](#common-fields-attributes)           |
| [disabled](#common-fields-attributes)          |
| [help](#common-fields-attributes)              |
| [id](#common-fields-attributes)                |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [novalidate](#common-fields-attributes)        |
| [outerclasses](#common-fields-attributes)      |
| [readonly](#common-fields-attributes)          |
| [size](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [title](#common-fields-attributes)             |
| [validate.required](#common-fields-attributes) |
| [validate.pattern](#common-fields-attributes)  |
| [validate.message](#common-fields-attributes)  |
[/div]


### Toggle Field

![Toggle Field](toggle_field_bp.gif)

The `toggle` field type is an on/off kind of input, with configurable labels.

Example:

[prism classes="language-yaml line-numbers"]
summary.enabled:
    type: toggle
    label: PLUGIN_ADMIN.ENABLED
    highlight: 1
    help: PLUGIN_ADMIN.ENABLED_HELP
    options:
        1: PLUGIN_ADMIN.YES
        0: PLUGIN_ADMIN.NO
    validate:
        type: bool
[/prism]


[div class="table table-keycol"]
| Attribute   | Description                                                  |
| :-----      | :-----                                                       |
| `highlight` | The key of the option to highlight (set green when selected) |
| `options`   | The list of key-value options                              |
[/div]

[div class="table"]
| Common Attributes Allowed                      |
| :-----                                         |
| [default](#common-fields-attributes)           |
| [help](#common-fields-attributes)              |
| [label](#common-fields-attributes)             |
| [name](#common-fields-attributes)              |
| [style](#common-fields-attributes)             |
| [toggleable](#common-fields-attributes)        |
| [validate.required](#common-fields-attributes) |
| [validate.type](#common-fields-attributes)     |
| [disabled](#common-fields-attributes)          |
[/div]


---

## Simple Contact Form

> Path: grav-learn/pages/06.forms/02.forms/03.example-form/docs.md


## Simple Contact Form

The **Grav Form Plugin** is the easiest way to use forms on your site. Let's see how we can create a simple contact form.


### A Live Example

The Sora Article skeleton has a form page ready to see while reading this tutorial:

[Live page](http://demo.getgrav.org/soraarticle-skeleton/contact)

[Page markdown file](https://raw.githubusercontent.com/getgrav/grav-skeleton-soraarticle-blog/develop/pages/03.contact/form.md)

### Setup the Page

You can put a form inside any page of your site. All you need to do is rename the page markdown file to `form.md`, or add a [template](../../../content/headers#template) header in the page frontmatter, to make it use the `form` template.

!! Your page's template, or page's parent template, must implement the `{% block content %}` tag in order for the **Grav Form Plugin** to render your inputs on the page.

The form fields and processing instructions are defined in the YAML frontmatter of the page, so just open the page markdown file with your favorite editor, and put the following code in it:

[prism classes="language-yaml line-numbers"]

# Contact form

Some sample page content
[/prism]

!!! Make sure you configured the "Email from" and "Email to" email addresses in the Email plugin with your email address

!! This example uses Google reCAPTCHA via the [captcha field](https://learn.getgrav.org/forms/forms/fields-available#captcha-field), and you should configure your `site_key` and `secret_key` in the form plugin in order for this to work.  If you don't want to use Google reCaptcha, simply remove the `g-recaptcha-response` field and the `captcha: true` process.

Now within your contact page folder create a subfolder named `thankyou/`, create a new file named `formdata.md`. And paste the following code into the file:

[prism classes="language-yaml line-numbers"]

## Email sent!
[/prism]

That's it!


### Live Demo

[Live page](http://demo.getgrav.org/soraarticle-skeleton/contact)

[Page markdown file](https://raw.githubusercontent.com/getgrav/grav-skeleton-soraarticle-blog/develop/pages/03.contact/form.md)

!!! Forms in modular pages work differently. To learn more about that we recommend reading [using forms in modular pages](https://learn.getgrav.org/forms/forms/how-to-forms-in-modular-pages)

When users submit the form, the plugin will send an email to you (as set in the `form` setting of the Grav Email Plugin), and will save the entered data in the data/ folder.

! For full details on setting up and configuring email, please read the [Email plugin documentation](https://github.com/getgrav/grav-plugin-email/blob/develop/README.md)

You can activate the **Grav Data Manager** plugin to see that data in the **Admin Plugin**.

!!! In the future we want Grav to be able to dynamically generate forms from the Admin Plugin

---

## Form actions

> Path: grav-learn/pages/06.forms/02.forms/04.reference-form-actions/docs.md


## Form actions

We saw some example form actions in the simple form example above. Let's detail the actions you can use.

### Email

Sends an email with the specified options.

Example:

[prism classes="language-yaml line-numbers"]
process:
    - email:
        from: "{{ config.plugins.email.from }}"
        to: "{{ config.plugins.email.to }}"
        subject: "Contact by {{ form.value.name|e }}"
        body: "{% include 'forms/data.html.twig' %}"
[/prism]

Sends an email from the email address specified in the Email plugin configuration, sends it to that same email address (it's a contact form, we send it to ourselves).
Unless you want to use other values, you could freely omit from and to, as they are already configured by default to use these values.
The email has the set subject and body.
In this case, the body is generated by the `forms/data.html.twig` file, which is found in the active template (Antimatter and the other main themes have it, but it's not guaranteed that every theme includes it).

Antimatter sets it to

[prism classes="language-twig line-numbers"]
{% for field in form.fields %}
    <div><strong>{{ field.label }}</strong>: {{ string(form.value(field.name)|e) }}</div>
{% endfor %}
[/prism]

In short, it just loops the values and prints them in the email body.

!! Refer to the email plugin documentation for additional [important form email options](https://github.com/getgrav/grav-plugin-email#emails-sent-with-forms) including [multipart message bodies](https://github.com/getgrav/grav-plugin-email#multi-part-mime-messages) (good for anti-spam scores), `reply_to`, and [attachments](https://github.com/getgrav/grav-plugin-email#sending-attachments).

##### Dynamic email attribute

If you want for example to set the `email.from` field from a Form input, you can get its content and use it in this way:

`from: "{{ form.value.email|e }}"`

In this case, we get the field "email" from the form, and use it for the "from" attribute. This way the site owner will receive an email and will be able to directly reply to the email entered in the form.

### Redirect

Redirects the user to another page. The action is immediate, so if you use this, you probably need to put it at the bottom of the actions list.

[prism classes="language-yaml line-numbers"]
process:
    - redirect: '/forms/landing-page'
[/prism]

You may also set some or all of the `redirect` field from a form input or hidden form field. You can get its content and use it in this way:

`redirect: "/path to/location/{{ form.value.hiddenfield }}"`

In this case, we get the field "hiddenfield" from the form, and use it for the last portion of the redirect location. This can be useful when creating forms that, for example, redirect to a download upon completion.

### Message

Sets a message to be shown upon form submission. 

[prism classes="language-yaml line-numbers"]
process:
    - message: Thank you for your feedback!
[/prism]

By default, the message will be rendered at the beginning of the `form` element. 

However, you can optionally modify the presentation either through `display` or through `redirect`.

#### Validation Message

You can utilize the message action to trigger in the event of a failed validation. For example:

[prism classes="language-yaml line-numbers"]
username:
   type: text
   label: Username
   validate:
     required: true
     message: My custom message when validation fails!
[/prism]

This will enable you to write a custom message that users will see in the event that validation fails.

### Display

After submitting the form, the presentation of the form will update to embed a subpage. So for example, if your form lives in `/form`, you can embed the subpage `/form/thankyou` with the following code:

[prism classes="language-yaml line-numbers"]
process:
    - display: thankyou
[/prism]

If you prefer to embed an absolute page path, like `site.com/thankyou`, prepend it with `/`, for example: `display: /thankyou`.

The Form plugin provides a `formdata` template that's suitable for the process destination page, as it outputs the result of the form submission. In the above example, you could create a `pages/form/thankyou/formdata.md` page.

Antimatter and compatible themes provide the `formdata.html.twig` Twig template, that looks like this:

[prism classes="language-twig line-numbers"]
{% extends 'partials/base.html.twig' %}

{% block content %}

    {{ content|raw }}

    <div class="alert">{{ form.message|e }}</div>
    <p>Here is the summary of what you wrote to us:</p>

    {% include "forms/data.html.twig" %}

{% endblock %}
[/prism]

If the `thankyou/formdata.md` page is

[prism classes="language-yaml line-numbers"]

## Email sent!
[/prism]

The output will be a page with the "Email sent!" title, followed by a confirmation message and the form data entered in the previous page.

You could use any page type you want, as a destination page. Just create your own and set the destination page type accordingly.

### Save

Saves the form data to a file. The file is saved to the `user/data` folder, in a subfolder named as the `form.name` parameter. The form **must** have a name for this action to succeed, and the subfolder must be created with appropriate permissions before data can be saved in it, as a new directory will not be created if one does not exist. For example:

!! The `fileprefix` and `body` can contain Twig markup.

[prism classes="language-yaml line-numbers"]
process:
    - save:
        fileprefix: feedback-
        dateformat: Ymd-His-u
        extension: txt
        body: "{% include 'forms/data.txt.twig' %}"
        operation: create
[/prism]

The body is taken from the theme's `templates/forms/data.html.twig` file, provided by Antimatter and updated themes.

! the `operation` can be either `create` (default) to create a new file per-form-submission or `add` to append to a single file.

! note that the `add` operation now requires a static filename: to be defined see the example below.

[prism classes="language-yaml line-numbers"]
process:
    - save:
        filename: feedback.txt
        body: "{% include 'forms/data.txt.twig' %}"
        operation: add
[/prism]

### Captcha

To also validate the captcha server-side, add the captcha process action.

[prism classes="language-yaml line-numbers"]
    process:
        - captcha:
            recaptcha_secret: ENTER_YOUR_CAPTCHA_SECRET_KEY
[/prism]

!! The `recaptcha_secret` is optional and will use the Form plugin's configuration values if you have provided them there.

### User IP Address

Display the user's IP address on the output. Put it above email / save processes in the 'form.md' to ensure it is used by the output processe(s).

[prism classes="language-yaml line-numbers"]
process:
    - ip:
        label: User IP Address
[/prism]

### Timestamp

Add a form submission timestamp to the output. Put it above email / save processes in the 'form.md' to ensure it is used by the output process(es).

[prism classes="language-yaml line-numbers"]
process:
    - timestamp:
        label: Submission Timestamp
[/prism]

### Reset the form after submit

By default, the form is not cleared after the submit. So if you don't have a `display` action and the user is sent back to the form page, it's still filled with the data entered. If you want to avoid this, add a `reset` action:

[prism classes="language-yaml"]
process:
    - reset: true
[/prism]

### Remember field values

Using the `remember` action, you can allow your users to have _some_ field values "recalled" from the last time a form was submitted. This is especially useful for forms which are submitted repeatedly, like an anonymous submission that requires information about the submitter.

! [HTML5](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete) and [Grav's Form plugin](../fields-available#common-field-attributes) already provide this in limited ways through the browser, so do make use of this. However, you may find that autocomplete doesn't work reliably for some users and fields.

! The `remember` action **uses cookies** to store the last value, so it will only work on the same device and browser where the browser is configured to allow them from your site.

To use this action, simply list the names of the fields you would like to be remembered.

For example, an online medical referral form is a good use case. These are typically completed from the same computer with some field values that rarely change and are boring to complete repeatedly.

[prism classes="language-yaml"]
process:
    - remember:
        - referrer-name
        - referrer-address
        - referrer-specialty
        - preferred-practitioner
[/prism]

## Custom Actions

You can "hook" into a form processing and perform any kind of operation. Perform custom processing, add data for an online web application, even save to a database.

To do this, in the form process field add your own processing action name, for example 'yourAction'.

[prism classes="language-yaml"]
process:
    yourAction: true
[/prism]

Then, create a simple plugin.

In its main PHP file, register for the event `onFormProcessed`

[prism classes="language-php line-numbers"]
namespace Grav\Plugin;
use Grav\Common\Plugin;
use RocketTheme\Toolbox\Event\Event;

class EmailPlugin extends Plugin
{
    public static function getSubscribedEvents()
    {
        return [
            'onFormProcessed' => ['onFormProcessed', 0]
        ];
    }
}
[/prism]

Then provide a handler for the saveToDatabase action:

[prism classes="language-php line-numbers"]
    public function onFormProcessed(Event $event)
    {
        $form = $event['form'];
        $action = $event['action'];
        $params = $event['params'];

        switch ($action) {
            case 'yourAction':
                //do what you want
        }
    }
[/prism]

If your processing might go wrong and you want to stop the next form actions, which are executed in series, you can stop the processing by calling `stopPropagation` on the $event object:

[prism classes="language-php line-numbers"]
$event->stopPropagation();
return;
[/prism]

Sample code with form handling is available in the Form plugin, and in the Email plugin repositories.

#### An example of custom form handling

The Form plugin offers this ability of sending emails, saving files, setting status messages and its really handy.
Sometimes however you need total control. Thats for example what the Login plugin does.

It defines the `login.md` page frontmatter:

[prism classes="language-yaml line-numbers"]
title: Login
template: form

form:
    name: login

    fields:
        - name: username
          type: text
          placeholder: Username
          autofocus: true

        - name: password
          type: password
          placeholder: Password
[/prism]

The Forms plugin correctly generates and shows the form. Notice theres no `process` defined.

The form `buttons` are missing too, since theyre manually added in `templates/login.html.twig`. Thats where the form `action` and `task` are defined too.

In this case, `task` is `login.login`, and `action` is set to the page url.

When a user presses 'Login' in the form, Grav calls the `onTask.login.login` event.

`user/plugins/login/login.php` hooks up to `onTask.login.login` to its `classes/controller.php` file, and that's where the authentication happens.

---

## Using forms in modular pages

> Path: grav-learn/pages/06.forms/02.forms/05.how-to-forms-in-modular-pages/docs.md


## Using forms in modular pages

If your theme does not provide a `templates/forms/form.html.twig` file, it's not set up to use forms, but no fear - just copy the form templates from Antimatter, the default Grav theme:

- `templates/form.html.twig`
- `templates/formdata.html.twig`

Now, create a modular folder with page type `form.md`

For example: `01.your-modular-page/_contact/form.md`

The `form.md` page will not contain any form definition. Its just an indication that this is the part that should output the form.

Important: set

[prism classes="language-yaml line-numbers"]
[/prism]

in that page frontmatter header, because of how modular pages work, if you forget this the form will be cached, along with the nonce that is generated every 12 hours. So when reaching the 12 hours change, the form will stop working until the cache is refreshed. This step is not needed for standalone page forms.

Now add the form header to the main modular page, `modular.md`

The modular.md page should contain the whole form definition, with fields etc, as if it was a full-page form.md file header. With its own page path as the `form.action` field.

!!! In Form v2.0, you can now define the form directly in the modular sub-page just like any other form. However, if not found, the form plugin will look in the 'current page', i.e. the top-level modular page for a form, so it's fully backwards compatible with the 1.0 way of doing things. !!!

For example:

[prism classes="language-yaml line-numbers"]

[/prism]

In the form header, make sure you add the `action` parameter, with the modular page route

Like present in the example above.
This step is needed because if you don't explicitly add `form.action`, the code usually looks for the page route, but being the form in a modular subpage, not an actual page, the path is wrong and breaks the form submit.

So if the modular page is e.g. `site.com/my-page`, just put `form: action: /my-page` in `modular.md`.
Even if the modular page is the homepage, use the page route, e.g. `form: action: /home`

#### A live example

The Deliver skeleton has a modular form page ready to see while reading this tutorial:

[Live page](http://demo.getgrav.org/deliver-skeleton/contact)

[Page markdown file](https://github.com/getgrav/grav-skeleton-deliver-site/blob/develop/pages/07.contact/modular_alt.md)

#### Troubleshooting forms in modular pages

The best way to troubleshoot a form is to first get back to the roots, and add your customizations one-by-one to see what might be going wrong.

- I suggest creating a "regular form", making sure it works, then try putting that into a modular form.
- Try making the form work on an Antimatter-based skeleton, which provides all the files you already need.
- If the form fields do not appear, if you have installed the Assets plugin disable / uninstall it. There's a known issue with it breaking modular forms will be soon fixed.

---

## Submitting forms via XHR/Ajax

> Path: grav-learn/pages/06.forms/02.forms/06.how-to-ajax-submission/docs.md


## Submitting forms via XHR/Ajax

The default mechanism for form processing relies on standard HTML style form submission that causes the contents of an HTML form to be sent to the server via either `POST` or `GET` (default is `POST`). After the form has been [validated](../fields-available), and [processed](../reference-form-actions), results are sent back to the form (or to a [redirected page](../reference-form-actions#redirect)) where messages are displayed and the form can be edited for re-submission if required.

This involves a page reload, and that is sometimes undesirable.  This is where a form submitted via JavaScript using Ajax or XHR is the preferred option.  Luckily, Grav's form capabilities are up to the task.

## Automatic Approach (Form plugin >= `v7.3.0`)

With the release of Form plugin version `7.3.0` the ability to submit forms with XHR to process the form in-place and not require an entire page reload is now available with a quick setup option.

To enable this simply add this option to your Form blueprint:

```yaml
xhr_submit: true
```

You are not required to provide `action:`, `template:`, or even `id:`.  The plugin will just 'work' even with multiple ajax forms on a single page. This uses a new `form-xhr.html.twig` template that the plugin provides as well as including some vanilla JS code to make the request.

!! This approach submits the whole form via an XHR request and replaces the entire form HTML from the response. This is intended to be a simple approach, you can still create your own more advanced solutions if required.

!!! The Javacript code used for the XHR request is located in `form/layouts/xhr.html.twig`. If you require, you can copy this to your theme's `templates` folder (maintaining the path structure) and modify as needed.

## Manual Approach (required for Form plugin < `v7.3.0`)

### Creating the form

You can create any standard form you like, so for this example, we'll keep the form as simple as possible to focus on the Ajax handling parts. First, we'll create a form in a page called: `forms/ajax-test/` and create a form page called `form.md`:

[prism classes="language-yaml line-numbers"]
[/prism]

As you can see this is a very basic form that simply asks for your name and provides a submit button.  The only thing that stands out is the `template: form-messages` part.  As outlined in the [Frontend Forms](../../forms) section, you can provide a custom Twig template with which to display the result of the form processing.  This is a great way for us to process the form, and then simply return the messages via Ajax and inject them into the page.  There is already a `form-messages.html.twig` template provided with the forms plugin that does just this.

!! NOTE: We use a hard-coded `action: '/forms/ajax-test'` so the ajax has a consistent URL rather than letting the form set the action to the current page route. This resolves an issue with the Ajax request not handling redirects properly. This can otherwise cause issues on the 'home' page. It doesn't have to be the current form page, it just needs to be a consistent, reachable route.

![](simple-form.png?classes=shadow)

### The page content

In this same page, we need to put a little HTML and JavaScript:

[ui-tabs]

[ui-tab title="Vanilla JS"]
[prism classes="language-twig line-numbers"]
<div id="form-result"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('#ajax-test-form');
    form.addEventListener('submit', function(event) {
        event.preventDefault();
        
        const result = document.querySelector('#form-result');
        const action = form.getAttribute('action');
        const method = form.getAttribute('method');
        
        fetch(action, {
            method: method,
            body: new FormData(form)
        })
        .then(function(response) {
            if (response.ok) {
                return response.text();
            } else {
                return response.json();
            }
        })
        .then(function(output) {
            if (result) {
                result.innerHTML = output;
            }
        })
        .catch(function(error) {
            if (result) {
                result.innerHTML = 'Error: ' + error;
            }
                
            throw new Error(error);
        });
    });
});
</script>
[/prism]
[/ui-tab]

[ui-tab title="jQuery"]
[prism classes="language-twig line-numbers"]
<div id="form-result"></div>

<script>
$(document).ready(function(){

    var form = $('#ajax-test-form');
    form.submit(function(e) {
        // prevent form submission
        e.preventDefault();

        // submit the form via Ajax
        $.ajax({
            url: form.attr('action'),
            type: form.attr('method'),
            dataType: 'html',
            data: form.serialize(),
            success: function(result) {
                // Inject the result in the HTML
                $('#form-result').html(result);
            }
        });
    });
});
</script>
[/prism]
[/ui-tab]

[/ui-tabs]

First we define a div placeholder with the ID `#form-result` to use as a location to inject the form results.

We are using JQuery syntax here for simplicity but obviously, you can use whatever JavaScript you like as long as it performs a similar function.  We first stop the default submit action of the form and make an Ajax call to the form's action with the form's data serialized.  The result of this call is then set back on that div we created earlier.

![](submitted-form.png?classes=shadow)

---

## Create a simple single form

> Path: grav-learn/pages/06.forms/02.forms/docs.md


The **Form** plugin gives you the ability to create virtually any type of frontend form. It is essentially a form construction kit, available for you to use in your own pages. Before going any further, don't forget to install the [**Form** plugin](https://github.com/getgrav/grav-plugin-form) with `bin/gpm install form` if it's not installed yet.

To get an understanding of how the **Form** plugin works, let's start by going over how to create a simple form.

!!!! With **Form 2.0** release, it is now required to pass the **name of the form** as a hidden field.  If you are using the form-plugin-provided `forms.html.twig`, this is handled automatically, however, if you have overridden the default `forms.html.twig` in your theme or plugin, you should manually add `{% include "forms/fields/formname/formname.html.twig" %}` in your form-rendering Twig file.

## Create a simple single form

To add a form to a page of your site, create a page, and set its Page File to "Form". You can do it via the Admin Panel, or via filesystem directly by naming the page `form.md`.

So, for example, `user/pages/03.your-form/form.md`.

The contents of this page will be:

[prism classes="language-yaml line-numbers"]

# My Form

Regular **markdown** content goes here...
[/prism]

!!! This is the content of the `form.md` file, when viewed via file-system. To do this via Admin Plugin, open the page in **Expert Mode**, copy the part between the triple dashes `---`, and paste it in the Frontmatter field.

This is enough to show a form in the page, below the page's content. It is a simple form with a name, email field, two buttons: one to submit the form and one to reset the fields. For more information on the available fields that are provided by the Form plugin, [check out the next section](fields-available).

What happens when you press the `Submit` button?  It executes the `process` actions in series. To find out about other actions, [check out the available options](reference-form-actions) or [create your own](reference-form-actions#custom-actions).

1. An email is sent to the email entered, with the subject `[Feedback] [name entered]`. The body of the email is defined in the `forms/data.html.twig` file of the theme in use.

2. A file is created in `user/data` to store the form input data. The template is defined in `forms/data.txt.twig` of the theme in use.

3. The `thankyou` subpage is shown, along with the passed message. The `thankyou` page must be a subpage of the page containing the form.

!!! Make sure you configured the **Email** plugin to ensure it has the correct configuration in order to send email successfully.

## Multiple Forms

With the release of **Form Plugin v2.0**, you are now able to define multiple forms in a single page.  The syntax is similar but each form is differentiated by the name of the form, in this case `contact-form` and `newsletter-form`:

[prism classes="language-yaml line-numbers"]
forms:
    contact-form:
        fields:
            ...
        buttons:
            ...
        process:
            ...

    newsletter-form:
        fields:
            ...
        buttons:
            ...
        process:
            ...
[/prism]

You can even use this format for single forms, by just providing one form under `forms:`:

[prism classes="language-yaml line-numbers"]
forms:
    contact-form:
        fields:
            ...
        buttons:
            ...
        process:
            ...
[/prism]

## Displaying Forms from Twig

The easiest way to include a form is to simply include a Twig file in the template that renders the page where the form is defined.  For example:

[prism classes="language-twig line-numbers"]
{% include "forms/form.html.twig" %}
[/prism]

This will use the Twig template provided by the Form plugin itself.  In turn, it will render the form as you have defined in the page, and handle displaying a success message, or errors, when the form is submitted.

There is however a more powerful method of displaying forms that can take advantage of the new multi-forms support.  With this method you actually pass a `form:` parameter to the Twig template specifying the form you wish to display:

[prism classes="language-twig line-numbers"]
{% include "forms/form.html.twig" with { form: forms('contact-form') } %}
[/prism]

Using this method, you can choose a specific name of a form to display.  You can even provide the name of a form defined in other pages.  As long as all your form names are unique throughout your site, Grav will find and render the correct form!

You can even display multiple forms in one page:

[prism classes="language-twig line-numbers"]
# Contact Form
{% include "forms/form.html.twig" with { form: forms('contact-form') } %}

# Newsletter Signup
{% include "forms/form.html.twig" with { form: forms('newsletter-form') } %}
[/prism]

An alternative way to display a form is to reference the page route rather than the form name using an array, for example:

[prism classes="language-twig line-numbers"]
# Contact Form
{% include "forms/form.html.twig" with { form: forms( {route:'/forms/contact'} ) } %}
[/prism]

This will find the first form from the page with route `/forms/contact`

## Displaying Forms in Page Content

You can also display a form from within your page content (for example `default.md`) directly without that page even having a form defined within it. Simply pass the name or route to the form.

!!  **Twig processing** should be enabled and **page cache** should be disabled to ensure the form is dynamically processed on the page and not statically cached and form handling can occur.

[prism classes="language-twig line-numbers"]

# Contact Form
{% include "forms/form.html.twig" with {form: forms('contact-form')} %}

# Newsletter Signup
{% include "forms/form.html.twig" with {form: forms( {route: '/newsletter-signup'} ) } %}
[/prism]

## Modular Forms

With previous versions of the Form plugin, to get a form to display in a modular sub-page of your overall **modular** page, you had to define the form in the **top-level modular page**.  This way the form would be processed and available to display in the modular sub-page.

In **Form v2.0**, you can now define the form directly in the modular sub-page just like any other form.  However, if not found, the form plugin will look in the 'current page', i.e. the top-level modular page for a form, so it's fully backwards compatible with the 1.0 way of doing things.

You can also configure your Modular sub-page's Twig template to use a form from another page, like the examples above.

! When using a form defined in a modular sub-page you should set the **action:** to the parent modular page and configure your form with a **redirect:** or **display:** action, as this modular sub-page is not a suitable page to load on form submission because it is **not routable**, and therefore not reachable by a browser.  

Here's an example that exists at `form/modular/_form/form.md`:

[prism classes="language-yaml line-numbers"]

## Modular Form
[/prism]


---

## Chapter 6

> Path: grav-learn/pages/06.forms/chapter.md


### Chapter 6

# Forms

This chapter explains how to **extend admin forms** and create **custom fields** for your page content.

Also, it digs into creating frontend forms.
---

## MacOS

> Path: grav-learn/pages/07.cli-console/01.command-line-intro/docs.md


It's no secret that Grav was built with the command line in mind. While the Admin plugin is certainly making it easier to get more done without opening a Terminal (MacOS and Linux) or Command Prompt (Windows), there's a lot to be said about the speed and level of control that comes with working from the command line.

This is especially true for folks that are running their own development servers, or a remote server with which they have the ability to access the command line. The amount of tools at your disposal from the command line are incredible. You can control virtually all aspects of your site's hosting, Grav, and its plugins and themes with a handful of keystrokes.

In the end, it all comes down to personal preference. On this page, we will list some great resources out there to help you become familiar with the command line.

!! Not all operating systems are compatible with one another when it comes to commands. There are minor differences between MacOS and many Linux distros, with Windows' Command Prompt having a very different set of commands from the other two.

## MacOS

MacOS is based on Unix and is POSIX standards compliant. This means that most of the commands you may be familiar with on other Unix or Linux-based operating systems will work exactly as expected in MacOS. There are some exceptions to the rule, and it's for that reason that we recommend researching Terminal commands for the specific operating system you're working with.

Here are some great resources to help you become accustomed to using the Terminal in MacOS:

* [Michael Hogg's MacOS Terminal Commands Guide](http://michael-hogg.co.uk/os_x_terminal.php) - A practical resource for MacOS-friendly Terminal commands, what they do, and how to use them.
* [MacRumors Guide to Terminal](http://guides.macrumors.com/Terminal) - A useful resource for navigating and using the Terminal, including tips for using it with the GUI.
* [Envato Tuts+ Terminal Tips and Tricks](http://computers.tutsplus.com/tutorials/40-terminal-tips-and-tricks-you-never-thought-you-needed--mac-51192) - 40 clever tips and tricks for mastering the Terminal. Includes commands you won't find in many basic introductions.
* [Envato Tuts+ Taming the Terminal](http://computers.tutsplus.com/articles/new-mactuts-session-taming-the-terminal--mac-45471) - A multi-part, detailed course in using the Terminal. Includes videos, screenshots, and more.


## Linux

The vast majority of Linux (and Unix) distros out there have one big thing in common: the Bash command line interface (Terminal). Whether you are running a GUI such as Gnome, Unity, or KDE or not, there is a good chance that if you're running a Linux distro on your desktop or laptop you have visited the command line.

After all, it's powerful. You can do pretty much anything you could with the GUI directly into the command line, often with more control over how the commands are carried out. Here are some excellent resources to help you get familiar with the Terminal in Linux:

* [TechSpot's Beginner's Guide to the Linux Command Line](http://www.techspot.com/guides/835-linux-command-line-basics/) - An excellent beginner's guide to the command line.
* [MakeUseOf's Quick Guide to Getting Started with the Linux Command Line](http://www.makeuseof.com/tag/a-quick-guide-to-get-started-with-the-linux-command-line/) - Another great resource for learning about the Terminal.
* [O'Reilly Linux DevCenter Directory of Linux Commands](http://www.linuxdevcenter.com/cmd/) - An index of commands available in the Terminal.
* [Ryan's Tutorials Linux Tutorial](http://ryanstutorials.net/linuxtutorial/) - An excellent all-in-one guide to Linux and the Bash command line interface (Terminal).

## Windows

Windows sits apart from the pack for a number of reasons. Many of the commands in the command line for Windows are reminiscent of its DOS roots. Common commands such as `ls` for a directory listing doesn't work here. Instead, you would type `dir`. Here are a handful of resources to help you get the hang of the Windows Command Prompt:

* [MakeUseOf's Beginner's Guide to the Windows Command Line](http://www.makeuseof.com/tag/a-beginners-guide-to-the-windows-command-line/) - A well-written introduction to the command line for Windows.
* [DOSPrompt.info](http://dosprompt.info/) - An entire site devoted to familiarizing users with the Command Prompt.

!! All of Grav's CLI commands rely on PHP, but this is not immediately available in Windows. You can find out whether it is installed by opening a console and typing `php -v` to check. If `'php' is not recognized as an internal or external command ...` returns, it is not.

If you want to add PHP to your Windows system, you need to find your "Environment Variables", either by searching for it in the Start-Menu or going to Control Panel -> Advanced System Settings -> Click the "Environment Variables"-button.

Under "System Variables", find "Path" and click edit. Copy the "variable value" into notepad, and add a semicolon at the end - to separate variables. Then find the path to your installation of PHP ([from scratch](http://windows.php.net/) or using a current installation that came with your development environment), and add it to the end of this long list of variables. You want the folder-path, not including `php.exe`.

When that is done, open a new console (or restart your current one) so the new path is applied. Then try `php -v` again, you should get an output like: `PHP 7.0.7 (cli) ...`. When you run Grav's commands, you will need to prepend `php` to them, for instance `php grav/gpm index`.

## Grav-specific Commands

One of the coolest things about Grav is that you have a host of powerful commands at your disposal to do everything from installing additional plugins and themes to adding users to the Admin. In this section, we will list many of the most commonly used commands.

All of the commands listed below are compatible with <strong>any operating system.</strong>

[version=15]
[div class="table table-keycol"]
| Command                           | Description                                                                                                                        |
| :----------------                 | :--------------------------------------                                                                                            |
| `bin/grav list`                   | Lists all commands available in Grav (excluding the GPM).                                                                          |
| `bin/grav help <command>`         | Gives you help on a specific command.                                                                                              |
| `bin/grav new-project <location>` | Used to create a new, clean Grav instance in a different folder. Can be run from an existing Grav install.                         |
| `bin/grav install`                | This command installs any dependencies needed to run your current Grav install.                                                    |
| `bin/grav clear-cache`            | This command clears the cache of your Grav install. Options include: `--all`, `--assets-only`, `--images-only`, and `--cache-only` |
| `bin/grav backup`                 | Creates a zip backup of your current Grav site.                                                                                    |
| `bin/grav composer`               | Updates manually-installed composer-based vendor packages.                                                                         |
| `bin/grav security`               | Runs through the configured XSS security checks on all Grav pages                                                                  |
| `bin/gpm list`                    | Lists all commands available via Grav's GPM (Grav Package Manager)                                                                 |
| `bin/gpm help <command>`          | Gives you help on a specific command.                                                                                              |
| `bin/gpm index`                   | Shows a list of all the available resources in the Grav repository, organized by themes and plugins.                               |
| `bin/gpm info`                    | Displays the details of the desired package, such as description, author, homepage, etc.                                           |
| `bin/gpm install`                 | Installs a resource from the repository to your current Grav instance with a simple command.                                       |
| `bin/gpm update`                  | Checks installed plugins and themes for available updates and lists them.                                                          |
| `bin/gpm uninstall`               | Removes an installed theme or plugin and clears the cache.                                                                         |
| `bin/gpm self-upgrade`            | Enables you to update Grav to the latest version.                                                                                  |
[/div]
[/version]


[version=16,17]
[div class="table table-keycol"]
| Command                           | Description                                                                                                                        |
| :----------------                 | :--------------------------------------                                                                                            |
| `bin/grav list`                   | Lists all commands available in Grav (excluding the GPM).                                                                          |
| `bin/grav help <command>`         | Gives you help on a specific command.                                                                                              |
| `bin/grav new-project <location>` | Used to create a new, clean Grav instance in a different folder. Can be run from an existing Grav install.                         |
| `bin/grav install`                | This command installs any dependencies needed to run your current Grav install.                                                    |
| `bin/grav cache`                  | This command clears the cache of your Grav install. Options include: `--all`, `--assets-only`, `--images-only`, and `--cache-only` |
| `bin/grav backup`                 | Creates a zip backup of your current Grav site.                                                                                    |
| `bin/grav composer`               | Updates manually-installed composer-based vendor packages.                                                                         |
| `bin/grav security`               | Runs through the configured XSS security checks on all Grav pages                                                                  |
| `bin/gpm list`                    | Lists all commands available via Grav's GPM (Grav Package Manager)                                                                 |
| `bin/gpm help <command>`          | Gives you help on a specific command.                                                                                              |
| `bin/gpm index`                   | Shows a list of all the available resources in the Grav repository, organized by themes and plugins.                               |
| `bin/gpm info`                    | Displays the details of the desired package, such as description, author, homepage, etc.                                           |
| `bin/gpm install`                 | Installs a resource from the repository to your current Grav instance with a simple command.                                       |
| `bin/gpm update`                  | Checks installed plugins and themes for available updates and lists them.                                                          |
| `bin/gpm uninstall`               | Removes an installed theme or plugin and clears the cache.                                                                         |
| `bin/gpm self-upgrade`            | Enables you to update Grav to the latest version.                                                                                  |
| `bin/gpm logviewer`               | Easily view Grav logs with configuration options to pick log file, number of lines, and verbosity                                  |
| `bin/gpm scheduler`               | Manage the scheduled jobs and manually run the scheduler process if required                                                       |
[/div]
[/version]


!! These commands are explained in greater detail within the [Grav CLI](../grav-cli) and [Grav GPM](../grav-cli-gpm) documentation.

The commands listed below, are compatible with <strong>mac or unix systems.</strong>

[div class="table table-keycol"]
| Command                                  | Description                                                                                                               |
| :----------------                        | :--------------------------------------                                                                                   |
|  `bin/gpm index \| grep '\| installed'`  | Lists all plugins and themes you currently have installed. |
[/div]

## Symbolic Links

Symbolic Links (also known as symlinks) are incredibly useful and easy to perform within the command line. What it does it create a virtual copy (clone) of a given folder or its contents and puts it wherever you'd like it to go. Unlike a true copy, it is simply a tunnel to the original so everything you see and change is reflected in multiple places at once.

Another great benefit of doing this is that it takes up virtually zero additional disk space since you don't have multiple copies of the same files.

Where Grav is concerned, symlinks are a great way to add plugins, themes, and content to multiple instances and doing so in a way that makes it infinitely easier to update and modify. You make a change once, and it appears everywhere the file(s) are symlinked.

The process for performing a symlink is pretty straightforward, with minor differences between operating systems.

### Symbolic Links in MacOS and Linux

![](osx_symlink.png)

The command follows a common pattern of `ln -s <original file, directory, or its contents> <put virtual copies here>`.

The commands that initiate a symlink differ between operating systems. For MacOS and the majority of Unix and Linux distros, `ln -s` is the command. The `ln` part tells the system you want to create a link. The `-s` switch sets the link as symbolic.

### Symbolic Links in Windows

The basic structure of the command in Windows is `mklink <type> <put virtual copies here> <original file, directory, or its contents>`. Unlike MacOS or Linux, you will need to set the argument for the type of file you're symbolically linking. The source and destination are also flipped in this case, where the new symbolic link comes before the file you're linking to. There are three arguments you can use here:

* `/j` - This is the most commonly used argument. It creates a symlink of a directory.
* `/h` - This creates a symbolic link for a specific file.
* `/d` - This creates a soft link, or a shortcut. It's not likely to be used for the purposes outlined here.


### Example Commands

Basically, you state the command that initiates the symlink, what you're symbolically linking, and where you're putting the virtual copies. Below, we've detailed examples of these commands:

##### Link Contents of One Folder to Another

[div class="table"]
| MacOS and Linux             | Windows                           |
| :-----                      | :-----                            |
| `ln -s ~/folder1 ~/folder2` | `mklink /J C:\folder2 C:\folder1` |
[/div]

This command creates a symlink that takes contents originally placed in **folder1** and puts a symbolically linked copy of them in **folder2**. If **folder2** does not already exist, it is created with this command.

##### Link Entire Folders from One Place to Another

[div class="table"]
| MacOS and Linux              | Windows                            |
| :-----                       | :-----                             |
| `ln -s ~/folder1 ~/folder2/` | `mklink /J C:\folder2\ C:\folder1` |
[/div]

This command copies the entire **folder1** directory and places it in the target location (in this case **folder2**). In this case, **folder2** would need to already exist as it will not be created with this command.
Watch the slash or backslash at the ending when specifying **folder2**.

##### Link Individual File(s) from One Place to Another

[div class="table"]
| MacOS and Linux                      | Windows                                     |
| :-----                               | :-----                                      |
| `ln -s ~/folder1/file.jpg ~/folder2` | `mklink /H C:\folder2\ C:\folder1\file.jpg` |
[/div]

This is a useful command for symbolically linking individual files. This is especially useful if you have files that are shared between multiple directories and you want to have them update everywhere at the same time. Keep in mind that the original file is the only actual copy, so it must remain where it is for all of the symbolic links to work.

---

## Backup

> Path: grav-learn/pages/07.cli-console/02.grav-cli/docs.md


Grav comes with a built-in command-line interface (CLI) which can be found at `bin/grav`. The CLI is extremely useful for running recurring tasks such as **clearing the cache**, making **backups**, and more.

Accessing the CLI is a simple process but you need to use a **terminal**.  On a mac this is called `Terminal`, on windows, it's called `cmd` and on Linux, it's just a shell. UNIX style commands are not natively available in Windows cmd. Installing the [msysgit](http://msysgit.github.io/) package on a Windows machine adds [Git](https://git-scm.com/) and Git BASH, which is an alternative command prompt that makes UNIX commands available.  If you are accessing your server remotely, you most likely will use **SSH** to remotely log in to your server.  Check out this [great tutorial for more information on SSH](http://code.tutsplus.com/tutorials/ssh-what-and-how--net-25138).

Although some operations can be performed manually, by _relying_ on the CLI, these tasks could be automated via _cronjobs_ that run daily.

To get a list of all the commands available in Grav, you can run the command:

[prism classes="language-bash command-line"]
bin/grav list
[/prism]

This should display something like:

[version=15]
[prism classes="language-text"]
Available commands:
  backup       Creates a backup of the Grav instance
  clean        Handles cleaning chores for Grav distribution
  clear-cache  [clearcache] Clears Grav cache
  composer     Updates the composer vendor dependencies needed by Grav.
  help         Displays help for a command
  install      Installs the dependencies needed by Grav. Optionally can create symbolic links
  list         Lists commands
  new-project  [newproject] Creates a new Grav project with all the dependencies installed
  sandbox      Setup of a base Grav system in your webroot, good for development, playing around or starting fresh
  security     Capable of running various Security checks
[/prism]
[/version]

[version=16,17]
[prism classes="language-text"]
Available commands:
  backup       Creates a backup of the Grav instance
  cache        [clearcache|cache-clear] Clears Grav cache
  clean        Handles cleaning chores for Grav distribution
  composer     Updates the composer vendor dependencies needed by Grav.
  help         Displays help for a command
  install      Installs the dependencies needed by Grav. Optionally can create symbolic links
  list         Lists commands
  logviewer    Display the last few entries of Grav log
  new-project  [newproject] Creates a new Grav project with all the dependencies installed
  sandbox      Setup of a base Grav system in your webroot, good for development, playing around or starting fresh
  scheduler    Run the Grav Scheduler.  Best when integrated with system cron
  security     Capable of running various Security checks
[/prism]
[/version]

To get help for a specific command, you can prepend help to the command:

[prism classes="language-bash command-line"]
bin/grav help install
[/prism]

## Backup

[version=15]
Backing up your project is nothing more than creating an archive of the _ROOT_ of Grav. No Database, no complications.

Of course, you can simplify this even more by just using the Grav CLI. Supposing we have our `~/workspace/portfolio` project and that we want to create a backup of it, here's what we will do:

[prism classes="language-bash command-line"]
cd ~/workspace/portfolio
bin/grav backup
[/prism]

A new backup `portfolio-20140812174352.zip` file has been created at the `backup/` folder of the project. The long number after the name is just the date in the format of _year month day hour minute second_.

[/version]
[version=16,17]
The Grav backup system has been completely revamped in Grav 1.6 to support multiple backup profiles.  These profiles are configures in the `user/config/backups.yaml`.  If you don't have a custom configuration file, Grav will use the default one provided in `system/config/backups.yaml`.

If Grav detects multiple backup profiles, the CLI command will prompt you to choose the one you wish to backup with the CLI command.

[prism classes="language-bash command-line" cl-output="2-10"]
cd ~/workspace/portfolio
bin/grav backup

Grav Backup
===========

Choose a backup?
  [0] Default Site Backup
  [1] Pages Backup
[/prism]

Alternatively you can pass an index of the profile directly:

[prism classes="language-bash command-line" cl-output="2-10"]
$ cd ~/workspace/portfolio
bin/grav backup 1

Archiving 36 files [===================================================] 100% < 1 sec Done...

 [OK] Backup Successfully Created: /users/joe/workspace/portfolio/backup/pages_backup--20190227120510.zip
[/prism]

More information on the backup functionality can be found in the [Advanced -> Backups](/advanced/backups) section.
[/version]

## Clean

This CLI command is primarily used during the package building process, as it removes extraneous files and folders from Grav.  It is strongly recommended you **do not use this** yourself unless you are using it build your own Grav packages.

[prism classes="language-bash command-line"]
bin/grav clean
[/prism]

## Clear-Cache

You can clear the cache by deleting all the files and folders under `cache/`.

The equivalent CLI command is:

[version=15]
[prism classes="language-bash command-line"]
$ cd ~/webroot/my-grav-project
bin/grav clear-cache
[/prism]

There are several aliases for compatibility (`clear-cache`, `clearcache`, `clear`).

The default option is the standard cache clearing process however, you can control this further with these options:

[prism classes="language-text"]
--all             If set will remove all including compiled, twig, doctrine caches
--assets-only     If set will remove only assets/*
--images-only     If set will remove only images/*
--cache-only      If set will remove only cache/*
--tmp-only        If set will remove only tmp/*
[/prism]
[/version]

[version=16,17]
[prism classes="language-bash command-line"]
$ cd ~/webroot/my-grav-project
bin/grav cache
[/prism]

There are several aliases for compatibility (`cache`, `cache-clear`, `clearcache`, `clear`).

The default option is the standard cache clearing process however, you can control this further with these options:

[prism classes="language-text"]
--purge           If set purge old caches
--all             If set will remove all including compiled, twig, doctrine caches
--assets-only     If set will remove only assets/*
--images-only     If set will remove only images/*
--cache-only      If set will remove only cache/*
--tmp-only        If set will remove only tmp/*
[/prism]
[/version]

## Composer

If you installed Grav via GitHub and have manually installed composer-based vendor packages, you can easily update with:

[prism classes="language-bash command-line"]
bin/grav composer
[/prism]

You can also pass composer options such as `install`:

[prism classes="language-bash command-line"]
bin/grav composer --install
[/prism]

or

[prism classes="language-bash command-line"]
bin/grav composer --update
[/prism]

!! These all use the `--no-dev` composer option, so to be able to perform testing you should use composer directly: `bin/composer.phar`

## Install

To install the dependencies Grav relies on (**error** plugin, **problems** plugin, **antimatter** theme), launch a **terminal** or **console** and navigate to the grav folder where you want to install the dependencies and run the CLI command.

[prism classes="language-bash command-line"]
$ cd ~/webroot/my-grav-project
bin/grav install
[/prism]

You should now have the dependencies installed under:
* `~/webroot/my-grav-project/user/plugins/error`
* `~/webroot/my-grav-project/user/plugins/problems`
* `~/webroot/my-grav-project/user/themes/antimatter`

[version=16,17]
## Log Viewer

As part of Grav 1.6, a new logviewer CLI command was created to allow for quick viewing of Grav logs.

The simplest way to use this command is to simply type:

[prism classes="language-bash command-line"]
cd ~/webroot/my-grav-project
bin/grav logviewer
[/prism]

This will output the last 20 log entries of the `logs/grav.log` file.  There are a few options:

[prism classes="language-text line-numbers"]
-f, --file[=FILE]     custom log file location (default = grav.log)
-l, --lines[=LINES]   number of lines (default = 10)
-v, --verbose         verbose output including a stack trace if available
[/prism]

e.g.

[prism classes="language-bash command-line" cl-output="2-11"]
bin/grav logviewer --lines=4                                                                           [12:27:20]

Log Viewer
==========

viewing last 4 entries in grav.log

2019-02-27 12:00:30 [WARNING] Plugin 'foo-plugin' enabled but not found! Try clearing cache with `bin/grav cache`
2019-02-27 12:04:57 [NOTICE] Backup Created: /Users/joe/my-grav-project/backup/default_site_backup--20190227120450.zip
2019-02-27 12:05:10 [NOTICE] Backup Created: /Users/joe/my-grav-project/backup/pages_backup--20190227120510.zip
2019-02-27 12:26:00 [NOTICE] Backup Created: /Users/joe/my-grav-project/backup/pages_backup--20190227122600.zip
[/prism]
[/version]

And verbose output with stack traces:

[prism classes="language-bash command-line" cl-output="2-22"]
bin/grav logviewer -v                                                                                                       [16:12:12]

Log Viewer
==========

viewing last 20 entries in grav.log

2019-03-14 05:52:44 [WARNING] Plugin 'simplesearch.bak' enabled but not found! Try clearing cache with `bin/grav clear-cache`
2019-03-14 05:52:44 [CRITICAL] A function must be an instance of \Twig_FunctionInterface or \Twig_SimpleFunction.
0 /Users/joe/my-grav-project/plugins/acme-twig-filters/acme-twig-filters.php(52): Twig\Environment->addFunction(Object(Twig\TwigFilter))
1 /Users/joe/my-grav-project/vendor/symfony/event-dispatcher/EventDispatcher.php(212): Grav\Plugin\ACMETwigFiltersPlugin->onTwigInitialized(Object(RocketTheme\Toolbox\Event\Event), 'onTwigInitializ...', Object(RocketTheme\Toolbox\Event\EventDispatcher))
2 /Users/joe/my-grav-project/vendor/symfony/event-dispatcher/EventDispatcher.php(44): Symfony\Component\EventDispatcher\EventDispatcher->doDispatch(Array, 'onTwigInitializ...', Object(RocketTheme\Toolbox\Event\Event))
3 /Users/joe/my-grav-project/vendor/rockettheme/toolbox/Event/src/EventDispatcher.php(23): Symfony\Component\EventDispatcher\EventDispatcher->dispatch('onTwigInitializ...', Object(RocketTheme\Toolbox\Event\Event))
4 /Users/joe/my-grav-project/system/src/Grav/Common/Grav.php(365): RocketTheme\Toolbox\Event\EventDispatcher->dispatch('onTwigInitializ...', Object(RocketTheme\Toolbox\Event\Event))
5 /Users/joe/my-grav-project/system/src/Grav/Common/Twig/Twig.php(175): Grav\Common\Grav->fireEvent('onTwigInitializ...')
6 /Users/joe/my-grav-project/system/src/Grav/Common/Processors/TwigProcessor.php(24): Grav\Common\Twig\Twig->init()
7 /Users/joe/my-grav-project/system/src/Grav/Framework/RequestHandler/Traits/RequestHandlerTrait.php(45): Grav\Common\Processors\TwigProcessor->process(Object(Nyholm\Psr7\ServerRequest), Object(Grav\Framework\RequestHandler\RequestHandler))
8 /Users/joe/my-grav-project/system/src/Grav/Framework/RequestHandler/Traits/RequestHandlerTrait.php(57): Grav\Framework\RequestHandler\RequestHandler->handle(Object(Nyholm\Psr7\ServerRequest))
9 /Users/joe/my-grav-project/system/src/Grav/Common/Processors/AssetsProcessor.php(28): Grav\Framework\RequestHandler\RequestHandler->handle(Object(Nyholm\Psr7\ServerRequest))

2019-03-14 05:52:46 [WARNING] Plugin 'simplesearch.bak' enabled but not found! Try clearing cache with `bin/grav clear-cache`
...
[/prism]

## New Project

Every time you want to start a new project with Grav, you need to start with a clean Grav instance. Through the CLI, this process is super easy and takes only a few seconds.

1. Launch a **terminal** or **console** and navigate to the _grav_ folder (for the sake of this document we will assume it resides under  `~/Projects/grav`)

[prism classes="language-bash command-line"]
cd ~/Projects/grav
[/prism]

2. Run the Grav CLI to create a new project, with the destination being the location where your project will reside in (usually the [webroot](http://en.wikipedia.org/wiki/Webroot) of your Web server). Let us assume we are creating a **portfolio** and we want it at `~/Webroot/portfolio`.

[prism classes="language-bash command-line"]
bin/grav new-project ~/webroot/portfolio
[/prism]

This will create a new Grav instance and download all the dependencies required.

## Sandbox

Grav has a nifty utility called `sandbox`, which can quickly create a [symlinked](/cli-console/command-line-intro#symbolic-links) copy of the Grav-installation. Simply put, running `bin/grav sandbox -s DESTINATION` - where "DESTINATION" is the path to the folder where you want the copied installation - recreates the Grav-installation in another folder.

For example, running:

[prism classes="language-bash command-line"]
bin/grav sandbox -s ../copy
[/prism]

From your current Grav-folder creates a sibling-folder named `copy`, where the following folders are virtual copies: `/bin, /system, /vendor, /webserver-configs`, as well as standard files that typically reside in Grav's root-folder. All content in /user will be carbon copies, not virtual, so you can easily get started with customizing the new installation without having created overhead from core files.

[version=16,17]
## Scheduler

As outlined in the [Advanced -> Scheduler](/advanced/scheduler) section, The scheduler can be monitored via the CLI command.

The base command will manually run the scheduler tasks that are due:

[prism classes="language-bash command-line"]
bin/grav scheduler
[/prism]

To get some more detail you can run with the optional `-v` option:

[prism classes="language-bash command-line" cl-output="2-10"]
bin/grav scheduler -v

Running Scheduled Jobs
======================

[2019-02-27T12:34:07-07:00] Success: Grav\Common\Cache::purgeJob
[2019-02-27T12:34:07-07:00] Success: Grav\Common\Cache::clearJob
[2019-02-27T12:34:07-07:00] Success: ls -lah
[/prism]

Other options include:

[prism classes="language-text line-numbers"]
-i, --install         Show Install Command
-j, --jobs            Show Jobs Summary
-d, --details         Show Job Details
[/prism]

Please refer to the [Advanced -> Scheduler](/advanced/scheduler) section, for more detailed information on these options.
[/version]

## Security

Added in Grav 1.5 is a new security scanner CLI command.  You can run this to quickly scan your contents against the [configured security settings](/basics/grav-configuration#security).

[prism classes="language-bash command-line" cl-output="2-10"]
bin/grav security                                                                                       [12:34:12]

Grav Security Check
===================

Scanning 11 pages [===================================================] 100% < 1 sec

[OK] Security Scan complete: No issues found...
[/prism]

#### PHP CGI-FCGI Information

To determine if your server is running `cgi-fcgi` on the command line, type the following:

[prism classes="language-bash command-line" cl-output="2-5"]
$ php -v
PHP 5.5.17 (cgi-fcgi) (built: Sep 19 2014 09:49:55)
Copyright (c) 1997-2014 The PHP Group
Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies
    with the ionCube PHP Loader v4.6.1, Copyright (c) 2002-2014, by ionCube Ltd.
[/prism]

If you see a reference to `(cgi-fcgi)` you will need to prefix all `bin/grav` commands with `php-cli`. Alternatively, you can set up an alias in your shell with something like: `alias php="php-cli"` which will ensure the **CLI** version of PHP runs from the command line.







---

## Reserved Commands and Options

> Path: grav-learn/pages/07.cli-console/03.grav-cli-plugin/docs.md


Plugins can integrate to Grav's CLI `bin/plugin` and enhance the plugin functionalities via Terminal by executing specific tasks.

As explained in the [Grav CLI](../grav-cli) section, you need to use a **terminal** in order to be able to execute commands.

When running the command `bin/plugin`, all the plugins who provide CLI integration will be listed.

![](bin-plugin.png)

The first option passed in to `bin/plugin` is always the plugin slug (ie, _error_, _login_, etc). The second option is the actual _command_ that the plugin provides.

Based on the plugin implementation there could be other following options and you can learn more about each of them by running the `bin/plugin [slug] list` command.

## Reserved Commands and Options

There are some reserved _commands_ and _options_ that are always available from any plugin. These are also particularly important to keep in mind if you are a developer and want to implement your own tasks, because you won't be able to use any of the reserved commands and options.

[div class="table table-keycol"]
| **Commands** |                             |
|--------------|-----------------------------|
| `help`       | Displays help for a command |
| `list`       | Lists commands              |
[/div]

[div class="table table-keycol"]
| **Options**                |                                                                                                    |
|----------------------------|----------------------------------------------------------------------------------------------------|
| `-h`, `--help`             | Display help message                                                                               |
| `-q`, `--quiet`            | Do not output any message                                                                          |
| `-v`, `--version`          | Display application version                                                                        |
| `--ansi`                   | Force ANSI output                                                                                  |
| `--no-ansi`                | Disable ANSI output                                                                                |
| `-n`, `--no-interaction`   | Do not ask any interactive question                                                                |
| `-v|vv|vvv`, `--verbose`   | Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug |
[/div]

## How to Use the CLI for Plugins

The **list** and **help** commands are very useful when you don't know yet how to use a certain plugin CLI.

With **list** you can access all the available commands and view a quick description of what each of them do.

Here is an example with the **login** plugin when we run the command `bin/plugin login list`.

! Not specifying any command after the plugin slug defaults automatically to `list`. This means that both `bin/plugin [slug] list` and `bin/plugin [slug]` are equivalents.

![](bin-plugin-login.png)

As you can see, most of the options and commands correspond to the [reserved list](#reserved-commands-and-options). The actual commands offered by the login plugin are `add-user`, `new-user` and `newuser`.

As you can notice the help description of all 3 commands is identical. This is because, by choice, the 3 commands are exactly the same. **add-user** and **newuser** are in fact aliases for **new-user**, which allows to easily guess the command without knowing or remembering it.

Now that we know the login plugin comes with a `new-user` command, we only need to learn how to use it. This is where the reserved **help** command comes in place. Let's run `bin/plugin login help new-user`.

![](bin-plugin-newuser.png)

Now we have a complete understanding of the `new-user` command and we know how to use it.
Let's try creating a new user. Because all the options are optional by definition, we will omit the password on purpose (we will be asked about it in a prompt later).

[prism classes="language-bash command-line" cl-output="2-7"]
bin/plugin login newuser -u joeuser -e joeuser@grav.org -P b -N "Joe User" -t "Site Administrator"
Creating new user

Enter a password: *********
Repeat the password: *********

Success! User joeuser created.
[/prism]

## Developers: Integrate the CLI in Plugin

As a Developer, you might want to create CLI commands for admins or users to run. It is extremely easy to add such functionality in a Plugin.

The first thing you want to do is to create a subfolder `cli/` at the root of your plugin. This folder will be processed by `bin/plugin` and scanned for commands classes.

Grav's CLI is based on the great [Symfony Console Component](http://symfony.com/doc/current/components/console/introduction.html) and you can pretty much follow their documentation for a complete reference, there are just a few important things you should consider.

1. The name of the class file is standard. It should start with a capital letter and end with **Command.php**.
    * `Hello.php`: WRONG
    * `helloworldCommand.php`: WRONG
    * `HelloworldCommand.php`: CORRECT
    * `HelloWorldCommand.php`: CORRECT
2. You should always extend `ConsoleCommand`, this will offer you some Grav extras such as formatted colors, direct access to the Grav instance and other utilities ([more details](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Console/ConsoleTrait.php)).
3. Symfony Console requires an `execute` method. When extending **ConsoleCommand** this becomes `serve`.

Below is a simple example to get you started. You can test it, as is, by saving it as `HelloCommand.php` and by placing it under your plugin's root `cli/` folder (**user/plugins/my_plugin/cli/HelloCommand.php**).

[prism classes="language-php line-numbers"]
<?php
namespace Grav\Plugin\Console;

use Grav\Console\ConsoleCommand;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Input\InputOption;

/**
 * Class HelloCommand
 *
 * @package Grav\Plugin\Console
 */
class HelloCommand extends ConsoleCommand
{
    /**
     * @var array
     */
    protected $options = [];

    /**
     * Greets a person with or without yelling
     */
    protected function configure()
    {
        $this
            ->setName("hello")
            ->setDescription("Greets a person.")
            ->addArgument(
                'name',
                InputArgument::REQUIRED,
                'The name of the person that should be greeted'
            )
            ->addOption(
                'yell',
                'y',
                InputOption::VALUE_NONE,
                'Wheter the greetings should be yelled or quieter'
            )
            ->setHelp('The <info>hello</info> greets someone.')
        ;
    }

    /**
     * @return int|null|void
     */
    protected function serve()
    {
        // Collects the arguments and options as defined
        $this->options = [
            'name' => $this->input->getArgument('name'),
            'yell' => $this->input->getOption('yell')
        ];

        // Prepare the strings we want to output and wraps the name into a cyan color
        // More colors available at:
        // https://github.com/getgrav/grav/blob/develop/system/src/Grav/Console/ConsoleTrait.php
        $greetings = 'Greetings, dear <cyan>' . $this->options['name'] . '</cyan>!';

        // If the optional `--yell` or `-y` parameter are passed in, let's convert everything to uppercase
        if ($this->options['yell']) {
            $greetings = strtoupper($greetings);
        }

        // finally we write to the output the greetings
        $this->output->writeln($greetings);
    }
}
[/prism]

![](grav-plugin-hello.png)

! Another good simple example can be found in the [Error Plugin (LogCommand.php)](https://github.com/getgrav/grav-plugin-error/blob/develop/cli/LogCommand.php), If you are looking for a more complex example, you should have a look at the [Login Plugin (NewUserCommand.php)](https://github.com/getgrav/grav-plugin-login/blob/develop/cli/NewUserCommand.php)

---

## PHP CGI-FCGI Information

> Path: grav-learn/pages/07.cli-console/04.grav-cli-gpm/docs.md


Since the release of version **0.9.3**, Grav includes a _GPM_ (Grav Package Manager) which allows you to install, update, uninstall and list all the themes and plugins available on the Grav repository, as well as upgrade Grav itself to the latest version.

Like the [Grav CLI](../grav-cli), the _GPM_ is a command-line tool which requires the user to run commands via a command-line interface, such as **Terminal** in MacOS. UNIX style commands are not natively available in Windows cmd. Installing the [msysgit](https://msysgit.github.io/) package on a Windows machine adds [Git](https://git-scm.com/) and Git BASH, which is an alternative command prompt that makes UNIX commands available.

To get started with _GPM_, you can run the following command to receive a list of all presently available commands:

[prism classes="language-bash command-line"]
bin/gpm list
[/prism]

To receive help for a specific command, you can add help to the line before the command:

[prism classes="language-bash command-line"]
bin/gpm help install
[/prism]

!! To be able to perform **install**, **upgrade**, and **selfupgrade**, PHP must have the `php_openssl` extension enabled.  If you get a fatal error while downloading, this is probably the cause.

#### PHP CGI-FCGI Information

To determine if your server is running `cgi-fcgi` on the command line, type the following:

[prism classes="language-bash command-line" cl-output="2-5"]
php -v
PHP 5.5.17 (cgi-fcgi) (built: Sep 19 2014 09:49:55)
Copyright (c) 1997-2014 The PHP Group
Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies
    with the ionCube PHP Loader v4.6.1, Copyright (c) 2002-2014, by ionCube Ltd.
[/prism]

If you see a reference to `(cgi-fcgi)` you will need to prefix all `bin/gpm` commands with `php-cli`. Alternatively, you can set up an alias in your shell with something like: `alias php="php-cli"` which will ensure the **CLI** version of PHP runs from the command line.

## How Does it Work?

_GPM_ downloads the repository metadata from **GetGrav.org**. The repository contains all the details about the packages available and _GPM_ is also capable of determining whether any of these packages are already installed and if they need updating.

The repository itself gets cached locally, on the Grav instance machine running the command, for 24 hours. Any further request after the cache has been generated will not contact the **GetGrav.org** server, but rather serve from the locally-stored repository. This approach guarantees a much quicker response.

Most of the commands (listed below) come with the option `--force (-f)` which allows the forcing a re-fetch of the repository. This could be extremely useful in the event an update is known to be out there and the user doesn't want to wait a full 24-hour cycle before the cache gets cleared.

## Commands

Below, we have broken down all of the commands available for _GPM_. To run a command, launch your favorite terminal app and from within the root of your Grav instance, you can type `bin/gpm <command>`.

## Index

The `index` command shows a list of all the available resources in the Grav repository, organized by _themes_ and _plugins_.

![](index.jpg)

Each row displays the **name**, **slug**, **version** and whether it's installed already or not.

In this view, you can also quickly determine if there is a new version of any of the resources you have already installed.

For instance, if we had a very old version of Antimatter (v1.1.1), but the latest version was v1.1.3, it will appear in the index as seen below.

![](index-outdated.jpg)

!! You can use --installed-only` option to show the state of **only your installed** plugins and themes.

## Info

The `info` command displays the details of the desired package, such as description, author, homepage, etc.

![](info.jpg)

!! You will also be prompted to view the plugin/theme **Changelog** via this option.

## Install

The `install` command does exactly what it states. It installs a resource from the repository to your current Grav instance with a simple command.

The command will also detect if a resource is already installed, or if it is symbolically linked, and prompts you on what to do.

You can also install multiple resources at once by separating the slugs with a space.

[plugin:youtube](https://www.youtube.com/watch?v=SUUtcYl2xrE)

!! You can use the option `--all-yes (-y)` to skip any prompts. Existing resources will be overridden and if they are symbolic links will automatically be skipped.

## Update

The `update` command shows a list of updatable resources and works similarly to `install`.

![](update.jpg)

[plugin:youtube](https://www.youtube.com/watch?v=jkxk2xBr5TM)

Alternatively, you can limit the updates to specific resources only.

![](update-limit.jpg)

[plugin:youtube](https://www.youtube.com/watch?v=rSWdmdx9TDA)

## Uninstall

The `uninstall` command removes an installed theme or plugin and clears the cache. Because Grav is purely filesystem, uninstalling a theme or a plugin means deleting the folder physically.

The command will also detect if a resource is symbolically linked, and prompts you on what to do.

You can also uninstall multiple resources at once by separating the slugs with a space.

!! You can use the option `--all-yes (-y)` to skip any prompts. If a resource is detected as symbolic link, it will automatically be skipped.

## Self-upgrade

The `self-upgrade` (or selfupgrade) allows you to update Grav to the latest available version. If no upgrade is needed, a message will tell you so, noting also which version you are currently running and when the release was published.

It is strongly advised to always do a backup before performing a self-upgrade (see _Creating a Backup_ in the [CLI section](../grav-cli)).

!! The self-upgrade only upgrades portions of your Grav instance, like `system/` folder, `vendor/` folder, `index.php`, and others. Your **`user`** and **`images`** folders will never be touched.

![](upgrade.jpg)

[plugin:youtube](https://www.youtube.com/watch?v=15-E8l5aaUo)

## Important Developer Information

#### Blueprints

With the introduction of _GPM_, we now have strict rules about valid `blueprints`. Whether it's a _theme_ or a _plugin_ you are developing, you should always ensure `blueprints` are formatted properly.

A blueprint can serve several different purposes, including defining your resource identity. Please refer to the [Blueprints](../blueprints) for more detailed documentation about what blueprints are and how they should be compiled.

#### Releases

Grav repository refreshes every hour and automatically detects when there are new releases, this implies that as a developer you followed our [Contributing](https://github.com/getgrav/grav#contributing) requirements.

On your end all you have to do is ensure you have updated the blueprints with the new version, and that you tagged and released the new version. The Grav repository will do the rest for you and as soon as your release is picked up, it will be available to everyone via Grav website or through _GPM_.

#### Add your resource to the repository

advanced/grav-development#themeplugin-release-process
Follow the instructions in the [Theme/Plugin Release Process](../../advanced/grav-development#themeplugin-release-process) section.

To add your new plugin/theme to the Grav repository, please open a Grav Issue on GitHub. You can also [use this precompiled link](https://github.com/getgrav/grav/issues/new?title=[add-resource]%20New%20Plugin/Theme&body=I%20would%20like%20to%20add%20my%20new%20plugin/theme%20to%20the%20Grav%20Repository.%0AHere%20are%20the%20project%20details:%20**user/repository**). Make sure you update the body to the proper `user/repository`.

More details about what the plugin/theme does are welcome and can be placed in the Issue.

Also please be aware that before adding a repository, the Grav team will inspect your plugin/theme ensuring that it fits the Grav standards. The team may also respond with requests for additional information, suggest minor improvements, etc. prior to closing the issue and adding the plugin/theme.

---

## Prerequisites

> Path: grav-learn/pages/07.cli-console/05.scripted-upgrades/docs.md


Or: Upgrading multiple Grav-installations at once.

This is a guide to make upgrading multiple Grav-installations easier, using [Deployer](https://deployer.org/). By multiple I mean separate installations, not a [multisite-installation](/advanced/multisite-setup). We'll use the path to each installation to run [Grav's CLI](/cli-console/grav-cli) commands, but without having to type each of them manually.

A benefit of a task-runner like Deployer is that as it runs through its tasks, it will let you know exactly what it is doing along the way. It will also show you any output from the server from the commands being run. For example, this is an output from Deployer:

[prism classes="language-text"]
Executing task packages

GPM Releases Configuration: Stable

Found 8 packages installed of which 1 need updating

1. Email           [v2.5.2 -> v2.5.3]

GPM Releases Configuration: Stable

Preparing to install Email [v2.5.3]
  |- Downloading package...   100%
  |- Checking destination...  ok
  |- Installing package...    ok
  '- Success!

Clearing cache

Cleared:  /home/username/public_html/deployer/grav/cache/twig/*
Cleared:  /home/username/public_html/deployer/grav/cache/doctrine/*
Cleared:  /home/username/public_html/deployer/grav/cache/compiled/*

Touched: /home/username/public_html/deployer/grav/user/config/system.yaml
[/prism]

And as simple as that, Deployer told Grav to upgrade all packages, which upgraded the Email-plugin to its newest version.

## Prerequisites

[version=15]
Like with Grav, you need PHP **v5.6.4** or above. This also applies for the command line (CLI), so if you have multiple versions installed use the one which refers to the right version. Use the command `php -v` to check your default version, mine is **PHP 5.4.45**.

On shared environments, check with your host which command to use for CLI. In my case, this is `php56` which with `-v` returns **PHP 5.6.28**. This also means prepending every path like this: `php56 vendor/bin/dep list`.
[/version]
[version=16]
Like with Grav, you need PHP **v7.1.3** or above. This also applies for the command line (CLI), so if you have multiple versions installed use the one which refers to the right version. Use the command `php -v` to check your default version, mine is **PHP 5.6.28**.

On shared environments, check with your host which command to use for CLI. In my case, this is `php73` which with `-v` returns **PHP 7.3.24**. This also means prepending every path like this: `php73 vendor/bin/dep list`.
[/version]
[version=17]
Like with Grav, you need PHP **v7.3.6** or above. This also applies for the command line (CLI), so if you have multiple versions installed use the one which refers to the right version. Use the command `php -v` to check your default version, mine is **PHP 7.2.34**.

On shared environments, check with your host which command to use for CLI. In my case, this is `php74` which with `-v` returns **PHP 7.4.12**. This also means prepending every path like this: `php74 vendor/bin/dep list`.
[/version]

Some hosts also allow you to select your default PHP version to use for CLI, check with your host how to do this.

## Setup

In your servers public root (like **public_html** or **www**), create a folder named `deployer` and enter it. We'll use this as a basis for the project. You'll want to password-protect this directory (see [DigitalOcean Guide](https://www.digitalocean.com/community/tutorials/how-to-set-up-password-authentication-with-apache-on-ubuntu-14-04) for a manual approach, or use [CPanel](https://www.siteground.com/tutorials/cpanel/pass_protected_directories.htm) if available).

You need to have a working installation of Grav, as well as [Composer](https://getcomposer.org/). Some hosts have Composer installed already, which you can check by running `composer -v`. If it is not installed you can install it through SSH -- from the root directory -- with the following:

[prism classes="language-bash command-line"]
export COMPOSERDIR=~/bin;mkdir bin
curl -sS https://getcomposer.org/installer | php -- --install-dir=$COMPOSERDIR --filename=composer
[/prism]

Or, if you prefer a [local installation](https://getcomposer.org/download/), run the following in the `public_html/deployer/`-folder:

[prism classes="language-bash command-line"]
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php composer-setup.php
php -r "unlink('composer-setup.php');"
[/prism]

With a local installation, composer is ran through `composer.phar` rather than just `composer`. Now, while still in the `public_html/deployer/`-folder, run the following to install [Deployer](https://deployer.org/docs/installation):

[prism classes="language-bash command-line"]
composer require deployer/deployer
[/prism]

Now, still in the same folder, create a file named `deploy.php`. We'll use this to run each task with Deployer. Copy and paste the following into the file:

[prism classes="language-php line-numbers"]
<?php
namespace Deployer;
require 'vendor/autoload.php';

// Configuration
set('default_stage', 'production');
set(php, 'php56');

// Servers
localServer('site1')
	->stage('production')
	->set('deploy_path', '/home/username/public_html/deployer/grav');

desc('Backup Grav installations');
task('backup', function () {
	$backup = run('{{php}} bin/grav backup');
	writeln($backup);
});
desc('Upgrade Grav Core');
task('core', function () {
	$self_upgrade = run('{{php}} bin/gpm self-upgrade -y');
	writeln($self_upgrade);
});
desc('Upgrade Grav Packages');
task('packages', function () {
	$upgrade = run('{{php}} bin/gpm update -y');
	writeln($upgrade);
});
?>
[/prism]

## Configuration

Because Deployer needs an explicit staging-environment, we set it to `production`. Further, to allow for specific php version we set a default executable to be used. This can be a named executable or the path to a specific version of PHP. Our configuration now looks like this:

[prism classes="language-php line-numbers"]
// Configuration
set('default_stage', 'production');
set(php, 'php56');
[/prism]

If your default PHP CLI version is **5.6\*** or higher, you change this to `set(php, 'php');`.

### Servers

We can set up as many servers/sites as needed, the script will be ran for each of them in order. They can be local installations or on external servers, but since this is a local setup we use `localServer` (see [Deployer/servers](https://deployer.org/docs/servers) for more configurations). Here's an example with multiple sites:

[prism classes="language-php line-numbers"]
// Servers
localServer('site1')
	->stage('production')
	->set('deploy_path', '/home/username/public_html/deployer/grav1');
localServer('site2')
	->stage('production')
	->set('deploy_path', '/home/username/public_html/deployer/grav2');
localServer('site3')
	->stage('production')
	->set('deploy_path', 'C:\caddy\grav1');
localServer('site4')
	->stage('production')
	->set('deploy_path', 'C:\caddy\grav2');
[/prism]

Note that we use absolute paths to the installations, but they are relative to how the path is interpreted by SSH. This means that on the server, we want the full path because Deployer interprets this correctly, but we could also use the tilde-key if a HOMEDIR is set, like this: `~/public_html/deployer/grav1`.

### Tasks

Three tasks are currently set up: `backup`, `core`, and `packages`. Running `php vendor/bin/dep backup` creates a backup of each installation, available in **deploy_path/backup/BACKUP.zip**, where `deploy_path` is the paths you configured for the servers.

Running `php vendor/bin/dep core` upgrades Grav itself, and does this with the `--all-yes` option to skip all Yes/No questions asked. The same applies when running `php vendor/bin/dep packages`, which upgrades all plugins and themes.

## Conclusion

We can now upgrade all your defined sites easily by running the tasks in order. First we enter the `public_html/deployer/`-folder, and then we run each command as needed:

[prism classes="language-bash command-line"]
php vendor/bin/dep backup
php vendor/bin/dep core
php vendor/bin/dep packages
[/prism]

We will now have made a backup of each site, upgraded Grav itself, as well as upgraded all plugins and themes.

---

## Chapter 7

> Path: grav-learn/pages/07.cli-console/chapter.md


### Chapter 7

# CLI Console

**Grav** is developer friendly and provides many useful **command line tools and features** to make things as simple and as scriptable as possible.

---

## Enabling a Directory

> Path: grav-learn/pages/08.advanced/01.flex/01.administration/01.introduction/docs.17.md



This section contains a walk-through on how to quickly enable an existing **Flex Directory** and how to display it within the Grav admin. In our examples we are using the **Contacts** Flex Directory which comes included with the **Flex Objects Plugin** for demonstration purposes.

## Enabling a Directory

To enable a custom **Flex Directory**, navigate to **Plugins** > **Flex Objects** in the Grav Admin.

Towards the bottom of the page you will see the **Directories** configuration setting. This setting lists all detected **Flex Directories** in your project.

![Plugin Configuration](flex-objects-options.png?width=2030&classes=shadow)

Locate any directories you would like to enable and ensure the **Enabled** option is checked.

For this demonstration, let's enable the **Contacts** directory and click **Save** at the top of the page.

After the page reloads, you should see a new item in the Grav Admin menu titled **Contacts**.

## Install Sample Data (Optional)

For our example, we assume that you have copied the sample data set for **Contacts** Directory:

```shell
$ cp user/plugins/flex-objects/data/flex-objects/contacts.json user/data/flex-objects/contacts.json
```

## Create a Page

Go to **[Pages](/admin-panel/page)** and [add a new page](/admin-panel/page#adding-new-pages). Enter following values:

- **Page Title**: `Directory`
- **Page Template**: `Flex-objects`

After this you can click on **Continue** button.

In the **[Advanced Content Editor](/advanced/flex/administration/views-edit)** ensure your frontmatter contains the `flex.directory` of  `contacts` as follows:

```twig

# Directory Example
```

When you are happy with the page, hit **Save**.

! **TIP:** If you do not specify `Flex Directory`, the page will list all directories instead of displaying entries from a single directory.

## Display the Page

Navigate to the page you created. You should see the following page which contains **Contacts**:

![](flex-objects-site.png?width=2030&classes=shadow)

In case if you did not select any directory, this is what you would see instead:

![](flex-objects-directory.png?width=2030&classes=shadow)

---

## Controls

> Path: grav-learn/pages/08.advanced/01.flex/01.administration/01.views-list/docs.17.md


![List View](flex-objects-list.png?width=2030&classes=shadow)

The **Content Listing** usually contains a paginated list of your content, but some directories, like **[Pages](/admin-panel/page)**, may have a highly customized look.

This is where you can create, edit, and delete your content. The page also has powerful tools to **Search** and **Order** the items.

## Controls

Along the top of the page, you will find the administrative controls. The controls may differ per **Flex Type**, but here is a list of some of the most common ones:

- **Back**: Return one level up, usually to [**Dashboard**](/admin-panel/dashboard) or **[Directory Listing](/advanced/flex/administration#directory-listing)**
- **Export**: Export content to a file, usually CSV
- **Add**: Add a new content item
- [**Configuration**](/advanced/flex/administration/configuration): Modify directory settings

## Navigation

- **Filter**: Text input for searching
- **Display Number**: Number of objects to display
- **Ordering**: Click on the column titles to change ordering
- **Pagination**: Quickly navigate through objects

## Single Row

- **Columns**: Type specific columns for quick overview on objects
- **Actions**: Actions for the single object, usually: **Preview**, **Edit**, **Delete**...


---

## Controls

> Path: grav-learn/pages/08.advanced/01.flex/01.administration/02.views-edit/docs.17.md


![Edit View](flex-objects-edit.png?width=2030&classes=shadow)

The **Content Editor** is a powerful view in **Flex Objects** that enables you to create and update your content type.

Editor may look very different with different **Controls**, **Tabs** and **Form Fields** as they are all specific for the directory type you're editing.

### Controls

Along the top of the page, you will find the administrative controls.

By default, there are three buttons **Back**, **Save** and **Delete**. Controls may also include other actions, such as **Preview**, **Export** etc...

- **Back**: Go back to **[Content Listing](/advanced/flex/administration/views-list)**
- **Save**: Save Object and return back to **[Content Listing](/advanced/flex/administration/views-list)**
- **Delete**: Delete Object and return back to **[Content Listing](/advanced/flex/administration/views-list)**

### Edit Form

Form is usually organized by **Tabs** and **Sections** to make the content easier to edit.

- [Form fields](/forms/blueprints/fields-available)
- Media (images and other files)



---

## Controls

> Path: grav-learn/pages/08.advanced/01.flex/01.administration/03.configuration/docs.17.md


**Configuration** has common settings for the **Flex Directory**.

These settings are typically used for changing the behaviour of the directory, setting defaults for the objects or alter rendering of the layouts.

!! The settings are different in every Directory, this document contains only the common settings found in every directory.

#### Controls

Along the top of the page, you will find the administrative controls.

- **Back**: Go back to **[Content Listing](/advanced/flex/administration/views-list)**
- **Save**: Save configuration and return back to **[Content Listing](/advanced/flex/administration/views-list)**

### Caching Tab

[div class="table table-striped table-keycol"]
| Option                        | Description |
| :-----                        | :----- |
| **Enable Index Caching** | Index caching speeds up searches by creating temporary lookup indexes for the queries. |
| **Index Cache Lifetime (seconds)** | Lifetime for index caching in seconds. |
| **Enable Object Caching** | Object caching speeds up loading the object data and images. |
| **Object Cache Lifetime (seconds)** | Lifetime for object caching in seconds. |
| **Enable Render Caching** | Render caching speeds up rendering the content by caching the resulting HTML. |
| **Render Cache Lifetime (seconds)** | Lifetime for render caching in seconds. |
[/div]

If the rendered HTML has dynamic content, render cache can be disabled from the Twig template by {% verbatim %}```{% do block.disableCache() %}```{% endverbatim %}.

---

## Enabling a Directory

> Path: grav-learn/pages/08.advanced/01.flex/01.administration/docs.17.md


If you have been using **Admin Panel** in Grav 1.7, you have already used **Flex Objects**. The best examples are **Accounts** and **Pages**, which are great examples what can be done with **Flex**.

By default, **Flex Administration** is invisible to the user. In order to see a **Directory**, it has to be enabled. Enabled directories can show up either on **Navigation Menu**, inside a **Flex Objects** menu item, or even inside other plugins.

!! **Flex Objects** Plugin has to be enabled in order to use any custom directories.

## Enabling a Directory

To enable a custom **Flex Directory**, you need to go to **Plugins** > **Flex Objects**.

We are interested in the **Directories** option inside the plugin, which lists all the detected **Flex Directories**. Just select the directories you're interested in and make sure the toggle is set to `Enabled`.

Hit **Save** and the directory should show up after a page load.

! **TIP:** Check **[Introduction](/advanced/flex/administration/introduction)** for full walkthrough on how to create a page for your directory.

## Directory Listing

![Directories View](./01.views-list/flex-objects-list.png?width=2030&classes=shadow)

By default, the **Flex Objects** navigation menu item contains all the **Flex Directories** that have been enabled in your site.

!! Some Flex Directories choose to hide from this list and show up elsewhere. **Accounts** and **Pages** are good examples of this.

#### Controls

Along the top of the page, you will find the administrative controls.

- **Back**: Go back to **[Dashboard](/admin-panel/dashboard)**
- **Configure**: Redirects to **Plugins** > **Flex Objects**, see [Enabling a Directory](#enabling-a-directory)

#### Directories

When you select a Directory, you will end up at the **Content Listing** view.

In **[Content Listing](/advanced/flex/administration/views-list)** you can browse through the objects, use **Search**, and change **Ordering**. Additionally each object has **Actions**, notably **Edit** and **Delete**. You can also add new objects by using the **Add** button at top of any page. Next to it is also the **Configuration** button to change directory-wide settings.

In **[Content Editor](/advanced/flex/administration/views-edit)** you can edit the object and **Save** it.

In **[Configuration](/advanced/flex/administration/configuration)** you can change configuration, which changes the behavior of the whole directory. Usually caching is among these options.

---

## count()

> Path: grav-learn/pages/08.advanced/01.flex/02.using/01.flex/docs.17.md


! **TIP:** Complete list of methods can be found from **Customizing Flex Objects** section.

## count()

`count(): int` Count the number of directories registered to Flex.

Returns:
- `int` Number of **[Directories](/advanced/flex/using/directory)**

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

Flex has {{ flex.count() }} enabled directories.
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var int $count */
$count = $flex->count();
```
[/ui-tab]
[/ui-tabs]

## getDirectories()

`getDirectories( [names] ): array` Get list of directories.

Parameters:
- **names** Optional: List of directory names (`array`)

Returns:
- `array` list of **[Directories](/advanced/flex/using/directory)**

! **TIP:** If no list of names was provided, method returns all directories registered to Flex.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

{# Get all directories #}
{% set directories = flex.directories() %}

{# Get listed directories #}
{% set listed_directories = flex.directories(['contacts', 'phonebook']) %}

{# Do something with the directories #}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexInterface;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var FlexDirectoryInterface[] $directories */
$directories = $flex->getDirectories();
// = ['contacts' => FlexDirectory, ...]

/** @var FlexDirectoryInterface[] $directories */
$listedDirectories = $flex->getDirectories(['contacts', 'phonebook']);
// = ['contacts' => FlexDirectory]

/** @var array<FlexDirectoryInterface|null> $directories */
$listedDirectoriesWithMissing = $flex->getDirectories(['contacts', 'phonebook'], true);
// = ['contacts' => FlexDirectory, 'phonebook' => null]
```
[/ui-tab]
[/ui-tabs]

! **TIP:** You may want to make sure you return only the directories you want to.

## hasDirectory()

`hasDirectory( name ): bool`: Check if directory exists.

Parameters:
- **name** Name of the directory (`string`)

Returns:
- `bool` True if found, false otherwise

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

Flex has {{ not flex.hasDirectory('contacts') ? 'not' }} contacts directory.
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var bool $exists */
$exists = $flex->hasDirectory('contacts');
```
[/ui-tab]
[/ui-tabs]

## getDirectory()

`getDirectory( name ): Directory | null` Get a directory, returns null if it was not found.

Parameters:
- **name** Name of the directory (`string`)

Returns:
- **[Directory](/advanced/flex/using/directory)** (`object`)
- `null` Directory not found

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

{# Get contacts directory (null if not found) #}
{% set directory = flex.directory('contacts') %}

{# Do something with the contacts directory #}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexInterface;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var FlexDirectoryInterface|null $directory */
$directory = $flex->getDirectory('contacts');
if ($directory) {
    // Directory exists, do something with it...
}
```
[/ui-tab]
[/ui-tabs]

!!! Check what you can do with **[Flex Directory](/advanced/flex/using/directory)**

## getObject()

`getObject( id, directory ): Object | null` Get an object, returns null if it was not found.

Parameters:
- **id** ID of the object (`string`)
- **directory** Name of the directory (`string`)

Returns:
- **[Object](/advanced/flex/using/object)** (`object`)
- `null` Object not found

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

{% set contact = flex.object('ki2ts4cbivggmtlj', 'contacts') %}

{# Do something #}
{% if contact %}
  {# Got Bruce Day #}
  {{ contact.first_name|e }} {{ contact.last_name|e }} has a website: {{ contact.website|e }}
{% else %}
  Oops, contact has been removed!
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var FlexObjectInterface|null $object */
$object = $flex->getObject('ki2ts4cbivggmtlj', 'contacts');
if ($object) {
    // Object exists, do something with it...
}
```
[/ui-tab]
[/ui-tabs]

!!! Check what you can do with **[Flex Object](/advanced/flex/using/object)**

## getCollection()

`getCollection( directory ): Collection | null` Get collection, returns null if it was not found.

Parameters:
- `directory` Name of the directory (`string`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`)
- `null` Directory not found

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set flex = grav.get('flex') %}

{% set contacts = flex.collection('contacts') %}

{# Do something #}
<h2>Ten random contacts:</h2>
<ul>
  {% for contact in contacts.filterBy({published: true}).shuffle().limit(0, 10) %}
    <li>{{ contact.first_name|e }} {{ contact.last_name|e }}</li>
  {% endfor %}
</ul>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexInterface;

/** @var FlexInterface $flex */
$flex = Grav::instance()->get('flex');

/** @var FlexCollectionInterface|null $collection */
$collection = $flex->getCollection('contacts');
if ($collection) {
    // Collection exists, do something with it...
}
```
[/ui-tab]
[/ui-tabs]

!!! Check what you can do with **[Flex Collection](/advanced/flex/using/collection)**

---

## getTitle()

> Path: grav-learn/pages/08.advanced/01.flex/02.using/02.directory/docs.17.md


## getTitle()

`getTitle(): string` Get title of the directory

Returns:
- `string` Title

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set directory = grav.get('flex').directory('contacts') %}

<h2>{{ directory.title|e }}</h2>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;

/** @var FlexDirectoryInterface|null $directory */
$directory = Grav::instance()->get('flex')->getDirectory('contacts');
if ($directory) {

    /** @var string $title */
    $title = $directory->getTitle();

}
```
[/ui-tab]
[/ui-tabs]

## getDescription()

`getDescription(): string` Get description of directory

Returns:
- `string` Description

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set directory = grav.get('flex').directory('contacts') %}

<p>{{ directory.description|e }}</p>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;

/** @var FlexDirectoryInterface|null $directory */
$directory = Grav::instance()->get('flex')->getDirectory('contacts');
if ($directory) {

    /** @var string $title */
    $description = $directory->getDescription();

}
```
[/ui-tab]
[/ui-tabs]

## getObject()

`getObject( id ): Object | null` Get an object, returns null if it was not found.

Parameters:
- **id** ID of the object (`string`)

Returns:
- **[Object](/advanced/flex/using/object)** (`object`)
- `null` Object not found

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set directory = grav.get('flex').directory('contacts') %}

{% set contact = directory.object('ki2ts4cbivggmtlj') %}

{# Do something #}
{% if contact %}
  {# Got Bruce Day #}
  Email for {{ contact.first_name|e }} {{ contact.last_name|e }} is {{ contact.email|e }}
{% else %}
  Oops, contact has been removed!
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexDirectoryInterface|null $directory */
$directory = Grav::instance()->get('flex')->getDirectory('contacts');
if ($directory) {

    /** @var FlexObjectInterface|null $object */
    $object = $directory->getObject('ki2ts4cbivggmtlj');
    if ($object) {
        // Object exists, do something with it...
    }

}
```
[/ui-tab]
[/ui-tabs]

!!! Check what you can do with **[Flex Object](/advanced/flex/using/object)**

## getCollection()

`getCollection(): Collection` Get collection, returns null if it was not found.

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`)

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set directory = grav.get('flex').directory('contacts') %}

{% set contacts = directory.collection() %}

{# Do something #}
<h2>Ten first contacts:</h2>
<ul>
  {% for contact in contacts.filterBy({published: true}).limit(0, 10) %}
    <li>{{ contact.first_name|e }} {{ contact.last_name|e }}</li>
  {% endfor %}
</ul>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexDirectoryInterface;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexDirectoryInterface|null $directory */
$directory = Grav::instance()->get('flex')->getDirectory('contacts');
if ($directory) {

    /** @var FlexCollectionInterface $collection */
    $collection = $directory->getCollection();

    // Do something with the collection...

}
```
[/ui-tab]
[/ui-tabs]

!!! Check what you can do with **[Flex Collection](/advanced/flex/using/collection)**

---

## Render Collection

> Path: grav-learn/pages/08.advanced/01.flex/02.using/03.collection/docs.17.md


**Flex Collection** is an **ordered map of objects** that can also be used like a list.

Collection provides a few useful methods, which can be used to render the output, fetch objects, filter and sort and so on.

! **TIP:** Flex Collection extends **[Doctrine Collections](https://www.doctrine-project.org/projects/doctrine-collections/en/1.6/index.html)**.

# Render Collection

## render()

`render( [layout], [context] ): Block` Renders the collection.

Parameters:
- **layout** Layout name (`string`)
- **context** Extra variables that can be used inside the Twig template file (`array`)

Returns:
- **Block** (`object`) HtmlBlock class containing the output

!!! **NOTE:** In twig there is a `{% render %}` tag, which should be used instead of calling the method directly. This will allow JS/CSS assets from the collection to work properly.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% set page = 2 %}
{% set limit = 10 %}
{% set start = (page - 1) * limit %}

<h2>Contacts:</h2>

{% render contacts.limit(start, limit) layout: 'cards' with { background: 'gray', color: 'white' } %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\ContentBlock\HtmlBlock;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$page = 2;
$limit = 10;
$start = ($page-1)*$limit;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->limit($start, $limit);

    /** @var HtmlBlock $block */
    $block = $collection->render('cards', ['background' =>'gray', 'color' => 'white']);

}
```
[/ui-tab]
[/ui-tabs]

# Collection Manipulation

All of these methods return **a modified copy** of the collection. The original collection remains unchanged.

## sort()

`sort( orderings ): Collection` Sort the collection by list of `property: direction` pairs.

Parameters:
- **orderings** Pairs of `property: direction` where direction is either 'ASC' or 'DESC' (`array`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New sorted instance of the collection

! **TIP:** Default sort order can be set for the frontend in the **Flex Type** blueprints.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.sort({last_name: 'ASC', first_name: 'ASC'}) %}

<div>Displaying all contacts in alphabetical order:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->sort(['last_name' => 'ASC', 'first_name' => 'ASC']);
    // Collection has now be sorted by last name, first name...

}
```
[/ui-tab]
[/ui-tabs]

## limit()

`limit( start, limit ): Collection` Return subset of collection starting from `start` and including only `limit` number of objects.

Parameters:
- **start** Start index starting from 0 (`int`)
- **limit** Maximum number of objects (`int`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New filtered instance of the collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% set page = 3 %}
{% set limit = 6 %}
{% set start = (page - 1) * limit %}

{% set contacts = contacts.limit(start, limit) %}

<div>Displaying page {{ page|e }}:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$start = 0;
$limit = 6;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->limit($start, $limit);
    // Collection contains only the objects in the current page...

}
```
[/ui-tab]
[/ui-tabs]

## filterBy()

`filterBy( filters ): Collection` Filter collection by list of `property: value` pairs.

Parameters:
- **filters** Pairs of `property: value` which are used to filter he collection (`array`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New filtered instance of the collection

! **TIP:** Default filtering can be set for the frontend in the **Flex Type** blueprints.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.filterBy({'published': true}) %}

<div>Displaying only published contacts:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$start = 0;
$limit = 6;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->filterBy(['published' => true]);
    // Collection contains only published objects...

}
```
[/ui-tab]
[/ui-tabs]

## reverse()

`reverse(): Collection`  Reverse the order of the objects in the Collection.

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New reversed instance of the collection

! **TIP:** If you're using `sort()`, it is recommended to reverse the ordering in there as it saves an extra step.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.reverse() %}

<div>Displaying contacts in reverse ordering:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$start = 0;
$limit = 6;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->reverse();
    // Collection is now in reverse ordering...

}
```
[/ui-tab]
[/ui-tabs]

## shuffle()

`shuffle(): Collection`  Shuffle objects to a random order.

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New randomly ordered instance of the collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.shuffle().limit(0, 6) %}

<div>Displaying 6 random contacts:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->shuffle()->limit(0,6);
    // Collection contains 6 random contacts...

}
```
[/ui-tab]
[/ui-tabs]

## select()

`select( keys ): Collection` Select objects (by their keys) from the collection.

Parameters:
- **keys** List of object keys used to select the objects (`array`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New instance of the collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% set selected = ['gizwsvkyo5xtms2s', 'gjmva53uoncdo4sb', 'mfzwwtcugv5hkocd', 'k5nfctkeoftwi4zu'] %}

{% set contacts = contacts.select(selected) %}

<div>Displaying 4 selected contacts:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$selected = ['gizwsvkyo5xtms2s', 'gjmva53uoncdo4sb', 'mfzwwtcugv5hkocd', 'k5nfctkeoftwi4zu'];

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->select($selected);
    // Collection now contains the 4 selected contacts...

}
```
[/ui-tab]
[/ui-tabs]

## unselect()

`unselect( keys ): Collection` Remove objects (by their keys) from the collection.

Parameters:
- **keys** List of object keys used to remove the objects (`array`)

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New instance of the collection


[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% set ignore = ['gizwsvkyo5xtms2s', 'gjmva53uoncdo4sb', 'mfzwwtcugv5hkocd', 'k5nfctkeoftwi4zu'] %}

{% set contacts = contacts.unselect(ignore) %}

<div>Displaying all but 4 ignored contacts:</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

$ignore = ['gizwsvkyo5xtms2s', 'gjmva53uoncdo4sb', 'mfzwwtcugv5hkocd', 'k5nfctkeoftwi4zu'];

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->unselect($ignore);
    // Collection now contains all but 4 ignored contacts...

}
```
[/ui-tab]
[/ui-tabs]

## search()

`search( string, [properties], [options] ): Collection` Search a string from the collection.

Parameters:
- **string** Search string (`string`)
- **properties** Properties to search, if null (or not provided), use defaults (`array` or `null`)
- **options** Extra options used while searching (`array`)
  - starts_with: `bool`
  - ends_with: `bool`
  - contains: `bool`
  - case_sensitive: `bool`

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New filtered instance of the collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.search('Jack', ['first_name', 'last_name', 'email'], {'contains': true}) %}

<div>Displaying all search results for 'Jack':</div>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->search('Jack', ['first_name', 'last_name', 'email'], ['contains' => true]);
    // Collection now contains all search results...

}
```
[/ui-tab]
[/ui-tabs]

## copy()

`copy(): Collection` Create a copy from the collection by cloning all the objects in the collection.

Returns:
- **[Collection](/advanced/flex/using/collection)** (`object`) New instance of the collection, now with cloned objects

!! **WARNING:** If you modify objects in your collection, you should always use copies!

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contacts = contacts.shuffle().limit(0, 10) %}
{% set fakes = contacts.copy() %}

{% do fakes.setProperty('first_name', 'JACK') %}

<h2>Fake cards</h2>
{% render fakes layout: 'cards' %}

<h2>Original cards</h2>
{% render contacts layout: 'cards' %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    $collection = $collection->search('Jack', ['first_name', 'last_name', 'email'], ['contains' => true]);
    // Collection now contains all search results...

}
```
[/ui-tab]
[/ui-tabs]

# Iterate Through Collection

**Collections** can be iterated over.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

<h2>All contacts:</h2>
<ul>
  {% for contact in contacts %}
    <li>{{ contact.first_name|e }} {{ contact.last_name|e }}</li>
  {% endfor %}
</ul>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface $object */
    foreach ($collection as $object) {
        // Do something with the object...
    }

}
```
[/ui-tab]
[/ui-tabs]

## first()

`first(): Object | false` Sets the iterator to the first object in the collection and returns this object.

Returns:
- **[Object](/advanced/flex/using/object)** (`object`) First object
- `false` No objects in the Collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contact = contacts.first() %}

{% if contact %}
    <h2>First contact:</h2>
    <div>{{ contact.first_name|e }} {{ contact.last_name|e }}</div>
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface|false $object */
    $object = $collection->first();
    if ($object) {
        // Do something with the object...
    }

}
```
[/ui-tab]
[/ui-tabs]

## last()

`last(): Object | false` Sets the iterator to the last object in the collection and returns this object.

Returns:
- **[Object](/advanced/flex/using/object)** (`object`) Last object
- `false` No objects in the Collection


[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contact = contacts.last() %}

{% if contact %}
    <h2>Last contact:</h2>
    <div>{{ contact.first_name|e }} {{ contact.last_name|e }}</div>
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface|false $object */
    $object = $collection->last();
    if ($object) {
        // Do something with the object...
    }

}
```
[/ui-tab]
[/ui-tabs]

## next()

`next(): object | false` Moves the iterator position to the next object and returns this element.

Returns:
- **[Object](/advanced/flex/using/object)** (`object`) Next object
- `false` No more objects in the Collection


[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% set first = contacts.first() %}
...

{% set contact = contacts.next() %}

{% if contact %}
    <h2>Next contact is:</h2>
    <div>{{ contact.first_name|e }} {{ contact.last_name|e }}</div>
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface|false $object */
    while ($object = $collection->next()) {
        // Do something with the object...
    }

}
```
[/ui-tab]
[/ui-tabs]

## current()

`current(): object | false` Gets the object of the collection at the current iterator position.

Returns:
- **[Object](/advanced/flex/using/object)** (`object`) Current object
- `false` No more objects in the Collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% do contacts.next() %}
{% do contacts.next() %}
...

{% set contact = contacts.current() %}

{% if contact %}
    <h2>Current contact is:</h2>
    <div>{{ contact.first_name|e }} {{ contact.last_name|e }}</div>
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {
    while ($collection->next()) {

        /** @var FlexObjectInterface|false $object */
        $object = $collection->current();
        // Do something with the object...

    }
}
```
[/ui-tab]
[/ui-tabs]

## key()

`key(): key | null` Gets the key of the object at the current iterator position.

Returns:
- **key** (`string`) Object key
- `null` No more objects in the Collection

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}
{% do contacts.next() %}
{% do contacts.next() %}
...

{% set key = contacts.key() %}

{% if key %}
    Current contact key is: <strong>{{ key|e }}</strong>
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {
    while ($collection->next()) {

        $key = $collection->key();
        // Do something with the key...

    }
}
```
[/ui-tab]
[/ui-tabs]

# Get Object / Key

## Array Access

**Collections** can be accessed just like associative arrays or maps.

!!! **NOTE:** `null` is being returned if object with given key is not in the collection.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contact = contacts['ki2ts4cbivggmtlj']

{# Do something #}
{% if contact %}
  {# Got Bruce Day #}
  Email for {{ contact.first_name|e }} {{ contact.last_name|e }} is {{ contact.email|e }}
{% else %}
  Oops, contact has been removed!
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface|null $object */
    $object = $collection['ki2ts4cbivggmtlj'];
    if ($object) {
        // Object exists, do something with it...
    }

}
```
[/ui-tab]
[/ui-tabs]

## get()

`get( key ): Object | null` Gets the object with the specified key.

Parameters:
- **key**  Object key (`string`)

Returns:
- **Object** (`object`)
- `null` Object with given key is not in the collection

Alternative to [Array Access](#array-access)

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set contact = contacts.get('ki2ts4cbivggmtlj')

{# Do something #}
{% if contact %}
  {# Got Bruce Day #}
  Email for {{ contact.first_name|e }} {{ contact.last_name|e }} is {{ contact.email|e }}
{% else %}
  Oops, contact has been removed!
{% endif %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface|null $object */
    $object = $collection->get('ki2ts4cbivggmtlj');
    if ($object) {
        // Object exists, do something with it...
    }

}
```
[/ui-tab]
[/ui-tabs]

# Collection as Array

## getKeys()

`getKeys(): array` Gets all keys of the collection.

Returns:
- `array` List of keys

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set keys = contacts.keys() %}

Keys are: {{ keys|join(', ')|e }}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var string[] $keys */
    $keys = $collection->getKeys();
    $keysList = implode(', ', $keys);

}
```
[/ui-tab]
[/ui-tabs]

## GetObjectKeys()

`GetObjectKeys(): array` Alias to the `getKeys()` method.

Returns:
- `array` List of keys

## getValues()

`getValues(): array` Gets all objects of the collection.

Converts collection into an array. Keys are not preserved.

Returns:
- List of **Objects** (`array`)

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set list = contacts.values() %}
<ol>
{% for i,object in list %}
    <li>#{{ (i+1)|e }}: {{ object.email|e }}</li>
{% endfor %}
</ol>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var FlexObjectInterface[] $objects */
    $objects = $collection->getValues();
    foreach ($objects as $pos => $object) {
        // Do something with the object and its position...
    }

}
```
[/ui-tab]
[/ui-tabs]

## toArray()

`toArray(): array` Gets a native PHP array representation of the collection.

Similar to `getValues()` but preserves the keys.

Returns:
- `array` List of `key: Object` pairs

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set list = contacts.toArray() %}
<ol>
{% for key,object in list %}
    <li>ID: {{ key|e }}: {{ object.email|e }}</li>
{% endfor %}
</ol>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var array<string, FlexObjectInterface> $objects */
    $objects = $collection->toArray();
    foreach ($objects as $key => $object) {
        // Do something with the object and its key...
    }

}
```
[/ui-tab]
[/ui-tabs]

## slice()

`slice( offset, length ): array` Extracts a slice of `length` elements starting at position `offset` from the Collection.

Parameters:
- **offset** Start offset starting from 0 (`int`)
- **length** Maximum number of objects (`int`)

Returns:
- `array` List of `key: Object` pairs

! **TIP:** This method can be used for pagination.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set list = contacts.slice(10, 5) %}

<div>Displaying 5 emails starting from offset 10:</div>
<ol>
{% for key,object in list %}
    <li>ID: {{ key|e }}: {{ object.email|e }}</li>
{% endfor %}
</ol>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var array<string, FlexObjectInterface> $objects */
    $objects = $collection->slice(10, 5);

    // Do something with the object and its key...

}
```
[/ui-tab]
[/ui-tabs]

## chunk()

`chunk( size ): array` Split collection into chunks of `size` objects.

Parameters:
- **size** Size of the chunks (`int`)

Returns:
- `array` Two dimensional list of `key: Object` pairs

! **TIP:** This method can be used to split content into rows and columns.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set columns = contacts.limit(0, 10).chunk(5) %}

<div>Displaying two columns of 5 emails each:</div>
<div class="columns">
{% for column,list in columns %}
    <div class="column">
    {% for object in list %}
        <div>{{ object.email|e }}</div>
    {% endfor %}
    </div>
{% endfor %}
</div>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var array $columns */
    $columns = $collection->limit(0, 10)->chunk(5);
    /** @var
        int $column
        array<string, FlexObjectInterface> $objects
    */
    foreach ($columns as $column => $objects) {
        // Do something with the objects...
    }
}

}
```
[/ui-tab]
[/ui-tabs]

## group()

`group( property ): array` Group objects in the collection by a property and return them as associated array.

Parameters:
- **property** Property name which is used to group the objects (`string`)

Returns:
- `array` Two dimensional list of `key: Object` pairs, where value of the property is the key of the first level

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contacts = grav.get('flex').collection('contacts') %}

{% set by_name = contacts.sort({last_name: 'ASC', first_name: 'ASC'}).group('last_name') %}

<div>Displaying contacts grouped by last name:</div>
<div>
{% for last_name,list in by_name %}
    {{ last_name|e }}:
    <ul>
    {% for object in list %}
        <li>{{ object.first_name|e }}</li>
    {% endfor %}
    </ul>
{% endfor %}
</div>
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\Flex\Interfaces\FlexCollectionInterface;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexCollectionInterface|null $collection */
$collection = Grav::instance()->get('flex')->getCollection('contacts');
if ($collection) {

    /** @var array $byName */
    $byName = $collection->group('last_name');
    /** @var
        string $lastName
        array<string, FlexObjectInterface> $objects
    */
    foreach ($byName as $lastName => $objects) {
        // Do something with the objects...
    }
}

}
```
[/ui-tab]
[/ui-tabs]

# Adding and Removing Objects

## add()

`add( Object )` Adds an Object at the end of the collection.

Parameters:
- **[Object](/advanced/flex/using/object)** Object to be added (`object`)

## remove()

`remove( key ): Object | null` Removes the element at the specified index from the collection.

Parameters:
- **key** Object key to be removed (`object`)

Returns:
- **[Object](/advanced/flex/using/object)** Removed object (`object`) or `null` if it was not found

## removeElement()

`removeElement( Object ): bool` Removes the specified object from the collection, if it is found.

Parameters:
- **[Object](/advanced/flex/using/object)** Object to be removed (`object`)

Returns:
- `true` if object was in the collection, `false` if not

## clear()

`clear()` Clears the collection, removing all elements.

# Tests

## containsKey()

`containsKey( key ): bool` Checks whether the collection contains an object with the specified key.

Parameters:
- **key** Key to be tested (`string`)

Returns:
- `true` if object is in the collection, `false` if not

## contains()

`contains( object ): bool` Checks whether an element is contained in the collection.

Parameters:
- **[Object](/advanced/flex/using/object)** Object to be tested (`object`)

Returns:
- `true` if object is in the collection, `false` if not

## indexOf()

`indexOf( object ): string | false` Gets the index/key of a given object.

Parameters:
- **[Object](/advanced/flex/using/object)** Object to be tested (`object`)

Returns:
- `string` index/key of the object, `false` if not object was not found

## isEmpty()

`isEmpty(): bool` Checks whether the collection is empty (contains no objects).

Returns:
- `true` if collection is empty, `false` otherwise

## count()

`count(): int`

Returns:
- `int` Number of objects in the collection

# Bulk Actions for Objects

## hasProperty()

`hasProperty( property ): array` Returns a list of `key: boolean` pairs whether object with key has property defined or not.

Parameters:
- **property** Property name (`string`)

Returns:
- `array` of `key: bool` pairs, where `key` is the object key and `bool` is either true or false.

## getProperty()

`getProperty( property, default ): array` Returns a list of `key: value` for each object.

Parameters:
- **property** Property name (`string`)

Returns:
- `array` of `key: value` pairs, where `key` is the object key and `value` is the value of the property.

## setProperty()

`setProperty( property, value ): Collection` Set new value to the property for every object in the collection.

Parameters:
- **property** Property name (`string`)
- **value** New value (`mixed`)

Returns:
- **Collection** (`object`) The collection for chaining the method calls.

!! **WARNING:** This method modifies the object instances shared between all the collections, if that is not intended, please  [copy()](#copy) collection before using this method.

## defProperty()

`defProperty( property, default ): Collection` Define default value to the property for every object in the collection.

Parameters:
- **property** Property name (`string`)
- **default** Default value (`mixed`)

Returns:
- **Collection** (`object`) The collection for chaining the method calls.

!! **WARNING:** This method modifies the object instances shared between all the collections, if that is not intended, please  [copy()](#copy) collection before using this method.

## unsetProperty()

`unsetProperty( property ): Collection` Remove value of the property for every object in the collection.

Parameters:
- **property** Property name (`string`)

Returns:
- **Collection** (`object`) The collection for chaining the method calls.

!! **WARNING:** This method modifies the object instances shared between all the collections, if that is not intended, please  [copy()](#copy) collection before using this method.

## call()

`call( method, arguments): array` Calls a method for every object in the collection. Return results of each call.

Parameters:
- **method** Method name (`string`)
- **arguments** List of arguments (`array`)

Returns:
- List of `key: result` pairs (`array`)

!! **WARNING:** If the method modifies the object, please  [copy()](#copy) collection before using this method.

## getTimestamps()

`getTimestamps(): array`  Returns a list of `key: timestamp` for each object.

Returns:
- List of `key: timestamp` pairs, where timestamp is integer (`array`)

## getStorageKeys()

`getStorageKeys(): array`  Returns a list of `key: storage_key` for each object.

Returns:
- List of `key: storage_key` pairs (`array`)

## getFlexKeys()

`getFlexKeys(): array`  Returns a list of `key: flex_key` for each object.

Returns:
- List of `key: flex_key` pairs (`array`)

## withKeyField()

`withKeyField( field ): Collection` Return new collection with a different key.

Parameters:
- **field** Key field (`string`)
  - 'key': Default key used by the directory
  - 'storage_key': Storage layer key
  - 'flex_key': Unique key which can be used without knowing the directory

Returns:
- **Collection** (`object`) The collection, but indexed with the new key.

# Closure Tests (PHP only)

## exists()

`exists( Closure ): bool` Tests for the existence of an object that satisfies the given predicate.

Parameters:
- **Closure** Method used to test each object.

Returns:
- `bool` True if your callback function returns true for any object.

## forAll()

`forAll( Closure ): bool` Tests whether the given predicate holds for all objects of this collection.

Parameters:
- **Closure** Method used to test each object.

Returns:
- `bool` True if your callback function returns true for all objects.

# Closure Filtering (PHP only)

## filter()

`filter( Closure ): Collection` Returns all the objects of this collection that satisfy the predicate.

The order of the elements is preserved.

Parameters:
- **Closure** Method used to test a single object.

Returns:
- **Collection** (`object`) New collection with all the objects for which your callback function returns `true`.

## map()

`map( Closure ): Collection` Applies the given function to each object in the collection and returns a new collection with the objects returned by the function.

Parameters:
- **Closure** Method used to test a single object.

Returns:
- **Collection** (`object`) New collection with objects returned by the callback function.


## collectionGroup()

`collectionGroup( property ): Collection[]` Group objects in the collection by a field and return them as associated array of collections.

Parameters:
- **property** (`string`) Property used to group the objects.

Returns:
- `array` Multiple collections in an array, key being the value of the property.

## matching()

`matching( Criteria ): Collection` Selects all objects that match the expression and returns a new collection containing these objects.

Parameters:
- **[Criteria](https://www.doctrine-project.org/projects/doctrine-collections/en/1.6/expression-builder.html#expression-builder)** Expression

Returns:
- **Collection** (`object`) New collection with objects matching the criteria.

! **TIP:** Check Doctrine documentation for **[Expression Builder](https://www.doctrine-project.org/projects/doctrine-collections/en/1.6/expression-builder.html#expression-builder)** and** [Expressions](https://www.doctrine-project.org/projects/doctrine-collections/en/1.6/expressions.html#expressions)**.

## orderBy()

`orderBy( array ): Collection` Reorder collection by list of property/value pairs.

Parameters:
- `array`

Returns:
- **Collection** (`object`) New collection with the new ordering.

## partition()

`partition( Closure ): array` Partitions this collection in two collections according to a predicate.

Keys are preserved in the resulting collections.

Parameters:
- **Closure** Method used to partition a single object. Returns true or false.

Returns:
- `array` Partitioned objects `[[a, b], [c, d, e]]`

---

## Render Object

> Path: grav-learn/pages/08.advanced/01.flex/02.using/04.object/docs.17.md


# Render Object

## render()

`render( [layout], [context] ): Block` Renders the object.

Parameters:
- **layout** Layout name (`string`)
- **context** Extra variables that can be used inside the Twig template file (`array`)

Returns:
- **Block** (`object`) HtmlBlock class containing the output

!!! **NOTE:** In twig there is a `{% render %}` tag, which should be used instead of calling the method directly. This will allow JS/CSS assets from the object to work properly.

[ui-tabs]
[ui-tab title="Twig"]
```twig
{% set contact = grav.get('flex').object('gizwsvkyo5xtms2s', 'contacts') %}

{% render contact layout: 'details' with { my_variable: true } %}
```
[/ui-tab]
[ui-tab title="PHP"]
```php
use Grav\Common\Grav;
use Grav\Framework\ContentBlock\HtmlBlock;
use Grav\Framework\Flex\Interfaces\FlexObjectInterface;

/** @var FlexObjectInterface|null $collection */
$object = Grav::instance()->get('flex')->getObject('gizwsvkyo5xtms2s', 'contacts');
if ($object) {

    /** @var HtmlBlock $block */
    $block = $object->render('details', ['my_variable' => true]);

}
```
[/ui-tab]
[/ui-tabs]

# Other

## getKey()

`getKey(): string` Get key of the object.

Returns:
- `string` Object key

## hasKey()

`hasKey(): bool` Returns true if the object key has been set.

Returns:
- `true` if object has a key, `false` otherwise

## getFlexType()

`getFlexType(): string` Get type of the object.

Returns:
- `string` Flex directory name where the object belongs into

## hasProperty()

`hasProperty( property ): bool` Returns true if the object property has been defined and has a value (not null).

Parameters:
- **property** Property name (`string`)

Returns:
- `true` if property has a value, `false` otherwise.

## getProperty()

`getProperty( property, default ): mixed` Returns the value of the object property.

Parameters:
- **property** Property name (`string`)

Returns:
- `mixed` Value of the property
- `null` if the property is not defined or has no value

## setProperty()

`setProperty( property, value ): Object` Set new value to the object property.

Parameters:
- **property** Property name (`string`)
- **value** New value (`mixed`)

Returns:
- **Object** (`object`) The object for chaining the method calls

!! **WARNING:** This method modifies the object instance shared between all the collections. If that is not intended, please `clone` the object before using this method.

## defProperty()

`defProperty( property, default ): Object` Define default value to the object property.

Parameters:
- **property** Property name (`string`)
- **default** Default value (`mixed`)

Returns:
- **Object** (`object`) The object for chaining the method calls

!! **WARNING:** This method modifies the object instance shared between all the collections. If that is not intended, please `clone` the object before using this method.

## unsetProperty()

`unsetProperty( property ): Object` Remove value of the object property.

Parameters:
- **property** Property name (`string`)

Returns:
- **Object** (`object`) The object for chaining the method calls

!! **WARNING:** This method modifies the object instance shared between all the collections. If that is not intended, please `clone` the object before using this method.

## isAuthorized()

`isAuthorized( action, [scope], [user] ): bool | null` Check if user is authorized for the action.

Parameters:
- **action** (`string`)
  - One of: `create`, `read`, `update`, `delete`, `list`
- **scope** Optional (`string`)
  - Usually either `admin` or `site`
- **user** Optional User Object (`object`)

Returns:
- `true` Allow action
- `false` Deny action
- `null` Not set (acts as Deny)

!!! **Note:** There are two deny values: denied (false), not set (null). This allows chaining multiple rules together when the previous rules were not matched.`

## getFlexDirectory()

`getFlexDirectory(): Directory`

Returns:
- **[Directory](/advanced/flex/using/directory)** (`object`)

## getTimestamp()

`getTimestamp(): int` Get last modified timestamp for the object.

Returns:
- `int` Timestamp.

## search()

`search(string, [properties], [options] ): float` Search a string from the object, returns weight between 0 and 1.

Parameters:
- **string** Search string (`string`)
- **properties** Properties to search, if null (or not provided), use defaults (`array` or `null`)
- **options** Extra options used while searching (`array`)
  - starts_with: `bool`
  - ends_with: `bool`
  - contains: `bool`
  - case_sensitive: `bool`

Returns:
- `float` Search weight between 0 and 1, used for ordering the results
- `0` Object does not match the search

!!! **Note:** If you override this function, make sure you return value in range 0...1!

## getFlexKey()

`getFlexKey(): string` Get a unique key for the object.

Returns:
- `string` **Flex key** of the object

Flex Keys can be used without knowing the Directory the Object belongs into.

## getStorageKey()

`getStorageKey(): string` Get a unique storage key (within the directory) which is used for figuring out the filename or database id.

Returns:
- `string` **Storage key** of the object

## exists()

`exists(): bool` Returns true if the object exists in the storage.

Returns:
- `true` Object exists in the storage
- `false` Object has not been saved

## update()

`update( data, files ): Object` Updates object in the memory.

Parameters:
- **data** (`array`) Nested arrays of properties with their values
- **files** (`array`) Array of `Psr\Http\Message\UploadedFileInterface` objects

Returns:
- **Object** (`object`) The object for chaining the method calls

! **TIP:** You need to save the object after calling this method.

## create()

`create( [key] ): Object` Create new object into the storage.

Parameters:
- **key** (`string`) Optional key

Returns:
- **Object** (`object`) Saved object

## createCopy()

`createCopy( [key] ): Object` Create a new object from the current one and save it into the storage.

Parameters:
- **key** (`string`) Optional key

Returns:
- **Object** (`object`) Saved object

## save()

`save(): Object` Save object into the storage.

Returns:
- **Object** (`object`) Saved object

## delete()

`delete(): Object` Delete object from the storage.

Returns:
- **Object** (`object`) Deleted object

## getBlueprint()

`getBlueprint( [name] ): Blueprint` Returns the blueprint of the object.

Parameters:
- **name** (`string`) Optional name for the blueprint

Returns:
- **Blueprint** (`object`)

## getForm()

`getForm( [name], [options] ): Form` Returns a form instance for the object.

Parameters:
- **name** (`string`) Optional name for the form
- **options** (`array`) Optional options to the form

Returns:
- **Form** (`object`)

## getDefaultValue()

`getDefaultValue( name, [separator] ): mixed` Returns default value suitable to be used in a form for the given property.

Parameters:
- **name** (`string`) Name of the property
- **separator** (`string`) Optional separator character for nested properties, defaults to `.` (dot)

Returns:
- `mixed` Default value of the property

## getDefaultValues()

`getDefaultValues(): array` Returns default values suitable to be used in a form for the given property.

Returns:
- `array` All default values

## getFormValue()

`getFormValue( name, [default], [separator] ): mixed` Returns raw value suitable to be used in a form for the given property.

Parameters:
- **name** (`string`) Name of the property
- **default** (`mixed`) Optional default value of the field, `null` if not given
- **separator** (`string`) Optional separator character for nested properties, defaults to `.` (dot)

Returns:
- `mixed` Value of the form field

## triggerEvent()

`triggerEvent( name, [Event] ): Object` Trigger an event of your choice.

Parameters:
- **name** (`string`) Name of the event
- **Event** (`object`) Optional event class

Returns:
- **Object** (`object`) The object for chaining the method calls

---

## Using `flex-objects` Page Type

> Path: grav-learn/pages/08.advanced/01.flex/02.using/docs.17.md


**Flex Objects** is designed to be easy to use. Displaying collection and groups in your pages can mostly be done from Twig templates.

! **TIP:** To enable and display Flex Directory, please read **[Enabling a Directory](/advanced/flex/administration/introduction)**

## Using `flex-objects` Page Type

Display multiple directories in your `directories/flex-objects.md` page:

```text
title: Directories
flex:
  layout: default
  list:
  - contacts
  - services

# Directories
```

Display a single directory in your `contacts/flex-objects.md` page:

```text
title: Contacts
flex:
  directory: contacts
  collection:
    title: '{{ directory.title }}'
    layout: default
    object:
      layout: list-default
  object:
    title: 'Contact: {{ object.first_name }} {{ object.last_name }}'
    layout: default

# Contacts
```

By default, `flex-objects` page type takes two URL parameters, **directory** and **id**. They are used to navigate directories. Example URLs look like this:

```text
https://www.domain.com/directories/directory:contacts/id:ki2ts4cbivggmtlj

https://www.domain.com/contacts/id:ki2ts4cbivggmtlj
```

! **TIP:** You can pass your own parameters inside `flex` and use them in your collection and object template files.

## Rendering Collections and Objects

Both Collections and Objects support rendering their output in HTML. Output can be customized with two parameters: layout and context. Layout allows you to set custom looks, for example you can have list of cards and then more detailed output for details. Context allows you to pass variables to be used in the template files.

```twig
{% render collection layout: 'custom' with { context_variable: true } %}

{% render object layout: 'custom' with { context_variable: true } %}
```

See more detailed documentation: [Render Collection](/advanced/flex/using/collection#render) and [Render Object](/advanced/flex/using/object#render).

## Templating Basics

Flex templates are located in `templates/flex` folder:

```text
templates/
  flex/
    contacts/
      collection/
        default.html.twig
      object/
        default.html.twig
```

Each type has two folders, one for rendering collection and one for rendering object. The files inside are layouts, named after the filename. In our example, we have `default` layout for both the collection and the object.

### Collection Template

Collection template `flex/contacts/collection/default.html.twig` is responsible for rendering all the objects in the collection. Rendered output is cached by default. Cache key is defined by the collection and the context passed to the `render()` method.

!! **WARNING:** If context contains non-scalar values, caching will be turned off. Try to keep the context as simple as possible!

Here is an example from Contacts Type:
```twig
<div id="flex-objects">
  <div class="text-center">
    <input class="form-input search" type="text" placeholder="Search by name, email, etc" />
    <button class="button button-primary sort asc" data-sort="name">
      Sort by Name
    </button>
  </div>

  <ul class="list">
    {% for object in collection.filterBy({ published: true }) %}
      <li>
        {% render object layout: layout with { options: options } %}
      </li>
    {% endfor %}
  </ul>
</div>

<script>
    var options = {
        valueNames: [ 'name', 'email', 'website', 'entry-extra' ]
    };
    var flexList = new List('flex-objects', options);
</script>
```

! **TIP:** If the rendered HTML has dynamic content, render cache can be disabled from the Twig template by `{% do block.disableCache() %}`.

### Object Template

Object template `flex/contacts/object/default.html.twig` is responsible for rendering a single object. Rendered output is cached by default. Cache key is defined by the object and the context passed to the `render()` method.

!! **WARNING:** If context contains non-scalar values, caching will be turned off. Try to keep the context as simple as possible!

Here is an example from Contacts Type:
```twig
<div class="entry-details">
    {% if object.website %}
        <a href="{{ object.website|e }}"><span class="name">{{ object.last_name|e }}, {{ object.first_name|e }}</span></a>
    {% else %}
        <span class="name">{{ object.last_name|e }}, {{ object.first_name|e }}</span>
    {% endif %}
    {% if object.email %}
        <p><a href="mailto:{{ object.email|e }}" class="email">{{ object.email|e }}</a></p>
    {% endif %}
</div>
<div class="entry-extra">
    {% for tag in object.tags %}
        <span>{{ tag|e }}</span>
    {% endfor %}
</div>
```

! **TIP:** If the rendered HTML has dynamic content, render cache can be disabled from the Twig template by `{% do block.disableCache() %}`.

### Custom Layouts

By using custom layouts, you can create an infinite amount of different views into both of your collections and objects.

You can create your custom layouts by just adding a new file next to `default.html.twig` file. The basename of the file is the same as your layout name.

! **TIP:** In collection layouts, it is recommended to call `{% render object layout: 'xxx' %}` instead of outputting the object variables directly into the collection template.

---

## Flex Configuration

> Path: grav-learn/pages/08.advanced/01.flex/03.custom-types/01.blueprint/docs.17.md


Basic structure of **Flex Blueprint** contains `title`, `description` and `type`, which describe the type and three sections: `config`, `blueprints` and `form`, which describe different aspects from the directory type.

Main structure of `contacts.yaml`:
```yaml
title: Contacts
description: Simple contact directory with tags.
type: flex-objects  # do not change

# Flex Configuration
config: {}

# Flex Directory Forms
blueprints: {}

# Flex Object Form
form: {}
```

To create your own custom Directory, you need to start by naming your `type` (filename) and filling in the `title` and `description`.

After creating the file and filling in the basic information, the next step is to either copy your existing form or to add some fields into the file.

! **TIP:** We assume that you already know how to create your own **[Forms and Blueprints](/forms)**.

!! **WARNING:** It is better not to use the simple list format to describe the fields as described in **[Create a simple single form](/forms/forms#create-a-simple-single-form)**. Also do not pass `process` section of the form to this file, it will not be used by Flex.

## Form

In our contacts example the form section looks like this:

```yaml
# Flex Object Form
form:
  validation: loose

  fields:
    published:
      type: toggle
      label: Published
      highlight: 1
      default: 1
      options:
        1: PLUGIN_ADMIN.YES
        0: PLUGIN_ADMIN.NO
      validate:
        type: bool
        required: true

    last_name:
      type: text
      label: Last Name
      validate:
        required: true

    first_name:
      type: text
      label: First Name
      validate:
        required: true

    email:
      type: email
      label: Email Address
      validate:
        required: true

    website:
      type: url
      label: Website URL

    tags:
      type: selectize
      size: large
      label: Tags
      classes: fancy
      validate:
        type: commalist
```

The form looks the same regardless if it was taken from a page or from a configuration, plugin or theme blueprint file. This is the main blueprint for every object in your directory and it should contain all the fields defined in the object. Think it as a form that is displayed to the administrator.

!! **WARNING:** Be careful when you modify a blueprint for existing Flex Type. Make sure objects you have already saved are compatible with the new version of the blueprint - meaning that you should be able to both save and display the older objects.

We are not quite done yet. There is still two things that needs to be done to make the Directory to work: we need to configure the data storage layer and define the fields to display in the Admin List view. We can do both of those inside `config` section.

## Config

Config section is the most complicated part of Flex Blueprint, though a lot of it is just to allow customization. It contains `data`, `admin` and `site` sections.

```yaml
# Flex Configuration
config:

  # Data Settings
  data: {}

  # Admin Settings
  admin: {}

  # Site Settings
  site: {}
```

The minimum configuration looks something like this:

```yaml
# Flex Configuration
config:

  # Data Settings
  data:
    storage: user-data://flex-objects/contacts.json

  # Admin Settings
  admin:
    # List view
    list:
      # List of fields to display
      fields:
        last_name:
          link: edit # Edit link
        first_name:
          link: edit # Edit link
        email:
        website:
```

There are two mandatory sections in the configuration: `config.data.storage` and `config.admin.list.fields`. The latter defines fields displayed inside admin list view. Data storage on the other hand defines how the data will be stored.

### Config > Data

**Flex Directory** is highly customizable. You can use your own `object`, `collection` and `index` PHP classes to add your own behavior. Additionally, you can configure the `storage` layer to best fit your needs. Directory also has it's default `ordering` and `search` functionality.

```yaml
config:
  data:
    # Flex Object Class
    object: CLASSNAME
    # Flex Collection Class
    collection: CLASSNAME
    # Flex Index Class
    index: CLASSNAME
    # Storage Options
    storage: {}
    # Ordering Options
    ordering: {}
    # Search Options
    search: {}
```

Object, collection and index take class names. If they are not provided, Grav will use the following default configuration:

```yaml
config:
  data:
    object: 'Grav\Common\Flex\Types\Generic\GenericObject'
    collection: 'Grav\Common\Flex\Types\Generic\GenericCollection'
    index: 'Grav\Common\Flex\Types\Generic\GenericIndex'
```

These classes will together define the behavior for your type. If you want to customize your own type, it is possible by extending these classes and passing your own classes here.

One of the most important parts is to define where and how the data is being stored:

```yaml
config:
  data:
    storage:
      class: 'Grav\Framework\Flex\Storage\SimpleStorage'
      options:
        formatter:
          class: 'Grav\Framework\File\Formatter\JsonFormatter'
        folder: user-data://flex-objects/contacts.json
```

Above is a special case which can also be written in a short form:

```yaml
config:
  data:
    storage: user-data://flex-objects/contacts.json
```

Grav 1.7 provides 3 different storage strategies, though you can easily create your own:

[div class="table-keycol"]
| Name | Class | Description |
|------|-------|-------------|
| Simple Storage | Grav\Framework\Flex\Storage\SimpleStorage | All objects are stored into a single file. Does not support media. |
| File Storage | Grav\Framework\Flex\Storage\FileStorage | Objects are stored into separate files in a single folder. |
| Folder Storage | Grav\Framework\Flex\Storage\FolderStorage | Every object is stored into a separate folder. |
[/div]

Additionally you can provide file format with `options.formatter.class`:

[div class="table-keycol"]
| Name | Class | Description |
|------|-------|-------------|
| JSON | Grav\Framework\File\Formatter\JsonFormatter | Use JSON file format. |
| YAML | Grav\Framework\File\Formatter\YamlFormatter | Use YAML file format. |
| Markdown | Grav\Framework\File\Formatter\MarkdownFormatter | Use Grav's Markdown file format with YAML frontmatter. |
| Serialize | Grav\Framework\File\Formatter\SerializeFormatter | Use PHP serializer. Fast but not human readable. |
| INI | Grav\Framework\File\Formatter\IniFormatter | Use INI file format. Not recommended. |
| CSV | Grav\Framework\File\Formatter\CsvFormatter | Use CSV file format. Not recommended. |
[/div]

Configuration options (with defaults) for the default formatters can be found below inside the tabs:

[ui-tabs]
[ui-tab title="JSON"]
```yaml
# JSON
formatter:
  class: 'Grav\Framework\File\Formatter\JsonFormatter'
  options:
    file_extension: '.json'
    encode_options: '' # See https://www.php.net/manual/en/function.json-encode.php (separate options with space)
    decode_assoc: true # Decode objects as arrays
    decode_depth: 512  # Decode up to 512 levels
    decode_options: '' # See https://www.php.net/manual/en/function.json-decode.php (separate options with space)
```
[/ui-tab]
[ui-tab title="YAML"]
```yaml
# YAML
formatter:
  class: 'Grav\Framework\File\Formatter\YamlFormatter'
  options:
    file_extension: '.yaml'
    inline: 5           # Save with up to 4 expanded levels
    indent: 2           # Indent with 2 spaces
    native: true        # Use native YAML decoder if available
    compat: true        # If YAML cannot be decoded, use compatibility mode (SLOW)
```
[/ui-tab]
[ui-tab title="Markdown"]
```yaml
# Markdown
formatter:
  class: 'Grav\Framework\File\Formatter\MarkdownFormatter'
  options:
    file_extension: '.md'
    header: 'header'    # Header variable eg. header.title
    body: 'markdown'    # Body variable
    raw: 'frontmatter'  # RAW YAML variable
    yaml:
      inline: 20        # YAML options, see YAML formatter from above
```
[/ui-tab]
[ui-tab title="Serialize"]
```yaml
# PHP Serialize
formatter:
  class: 'Grav\Framework\File\Formatter\SerializeFormatter'
  options:
    file_extension: '.ser'
    decode_options:
      allowed_classes: ['stdClass'] # List of allowed / safe classes during unserialize
```
[/ui-tab]
[ui-tab title="INI"]
```yaml
# INI
formatter:
  class: 'Grav\Framework\File\Formatter\IniFormatter'
  options:
    file_extension: '.ini'
```
[/ui-tab]
[ui-tab title="CSV"]
```yaml
# CSV
formatter:
  class: 'Grav\Framework\File\Formatter\CsvFormatter'
  options:
    file_extension: ['.csv', '.tsv']
    delimiter: ','      # Delimiter to separate the values
    mime: 'text/x-csv'  # MIME type for downloading file
```
[/ui-tab]
[/ui-tabs]

You can also set default ordering, which is defined by `key: ASC|DESC` pairs:

```yaml
config:
  data:
    # Ordering Options
    ordering:
      key: ASC
      timestamp: ASC
```

Finally, you can add search fields, which are looked at when you call `collection.search()`:

```yaml
config:
  data:
    search:
      # Fields to be searched
      fields:
        - last_name
        - first_name
        - email
      # Search Options
      options:
        - contains: 1   # If field contains the search string, assign weight 1 to the object
```

**Fields** contain a list of fields to be searched against.

Search options can be:

[div class="table-keycol"]
| Name | Value | Description |
|------|-------|-------------|
| case_sensitive | `true` or `false` | If true, all checks are case sensitive, defaults to false |
| same_as | 0 ... 1 | Value of the field must be identical to the search string |
| starts_with | 0 ... 1 | Value of the field must start with the search string |
| ends_with | 0 ... 1 | Value of the field must end with the search string |
| contains | 0 ... 1 | Value of the field must contain the search string |
[/div]

Search function returns 0 if the field does not match and weight between 0 and 1 if there is a match. Weight is used for ordering the search results. Object which gets the highest core has better match than one with a lower score.

!!! Currently, search does not support having different weights or strategies per field.

### Config > Admin

Admin section contains various configuration options to customize directory administration. It contains a few main sections: `router`, `actions`, `permissions`, `menu`, `template` and `views`.

```yaml
config:
  # Admin Settings
  admin:
    # Admin router
    router: {}
    # Allowed admin actions
    actions: {}
    # Permissions
    permissions: {}
    # Admin menu
    menu: {}
    # Admin template type
    template: pages
    # Admin views
    views: {}
```

Optional `router` section can be used to customize the **Flex Directory** admin routes. Routing supports a base path, customizable routes for every action as well as redirects to handle for example backwards compatibility. All the paths are relative to admin base URL.

```yaml
config:
  admin:
    # Admin router
    router:
      path: '/contacts' # Custom path to the directory
      actions:
        configure: # Action name
          path: '/contacts/configure' # New path to the action.
      redirects: # List of redirects (from: to)
        '/flex-objects/contacts': '/contacts'
```

Sometimes you want to restrict the administration to only display the entries or for example to only allow editing the existing ones. For this `actions` is where you can tweak the allowed CRUD operations to fit better your needs.

```yaml
config:
  admin:
    # Allowed admin actions (for all users, including super user)
    actions:
      list: true   # Needs to be true (may change in the future)
      create: true # Set to false to disable creating new objects
      read: true   # Set to false to disable link to edit / details of the objects
      update: false # Set to false to disable saving existing objects
      delete: false # Set to false to disable deleting objects
```

Above example will prevent saving existing objects and deleting them for every user, including Super Admin.

Permissions section allows you to add new permission rules for Grav. These rules will appear in user/group admin. You can create as many permission rules as you wish, but you need to add your own logic or `authorize` rules in this file to use them.

```yaml
config:
  admin:
    # Permissions
    permissions:
      # Primary permissions (used for the objects)
      admin.contacts:
        type: crudl # Create, Read, Update, Delete, List
        label: Contacts Directory
      # Secondary permissions (you need to assign these to a view, otherwise these will not be used)
      admin.configuration.contacts:
        type: default # Simple permission
        label: Contacts Configuration
```

If you do not want to display your directory in `Flex Objects` administration, one option is to display menu item in the main navigation. You can do just that in the `menu` section of the configuration.

```yaml
config:
  admin:
    # Admin Menu
    menu:
      list:
        hidden: false # If true, hide the menu item.
        route: '/contacts' # Alias to `config.admin.router.path` if router path is not set.
        title: Contacts
        icon: fa-address-card-o
        authorize: ['admin.contacts.list', 'admin.super'] # Authorization needed to access the menu item.
        priority: 2 # Priority -10 .. 10 (highest goes up)
```

Above example creates **Contacts** menu item pointing to `/admin/contacts`.

When you're creating your own Flex Directories, you may sometimes want to share the same templates between all of your custom directories. You can do this with `template`:

```yaml
config:
  admin:
    # Admin template type (folder)
    template: contacts
```

**Flex Admin** has multiple views to the objects. By default, following views are supported: `list`, `edit`, `configure` and optionally `preview` & `export`. It is possible to add your own views as well.

```yaml
config:
  admin:
    views:
      # List view
      list: {}
      # Edit view
      edit: {}
      # Configure view
      configure: {}
      # Preview
      preview: {}
      # Data Export
      export: {}
```

#### List View

The first view you will need, is the one which lists all of your objects. By default `list` view uses *VueTable* and *AJAX* to paginate the objects. It needs a list of `fields` to display as well as `options` to define how many items are being shown at once as well as the default field used for ordering.

```yaml
config:
  admin:
    views:
      # List view
      list:
        icon: fa-address-card-o
        title: Site Contacts
        fields: {}        # See below
        options:
          per_page: 20    # Default number of items per page
          order:
            by: last_name # Default field used for ordering
            dir: asc      # Default ordering direction
```

**Icon** and **title** are used to customize the icon and title of the listing page. **Title** supports also using Twig template by using following format:

```yaml
        title:
          template: "{{ 'PLUGIN_CONTACTS.CONTACTS_TITLE'|tu }}"
```

**Fields** contains the fields you want to display in the directory listing. Each field has a key, which is the name of the field. Value can be omitted or it can contain the following configuration options:

[div class="table-keycol"]
| Name | Value | Example | Description |
|------|-------|-------------|
| width | `integer` | 8 | Width of the field in pixels |
| alias | `string` | 'header.published' | Name of the form field to use. VueTable doesn't like dots in the names, so set alias for nested variables. |
| field | `array` |  | Form field override. Written just like any form field, but just without a key. |
| link | `string` | 'edit' | Adds edit link to the text. |
| search | `boolean` | true | Makes the field searchable in admin list. |
| sort | `array` | field:'first_name' | You can specify different value if you use different field name when querying data on the server side, e.g. first_name. |
| title_class | `string` | 'center' | CSS classes used in titles. |
| data_class | `string` |  'left' | CSS classes used in data columns. |
[/div]

#### Edit View

Edit view has the same basic configuration options as list view:

```yaml
config:
  admin:
    views:
      # Edit view
      edit:
        icon: fa-address-card-o
        title:
          template: '{{ object.last_name ?? ''Last'' }}, {{ object.first_name ?? ''First Name'' }}'
```

#### Configure view

Configure view allows you to add directory wide configuration options, which can then be used in the template files.

```yaml
config:
  admin:
    views:
      # Configure view
      configure:
        hidden: false # Configuration button can be hidden, for example if you have custom tab to replace it, like in Accounts.
        authorize: 'admin.configuration.contacts' # Optional custom authorize rule for this view.
        file: 'config://flex/contacts.yaml' # Optional file where the configuration is saved.

        icon: fa-cog
        title:
          template: "{{ directory.title }} {{ 'PLUGIN_ADMIN.CONFIGURATION'|tu }}"
```

#### Preview view

Flex also supports preview, though right now it works by rendering a page from the frontend, which can be defined in the blueprint file.

```yaml
    # Preview View
    preview:
      enabled: true
      route:
        template: '/contacts' # Twig template to create URL. In this case we use the list view

       icon: fa-address-card-o
        title:
          template: "{{ object.form.getValue('title') ?? object.title ?? key }}"
```

#### Export view

All objects can be exported into a single file, here is an example configuration how to export data into YAML file:

```yaml
    # Data Export
    export:
      enabled: true
      method: 'jsonSerialize'
      formatter:
        class: 'Grav\Framework\File\Formatter\YamlFormatter'
      filename: 'contacts'
```

### Config > Site

```yaml
config:
  # Site Settings
  site:
    templates:
      collection:
        # Lookup for the template layout files for collections of objects
        paths:
          - 'flex/{TYPE}/collection/{LAYOUT}{EXT}'
      object:
        # Lookup for the template layout files for objects
        paths:
          - 'flex/{TYPE}/object/{LAYOUT}{EXT}'
      defaults:
        # Default template variable {TYPE}; overridden by filename of this blueprint if template folder exists
        type: contacts
        # Default template variable {LAYOUT}; can be overridden in render calls (usually Twig in templates)
        layout: default
```

Template settings allow you to customize the template lookup paths and set the default type and layout name in the frontend.

## Blueprints

Blueprints section defines the common configuration options for the whole Directory. The options allow you to customize a common directory to better suit the needs of the site without requiring manual editing of the files.

```yaml
blueprints:
  # Blueprint for configure view.
  configure:
    # We are inside TABS field.
    fields:
      # Add our own tab
      compatibility:
        type: tab
        title: Compatibility
        fields:
          # Fields should be prefixed with object, collection etc..
          object.compat.events:
            type: toggle
            toggleable: true
            label: Admin event compatibility
            help: Enables onAdminSave and onAdminAfterSave events for plugins
            highlight: 1
            default: 1
            options:
              1: PLUGIN_ADMIN.ENABLED
              0: PLUGIN_ADMIN.DISABLED
            validate:
              type: bool
```

! **TIP:** These configuration options can be modified in **[Configuration](/advanced/flex/administration/configuration)** section of the **[Flex Directory Administration](/advanced/flex/administration)**.

!!! **NOTE:** Currently the only used configuration options are inside the cache section. For your custom settings, you need to add logic to use them by yourself.

---

## docs.17

> Path: grav-learn/pages/08.advanced/01.flex/03.custom-types/docs.17.md


For many sites, the main reason for using **Flex Directories** is to be able to define your own custom data types, which are neither simple or small enough to fit into configuration or suitable to be represented as individual pages.

Flex Directories solve this issue for you. Since **Flex Types** use the common design principles to both configuration and pages, it is really easy to convert your existing configuration and pages to use Flex. You may also have existing forms in the site, which you'd want to manage from the Administration Panel, or maybe you want to display selected comments in your site. These forms can also be converted to use Flex.

The base of a **Flex Type** is its **Blueprint**. The blueprint defines both the form and the fields of the object. It also has some additional configuration, which can be used to customize the directory and its objects, where it shows up in Admin Panel and ACL.

---

## Introduction

> Path: grav-learn/pages/08.advanced/01.flex/docs.17.md


**Flex Objects** is a new concept in Grav 1.7 that adds support for custom data types which can be easily integrated to your site. **Flex Objects** are provided by the [**Flex Objects** Plugin](https://github.com/trilbymedia/grav-plugin-flex-objects) which is required by the [Admin Panel](/admin-panel) and included in the [**Grav Core + Admin Plugin**](https://getgrav.org/downloads) package. 

!! **Flex Directories** in this documentation has nothing to do with the older **Flex Directories Plugin**. In fact the old plugin has been superseded with this feature together with **Flex Objects Plugin**.

## Introduction

**Flex** is a set of **Directories** of a given type. Grav has its own built-in types, such as **User Accounts** and **Pages**. Plugins and themes can also define their own types and register those with Grav.


#### Flex

**[Flex](/advanced/flex/using/flex)** is a container for **Flex Directories**.

This gives a single access point for all the data in the site, given that the data is inside a Flex Directory. This makes all the objects available to every page and plugin in your site.

! **TIP:** Even if Flex *User Accounts* or *Pages* are not enabled, you can still access Flex versions of them in both frontend and Admin Panel.

#### Flex Type

**Flex Type** is the blueprint for your **Flex Directory**.

It defines everything that is needed to display and modify the content: data structure, form fields, permissions, template files, even storage layer.

#### Flex Directory

**[Flex Directory](/advanced/flex/using/directory)** keeps a collection of **Flex Objects** of a single **Flex Type**.

Each Directory contains a **Collection** of **Objects** with optional support for **Indexes** to speed up queries to **Storage**.

#### Flex Collection

**[Flex Collection](/advanced/flex/using/collection)** is a structure that contains **Flex Objects**.

The collection usually contains only the objects which are needed to display the page or to perform the given action. It provides useful tools to further filter or manipulate the data as well as methods to render the whole collection.

#### Flex Object

**[Flex Object](/advanced/flex/using/object)** is a single instance of some **Flex Type**.

The object represents a single entity. The object gives access to its properties, including any associated data, such as **[Media](/content/media)**. Object also knows how to **Render** itself or which **Form** to use to edit its contents. Actions like creating, updating and deleting objects are supported by the object itself.

#### Flex Index

**Flex Index** is used to make fast queries to **Flex Directory**.

It contains meta-data for the **Flex Objects**, but not the objects themselves.

#### Flex Storage

**Flex Storage** is a storage layer for the **Flex Objects**.

It can be a single file, set of files in a single folder or set of folders. Flex also supports custom storages, such as database storages.

#### Flex Form

**Flex Form** integrates to **Form Plugin** and allows **Flex Object** to be created or edited.

Flex supports multiple views, which allow different parts of the object to be modified.

#### Flex Administration ####

**[Flex Administration](/advanced/flex/administration)** is implemented by **Flex Objects Plugin**.

It adds a new section to **Admin Plugin** allowing site administrators to manage **Flex Objects**. Each **Flex Directory** comes with CRUD-type ACL, which can be used to restrict parts of Admin and actions within them to certain users.

## Current Limitations

There is still a lot of work to do. Here are the current limitations when considering use of Flex Objects:

* Multi-language support has only been implemented for **Pages**, also admin cannot be fully translated yet
* Frontend only has a basic routing; for your custom tasks, such as saving, you need your own implementation
* Bulk update features have not yet been implemented in Admin (in code, they are easy)
* Due to indexing limitations, it is not recommended to use Flex for objects that are constantly being updated
* Customizing your **Flex Type** requires a good coding knowledge and creating your own classes

---

## Performance

> Path: grav-learn/pages/08.advanced/02.performance-and-caching/docs.md


 One of the core features that make Grav so compelling is just how fast it is.  This has always been a key consideration in the inherent design of Grav and is primarily due to caching, but does include several other components.

## Performance

1. **PHP caching is critical**.  You should run a PHP **opcache** and **usercache** (such as **APCu**) in order to get the best performance out of Grav.

2. **SSD drives** can make a big difference. Most things can get cached in PHP user cache, but some are stored as files, so SSD drives can make a big impact on performance. Avoid using network filesystems such as NFS with Grav.

3. **Native hosting** will always be faster than a Virtual Machine.  VMs are a great way hosting providers can offer flexible cloud type environments. These add a layer of processing that will always affect performance. Grav can still be fast on a VM (much faster than wordpress, joomla, etc), but still, for optimal performance, you can't beat a native hosting option.

4. **Faster memory** is better. Because Grav is so fast, and because many of its caching solutions use memory heavily, the speed of the memory on your server can have a big impact on performance. Grav does not use extensive amounts of memory compared to some platforms so the amount of memory is not as important, nor does it impact performance as much, as memory type and speed.

5. **Fast Multi-core processors** are better. Faster and more advanced processors will always help, but not as much as the other points.

6. **Shared hosting** is cheap and readily available, but sharing resources will always slow things down a bit. Again, Grav can run very well on a shared server (better than other CMSes), but for ultimate speed, a dedicated server is the way to go.

7. **PECL Yaml Parser**.  Installing the native PHP PECL Yaml parser can increase YAML parsing speed by as much as 400%!  This is well worth looking at if you are looking for some extra speed.

!! The getgrav.org runs on a single dedicated server with quad core processors, 16GB of memory and 6G SSD drives. We also run PHP 7.4 with Zend opcache and APCu user cache. The web servers do run a few other websites but not as many as you would find in a shared-hosting environment.

## Caching Options

Caching is an integral feature of Grav that has been baked in from the start.  The caching mechanism that Grav employs is the primary reason Grav is as fast as it is.  That said, there are some factors to take into account.

Grav uses the established and well-respected [Doctrine Cache](https://www.doctrine-project.org/projects/doctrine-cache/en/latest/index.html) library. This means that Grav supports any caching mechanism that Doctrine Cache supports.  This means that Grav supports:

* **Auto** _(Default)_ - Finds the best option automatically
* **File** - Stores in cache files in the `cache/` folder
* **APCu** - [https://php.net/manual/en/book.apcu.php](https://php.net/manual/en/book.apcu.php)
* **Memcache** - [https://php.net/manual/en/book.memcache.php](https://php.net/manual/en/book.memcache.php)
* **Redis** - [https://redis.io](https://redis.io)
* **WinCache** - [https://www.iis.net/downloads/microsoft/wincache-extension](https://www.iis.net/downloads/microsoft/wincache-extension)

By default, Grav comes preconfigured to use the `auto` setting.  This will try **APC**, then **WinCache**, and lastly **File**.  You can, of course, explicitly configure the cache in your `user/config/system.yaml` file, which could make things ever so slightly faster.

## Caching Types

There are actually **5 types** of caching happening in Grav.  They are:

1. YAML configuration caching into PHP.
2. Core Grav caching for page objects.
3. Twig caching of template files as PHP classes.
4. Image caching for media resources.
5. Asset caching of CSS and JQuery with pipelining.

The YAML configuration caching is not configurable, and will always compile and cache the configuration into the `/cache` folder. Image caching is also always on, and stores its processed images in the `/images` folder.

### Grav Core Caching

Core Grav caching has the following configuration options as configured in your `user/config/system.yaml` file:

[prism classes="language-yaml line-numbers"]
cache:
  enabled: true                        # Set to true to enable caching
  check:
    method: file                       # Method to check for updates in pages: file|folder|hash|none
  driver: auto                         # One of: auto|file|apc|xcache|memcache|wincache|redis
  prefix: 'g'                          # Cache prefix string (prevents cache conflicts)
[/prism]

As you can see, the options are documented in the configuration file itself.  During development sometimes it is useful to disable caching to ensure you always have the latest page edits.

By default, Grav uses the `file` check method for its caching.  What this means is that every time you request a Grav URL, Grav uses a highly optimized routing to run through all the **files** in the `user/pages`  folder to determine if anything has changed.

`folder` cache check is going to be slightly faster than `file` but will not work reliably in all environments.  You will need to check if Grav picks up modifications to pages on your server when using the `folder` option.

`hash` checking uses a fast hash algorithm on all of the files in each page folder.  This may be faster than file checking in some situations and does take into account every file in the folder.

If automatic re-caching of changed pages is not critical to you (or if your site is rather large), then setting this value to `none` will speed up a production environment even more. You will just need to manually [clear the cache](../grav-cli#clearing-grav-cache) after changes are made. This is intended as a **Production-only** setting.

!!!! Deleting a page does not clear the cache as cache clears are based on folder-modified timestamps.

<!-- -->

!!! You can easily force the cache to clear by just touching/saving a configuration file.

#### Memcache Specific Options

There are some extra configuration options that are required if you are connecting to a **memcache** server via the `memcache` driver option.  These options should go under the `cache:` group in your `user/config/system.yaml`:

[prism classes="language-yaml line-numbers"]
cache:
  ...
  memcache:
    server: localhost
    port: 11211
[/prism]

#### Memcached Specific Options

Similar to memcache, memcached has some extra configuration options that are required if you are connecting to a **memcached** server via the `memcached` driver option.  These options should go under the `cache:` group in your `user/config/system.yaml`:

[prism classes="language-yaml line-numbers"]
cache:
  ...
  memcached:
    server: localhost
    port: 11211
[/prism]


#### Redis Specific Options

There are some extra configuration options that are required if you are connecting to a **redis** server via the `redis` driver option.  These options should go under the `cache:` group in your `user/config/system.yaml`:

[prism classes="language-yaml line-numbers"]
cache:
  ...
  redis:
    server: localhost
    port: 6379
[/prism]

Alternatively, you can use a socket connection:

[prism classes="language-yaml line-numbers"]
cache:
  ...
  redis:
    socket: '/tmp/redis.sock'
[/prism]

If your redis server has a password or secret set you can also set that in this configuration:

[prism classes="language-yaml line-numbers"]
cache:
  ...
  redis:
    password: your-secret
[/prism]

_you will also need the php-redis installed in your system_

#### Twig Specific Options

The Twig templating engine uses its own file based cache system, and there are a few options associated with it.

[prism classes="language-yaml line-numbers"]
twig:
  cache: false                          # Set to true to enable twig caching
  debug: true                           # Enable Twig debug
  auto_reload: true                     # Refresh cache on changes
  autoescape: false                     # Autoescape Twig vars
[/prism]

For slight performance gains, you can disable the `debug` extension, and also disable `auto_reload` which performs a similar function to `cache: check: method: none` as it will not look for changes in `.html.twig` files to trigger cache refreshes.

## Caching and Events

For the most part, [events are still fired](../../plugins/event-hooks) even when caching is enabled.  This holds true for all the events except for `onPageContentRaw`, `onPageProcessed`, `onPageContentProcessed`, `onTwigPageVariables`, and `onFolderProcessed`.  These events are run as all pages and folders are recursed and they fire on each page or folder found.  As their name implies they are only run during the **processing**, and not after the page has been cached.

---

## Debug Bar

> Path: grav-learn/pages/08.advanced/03.debugging/docs.md


When developing themes and plugins, there is often a need to display **debugging** information. Grav has powerful debugging capabilities via a variety of features:

## Debug Bar

Grav comes with a great tool to make this effort easier called via a **Debug Bar**.  This feature is **disabled** by default, but can be turned on either globally or for your [development environment](../environment-config) only via the `system.yaml` configuration file:

[version=15,16]
[prism classes="language-yaml line-numbers"]
debugger:
  enabled: true                        # Enable Grav debugger and following settings
  shutdown:
    close_connection: true             # Close the connection before calling onShutdown(). false for debugging
[/prism]
[/version]
[version=17]
[prism classes="language-yaml line-numbers"]
debugger:
  enabled: true                        # Enable Grav debugger and following settings
  provider: debugbar                    # Set provider to debugbar
  shutdown:
    close_connection: true             # Close the connection before calling onShutdown(). false for debugging
[/prism]
[/version]

![](config.png)

!! The first time you enable it, the debug bar might appear as a little Grav icon in the bottom left of the page. Clicking that will show the full debug bar.

The PHP Debug Bar still provides an overall **processing time** as well as **memory usage**, but it now has several tabs that provide more detailed information.

The first tab is for **Messages** and you can use this to help debug your Grav development process by posting information to this tab from your code.

Along with **Request**, **Exceptions**, and **Configuration** information, you can also see a detailed breakdown of Grav timing in the **Timeline** panel:

![](timeline.png)

### Dump Command for PHP

If you are trying to debug some PHP, for example a custom plugin you are developing, and wish to quickly examine some object or variable, you can use the powerful `dump()` command.  This accepts basically any valid PHP variable and will output the results in a nicely formatted and colorized display in your browser.

For example, you can easily dump a PHP variable or object:

[prism classes="language-php"]
dump($myvariable);
[/prism]

and see the results in your browser:

![](dump.png)

You can also dump variables into the **Messages** tab of the Debug Bar by using the syntax:

[prism classes="language-php"]
$this->grav['debugger']->addMessage($myvariable)
[/prism]

### Dump command for Twig

You can also display Twig variables from your Twig templates.  This is done in a similar fashion, but the results are displayed in the **Messages** panel of the Debug Bar. This feature is **disabled** by default, but can be turned on either globally or for your [development environment](../environment-config) only via the `system.yaml` configuration file:

[prism classes="language-yaml line-numbers"]
twig:
  debug: true                        # Enable Twig debugger
[/prism]

For example, you can easily dump a Twig variable or object:

{% verbatim %}
[prism classes="language-twig line-numbers"]
{{ dump(page.header) }}
[/prism]
{% endverbatim %}

and see the results in the Debugbar:

![](twig-dump.png)

It's possible to output multiple dump commands at the same time but it can get confusing to tell them apart. Add static text like this:
{% verbatim %}
[prism classes="language-twig line-numbers"]
{{ dump('page.header output:',page.header) }}
[/prism]
{% endverbatim %}

![](twig-dump-text.png)

### Dump to browser console from Twig

To display variables before a page is returned by Grav or in case no page refresh occurs such as when using AJAX there is another alternative. By using a single line of Javascript any variable can be displayed in your browser's developer console, for example:

{% verbatim %}
[prism classes="language-twig"]
<script> console.log({{ page.header|json_encode|raw }}) </script>
[/prism]
{% endverbatim %}

Then examine the value in the browser console:

![](console-dump.png)

## Error Display

Our new error display page provides detailed information, backtraces, and even relevant code blocks.  This helps to more quickly isolate, identify and resolve critical errors. By default in Grav, these are turned off by default, so you will need to enable them to take advantage of this helpful error handling for development:

[prism classes="language-yaml line-numbers"]
errors:
  display: true
[/prism]

![](error.png)

For production environments you can disable the detailed error page with something more subtle by configuring the errors options in your `user/config/system.yaml` file and rely on errors being logged to file:

[prism classes="language-yaml line-numbers"]
errors:
  display: false
  log: true
[/prism]

![](error2.png)

## Logging

The ability to log information is often useful, and once again, Grav provides us with a simple put powerful logging feature.  Use one of the following syntaxes:

[prism classes="language-twig line-numbers"]
$this->grav['log']->info('My informational message');
$this->grav['log']->notice('My notice message');
$this->grav['log']->debug('My debug message');
$this->grav['log']->warning('My warning message');
$this->grav['log']->error('My error message');
$this->grav['log']->critical('My critical message');
$this->grav['log']->alert('My alert message');
$this->grav['log']->emergency('Emergency, emergency, there is an emergency here!');

[/prism]

All your message will be appended to the `/logs/grav.log` file.

---

## Automatic Environment Configuration

> Path: grav-learn/pages/08.advanced/04.environment-config/docs.md


Grav has the ability to extend the [powerful configuration capabilities](../../basics/grav-configuration) for different environments to support different configuration for **development**, **staging**, and **production** scenarios.

[version=17]
!! Up to Grav 1.6 environments were stored in `user/` folder. Grav 1.7 moves environments to `user/env/` to make environments easier to maintain. It is highly recommended that you move all the environments into this new location on your existing sites.
[/version]

### Automatic Environment Configuration

What this means is that you can provide as little or as much configuration changes per environment as needed.  A good example of this is the [Debug Bar](../debugging).  By default, the new Debug Bar is disabled in the core `system/config/system.yaml` file, and also in the user override file:

[prism classes="language-bash command-line"]
user/config/system.yaml
[/prism]

If you wanted to turn it on, you can easily enable it in your `user/config/system.yaml` file, however a better solution might be to have it _enabled_ for your development environment when accessing via **localhost**, but _disabled_ on your **production** server.

This can be easily accomplished by providing an override of that setting in the file:

[version=15,16]
[prism classes="language-bash command-line"]
user/localhost/config/system.yaml
[/prism]
[/version]
[version=17]
[prism classes="language-bash command-line"]
user/env/localhost/config/system.yaml
[/prism]
[/version]

where `localhost` is the hostname of the environment (this is what the host you enter in your browser, e.g. http://localhost/your-site) and your configuration file contains:

[prism classes="language-yaml line-numbers"]
debugger:
  enabled: true
[/prism]

Similarly, you may want to enable CSS, Link, JS and JS Module Asset Pipelining (combining + minification) for your production site only
([version=15,16]`user/www.mysite.com/config/system.yaml`[/version][version=17]`user/env/www.mysite.com/config/system.yaml`[/version]):

[prism classes="language-yaml line-numbers"]
assets:
  css_pipeline: true
  js_pipeline: true
  js_module_pipeline: true
[/prism]

If your production server was reachable via `http://www.mysite.com` then you could also provide configuration specific for that production site with a file located at
[version=15,16]`user/www.mysite.com/config/system.yaml`[/version][version=17]`user/env/www.mysite.com/config/system.yaml`[/version].

Of course, you are not limited to changes to `system.yaml`, you can actually provide overrides for **any** Grav setting in the `site.yaml` or even in any [plugin configuration](../../plugins/plugin-basics)!

!! If you are using the Grav [Scheduler](/advanced/scheduler), be aware of it using the `localhost` environment and therefore its configuration.

#### Plugin Overrides

To override a plugin configuration YAML file is simply the same process as overriding a regular file.   If the standard configuration file is located in:

[prism classes="language-bash command-line"]
user/config/plugins/email.yaml
[/prism]

Then you can override this with a setting that only overrides specific options that you want to use for local testing:

[version=15,16]
[prism classes="language-bash command-line"]
user/localhost/config/plugins/email.yaml
[/prism]
[/version]
[version=17]
[prism classes="language-bash command-line"]
user/env/localhost/config/plugins/email.yaml
[/prism]
[/version]

With the configuration:

[prism classes="language-yaml line-numbers"]
mailer:
  engine: smtp
  smtp:
    server: smtp.mailtrap.io
    port: 2525
    encryption: none
    user: '9a320798e65135'
    password: 'a13e6e27bc7205'
[/prism]

#### Theme Overrides

You can override themes in much the same way:

[prism classes="language-bash command-line"]
user/config/themes/antimatter.yaml
[/prism]

Can be overridden for any environment, say some production site (`http://www.mysite.com`):

[version=15,16]
[prism classes="language-bash command-line"]
user/www.mysite.com/config/themes/antimatter.yaml
[/prism]
[/version]
[version=17]
[prism classes="language-bash command-line"]
user/env/www.mysite.com/config/themes/antimatter.yaml
[/prism]

### Server Based Environment Configuration

Starting from Grav 1.7, it is possible to set the environment by using server configuration. In this use scenario, you set environment variables from the server or from a script that runs before Grav to select the environment to be used.

The simplest way to set environment is by using `GRAV_ENVIRONMENT`. Value of `GRAV_ENVIRONMENT` has to be a valid server name with or without domain.

The following example selects **development** environment for the localhost:

[ui-tabs]
[ui-tab title="Apache 2"]
[prism classes="language-apacheconf line-numbers"]
<VirtualHost 127.0.0.1:80>
    ...

    SetEnv GRAV_ENVIRONMENT development
</VirtualHost>
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-fpm"]
[prism classes="language-nginx line-numbers"]
location / {
    ...

   fastcgi_param GRAV_ENVIRONMENT development;
}
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-cgi"]
[prism classes="language-nginx line-numbers"]
location / {
   ...

    env[GRAV_ENVIRONMENT] = development
}
[/prism]
[/ui-tab]
[ui-tab title="Docker"]
[prism classes="language-yaml line-numbers"]
web:
  environment:
    - GRAV_ENVIRONMENT=development
[/prism]
[/ui-tab]
[ui-tab title="PHP"]
[prism classes="language-php line-numbers"]
// Set environment in setup.php or make sure it runs before Grav.
define('GRAV_ENVIRONMENT', 'development');
[/prism]
[/ui-tab]
[/ui-tabs]

### Custom Environment Paths

Starting from Grav 1.7, you can also change the location of the environments. There are two possibilities: either you configure a common location for all the environments or you define them one by one.

#### Custom location for all the environments

If for some reason you are not happy with the default `user/env` location for your environments, it can be changed by using `GRAV_ENVIRONMENTS_PATH` environment variable.

Value of `GRAV_ENVIRONMENTS_PATH` has to be existing path under `GRAV_ROOT`. Do not use trailing slash.

In the next example, all the environments will be located in `user/sites/GRAV_ENVIRONMENT`, where `GRAV_ENVIRONMENT` is either automatically detected or manually set in the server configuration:

[ui-tabs]
[ui-tab title="Apache 2"]
[prism classes="language-apacheconf line-numbers"]
<VirtualHost 127.0.0.1:80>
...

    SetEnv GRAV_ENVIRONMENTS_PATH user://sites
</VirtualHost>
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-fpm"]
[prism classes="language-nginx line-numbers"]
location / {
    ...

fastcgi_param GRAV_ENVIRONMENTS_PATH user://sites;
}
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-cgi"]
[prism classes="language-nginx line-numbers"]
location / {
...

    env[GRAV_ENVIRONMENTS_PATH] = user://sites
}
[/prism]
[/ui-tab]
[ui-tab title="Docker"]
[prism classes="language-yaml line-numbers"]
web:
  environment:
    - GRAV_ENVIRONMENTS_PATH=user://sites
[/prism]
[/ui-tab]
[ui-tab title="PHP"]
[prism classes="language-php line-numbers"]
// Set environments path in setup.php or make sure that the following code runs before Grav.
define('GRAV_ENVIRONMENTS_PATH', 'user://sites');
[/prism]
[/ui-tab]
[/ui-tabs]

#### Custom location for the current environment

Sometimes it may be useful to have a custom location for your environment

Value of `GRAV_ENVIRONMENT_PATH` has to be existing path under `GRAV_ROOT`. Do not use trailing slash.

In the next example, only the current environment will be located in `user/development`:

[ui-tabs]
[ui-tab title="Apache 2"]
[prism classes="language-apacheconf line-numbers"]
<VirtualHost 127.0.0.1:80>
...

    SetEnv GRAV_ENVIRONMENT_PATH user://development
</VirtualHost>
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-fpm"]
[prism classes="language-nginx line-numbers"]
location / {
    ...

fastcgi_param GRAV_ENVIRONMENT_PATH user://development;
}
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-cgi"]
[prism classes="language-nginx line-numbers"]
location / {
...

    env[GRAV_ENVIRONMENT_PATH] = user://development
}
[/prism]
[/ui-tab]
[ui-tab title="Docker"]
[prism classes="language-yaml line-numbers"]
web:
  environment:
    - GRAV_ENVIRONMENT_PATH=user://development
[/prism]
[/ui-tab]
[ui-tab title="PHP"]
[prism classes="language-php line-numbers"]
// Set environment path in setup.php or make sure that the following code runs before Grav.
define('GRAV_ENVIRONMENT_PATH', 'user://development');
[/prism]
[/ui-tab]
[/ui-tabs]

Note that `GRAV_ENVIRONMENT_PATH` is separate from `GRAV_ENVIRONMENT`, so you may also want to set the environment name if you don't want it to be automatically set to match the current domain name.

### Further Customization

Environments can be customized far further than described in this page.

For more information, please continue to the next page: [Multisite Setup](/advanced/multisite-setup).



---

## What is a Multisite Setup?

> Path: grav-learn/pages/08.advanced/05.multisite-setup/docs.17.md


!! Grav has preliminary multisite support available.  However, the Admin plugin still need to be updated to fully support multisite configurations.  We will continue to work on this in subsequent releases of Grav.

### What is a Multisite Setup?

A multisite setup allows you to create and manage a network of multiple websites, all running on a single installation.

Grav has built-in multisite support. This functionality extends the [basic environment configuration](../environment-config), which lets you define custom environments for your production and development sites.

A full multisite setup gives you the power to change how and from where Grav loads all its files.

### Requirements for a Grav Multisite Setup

The most important thing you will need to run a Grav multisite network is good website hosting. If you are not planning to create many sites and do not expect many visitors, then you can get away with shared hosting. However, due to the nature of multisites, youd probably need a VPS or dedicated server as your sites grow.

### Setup and installation

Before you begin, youll want to be sure your web server is capable of running multiple websites i.e., you have access to your Grav root directory.

This is essential since serving multiple websites from the same installation is based on a `setup.php` file located in your Grav root.

#### Quickstart (for Beginners)

Once created, the `setup.php` is called every time a user requests a page. In order to serve multiple websites from one single installation, this script (roughly speaking) has to tell Grav where the files (for the configurations, themes, plugins, pages etc.) for a specific subsite are located.

The provided snippets below setup your Grav installation in such a way that a request like

[prism classes="language-text"]
https://<subsite>.example.com   -->   user/env/<subsite>.example.com
[/prism]
or
[prism classes="language-text"]
https://example.com/<subsite>   -->   user/env/<subsite>
[/prism]

will use the `user/env` directory as the base "user" path instead of the `user` directory.

If you choose sub-directories or path based URLs for subsites, then the only thing you need is to create a directory for each subsite in the `user/env` directory containing at least the required folders `config`, `pages`, `plugins`, and `themes`.

If you choose sub-domains for structuring your website network, then you will have to configure (wildcard) sub-domains on your server in addition to the setup of your subsites in your `user/env` directory.

Either way, decide which setup suits you best.

##### Snippets

For subsites accessible via sub-domains copy the `setup_subdomain.php` file, otherwise for subsites accessible via sub-directories the `setup_subdirectory.php` file into your `setup.php`.

!!! The `setup.php` file must be put in the Grav root folder, the same folder where you can find `index.php`, `README.md` and the other Grav files.

**setup_subdomain.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Multisite setup for subsites accessible via sub-domains.
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Utils;

// Get subsite name from sub-domain
$environment = isset($_SERVER['HTTP_HOST'])
    ? $_SERVER['HTTP_HOST']
    : (isset($_SERVER['SERVER_NAME']) ? $_SERVER['SERVER_NAME'] : 'localhost');
// Remove port from HTTP_HOST generated $environment
$environment = strtolower(Utils::substrToString($environment, ':'));
$folder = "env/{$environment}";

if ($environment === 'localhost' || !is_dir(ROOT_DIR . "user/{$folder}")) {
    return [];
}

return [
    'environment' => $environment,
    'streams' => [
        'schemes' => [
            'user' => [
               'type' => 'ReadOnlyStream',
               'prefixes' => [
                   '' => ["user/{$folder}"],
               ]
            ]
        ]
    ]
];
[/prism]

**setup_subdirectory.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Multisite setup for sub-directories or path based
 * URLs for subsites.
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Filesystem\Folder;

// Get relative path from Grav root.
$path = isset($_SERVER['PATH_INFO'])
   ? $_SERVER['PATH_INFO']
   : Folder::getRelativePath($_SERVER['REQUEST_URI'], ROOT_DIR);

// Extract name of subsite from path
$name = Folder::shift($path);
$folder = "env/{$name}";
$prefix = "/{$name}";

if (!$name || !is_dir(ROOT_DIR . "user/{$folder}")) {
    return [];
}

// Prefix all pages with the name of the subsite
$container['pages']->base($prefix);

return [
    'environment' => $name,
    'streams' => [
        'schemes' => [
            'user' => [
               'type' => 'ReadOnlyStream',
               'prefixes' => [
                   '' => ["user/{$folder}"],
               ]
            ]
        ]
    ]
];
[/prism]

When using subdirectories to switch language contexts you might need to load different configs depending on the language.
You can place your language specific configs in `config/<lang-context>/site.yaml` using the example for `setup_subdir_config_switch.php` below.
This way `yoursite.com/de-AT/index.html` would load `config/de-AT/site.yaml`, `yoursite.com/de-CH/index.html` would load `config/de-CH/site.yaml` and so on.

**setup_subdir_config_switch.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Switch config based on the language context subdir
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Filesystem\Folder;

$languageContexts = [
    'de-AT',
    'de-CH',
    'de-DE',
];

// Get relative path from Grav root.
$path = isset($_SERVER['PATH_INFO'])
    ? $_SERVER['PATH_INFO']
    : Folder::getRelativePath($_SERVER['REQUEST_URI'], ROOT_DIR);

// Extract name of subdir from path
$name = Folder::shift($path);

if (in_array($name, $languageContexts)) {
    return [
        'streams' => [
            'schemes' => [
                'config' => [
                    'type' => 'ReadOnlyStream',
                    'prefixes' => [
                        '' => [
                            'environment://config',
                            'user://config/' . $name,
                            'user://config',
                            'system/config',
                        ],
                    ],
                ],
            ],
        ],
    ];
}

return [];
[/prism]

##### GPM (Grav Package Manager) and multiple setups
Should you need to manage your subsites' plugins and themes with the [GPM](https://learn.getgrav.org/17/cli-console/grav-cli-gpm), 
Keep both `user/themes` + `user/plugins`, so that the GPM fetches and updates them in a single location. Then symlink the needed items under `user/env/my.site.com/themes` or `user/env/my.site.com/plugins`. Then setup individual yaml configurations `user/env/my.site.com/config/plugins` for each subsites.

#### Advanced configuration (for Experts)

Once created a `setup.php` have access to two important variables: (i) `$container`, which is the yet not properly initialized [Grav instance](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Grav.php) and (ii) `$self`, which is an instance of the [ConfigServiceProvider class](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Service/ConfigServiceProvider.php).

Inside this script, you can do anything, but please be aware that the `setup.php` is called every time a user requests a page. This means that memory critical or time-consuming initializations operations lead to a slow-down of your whole system and should therefore be avoided.

In the end, the `setup.php` has to return an associative array with the optional environment name **environment** and a stream collection **streams**
(for more informations and in order to set them up correctly, see the section [Streams](#streams)):

[prism classes="language-php line-numbers"]
return [
  'environment' => '<name>',            // A name for the environment
  'streams' => [
    'schemes' => [
      '<stream_name>' => [              // The name of the stream
        'type' => 'ReadOnlyStream',     // Stream object e.g. 'ReadOnlyStream' or 'Stream'
        'prefixes' => [
          '<prefix>' => [
            '<path1>',
            '<path2>',
            '<etc>'
          ]
        ],
        'paths' => [                    // Paths (optional)
          '<paths1>',
          '<paths2>',
          '<etc>'
        ]
      ]
    ]
  ]
]

[/prism]

!!!! Please be aware that a this very early stage you neither have access to the configuration nor to the URI instance and thus any call to a non-initialized class might end in a freeze of the system, in unexpected errors or in (complete) data loss.

#### Streams

Grav uses URI like streams to define all the file paths in Grav. Using streams makes it really easy to customize lookup paths for any file.

By default, streams have been configured like this:

* `user://` - user folder. e.g. `user/`
* `page://` - pages folder. e.g. `user://pages/`
* `image://` - images folder. e.g. `user://images/`, `system://images/`
* `account://` - accounts folder. e.g. `user://accounts/`
* `environment://` - current multi-site location.
* `asset://` - compiled JS/CSS folder. e.g. `assets/`
* `blueprints://` - blueprints folder. e.g. `environment://blueprints/`, `user://blueprints/`, `system://blueprints/`
* `config://` - configuration folder. e.g. `environment://config/`, `user://config/`, `system://config/`
* `plugins://` - plugins folder.  e.g. `user://plugins/`
* `themes://` - current theme.  e.g. `user://themes/`
* `theme://` - current theme.  e.g. `themes://antimatter/`
* `languages://` - languages folder. e.g. `environment://languages/`, `user://languages/`, `system://languages/`
* `user-data://` - data folder.  e.g. `user/data/`
* `system://` - system folder. e.g. `system/`
* `cache://` - cache folder. e.g. `cache/`, `images/`
* `log://` - log folder. e.g. `logs/`
* `backup://` - backup folder. e.g. `backups/`
* `tmp://` - temporary folder. e.g. `tmp/`

In multi-site setups, some of these default settings may not be what you want. Grav provides easy way to customize streams from the environment configuration using `config/streams.yaml`. Additionally you can create and use your own streams when needed.

Mapping physical directories to a logical device can be done by setting up `prefixes`. Here is an example where we separate pages, images, accounts, data, cache and logs from the rest of the sites, but make everything else to look up from the default locations:

`user/env/domain.com/config/streams.yaml`:
[prism classes="language-yaml line-numbers"]
schemes:
  account:
    type: ReadOnlyStream
    prefixes:
      '': ['environment://accounts']
  page:
    type: ReadOnlyStream
    prefixes:
      '': ['environment://user']
  image:
    type: Stream
    prefixes:
      '': ['environment://images', 'system://images/']
  'user-data':
    type: Stream
    prefixes:
      '': ['environment://data']
  cache:
    type: Stream
    prefixes:
      '': ['cache/domain.com']
      images: ['images/domain.com']
  log:
    type: Stream
    prefixes:
      '': ['logs/domain.com']
[/prism]

In Grav streams are objects, mapping a set of physical directories of the system to a logical device. They are classified via their `type` attribute. For read-only streams that's the `ReadOnlyStream` type and for read-writeable streams that's the `Stream` type.

For example, if you use `image://mountain.jpg` stream, Grav looks up `environment://images` (`user/env/domain.com/images`) and `system://images` (`system/images`). This means that streams can be used to define other streams.


Prefixes allows you to combine several physical paths into one logical stream. If you look carefully at `cache` stream definition, it is a bit different. In this case `cache://` resolves to `cache`, but `cache://images` resolves to `images`.

[version=17]
### Server Based Multi-Site Configuration

Grav 1.7 adds support to customize initial environment from your server configuration.

This feature comes handy if you want to use for example docker containers and you want to make them independent of the domain you happen to use. Or if do not want to store secrets in the configuration, but to store them in your server setup.

The following environment variables can be used to customize the default paths which Grav uses to setup the environment. After initialization the streams may point to different location.

!!! **Note:** You can use either environment variables or PHP constants, but they need to be set before Grav runs.

[div class="table-keycol"]
| Variable | Default | Description |
| -------- | ------- | ----------- |
| **GRAV_SETUP_PATH** | AUTO DETECT | A custom path to `setup.php` file including the filename. By default Grav looks the file from `GRAV_ROOT/setup.php` and `GRAV_ROOT/GRAV_USER_PATH/setup.php`. |
| **GRAV_USER_PATH** | `user` | A relative path for `user://` stream. |
| **GRAV_CACHE_PATH** | `cache` | A relative path for `cache://` stream. |
| **GRAV_LOG_PATH** | `logs` | A relative path for `log://` stream. |
| **GRAV_TMP_PATH** | `tmp` | A relative path for `tmp://` stream. |
| **GRAV_BACKUP_PATH** | `backup` | A relative path for `backup://` stream. |
[/div]

In addition there are variables to customize the environments. Better documentation for these can be found in [Server Based Environment Configuration](/advanced/environment-config#server-based-environment-configuration).

!!! **Note:** These work also from `setup.php` file. You can either make them constants by using `define()` or environment variables with `putenv()`. Constants are preferred over environment variables.

[div class="table-keycol"]
| Variable | Default | Description |
| -------- | ------- | ----------- |
| **GRAV_ENVIRONMENT** | DOMAIN NAME | Environment name. Can be used for example in docker containers to set a custom environment which does not rely domain name, such as `production` and `develop`. |
| **GRAV_ENVIRONMENTS_PATH** | `user://env` | Lookup path for all environments if you do prefer something like `user://sites`. Can be either a stream or relative path from `GRAV_ROOT`. |
| **GRAV_ENVIRONMENT_PATH** | `user://env/ENVIRONMENT` | Sometimes it may be useful to have a custom location for your environment. |
[/div]

#### Server Based Configuration Overrides

If you do not wish to store secret credentials inside the configuration, you can also provide them by using environment variables from your server.

As environmental variables have strict naming requirements (they can only contain A-Z, a-z, 0-9 and _), some tricks are needed to get the configuration overrides to work.

Here is an example of a simple configuration override using YAML format for presentation:

```yaml
GRAV_CONFIG: true                           # If false, the configuration here will be ignored.

GRAV_CONFIG_ALIAS__GITHUB: plugins.github   # Create alias GITHUB='plugins.github' to shorten the variable names below

GRAV_CONFIG__GITHUB__auth__method: api      # Override config.plugins.github.auth.method = api
GRAV_CONFIG__GITHUB__auth__token: xxxxxxxx  # Override config.plugins.github.auth.token = xxxxxxxx
```

In above example `__` (double underscore) represents nested variable, which in twig is represented with `.` (dot).

You can also use environment variables in `setup.php`. This allows you for example to store secrets outside the configuration:

`user/setup.php`:
```php
<?php

// Use following environment variables in your server configuration:
//
// DYNAMODB_SESSION_KEY: DynamoDb server key for the PHP session storage
// DYNAMODB_SESSION_SECRET: DynamoDb server secret
// DYNAMODB_SESSION_REGION: DynamoDb server region
// GOOGLE_MAPS_KEY: Google Maps secret key

return [
    'plugins' => [
        // This plugin does not exist
        'dynamodb_session' => [
            'credentials' => [
                'key' => getenv('DYNAMODB_SESSION_KEY') ?: null,
                'secret' => getenv('DYNAMODB_SESSION_SECRET') ?: null
            ],
            'region' => getenv('DYNAMODB_SESSION_REGION') ?: null
        ],
        // This plugin does not exist
        'google_maps' => [
            'key' => getenv('GOOGLE_MAPS_KEY') ?: null
        ]
    ]
];
```

!! **WARNING:** `setup.php` is used to set initial configuration. If the plugin or your configuration later override these settings, the initial values get lost.

After defining the variables in `setup.php`, you can then set those in your server:

[ui-tabs]
[ui-tab title="Apache 2"]
[prism classes="language-apacheconf line-numbers"]
<VirtualHost 127.0.0.1:80>
    ...

    SetEnv GRAV_SETUP_PATH         user/setup.php
    SetEnv GRAV_ENVIRONMENT        production
    SetEnv DYNAMODB_SESSION_KEY    JBGARDQ06UNJV00DL0R9
    SetEnv DYNAMODB_SESSION_SECRET CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    SetEnv DYNAMODB_SESSION_REGION us-east-1
    SetEnv GOOGLE_MAPS_KEY         XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
</VirtualHost>
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-fpm"]
[prism classes="language-nginx line-numbers"]
location / {
    ...

    fastcgi_param GRAV_SETUP_PATH         user/setup.php;
    fastcgi_param GRAV_ENVIRONMENT        production;
    fastcgi_param DYNAMODB_SESSION_KEY    JBGARDQ06UNJV00DL0R9;
    fastcgi_param DYNAMODB_SESSION_SECRET CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7;
    fastcgi_param DYNAMODB_SESSION_REGION us-east-1;
    fastcgi_param GOOGLE_MAPS_KEY         XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp;
}
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-cgi"]
[prism classes="language-nginx line-numbers"]
location / {
...

    env[GRAV_SETUP_PATH]          = user/setup.php
    env[GRAV_ENVIRONMENT]         = production
    env[DYNAMODB_SESSION_KEY]     = JBGARDQ06UNJV00DL0R9
    env[DYNAMODB_SESSION_SECRET]  = CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    env[GDYNAMODB_SESSION_REGION] = us-east-1
    env[GGOOGLE_MAPS_KEY]         = XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
}
[/prism]
[/ui-tab]
[ui-tab title="Docker"]
[prism classes="language-yaml line-numbers"]
web:
  environment:
    - GRAV_SETUP_PATH=user/setup.php
    - GRAV_ENVIRONMENT=production
    - DYNAMODB_SESSION_KEY=JBGARDQ06UNJV00DL0R9
    - DYNAMODB_SESSION_SECRET=CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    - DYNAMODB_SESSION_REGION=us-east-1
    - GOOGLE_MAPS_KEY=XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
[/prism]
[/ui-tab]
[ui-tab title="PHP"]
[prism classes="language-php line-numbers"]
putenv('GRAV_SETUP_PATH', 'user/setup.php');
putenv('GRAV_ENVIRONMENT', 'production');
putenv('DYNAMODB_SESSION_KEY', 'JBGARDQ06UNJV00DL0R9');
putenv('DYNAMODB_SESSION_SECRET', 'CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7');
putenv('DYNAMODB_SESSION_REGION', 'us-east-1');
putenv('GOOGLE_MAPS_KEY', 'XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp');
[/prism]
[/ui-tab]
[/ui-tabs]

In this example, server will also use `production` environment stored in `user/env/production` folder.

[/version]

---

## What is a Multisite Setup?

> Path: grav-learn/pages/08.advanced/05.multisite-setup/docs.md


!! Grav has preliminary multisite support available.  However, CLI commands as well as the Admin plugin still need to be updated to fully support multisite configurations.  We will continue to work on this in subsequent releases of Grav.

### What is a Multisite Setup?

> A multisite setup allows you to create and manage a network of multiple websites, all running on a single installation.

Grav has built-in multisite support. This functionality extends the [basic environment configuration](../environment-config), which lets you define custom environments for your production and development sites.

A full multisite setup gives you the power to change the way how and from where Grav loads all its files.

### Requirements for a Grav Multisite Setup

The most important thing you will need to run a Grav multisite network is good website hosting. If you are not planning to create many sites and do not expect many visitors, then you can get away with shared hosting. However, due to the nature of multisites, youd probably need a VPS or dedicated server as your sites grow.

### Setup and installation

Before you begin, youll want to be sure your web server is capable of running multiple websites i.e., you have access to your Grav root directory.

This is essential since serving multiple websites from the same installation is based on a `setup.php` file located in your Grav root.

#### Quickstart (for Beginners)

Once created, the `setup.php` is called every time a user requests a page. In order to serve multiple websites from one single installation, this script (roughly speaking) has to tell Grav where the files (for the configurations, themes, plugins, pages etc.) for a specific subsite are located.

The provided snippets below setup your Grav installation in such a way that a request like

[prism classes="language-text"]
http://<subsite>.example.com   -->   user/sites/<subsite>.example.com
[/prism]
or
[prism classes="language-text"]
http://example.com/<subsite>   -->   user/sites/<subsite>
[/prism]

will use the `user/sites` directory as the base "user" path instead of the `user` directory.

If you choose sub-directories or path based URLs for subsites, then the only thing you need is to create a directory for each subsite in the `user/sites` directory containing at least the required folders `config`, `pages`, `plugins`, and `themes`.

If you choose sub-domains for structuring your website network, then you will have to configure (wildcard) sub-domains on your server in addition to the setup of your subsites in your `user/sites` directory.

Either way, decide which setup suits you best.

##### Snippets

For subsites accessible via sub-domains copy the `setup_subdomain.php` file, otherwise for subsites accessible via sub-directories the `setup_subdirectory.php` file into your `setup.php`.

!!! The `setup.php` file must be put in the Grav root folder, the same folder where you can find `index.php`, `README.md` and the other Grav files.

**setup_subdomain.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Multisite setup for subsites accessible via sub-domains.
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Utils;

// Get subsite name from sub-domain
$environment = isset($_SERVER['HTTP_HOST'])
    ? $_SERVER['HTTP_HOST']
    : (isset($_SERVER['SERVER_NAME']) ? $_SERVER['SERVER_NAME'] : 'localhost');
// Remove port from HTTP_HOST generated $environment
$environment = strtolower(Utils::substrToString($environment, ':'));
$folder = "sites/{$environment}";

if ($environment === 'localhost' || !is_dir(ROOT_DIR . "user/{$folder}")) {
    return [];
}

return [
    'environment' => $environment,
    'streams' => [
        'schemes' => [
            'user' => [
               'type' => 'ReadOnlyStream',
               'prefixes' => [
                   '' => ["user/{$folder}"],
               ]
            ]
        ]
    ]
];
[/prism]

**setup_subdirectory.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Multisite setup for sub-directories or path based
 * URLs for subsites.
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Filesystem\Folder;

// Get relative path from Grav root.
$path = isset($_SERVER['PATH_INFO'])
   ? $_SERVER['PATH_INFO']
   : Folder::getRelativePath($_SERVER['REQUEST_URI'], ROOT_DIR);

// Extract name of subsite from path
$name = Folder::shift($path);
$folder = "sites/{$name}";
$prefix = "/{$name}";

if (!$name || !is_dir(ROOT_DIR . "user/{$folder}")) {
    return [];
}

// Prefix all pages with the name of the subsite
$container['pages']->base($prefix);

return [
    'environment' => $name,
    'streams' => [
        'schemes' => [
            'user' => [
               'type' => 'ReadOnlyStream',
               'prefixes' => [
                   '' => ["user/{$folder}"],
               ]
            ]
        ]
    ]
];
[/prism]

When using subdirectories to switch language contexts you might need to load different configs depending on the language.
You can place your language specific configs in `config/<lang-context>/site.yaml` using the example for `setup_subdir_config_switch.php` below.
This way `yoursite.com/de-AT/index.html` would load `config/de-AT/site.yaml`, `yoursite.com/de-CH/index.html` would load `config/de-CH/site.yaml` and so on.

**setup_subdir_config_switch.php**:
[prism classes="language-php line-numbers"]
<?php
/**
 * Switch config based on the language context subdir
 *
 * DO NOT EDIT UNLESS YOU KNOW WHAT YOU ARE DOING!
 */

use Grav\Common\Filesystem\Folder;

$languageContexts = [
    'de-AT',
    'de-CH',
    'de-DE',
];

// Get relative path from Grav root.
$path = isset($_SERVER['PATH_INFO'])
    ? $_SERVER['PATH_INFO']
    : Folder::getRelativePath($_SERVER['REQUEST_URI'], ROOT_DIR);

// Extract name of subdir from path
$name = Folder::shift($path);

if (in_array($name, $languageContexts)) {
    return [
        'streams' => [
            'schemes' => [
                'config' => [
                    'type' => 'ReadOnlyStream',
                    'prefixes' => [
                        '' => [
                            'environment://config',
                            'user://config/' . $name,
                            'user://config',
                            'system/config',
                        ],
                    ],
                ],
            ],
        ],
    ];
}

return [];
[/prism]

#### Advanced configuration (for Experts)

Once created a `setup.php` have access to two important variables: (i) `$container`, which is the yet not properly initialized [Grav instance](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Grav.php) and (ii) `$self`, which is an instance of the [ConfigServiceProvider class](https://github.com/getgrav/grav/blob/develop/system/src/Grav/Common/Service/ConfigServiceProvider.php).

Inside this script, you can do anything, but please be aware that the `setup.php` is called every time a user requests a page. This means that memory critical or time-consuming initializations operations lead to a slow-down of your whole system and should therefore be avoided.

In the end, the `setup.php` has to return an associative array with the optional environment name **environment** and a stream collection **streams**
(for more informations and in order to set them up correctly, see the section [Streams](#streams)):

[prism classes="language-php line-numbers"]
return [
  'environment' => '<name>',            // A name for the environment
  'streams' => [
    'schemes' => [
      '<stream_name>' => [              // The name of the stream
        'type' => 'ReadOnlyStream',     // Stream object e.g. 'ReadOnlyStream' or 'Stream'
        'prefixes' => [
          '<prefix>' => [
            '<path1>',
            '<path2>',
            '<etc>'
          ]
        ],
        'paths' => [                    // Paths (optional)
          '<paths1>',
          '<paths2>',
          '<etc>'
        ]
      ]
    ]
  ]
]

[/prism]

!!!! Please be aware that a this very early stage you neither have access to the configuration nor to the URI instance and thus any call to a non-initialized class might end in a freeze of the system, in unexpected errors or in (complete) data loss.

#### Streams

In Grav streams are objects, mapping a set of physical directories of the system to a logical device. They are classified via their `type` attribute. For read-only streams that's the `ReadOnlyStream` type and for read-writeable streams that's the `Stream` type. You can register any custom stream type and pointing to it as long as it is an instance of the [StreamInterface](https://github.com/rockettheme/toolbox/blob/develop/StreamWrapper/src/StreamInterface.php) interface class.

By default, streams have been configured like this:

* `user://` - user folder. e.g. `user/`
* `page://` - pages folder. e.g. `user://pages/`
* `image://` - images folder. e.g. `user://images/`, `system://images/`
* `account://` - accounts folder. e.g. `user://accounts/`
* `environment://` - current multi-site location.
* `asset://` - compiled JS/CSS folder. e.g. `assets/`
* `blueprints://` - blueprints folder. e.g. `environment://blueprints/`, `user://blueprints/`, `system://blueprints/`
* `config://` - configuration folder. e.g. `environment://config/`, `user://config/`, `system://config/`
* `plugins://` - plugins folder.  e.g. `user://plugins/`
* `themes://` - current theme.  e.g. `user://themes/`
* `theme://` - current theme.  e.g. `themes://antimatter/`
* `languages://` - languages folder. e.g. `environment://languages/`, `user://languages/`, `system://languages/`
* `user-data://` - data folder.  e.g. `user/data/`
* `system://` - system folder. e.g. `system/`
* `cache://` - cache folder. e.g. `cache/`, `images/`
* `log://` - log folder. e.g. `logs/`
* `backup://` - backup folder. e.g. `backups/`
* `tmp://` - temporary folder. e.g. `tmp/`

Mapping physical directories to a logical device can be done in two ways, either by setting up `paths` or `prefixes`. The former can be understood as a 1-to-1 mapping, whereas the latter (as the name suggests) allows you to combine several physical paths into one logical stream. Let's say you want to register a stream with the name "image". You can then with the stream `images://` list with

[prism classes="language-php line-numbers"]
'image' => [
    'type' => 'ReadOnlyStream',
    'paths' => [
        'user/images',
        'system/images'
    ]
];
[/prism]

all images located in the folders `user/images` and `system/images`. For **prefixes** consider the example

[prism classes="language-php line-numbers"]
'cache' => [
    'type' => 'Stream',
    'prefixes' => [
        '' => ['cache'],
        'images' => ['images']
    ]
];
[/prism]

In this case `cache://` resolves to `cache`, but `cache://images` resolves to `images`.

Last but not least, streams can be used in other streams. For example, provided a stream `user` and a stream `system` exists, the above "image" stream can also be written as

[prism classes="language-php line-numbers"]
'image' => [
    'type' => 'ReadOnlyStream',
    'paths' => [
        'user://images',
        'system://images'
    ]
];

[/prism]

[version=17]
### Server Based Multi-Site Configuration

Grav 1.7 adds support to customize initial environment from your server configuration.

This feature comes handy if you want to use for example docker containers and you want to make them independent of the domain you happen to use. Or if do not want to store secrets in the configuration, but to store them in your server setup.

The following environment variables can be used to customize the default paths which Grav uses to setup the environment. After initialization the streams may point to different location.

!!! **Note:** You can use either environment variables or PHP constants, but they need to be set before Grav runs.

[div class="table-keycol"]
| Variable | Default | Description |
| -------- | ------- | ----------- |
| **GRAV_SETUP_PATH** | AUTO DETECT | A custom path to `setup.php` file including the filename. By default Grav looks the file from `GRAV_ROOT/setup.php` and `GRAV_ROOT/GRAV_USER_PATH/setup.php`. |
| **GRAV_USER_PATH** | `user` | A relative path for `user://` stream. |
| **GRAV_CACHE_PATH** | `cache` | A relative path for `cache://` stream. |
| **GRAV_LOG_PATH** | `logs` | A relative path for `log://` stream. |
| **GRAV_TMP_PATH** | `tmp` | A relative path for `tmp://` stream. |
| **GRAV_BACKUP_PATH** | `backup` | A relative path for `backup://` stream. |
[/div]

In addition there are variables to customize the environments. Better documentation for these can be found in [Server Based Environment Configuration](/advanced/environment-config#server-based-environment-configuration).

!!! **Note:** These work also from `setup.php` file. You can either make them constants by using `define()` or environment variables with `putenv()`. Constants are preferred over environment variables.

[div class="table-keycol"]
| Variable | Default | Description |
| -------- | ------- | ----------- |
| **GRAV_ENVIRONMENT** | DOMAIN NAME | Environment name. Can be used for example in docker containers to set a custom environment which does not rely domain name, such as `production` and `develop`. |
| **GRAV_ENVIRONMENTS_PATH** | `user://env` | Lookup path for all environments if you do prefer something like `user://sites`. Can be either a stream or relative path from `GRAV_ROOT`. |
| **GRAV_ENVIRONMENT_PATH** | `user://env/ENVIRONMENT` | Sometimes it may be useful to have a custom location for your environment. |
[/div]

#### Server Based Configuration Overrides

If you do not wish to store secret credentials inside the configuration, you can also provide them by using environment variables from your server.

As environmental variables have strict naming requirements (they can only contain A-Z, a-z, 0-9 and _), some tricks are needed to get the configuration overrides to work.

Here is an example of a simple configuration override using YAML format for presentation:

```yaml
GRAV_CONFIG: true                           # If false, the configuration here will be ignored.

GRAV_CONFIG_ALIAS__GITHUB: plugins.github   # Create alias GITHUB='plugins.github' to shorten the variable names below

GRAV_CONFIG__GITHUB__auth__method: api      # Override config.plugins.github.auth.method = api
GRAV_CONFIG__GITHUB__auth__token: xxxxxxxx  # Override config.plugins.github.auth.token = xxxxxxxx
```

In above example `__` (double underscore) represents nested variable, which in twig is represented with `.` (dot).

You can also use environment variables in `setup.php`. This allows you for example to store secrets outside the configuration:

`user/setup.php`:
```php
<?php

// Use following environment variables in your server configuration:
//
// DYNAMODB_SESSION_KEY: DynamoDb server key for the PHP session storage
// DYNAMODB_SESSION_SECRET: DynamoDb server secret
// DYNAMODB_SESSION_REGION: DynamoDb server region
// GOOGLE_MAPS_KEY: Google Maps secret key

return [
    'plugins' => [
        // This plugin does not exist
        'dynamodb_session' => [
            'credentials' => [
                'key' => getenv('DYNAMODB_SESSION_KEY') ?: null,
                'secret' => getenv('DYNAMODB_SESSION_SECRET') ?: null
            ],
            'region' => getenv('DYNAMODB_SESSION_REGION') ?: null
        ],
        // This plugin does not exist
        'google_maps' => [
            'key' => getenv('GOOGLE_MAPS_KEY') ?: null
        ]
    ]
];
```

!! **WARNING:** `setup.php` is used to set initial configuration. If the plugin or your configuration later override these settings, the initial values get lost.

After defining the variables in `setup.php`, you can then set those in your server:

[ui-tabs]
[ui-tab title="Apache 2"]
[prism classes="language-apacheconf line-numbers"]
<VirtualHost 127.0.0.1:80>
    ...

    SetEnv GRAV_SETUP_PATH         user/setup.php
    SetEnv GRAV_ENVIRONMENT        production
    SetEnv DYNAMODB_SESSION_KEY    JBGARDQ06UNJV00DL0R9
    SetEnv DYNAMODB_SESSION_SECRET CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    SetEnv DYNAMODB_SESSION_REGION us-east-1
    SetEnv GOOGLE_MAPS_KEY         XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
</VirtualHost>
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-fpm"]
[prism classes="language-nginx line-numbers"]
location / {
    ...

    fastcgi_param GRAV_SETUP_PATH         user/setup.php;
    fastcgi_param GRAV_ENVIRONMENT        production;
    fastcgi_param DYNAMODB_SESSION_KEY    JBGARDQ06UNJV00DL0R9;
    fastcgi_param DYNAMODB_SESSION_SECRET CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7;
    fastcgi_param DYNAMODB_SESSION_REGION us-east-1;
    fastcgi_param GOOGLE_MAPS_KEY         XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp;
}
[/prism]
[/ui-tab]
[ui-tab title="NGINX php-cgi"]
[prism classes="language-nginx line-numbers"]
location / {
...

    env[GRAV_SETUP_PATH]          = user/setup.php
    env[GRAV_ENVIRONMENT]         = production
    env[DYNAMODB_SESSION_KEY]     = JBGARDQ06UNJV00DL0R9
    env[DYNAMODB_SESSION_SECRET]  = CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    env[GDYNAMODB_SESSION_REGION] = us-east-1
    env[GGOOGLE_MAPS_KEY]         = XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
}
[/prism]
[/ui-tab]
[ui-tab title="Docker"]
[prism classes="language-yaml line-numbers"]
web:
  environment:
    - GRAV_SETUP_PATH=user/setup.php
    - GRAV_ENVIRONMENT=production
    - DYNAMODB_SESSION_KEY=JBGARDQ06UNJV00DL0R9
    - DYNAMODB_SESSION_SECRET=CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7
    - DYNAMODB_SESSION_REGION=us-east-1
    - GOOGLE_MAPS_KEY=XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp
[/prism]
[/ui-tab]
[ui-tab title="PHP"]
[prism classes="language-php line-numbers"]
putenv('GRAV_SETUP_PATH', 'user/setup.php');
putenv('GRAV_ENVIRONMENT', 'production');
putenv('DYNAMODB_SESSION_KEY', 'JBGARDQ06UNJV00DL0R9');
putenv('DYNAMODB_SESSION_SECRET', 'CVjwH+QkfnPhKgVvJvrG24s0ABi343cJ7WTPxvb7');
putenv('DYNAMODB_SESSION_REGION', 'us-east-1');
putenv('GOOGLE_MAPS_KEY', 'XWIozB2R2GmYInTqZ6jnKuUrdELounUb4BIxYmp');
[/prism]
[/ui-tab]
[/ui-tabs]

In this example, server will also use `production` environment stored in `user/env/production` folder.

[/version]

---

## docs

> Path: grav-learn/pages/08.advanced/06.plugin-prioritization/docs.md


When multiple plugins listen to the same event hooks (see the [Plugins > Event Hooks page for details](../../plugins/event-hooks)), the various handlers are executed in order of "priority." Priority is simply a number. The higher the number, the earlier the handler will execute.

In rare cases, users may need to tweak the priorities of certain handlers. This can be done without touching the original plugin code.

First determine precisely which handlers need to be tweaked and how. This is an advanced task that requires that you be able to read the plugin's `.php` file. Normally the event hooks, handler functions, and default priorities can be found in a plugin's `onPluginsInitialized()` function.

Then create the file `user/config/priorities.yaml`. The data should be structured as follows:

```yaml
pluginName:
    eventName:
        handlerName: [integer]
```

So for example, let's say you have a plugin called `essential` that listens to the `onPageInitialized` event, triggering the function `handlePage` with a priority of 0. Let's then say you discover that you need that priority to be `100` to make sure it executes *before* some other plugin. You would add the following to your `user/config/priorities.yaml` file:

```yaml
essential:
    onPageInitialized:
        handlePage: 100
```

---

## Installation

> Path: grav-learn/pages/08.advanced/06.scheduler/docs.16.md


The Grav scheduler is a new feature that was added in Grav 1.6 that allows jobs to be run on a periodic basis.  The underlying processing relies on the server's **cron** scheduler, but once a single entry has been added to the cron service, all jobs and specific schedules can be configured via Grav.

One of the main advantages of utilizing the scheduler to handle tasks is that they can be performed without any user interaction and independently of the front end.  Tasks such as periodic cache clearing, backups, synchronization, search indexing, etc., are all prime candidates for scheduled jobs.

## Installation

The first step in getting the scheduler setup and ready for tasks, is to add the `bin/grav scheduler` command to the cron service.  The simplest approach is to utilize the CLI command itself to output the appropriate command to run for installation:

[prism classes="language-bash command-line" highlight="10" cl-output="2-10"]
$ bin/grav scheduler -i

Install Scheduler
=================

 [ERROR] You still need to set up Grav's Scheduler in your crontab

 ! [NOTE] To install, run the following command from your terminal:

 (crontab -l; echo "* * * * * cd /Users/andym/grav;/usr/local/bin/php bin/grav scheduler 1>> /dev/null 2>&1") | crontab -
[/prism]

On my mac system, the full command required is displayed, so all you need to do is to copy and paste the entire then into your terminal and hit return.

!! You need to be logged in to the shell with the same user as your webserver.  This is to ensure that the user that runs the schdeduler commands matches the webserver user that needs to interact with those files.  If you install the crontab entry with another user (e.g. `root`) any files created will be created as that `root` user and not the `webserver` user which can lead to problems.

[prism classes="language-bash command-line"]
(crontab -l; echo "* * * * * cd /Users/andym/grav;/usr/local/bin/php bin/grav scheduler 1>> /dev/null 2>&1") | crontab -
[/prism]

 You won't get a response, but you should not get any errors either.  After that you can confirm things look good by re-running the `bin/grav scheduler -i` command:

[prism classes="language-bash command-line" cl-output="2-10"]
bin/grav scheduler -i

Install Scheduler
=================

 [OK] All Ready! You have already set up Grav's Scheduler in your crontab
[/prism]

You can also get the needed command from the admin plugin by simply navigating to **Tools**  **Scheduler**.

## Scheduling Basics

In order to schedule a job the frequency is controlled by a flexible format.

[prism classes="language-text"]
* * * * * *
| | | | | |
| | | | | +-- Year              (range: 1900-3000)
| | | | +---- Day of the Week   (range: 1-7, 1 standing for Monday)
| | | +------ Month of the Year (range: 1-12)
| | +-------- Day of the Month  (range: 1-31)
| +---------- Hour              (range: 0-23)
+------------ Minute            (range: 0-59)
[/prism]

Some examples:

`0 * * * *`	run once an hour (every hour at minute zero)
`0 0 * * *`	run once a day (every day at midnight and minute zero)
`0 0 1 * *`	run once a month (on the first day of every month at midnight and minute zero)
`0 0 1 1 *`	run once a year (on the first day of the first month every year at midnight and minute zero)

Advanced options:

`*/5 * * * *` run every 5 minutes



## Configuration File

You can see which jobs are currently available to the Scheduler  by running the `bin/grav scheduler -j` command:

[prism classes="language-bash command-line" cl-output="2-16"]
bin/grav scheduler -j

Scheduler Jobs Listing
======================


 Job ID               Command                             Run At     Status   Last Run          State   

 cache-purge          Grav\Common\Cache::purgeJob         * * * * *  Success  2019-02-21 11:23  Enabled 
 cache-clear          Grav\Common\Cache::clearJob         * * * * *  Success  2019-02-21 11:23  Enabled 
 default-site-backup  Grav\Common\Backup\Backups::backup  0 3 * * *  Ready    Never             Enabled 
 pages-backup         Grav\Common\Backup\Backups::backup  * 3 * * *  Success  2018-09-20 09:55  Enabled 
 ls-job               ls                                  * * * * *  Success  2019-02-21 11:23  Enabled 


 ! [NOTE] For error details run "bin/grav scheduler -d"
[/prism]

The Grav scheduler is controlled by a primary configuration file.  This is located in `user/config/scheduler.yaml` and is required to have any job `enabled` in order to run.

Below the configruation shows the jobs that are available and if they are enabled to run or not.  Simply set an entry to `disabled` to stop it from running.

[prism classes="language-yaml line-numbers"]
status:
  ls-job: enabled
  cache-purge: enabled
  cache-clear: enabled
  default-site-backup: enabled
  pages-backup: enabled
[/prism]

To see more details about any potential **errors** or to see the next time the job will run you can use the `/bin/grav scheduler -d` command:

[prism classes="language-bash command-line" cl-output="2-14"]
bin/grav scheduler -d

Job Details
===========


 Job ID               Last Run          Next Run          Errors 

 cache-purge          2019-02-21 11:29  2019-02-21 11:31  None   
 cache-clear          2019-02-21 11:29  2019-02-21 11:31  None   
 default-site-backup  Never             2019-02-22 03:00  None   
 pages-backup         2018-09-20 09:55  2019-02-22 03:00  None   
 ls-job               2019-02-21 11:29  2019-02-21 11:31  None   

[/prism]

## Manually Running Jobs

The CLI command provides an simple way to manually run any jobs.  In fact this is what the scheduler is doing when it runs periodically.

[prism classes="language-bash command-line"]
bin/grav scheduler
[/prism]

This will silently run the jobs, but you can also see details of what run using:

[prism classes="language-bash command-line"]
bin/grav scheduler -v
[/prism]

## Grav System Jobs

The Grav core provides a few jobs out-of-the-box.  These include some useful maintenance type tasks:

* `cache-purge` - This task is useful if you use Grav's `file` caching because it clears out old files that have expired.  This is a great task to schedule as otherwise it would require a user to manually clear the old caches.  If you don't keep up on this, and your file space is limited, you could run out of space and crash the server.

* `cache-clear` - The cache clear is the job that works the same way as the `bin/grav clear` command that you would manually run.  You can configure if you want to use a `standard` cache clearing, or the `all` variant that deletes all the files and folders in the `cache/` folder for a more thorough cache clearing.

* `default-site-backup` - The default backup job available via the new Grav Backup configuration.  You can create custom backup configurations, and these will also be available to run as a scheduled job.

## Custom Jobs

The Grav Scheduler can be manually configured with any number of custom jobs.  These can be setup in the same `scheduler.yaml` configuration file referenced above.  For example, the `ls-job` referenced above would be configured:

[prism classes="language-yaml line-numbers"]
custom_jobs:
  ls-job:
    command: ls
    args: '-lah'
    at: '* * * * *'
    output: logs/cron-ls.out
    output_mode: overwrite
    email: user@email.com
[/prism]

The command should be any local script that can be run from the command line/terminal.  Only the `command` and the `at` attributes are required.

## Plugin-provided Jobs

One of the most powerful feature of the Grav Scheduler, is the ability for 3rd party plugins to provide their own jobs.  A great example of this is provided by the `TNTSearch` plugin.  TNTSearch is a full-featured text search engine that requires content to be indexed before it can be searched.  This indexing job can be performed in a variety of ways, but the Grav Scheduler allows you to reindex your content periodically rather than having to do so manually.

The first step is for your plugin to subscribe to the `onSchedulerInitialized()` event.  And then create a method in your plugin file that can add a custom job when called:

[prism classes="language-php line-numbers"]
public function onSchedulerInitialized(Event $e): void
{
    $config = $this->config();

    if (!empty($config['scheduled_index']['enabled'])) {
        $scheduler = $e['scheduler'];
        $at = $config['scheduled_index']['at'] ?? '* * * * *';
        $logs = $config['scheduled_index']['logs'] ?? '';
        $job = $scheduler->addFunction('Grav\Plugin\TNTSearchPlugin::indexJob', [], 'tntsearch-index');
        $job->at($at);
        $job->output($logs);
        $job->backlink('/plugins/tntsearch');
    }
}
[/prism]

Here, you can see how some relevant scheduler configuration is obtained from the TNTSearch plugin's configuration settings, and then a new `Job` is created with a **static** function called `indexJob()`.










---

## Configuration

> Path: grav-learn/pages/08.advanced/07.backups/docs.16.md


The backup system in Grav has been completely rewritten for Grav 1.6 to provide more features and functionality. The improvements include:

* Integration into the new Grav [Scheduler](../scheduler) to allow for offline backups to run whenever you wish
* Ability to create multiple backup **profiles** each with their own set of files, exclude path and file rules, and schedule configuration
* New **auto-purge** options based on `number`, `space`, or `time`.
* New dedicated backups page in the **Tools** section of the admin plugin.

## Configuration

For backwards compatibility, the default configuration mimics the system prior to Grav 1.6, however, it does now have a 5GB limit by default for backup space.  You should copy the default configuration file (`system/config/backups.yaml`) to your `user/config/

!! If you use the **admin plugin**, and save the configuration, the `user/config/backups.yaml` file will be created automatically.

The default configuration is as follows:

[prism classes="language-yaml line-numbers"]
purge:
    trigger: space
    max_backups_count: 25
    max_backups_space: 5
    max_backups_time: 365

profiles:
  -
    name: 'Default Site Backup'
    root: '/'
    schedule: false
    schedule_at: '0 3 * * *'
    exclude_paths: "/backup\r\n/cache\r\n/images\r\n/logs\r\n/tmp"
    exclude_files: ".DS_Store\r\n.git\r\n.svn\r\n.hg\r\n.idea\r\n.vscode\r\nnode_modules"
[/prism]

#### Purge

* `space` - will purge older backups when you hit the space limit. Controlled by `max_backups_space` measured in `GB`
* `time` - will purge older backups beyond a number of day. Controlled by `max_backups_time`  measured in `days`
* `number` - will purge older backups beyond a certain number of backups. Controlled by `max_backups_count`.

#### Profiles

An array of profiles can be configured.  The `Default Site Backup` profile is configured similarly to the default Grav backup in previous versions.  By default, the backup is not automatically processed by the scheduler, but you can set `schedule: true` and configure the `schedule_at:` option with a preferred [cron expression](https://crontab.guru/).

An example of a more complex set of profiles could be:

[prism classes="language-yaml line-numbers"]
profiles:
  -
    name: 'Default Site Backup'
    root: /
    exclude_paths: "/backup\r\n/cache\r\n/images\r\n/logs\r\n/tmp"
    exclude_files: ".DS_Store\r\n.git\r\n.svn\r\n.hg\r\n.idea\r\n.vscode\r\nnode_modules"
    schedule: true
    schedule_at: '0 4 * * *'
  -
    name: 'Pages Backup'
    root: 'page://'
    exclude_files: .git
    schedule: true
    schedule_at: '* 3 * * *'
[/prism]

## CLI Command

This is covered in more details in the [Cli Console -> Grav Command](/cli-console/grav-cli) section, but here's an example of running the backup manually:

[prism classes="language-bash command-line" cl-output="3-13"]
cd ~/workspace/portfolio
bin/grav backup

Grav Backup
===========

Choose a backup?
  [0] Default Site Backup
  [1] Pages Backup

Archiving 36 files [===================================================] 100% < 1 sec Done...

 [OK] Backup Successfully Created: /users/joe/workspace/portfolio/backup/pages_backup--20190227120510.zip
[/prism]


---

## Preparations

> Path: grav-learn/pages/08.advanced/09.grav-development/01.grav-15-upgrade-guide/docs.md


!!! This guide has been tested for Grav v1.2.0 and all the later versions.

!! **WARNING**: Upgrading Grav directly to the latest version works, but is not fully supported and will likely cause your site to break!

## Preparations

The easiest way to upgrade older versions of Grav is to create a copy of your site into a Linux/Unix server which has **PHP 7.3** installed and supports SSH login to access CLI commands. This guide also works with Linux subsystem for Windows 10, but if you do not have it installed, you may have to download and rename the update packages manually.

**PHP 7.3** was chosen because of it is the only version of PHP which can be used for all the versions of Grav. You may also use PHP 7.1 or 7.2, but going that only allows you to upgrade Grav up to v1.6.31. At that point you would need to switch to PHP 7.3 or 7.4 before continuing the upgrade process. PHP 8 should only be used after upgrading to Grav 1.7 or later version.

This guide includes instructions to upgrade **Grav**, and the most commonly used packages: **Problems**, **Error**, **Form**, **Email**, **Login** and **Admin**. For every other plugin, make sure that they are still maintained and that it supports both Grav 1.6 and the latest version of Grav. As of writing this guide, almost all actively maintained plugins should fit into this category. The safest plugins are those, which have been updated after Grav 1.7.0 release (01/18/2021) or have been confirmed to work in Grav 1.7.

Your **theme** and any **custom** or **unmaintained plugins** will need more work. Any custom code should be checked through to make sure it still works with the current versions of Grav and PHP. The same is true with **Markdown**, **YAML** and **twig** files as the latter versions of the libraries have fixes which catch the errors, usually meaning that parsing of broken files will fail. Newer versions of Grav provide tools to check these files, but the checks do not catch all the issues, so some testing is also needed.

Checklist (using a console and Grav CLI):

* Take a backup
* Figure out Grav version by `bin/gpm version grav`
* Check PHP CLI version by `php -v`, it should be **PHP 7.3** (>=7.3.6)
* Check PHP server version, it should be the same as in CLI
* List all installed plugins and categorize them (supported, custom, unmaintained)
* Do the same with your theme

## Step to Grav 1.6.31

This part assumes that you have already made a copy of your site and the CLI commands work. Windows users who do not have Linux subsystem installed need to download the files manually and rename them.

Perform the following commands in the root folder of your Grav site (omit `-y` parameter in GPM command if you're using Grav 1.2 or below):

[prism classes="language-bash command-line"]
wget -q https://getgrav.org/download/core/grav-update/1.6.31 -O tmp/grav-update-v1.6.31.zip

bin/gpm direct-install -y tmp/grav-update-v1.6.31.zip
[/prism]

Grav can also be updated manually. Delete following folders: `assets bin system vendor  webserver-configs` and copy/override **all** the files from the Grav update zip file [found from here](https://getgrav.org/download/core/grav-update/1.6.31). Note that the files in the zip file are inside a `grav-update` folder.

Next we need to update the base plugins.

[prism classes="language-bash command-line"]
wget -q https://getgrav.org/download/plugins/problems/2.0.3 -O tmp/grav-plugin-problems-v2.0.3.zip
wget -q https://getgrav.org/download/plugins/error/1.7.1 -O tmp/grav-plugin-error-v1.7.1.zip
wget -q https://getgrav.org/download/plugins/form/4.3.0 -O tmp/grav-plugin-form-v4.3.0.zip
wget -q https://getgrav.org/download/plugins/email/3.1.0 -O tmp/grav-plugin-email-v3.1.0.zip
wget -q https://getgrav.org/download/plugins/login/3.3.8 -O tmp/grav-plugin-login-v3.3.8.zip
wget -q https://getgrav.org/download/plugins/admin/1.9.19 -O tmp/grav-plugin-admin-v1.9.19.zip


bin/gpm direct-install -y tmp/grav-plugin-problems-v2.0.3.zip
bin/gpm direct-install -y tmp/grav-plugin-error-v1.7.1.zip
bin/gpm direct-install -y tmp/grav-plugin-form-v4.3.0.zip
bin/gpm direct-install -y tmp/grav-plugin-email-v3.1.0.zip
bin/gpm direct-install -y tmp/grav-plugin-login-v3.3.8.zip
bin/gpm direct-install -y tmp/grav-plugin-admin-v1.9.19.zip
[/prism]

Alternatively plugins can be installed manually by just deleting all the files in `user/plugins/pluginnname` and copying files back from the zip file. Note that the files in the zip file are inside a semi-randomly named folder.

## Upgrading to Grav 1.7

Run following CLI commands one by one and follow their instructions:

[prism classes="language-bash command-line"]
bin/gpm self-upgrade
bin/gpm update
[/prism]

You may also want to update other plugins one by one to the latest version, but please do it only if the latest version of the plugin supports Grav 1.6. Rest of the plugins should be disabled if you are not sure if they will work. They can be re-enabled later, when you are testing the site.



!!! If you do not have broken plugins, Administration Panel and the site should be fully operational at this point.

!! **WARNING**: Avoid upgrading Grav or Admin plugin any further before you have read **[Upgrading to Grav 1.7](/advanced/grav-development/grav-17-upgrade-guide)**. You may end up breaking both your site and Admin Panel.


---

## Deprecated Debug Bar Tab

> Path: grav-learn/pages/08.advanced/09.grav-development/02.grav-16-upgrade-guide/docs.md


Grav 1.6 is the largest update since the initial release of Grav. It introduces a few new features, improvements, bug fixes and provides many architectural changes which pave the road towards Grav 2.0.

!!!! **IMPORTANT:** For most people, Grav 1.6 should be a simple upgrade without any issues, but like any upgrade, it is recommended to **take a backup** of your site and **test the upgrade in a testing environment** before upgrading your live site.

Whether you are a developer or administrator of your site, your test site should have [Debug Bar](/advanced/debugging#debug-bar) enabled. This is because of Debug Bar has some useful tools which help you to ensure your site will be better prepared to run on later versions of Grav.

!!! **TIP:** For more information how to enable the feature, please see [Debugging & Logging](https://learn.getgrav.org/16/advanced/debugging) section in the documentation.

## Deprecated Debug Bar Tab

For our purposes, we are looking **Deprecated** tab in the Debug Bar, which allows you to identify deprecated issues and fix or report them before upgrading to later Grav versions. Fixing the issues found in the **Deprecated** tab will help you to make your site faster and save you time when it is time to during future upgrades.

![Deprecated Tab](deprecated-tab.png?classes=shadow)

! **NOTE:** that **Deprecated** tab shows up only if deprecated calls are detected in the page

To make sure that you catch all the issues, you should either clear the cache and run Grav with caching disabled to maximize the chance you will catch all the errors. Even by following these steps, you may notice that some of the YAML/Twig errors appear only after clearing the cache.

The **Deprecated** tab contains a list of deprecated features which were found. Every issue is clickable and opens up deprecation message, which has a short explanation from the issue as well as trace back, which allows you to locate and fix the code. In the right side you can see type of the deprecated error and in lower right corner you can filter the displayed types by clicking on the badges.

When you open up the deprecation message, the content may first feel overwhelming. But in most cases you can ignore most of the content and just read the first few lines: message, file and line (if available).

There are a few types of deprecation issues:

* `yaml`: YAML or Markdown file uses deprecated YAML syntax.
* `twig`: Twig file contains deprecated Twig syntax or there was another Twig related issue.
* `grav`: Something is calling deprecated Grav method or using deprecated property.
* `vendor`: Something is using deprecated 3rd party library code.
* `unknown`: Unknown deprecated message.

## YAML Parsing

! **NOTE:** In Grav 1.6 YAML has stricter parsing with a fallback for backwards compatibility

Grav 1.6 uses a **Symfony 4.2 YAML parser**, which follows the [YAML standard specification](https://yaml.org/spec?target=_blank) much more closely than the previously parser from Symfony **3.4**. This means that YAML files which previously worked just fine, may cause errors resulting from being invalid YAML. However, if the file fails to load with the new **4.2** version of the parser, Grav will by default still fall back to the older **3.4** version of the parser to keep your site up and running. However this will decrease the performance of the site and you should catch and fix the issues to ensure optimal performance.

! **NOTE:** This backwards compatibility fallback mechanism will be removed in Grav 2.0

**Grav 1.6.7** and all later versions have a new CLI command to detect YAML parsing issues, please run `bin/grav yamllinter` to find and fix any YAML parsing errors in your site. It is recommended to run this command right after upgrading to Grav 1.6 or later version.

**Admin 1.9.3** and all later versions have **YAML Linter** integrated to **Tools** > **Reports**, if you prefer using it instead of the CLI command.

##### Look for these YAML errors:

- Do not use `@`, `\`, `|`, `%` and `>` at the beginning of an unquoted string: do not use `@data-options: []`, use `data-options@: []` instead.
- Always add whitespace after a colon `:` for the keys: do not use `key:value`, use `key: value` instead.
- Always quote `null`, `true`, `false`, `2.0` (floats) in keys; keys can only be either integers or strings.
- Also quote `null`, `true`, `false`, `2` and `2.0` in values if they are meant to be strings.
- When surrounding strings with double-quotes, you must now escape `\` characters.

Also the Debug Bar can be used to spot any deprecated YAML. Just open the Debug Bar and look at the **Deprecated** tab. If the tab cannot be found, no issues were detected.

!!! **TIP:** You can filter any **YAML** issues by looking at the **badges in the bottom-right corner** of the Debug Bar. Simply filter to only show **YAML** issues by clicking the other buttons to disable them.

! **NOTE:** YAML errors require you to clear cache the errors will only be picked up when the YAML files are decoded.

### YAML Compatibility Mode

By default, YAML Compatibility Mode has been turned on in Grav 1.6. This will allow older sites to keep on working after upgrade, but it is not ideal to be used in new sites or if you have already fixed and tested your site against all YAML parsing errors.

You can change this setting in `user/config/system.yaml`:

[prism classes="language-yaml line-numbers"]
strict_mode:
  yaml_compat: false
[/prism]

Our recommendation is not to touch this setting on existing sites just yet, rather you should create test sites with compatibility mode **false**. Also any new site made with Grav 1.6 or later should have compatibility mode turned off during development as it allows you to save a lot of time when it is time to upgrade to Grav 2.0.

## Twig

### Deferred Blocks

You should update your theme to version that add support for deferred asset blocks to provide full Grav 1.6 support. Alternatively, if you have a custom modified theme or developed your own, you should update it yourself in order to ensure that it keeps working with the new features and later versions of Grav and its plugins by following the guide in the [Important Theme Updates](https://getgrav.org/blog/important-theme-updates) blog post.

### Deprecated Twig

Grav 2.0 will be using **Twig 2** instead of Twig 1 that is currently used in the Grav 1.x releases. There are a few deprecated features which have been removed in Twig 2, which is why you should make sure that you catch and fix all of those issues before upgrading to Grav 2.0 down the road.

The Debug Bar can be used to spot any deprecated Twig issues. Just open the Debug Bar and click on the **Deprecated** tab.

##### Look for these Twig issues:

- Macros imported in a file will not be available in child templates anymore (via an include call for instance). You need to import macros explicitly in each file where you are using them.
- Filter `|replace()` will only work with associated array as the parameter: `{ "I like this and that."|replace({'this': 'foo', 'that': 'bar'}) }}`.
- Test `sameas()` should now be written as `same as()`.

More information of what has been deprecated [can be found here](https://twig.symfony.com/doc/1.x/deprecated.html?target=_blank).

### Auto-Escaping

Grav has been rather safe from vulnerabilities, except from XSS attacks, which can be triggered without much effort on any code which does not properly escape untrusted input from a user. Twig is an easy way to write template files, but at the same time it is too easy to forget that most of the variables which are used in the template files are not sanitized before being used. Even if they are filtered and safe, they may contain special characters which should be escaped to make the HTML code valid.

For example you may have a Twig template like this:

[prism classes="language-twig line-numbers"]
{% set my_string = '<script>echo("hello there!");<script>' %}
<p>
    {{ my_string }}
</p>
[/prism]

By default Grav has **Twig auto-escaping turned off** for simplicity and clarity of templates, but unfortunately this was a poor decision because nobody, including us, remembers to always escape variables which either may contain special characters or are coming from an untrusted source. To make the things worse, it is usually not known if the variable is HTML-safe or not. To make sure that a site is protected from most XSS vulnerabilities, you should enable auto-escaping in your configuration. Unfortunately themes and plugins that utilize Twig templates tend to not work with the setting turned on -- and templates written without explicit escaping are most likely vulnerable to malicious content.

With the example above, as auto-escaping is disabled, the output will render as pure HTML, and an alert box with `"hello there!"` will popup.  However, this should be escaped using the `|e` Twig escape filter (or `|e('html')`:

[prism classes="language-twig line-numbers"]
{% set my_string = '<script>echo("hello there!");<script>' %}
<p>
    {{ my_string|e }}
</p>
[/prism]

Because of most people tend to forget to escape the variables in Twig and because using `|e` everywhere can make the template files harder to read, there is a new setting in `user/config/system.yaml`:


[prism classes="language-yaml line-numbers"]
strict_mode:
  twig_compat: false
[/prism]

This setting forces `auto-escaping` to be turned on in all Twig template files and disables the old setting to turn it on and off. The side effect of the setting is that your site will likely contain a few escaped pieces of content, which you will need to fix by using `|raw` filter for all the content which needs to contain HTML and HTML only. Many templates and plugins have not yet been updated to work with escaping forced on, so please report of any bugs in those to allow them to be fixed in a timely manner.

The transition to use auto-escaping will not be easy. During the transition all the template files should either contain both `|e` and `|raw` filters on every variable to make sure that the template file is safe to be used in both modes, or you can surround all the template code with `{% autoescape %}` Twig tags.

See [Twig Manual](https://twig.symfony.com/doc/1.x/tags/autoescape.html) for more information.

---

## Most Common Issues

> Path: grav-learn/pages/08.advanced/09.grav-development/03.grav-17-upgrade-guide/docs.md


Grav 1.7 introduces a few new features, improvements, bug fixes and provides many architectural changes which pave the road towards Grav 2.0. Here are a few highlights:

* **Flex Objects**: A new way to build your own data types.
* **Symfony Server**: Run Grav without needing to install web server.
* **Improved Multi-Language**: Better language fallbacks, improved admin support.
* **Improved Multi-Site**: Admin has improved multi-site support.
* **Improved Admin ACL**: Full CRUD support for users and pages.
* **Improved Media Support**: Support `webp` image format, lazy loading and more.
* **Improved Caching**: New `{% cache %}` tag and improved performance especially in admin.
* **XSS Detection in Forms**: Forms will not submit if potential XSS is detected in them. Check the [documentation](/forms/forms/form-options#xss-checks) on how to disable the checks.
* **Better Debugging Tools**: [Clockwork](https://underground.works/clockwork/) integration, Twig profiling and support for [Tideways XHProf](https://github.com/tideways/php-xhprof-extension) PHP Extension for performance profiling.

!!!! **IMPORTANT:** For most people, Grav 1.7 should be a simple upgrade without any issues, but like any upgrade, it is recommended to **take a backup** of your site and **test the upgrade in a testing environment** before upgrading your live site.

### Most Common Issues

1.  ###### HTML is displayed as **code** on your site rather than being **rendered** as HTML as intended.
    This behavior is a result of the new default of **auto-escaping** being true in Grav 1.7.  This is a security enhancement, and if you are upgrading from a version prior to 1.7, we automatically enable **Twig Compatibility** setting in the system configuration to ensure your old Twig code will continue to function.  If you manually update to 1.7 or upgrade in any way that does not go through the GPM self upgrade process, you should set this setting yourself.

    Check out the [Twig section](#twig) of this guide for full details...

2.  ###### Getting errors about invalid YAML.
    As we have upgraded to a newer version of Symfony framework, the YAML parser is stricter than it was in versions prior to 1.7.  To handle this we have included an older version of the parser that is available when enabling **Yaml Compatibility**.  This is automatically handled for you if you upgrade to Grav 1.7 via GPM, but if you have upgraded manually, you will need to set this value yourself.

    Check out the [YAML section](#yaml) of this guide for full details...

3. ###### Admin showing up with untranslated strings

   If your admin is displaying with untranslated strings in the interface, it's most likely because you have previously disabled **Language Translations**.  This was buggy in previous versions of Grav and disabling it, didn't actually disable translations throughout the admin as intended.  This is **fixed** in Grav 1.7 and this setting is doing what it is intended to do, show the translation codes in uppercase rather than the translated strings themselves.

   Check out the [Troubleshooting](#troubleshooting-issues) section for the fix.

4. ###### Errors on Saving or Non-functioning Admin plugins
   In Grav 1.7 we introduced **Flex Pages** as the new default page management UI.  Also, to optimize performance, we stopped initializing pages on every admin call.  Switching back to regular **Grav Pages** might temporarily resolve your issue.  This is done by editing the **FlexObjects** plugin and disabling **Pages (Admin)**.

   To properly address the issue, custom plugins should be updated to support both **Grav Pages** and **Flex Pages** by using `PageInterface` and also should explicitly Pages when required.

   Check out the [Pages section](#pages-1) and [Admin Section](#admin) of this guide for full details...

    There have also been some specific plugin issues that have already been discovered. Check out the [Troubleshooting](#troubleshooting-issues) section of this page for specific issues with plugins.

5. ###### Page blueprints stop working or give error about a loop
   **Grav 1.7.8** adds support for defining any **blueprint** in your theme. This means that if you have page blueprints in `blueprints/pages/` folder, standard blueprint locations are used, just like in plugins. Unfortunately some older themes may have a mix of files in `blueprints/` and `blueprint/pages`, which breaks the detection and causes either missing fields in admin when editing the pages or a fatal error: `Loop detected while extending blueprint file`.

   If either of these errors happen, check out the [Troubleshooting](#troubleshooting-issues) section for the fix.

### Quick Update Guide

!! **Grav 1.7** requires **PHP 7.3.6** or later version. The recommended version is the latest **PHP 7.4** release.

### YAML

!!!! **IMPORTANT:** Grav 1.7 YAML parser is more strict and your site may break if you have syntax errors in your configuration files or page headers. However, if you update your existing site using `bin/gpm` or `Admin Plugin` upgrade process keeps most of the broken YAML syntax working.

To revert to the old behavior you need to make sure you have following setting in `user/config/system.yaml`:

```yaml
strict_mode:
  yaml_compat: true
```

or in Admin under **Configuration**  **Advanced** -> **YAML Compatibility**

![Yaml Compatibility](yaml-compat.png?classes=shadow)

!!! **TIP:** **Grav 1.6 Upgrade Guide** has a dedicated **[YAML Parsing](/advanced/grav-development/grav-16-upgrade-guide#yaml-parsing)** section to help you to fix these issues.

By default, Grav 1.7 uses a **Symfony 4.4 YAML parser**, which follows the [YAML standard specification](https://yaml.org/spec?target=_blank) more closely than the older versions of Grav. This means that YAML files which previously worked just fine, may cause errors resulting from being invalid YAML. However, Grav will by default still fall back to the older 3.4 version of the parser to keep your site up and running.

!!! **TIP:** You should run **CLI command** `bin/grav yamllinter` or visit in **Admin** > **Tools** > **Reports** before and after upgrade and fix all the YAML related warnings and errors.

### Twig

!!!! **IMPORTANT:** Grav 1.7 enables **Twig Auto-Escaping** by default. However, if you update your existing site using `bin/gpm` or `Admin Plugin` upgrade process keeps the existing auto-escape settings.

To revert to the old behavior you need to make sure you have following settings in `user/config/system.yaml`:

```yaml
twig:
  autoescape: false
strict_mode:
  twig_compat: true
```

or in Admin under **Configuration**  **Advanced** -> **Twig Compatibility**

And please remember to clear cache after doing this!

![Twig Compatibility](twig-compat.png?classes=shadow)

!!! **TIP:** **Grav 1.6 Upgrade Guide** has a dedicated **[Twig](/advanced/grav-development/grav-16-upgrade-guide#twig)** section. It is very important to read it first!

Twig template engine has been updated to version 1.43, but it also supports Twig 2.13. In order to support this newer version of Twig, you need to update any old syntax in your Twig templates. **Grav 1.6 Upgrade Guide** helps you to do this.

Additional changes in templating are:

* Added a new `{% cache %}` Twig tag eliminating need for `twigcache` extension.
* Added `array_diff()` twig function
* Added `template_from_string()` twig function
* Added a new `svg_image()` twig function to make it easier to 'include' SVG source in Twig
* Improved `url()` twig function to take third parameter (`true`) to return URL on non-existing file instead of returning false
* Improved `|array` twig filter to work with iterators and objects with `toArray()` method
* Improved `authorize()` twig function to work better with nested rule parameters
* Improved `|yaml_serialize` twig filter: added support for `JsonSerializable` objects and other array-like objects
* Added default templates for `external.html.twig`, `default.html.twig`, and `modular.html.twig`
* **BACKWARDS COMPATIBILITY BREAK**: Use `{% script 'file.js' at 'bottom' %}` instead of `in 'bottom'` which is broken

## Forms

!!!! **IMPORTANT:** Grav 1.7 changes the behavior of **Strict Validation**. However, if you update your existing site using `bin/gpm` or `Admin Plugin` upgrade process keeps the existing strict mode behaviour.

**Strict mode Improvements**: Inside forms, declaring `validation: strict` was not as strict as we hoped because of a bug. The strict mode should prevent forms from sending any extra fields and this was fixed into Grav 1.7. Unfortunately many of the old forms declared to be strict even if they had extra data in them.

To revert to the old behavior you need to make sure you have following setting in `user/config/system.yaml`:

```yaml
strict_mode:
  blueprint_compat: true
```

**XSS Injection Detection** is now enabled in all the frontend forms by default. Check the [documentation](/forms/forms/form-options#xss-checks) on how to disable or customize the checks per form and per field.

Because of this, we added new configuration option `system.strict_mode.blueprint_compat: true` to maintain old `validation: strict` behavior. It is recommended to turn off this setting to improve site security, but before doing that, please search through all your forms if you were using `validation: strict` feature. If you were, either remove the line or test if the form still works.

! **NOTE:** This backwards compatibility fallback mechanism will be removed in Grav 2.0

### Environments and Multi-Site

!!!! **Important:** Grav 1.7 moves [environments](/advanced/environment-config) into `user://env` folder. The old location still works, but it is better to move environments into a single location future features may rely on it.

Grav 1.7 also adds support for [Server Based Environment Configuration](/advanced/environment-config#server-based-environment-configuration) and [Server Based Multi-Site Configuration](/advanced/multisite-setup#server-based-multi-site-configuration). This feature comes handy if you want to use for example docker containers and you want to make them independent of the domain you happen to use. Or if do not want to store secrets in the configuration, but to store them in your server setup.

In addition `setup.php` file can now be in either `GRAV_ROOT/setup.php` or `GRAV_ROOT/GRAV_USER_PATH/setup.php`. The second location makes it easier to use environments with git repositories containing only user folder.

### User Accounts

Admin has now new [Accounts Administration](/admin-panel/accounts) using **Flex Users**:

* [User Accounts Manager](/admin-panel/accounts/users)
* [User Groups Manager](/admin-panel/accounts/groups)

!!! **NOTE:** Flex Users feature is not yet used in the frontend of your site.

### Pages

The existing [Pages Administration](/admin-panel/page) has been greatly improved with **Flex Pages**:

* Reworked list view: Far better support for large sites
* Better access control: [CRUD ACL](/admin-panel/page/permissions) support with page owners
* Better multi-language support

!! **BACKWARDS COMPATIBILITY BREAK**: We fixed 404 error page when you go to non-routable page with routable, visible child pages under it. Now you get redirected to the first routable, visible child page instead. This is probably what you wanted in the first place.

!!! **NOTE:** Flex Pages feature is not yet used in the frontend of your site.

### Multi-language

Grav 1.7 changed the behavior of how the multi-language fallbacks work for the pages.

Previously if the page did not exist with the requested language, the old implementation looked up the next supported language. This meant that the untranslated page was always displayed, but the page could be using some unknown language to the reader.

The new behavior is to fall back only to the default language of the site. This default behavior can be overridden by setting fallback languages per language by using `system.languages.content_fallback` configuration option.

If the page does not exist in any of the fallback languages, **404 Not Found** will be displayed instead.

!! **BACKWARDS COMPATIBILITY BREAK**: Please add correct fallback languages for the page content in `system.yaml` or admin: **Configuration** > **System** > **Languages** > **Content Language Fallback**.

### Media

Media handling has been greatly improved in Grav 1.7. Some highlights are:

* Support for `webp` image format
* Markdown: Added support for native `loading=lazy` attributes on images.  Can be set in `system.images.defaults` or per md image with `?loading=lazy`
* Added ability to `noprocess` specific items only in Link/Image Excerpts, e.g. `http://foo.com/page?id=foo&target=_blank&noprocess=id`

### CLI

Some highlights are:

* All CLI commands now accept `--env` and `--lang` parameters to set the environment and the used language respectively (`-e` does not work anymore)
* Added new `bin/grav server` CLI command to easily run Symfony or PHP built-in web servers
* Improved `Scheduler` cron command check and more useful CLI information
* Added new `-r <job-id>` option for Scheduler CLI command to force-run a job
* Improved `bin/grav yamllinter` CLI command by adding an option to find YAML Linting issues from the whole site or custom folder
* CLI/GPM command failures now return non-zero code (allowing error detection if command fails)

### Configuration

Added new configuration option to keep default language in `.md` files if set to `false`
  * system.yaml: `languages.include_default_lang_file_extension`: **true**|false
  * Admin: **Configuration** > **System** > **Languages** > **Include default language in file extension**

Added new configuration option to set fallback content languages individually for every language
  * system.yaml: `languages.content_fallback`: See [Language Configuration](/content/multi-language#language-configuration)
  * Admin: **Configuration** > **System** > **Languages** > **Content Language Fallback**

Added new configuration option to choose between debugbar and clockwork
  * system.yaml: `debugger.provider`: **clockwork**|debugbar
  * Admin: **Configuration** > **System** > **Debugger** > **Debugger Provider**

Added new configuration option to hide potentially sensitive information
  * system.yaml: `debugger.censored`: **false**|true
  * Admin: **Configuration** > **System** > **Debugger** > **Censor Sensitive Data**

Added new configuration option to maintain old `validation: strict` behavior
  * system.yaml: `strict_mode.blueprint_compat`: **true**|false
  * Admin: **Configuration** > **System** > **Advanced** > **Blueprint Compatibility**

Added system configuration support for `HTTP_X_FORWARDED` headers (host disabled by default)
  * system.yaml: `http_x_forwarded.protocol`: **true**|false
  * Admin: **Configuration** > **System** > **Advanced** > **HTTP_X_FORWARDED_PROTO Enabled**
  * system.yaml: `http_x_forwarded.host`: true|**false**
  * Admin: **Configuration** > **System** > **Advanced** > **HTTP_X_FORWARDED_HOST Enabled**
  * system.yaml: `http_x_forwarded.port`: **true**|false
  * Admin: **Configuration** > **System** > **Advanced** > **HTTP_X_FORWARDED_PORT Enabled**
  * system.yaml: `http_x_forwarded.ip`: true|**false**
  * Admin: **Configuration** > **System** > **Advanced** > **HTTP_X_FORWARDED IP Enabled**

Added new configuration option `security.sanitize_svg` to remove potentially dangerous code from SVG files
  * security.yaml: `sanitize_svg`: **true**|false
  * Admin: **Configuration** > **Security** > **Sanitize SVG**

## DEVELOPERS

### Debugging

* Added support for [Clockwork](https://underground.works/clockwork) developer tools (now default debugger)
* Added support for [Tideways XHProf](https://github.com/tideways/php-xhprof-extension) PHP Extension for profiling method calls
* Added Twig profiling for Clockwork debugger

### Use composer autoloader

* Upgraded `bin/composer.phar` to `2.0.2` which is all new and much faster
* Please add `composer.json` file to your plugin and run `composer update --no-dev` (and remember to keep it updated):

    composer.json
    ```json
    {
        "name": "getgrav/grav-plugin-example",
        "type": "grav-plugin",
        "description": "Example plugin for Grav CMS",
        "keywords": ["example", "plugin"],
        "homepage": "https://github.com/getgrav/grav-plugin-example",
        "license": "MIT",
        "authors": [
            {
                "name": "...",
                "email": "...",
                "homepage": "...",
                "role": "Developer"
            }
        ],
        "support": {
            "issues": "https://github.com/getgrav/grav-plugin-example/issues",
            "docs": "https://github.com/getgrav/grav-plugin-example/blob/master/README.md"
        },
        "require": {
            "php": ">=7.1.3"
        },
        "autoload": {
            "psr-4": {
                "Grav\\Plugin\\Example\\": "classes/",
                "Grav\\Plugin\\Console\\": "cli/"
            },
            "classmap":  [
                "example.php"
            ]
        },
        "config": {
            "platform": {
                "php": "7.1.3"
            }
        }
    }
    ```

  See [Composer schema](https://getcomposer.org/doc/04-schema.md)

* Please use autoloader instead of `require` in the code:

    example.php
    ```php
      /**
       * @return array
       */
      public static function getSubscribedEvents(): array
      {
          return [
              'onPluginsInitialized' => [
                  // This is only required in Grav 1.6. Grav 1.7 automatically calls $plugin->autolaod() method.
                  ['autoload', 100000],
              ]
          ];
      }

      /**
       * Composer autoload.
       *
       * @return \Composer\Autoload\ClassLoader
       */
      public function autoload(): \Composer\Autoload\ClassLoader
      {
          return require __DIR__ . '/vendor/autoload.php';
      }
    ```

* Plugins & Themes: Call `$plugin->autoload()` and `$theme->autoload()` automatically when object gets initialized
* Make sure your code does not use `require` or `include` for loading classes

### Plugin/Theme Blueprints (`blueprints.yaml`)

* Please add:
    ```yaml
    slug: folder-name
    type: plugin|theme
    ```
* Make sure you update your dependencies. I recommend setting Grav to either 1.6 or 1.7 and update your code/vendor to PHP 7.1
    ```yaml
    dependencies:
        - { name: grav, version: '>=1.6.0' }
    ```

* Added `themes` to cached blueprints and configuration
* **Grav 1.7.8** adds support for defining any **blueprint** in your theme. Move all files and folders in `blueprints/` into `blueprints/pages/` to keep your theme forward compatible. Also remember to update minimum Grav dependency to `>=1.7.8`.

### Sessions

* Session ID now changes on login to prevent session fixation issues
* Added `Session::regenerateId()` method to properly prevent session fixation issues

### ACL

* `user.authorize()` now requires user to be authorized (passed 2FA check), unless the rule contains `login` in its name.
* Added support for more advanced ACL (CRUD)

* **BC BREAK** `user.authorize()` and Flex `object.isAuthorized()` now have two deny states: `false` and `null`.

    Make sure you do not have strict checks against false: `$user->authorize($action) === false` (PHP)  or `user.authorize(action) is same as(false)` (Twig).

    For the negative checks you should be using `!user->authorize($action)` (PHP) or `not user.authorize(action)` (Twig).

    The change has been done to allow strong deny rules by chaining the actions if previous ones do not match: `user.authorize(action1) ?? user.authorize(action2) ?? user.authorize(action3)`.

    Note that Twig function `authorize()` will still **keeps** the old behavior!

### Pages

* Added default templates for `external.html.twig`, `default.html.twig`, and `modular.html.twig`
* Admin uses `Flex Pages` by default (can be disabled from `Flex-Objects` plugin)

  ![Disable Flex Pages](disable-flex-pages.png?classes=shadow)

* Added page specific admin permissions support for `Flex Pages`
* Added root page support for `Flex Pages`
* Fixed wrong `Pages::dispatch()` calls (with redirect) when we really meant to call `Pages::find()`
* Added `Pages::getCollection()` method
* Moved `collection()` and `evaluate()` logic from `Page` class into `Pages` class

* **DEPRECATED** `$page->modular()` in favor of `$page->isModule()`
* **DEPRECATED** `PageCollectionInterface::nonModular()` in favor of `PageCollectionInterface::pages()`
* **DEPRECATED** `PageCollectionInterface::modular()` in favor of `PageCollectionInterface::modules()`

* **BC BREAK** Fixed `Page::modular()` and `Page::modularTwig()` returning `null` for folders and other non-initialized pages. Should not affect your code unless you were checking against `false` or `null`.
* **BC BREAK** Always use `\Grav\Common\Page\Interfaces\PageInterface` instead of `\Grav\Common\Page\Page` in method signatures
* Admin now uses `Flex Pages` by default, collection will behave in slightly different way
* **BC BREAK** `$page->topParent()` may return page itself instead of null
* **BC BREAK** `$page->header()` may now `\Grav\Common\Page\Header` return object instead of `stdClass`, you need to handle both (Flex vs regular)

### Media

* Added `MediaTrait::freeMedia()` method to free media (and memory)
* Added support for uploading and deleting images directly in `Media` by using PSR-7
* Adjusted asset types to enable extension of assets in class
* **BC BREAK** Media no longer extends `Getters`, accessing `$media->$filename` no longer works, use `$media[$filename]` instead!

### Markdown

* **BC BREAK** Upgraded Parsedown to 1.7 for Parsedown-Extra 0.8. Plugins that extend Parsedown may need a fix to render as HTML
* Added new `Excerpts::processLinkHtml()` method

### Users

* Added experimental support for `Flex Users` in the frontend (not recommended to use yet)
* Admin uses `Flex Users` by default (can be disabled from `Flex-Objects` plugin)
* Improved `Flex Users`: obey blueprints and allow Flex to be used in admin only
* Improved `Flex Users`: user and group ACL now supports deny permissions
* Changed `UserInterface::authorize()` to return `null` having the same meaning as `false` if access is denied because of no matching rule
* **DEPRECATED** `\Grav\Common\User\Group` in favor of `$grav['user_groups']`, which contains Flex UserGroup collection
* **BC BREAK** Always use `\Grav\Common\User\Interfaces\UserInterface` instead of `\Grav\Common\User\User` in method signatures

### Flex

* Do not use `Framework` Flex classes directly, it's better to use or extend classes under `Grav\Common\Flex\Types\Generic` namespace
* Added `$grav['flex']` to access all registered Flex Directories
  * Added `FlexRegisterEvent` which triggers when `$grav['flex']` is being accessed the first time
* Added `hasFlexFeature()` method to test if `FlexObject` or `FlexCollection` implements a given feature
* Added `getFlexFeatures()` method to return all features that `FlexObject` or `FlexCollection` implements
* Added `FlexObject::refresh()` method to make sure object is up to date
* Added `FlexStorage::getMetaData()` to get updated object meta information for listed keys
* Added `FlexDirectoryInterface` interface
* Added search option `same_as` to Flex Objects
* `Flex Pages` method `$page->header()` returns `\Grav\Common\Page\Header` object, old `Page` class still returns `stdClass`
* Renamed `PageCollectionInterface::nonModular()` into `PageCollectionInterface::pages()` and deprecated the old method
* Renamed `PageCollectionInterface::modular()` into `PageCollectionInterface::modules()` and deprecated the old method
* `FlexDirectory::getObject()` can now be called without any parameters to create a new object
* Implemented customizable configuration per flex directory type
* **DEPRECATED** `FlexDirectory::update()` and `FlexDirectory::remove()`
* **BC BREAK** Moved all Flex type classes under `Grav\Common\Flex`
* **BC BREAK** `FlexStorageInterface::getStoragePath()` and `getMediaPath()` can now return null
* **BC BREAK** Flex objects no longer return temporary key if they do not have one; empty key is returned instead
* **BC BREAK** Added reload argument to `FlexStorageInterface::getMetaData()`
* You can add `edit_list.html.twig` file to a form field in order to customize look in the listing view

### Multi-language

* Improved language support for `Route` class
* Translations: rename MODULAR to MODULE everywhere
* Added `Language::getPageExtensions()` to get full list of supported page language extensions
* **BC BREAK** Fixed `Language::getFallbackPageExtensions()` to fall back only to default language instead of going through all languages

### Multi-site

* Added support for having all sites / environments under `user/env` folder

### Serialization

* All classes now use PHP 7.4 serialization. The old `Serializable` methods are now final and cannot be overridden.

### Blueprints

* Added `flatten_array` filter to form field validation
* Added support for `security@: or: [admin.super, admin.pages]` in blueprints (nested AND/OR mode support)
* Blueprint validation: Added `validate: value_type: bool|int|float|string|trim` to `array` to filter all the values inside the array
* If your plugins has blueprints folder, initializing it in the event will be too late. Do this instead:

    ```php
    class MyPlugin extends Plugin
    {
        /** @var array */
        public $features = [
            'blueprints' => 0, // Use priority 0
        ];
    }
    ```

### Events

* Use `Symfony EventDispatcher` directly instead of `rockettheme/toolbox` wrapper.
* Added `$grav->dispatchEvent()` method for PSR-14 events
* Added `PluginsLoadedEvent` which triggers after plugins have been loaded but not yet initialized
* Added `SessionStartEvent` which triggers when session is started
* Added `FlexRegisterEvent` which triggers when `$grav['flex']` is being accessed the first time
* Added `PermissionsRegisterEvent` which triggers when `$grav['permissions']` is being accessed the first time
* Added `onAfterCacheClear` event
* Check `onAdminTwigTemplatePaths` event, it should NOT be:

    ```php
    public function onAdminTwigTemplatePaths($event)
    {
        // This code breaks all the other plugins in admin, including Flex Objects
        $event['paths'] = [__DIR__ . '/admin/themes/grav/templates'];
    }
    ```
    but:
    ```php
    public function onAdminTwigTemplatePaths($event)
    {
        // Add plugin template path for admin.
        $paths = $event['paths'];
        $paths[] = __DIR__ . '/admin/themes/grav/templates';
        $event['paths'] = $paths;
    }
    ```

### JavaScript

* Updated bundled JQuery to latest version `3.5.1`

### Misc

* Added `Utils::functionExists()`: PHP 8 compatible `function_exists()`
* Added `Utils::isAssoc()` and `Utils::isNegative()` helper methods
* Added `Utils::simpleTemplate()` method for very simple variable templating
* Added `Utils::fullPath()` to get the full path to a file be it stream, relative, etc.
* Support customizable null character replacement in `CSVFormatter::decode()`
* Added new `Security::sanitizeSVG()` function
* Added `$grav->close()` method to properly terminate the request with a response
* Added `Folder::countChildren()` method to determine if a folder has child folders
* Support symlinks when saving `File`
* Added `Route::getBase()` method
* **BC BREAK** Make `Route` objects immutable. This means that you need to do: `{% set route = route.withExtension('.html') %}` (for all `withX` methods) to keep the updated version.
* Better `Content-Encoding` handling in Apache when content compression is disabled
* Added a `Uri::getAllHeaders()` compatibility function
* Allow `JsonFormatter` options to be passed as a string

### CLI

* **BC BREAK** Many plugins initialize Grav in a wrong way, it is not safe to initialize plugins and theme by yourself
    * Following calls require Grav 1.6.21 or later, so it is recommended to set Grav dependency to that version
    * Inside `serve()` method:
    * Call `$this->setLanguage($langCode);` before doing anything else if you want to set the language (or use default)
    * Call one of following:
        * `$this->initializeGrav();` Already called if you're in `bin/plugin`, otherwise you may need to call this one
        * `$this->initializePlugins();` This initializes grav, plugins (up to `onPluginsInitialized`)
        * `$this->initializeThemes();` This initializes grav, plugins and theme
        * `$this->initializePages();` This initializes grav, plugins, theme and everything needed by pages
* It is a good idea to prefix your CLI command classes with your plugin name, otherwise there may be naming conflicts (we already have some!)

### Used Libraries

* Updated Symfony Components to 4.4, please update any deprecated features in your code
* **BC BREAK** Please run `bin/grav yamllinter` to find any YAML parsing errors in your site (including your plugins and themes).

## PLUGINS

### Admin

* Added `Content Editor` option to user account blueprint

* **BC BREAK** Admin will not initialize frontend pages anymore, this has been done to greatly speed up Admin plugin.

    Please call `$grav['admin']->enablePages()` or `{% do admin.enablePages() %}` if you need to access frontend pages. This call can be safely made multiple times.

    If you're using `Flex Pages`, please use Flex Directory instead, it will make your code so much faster.

* Admin now uses Flex for editing `Accounts` and `Pages`. If your plugin hooks into either of those, please make sure they still work.

* Admin cache is enabled by default, make sure your plugin clears cache when needed. Please avoid clearing all cache!

### Shortcode Core

* **DEPRECATED** Every shortcode needs to have `init()` method, classes without it will stop working in the future.

## Troubleshooting Issues

#### `ERROR: flex-objects.html.twig template not found for page`

If you get this error after upgrading to Grav 1.7, it might be related to a plugin called `content-edit`.  If you disable this plugin, the error should resolve itself. [Grav Issue #3169](https://github.com/getgrav/grav/issues/3169)

#### Untranslated Admin

If your admin plugin looks like this:

![Untranslated Admin](untranslated.png?classes=shadow)

The fix is very easy, and can be done even when not fully translated. Simply navigate to `PLUGIN_ADMIN.CONFIGURATION` and then in `PLUGIN_ADMIN.LANGUAGES`, set `PLUGIN_ADMIN.LANGUAGE_TRANLATIONS` to `PLUGIN_ADMIN.YES`:

![Fix translations](fix-translations.png?classes=shadow)

#### Page blueprints stop working in Admin

If you cannot see your custom fields when editing the page, your theme is using two conflicting locations for page blueprints.

If the theme was not created by you, please report a bug to the theme author.

To fix the bug, you need to move all files and folders in your theme from `blueprints/` to `blueprints/pages/` (requires **Grav 1.7.8+**). Alternatively if the theme must support older versions of Grav, do the opposite.

#### Error: Loop detected while extending blueprint file

The easiest fix for loop error is to move the files into their proper location, please see the above issue.

Alternatively you can fix the issue by changing the broken page blueprint from:

```yaml
extends@:
    type: [NAME]
    context: 'blueprints://pages'
```

where `[NAME]` is the filename (without the file extension) of the blueprint itself, to:

```yaml
extends@: self@
```

#### Missing CSS Styling in Admin

It has been reported that after upgrading to latest Grav 1.7 and Admin 1.10, some admin pages appear broken and not fully styled.  THis could be related to the `imagecreate` plugin.  Disabling this plugin is not enough, you must **completely remove** the plugin, and then the error should resolve  itself.  [Admin Issue #2035](https://github.com/getgrav/grav-plugin-admin/issues/2035)

## Reverting back to latest Grav 1.6

While we recommend resolving any issues you may have to ensure that Grav 1.7 and future updates will be an easy upgrade, there are going to be scenarios where you have custom plugin functionality, or don't have the developer resources handy, and just need to get back to Grav 1.6 quickly.

If you have CLI access to the site, this can be done by running these commands from the **root of your Grav 1.7** site:

```bash
wget -q https://getgrav.org/download/core/grav-update/1.6.31 -O tmp/grav-update-v1.6.31.zip
wget -q https://getgrav.org/download/plugins/admin/1.9.19 -O tmp/grav-plugin-admin-v1.9.19.zip
unzip tmp/grav-update-v1.6.31.zip -d tmp
unzip tmp/grav-plugin-admin-v1.9.19.zip -d tmp
cp -rf tmp/getgrav-grav-plugin-admin-5d86394/* user/plugins/admin/
cp -rf tmp/grav-update/* ./
```

Basically it does a **direct-install** of the latest version of Grav 1.6 and Admin 1.9 on top of your current installation.  It doesn't touch the `user/` folder so your content and plugins are not impacted.

For those who do not have CLI access, download [grav-update-v1.6.31.zip](https://github.com/getgrav/grav/releases/download/1.6.31/grav-update-v1.6.31.zip) and [grav-plugin-admin-1.9.19.zip](https://github.com/getgrav/grav-plugin-admin/archive/1.9.19.zip) files using the links given here. Unzip the files into your filesystem. Then use your favorite FTP/SFTP client to copy all the Grav files to your `WEBROOT` and Admin files into `WEBROOT/user/plugins/admin`.

---

## Grav Core

> Path: grav-learn/pages/08.advanced/09.grav-development/docs.md


If you want to develop with Grav, you will benefit from a more sophisticated setup than the one required for a regular Grav user. This includes just about any type of development, such as: **Grav Core**, **Grav Plugins**, **Grav Skeletons**, or even **Grav Themes**.

First, let us break down the various types of development:

## Grav Core

When we talk about the **Grav Core**, we are effectively talking about things in the `system` folder.  This folder controls everything about Grav and is really the very essence of the [Grav workflow and lifecycle](../grav-lifecycle).

Grav is intentionally focused on working with pages in an efficient manner.  Manipulation of pages and extensive functionality are often best served by creating a plugin.  We strongly encourage our community to contribute bug fixes, and even propose development of appropriate functionality within the core of Grav.

## Running Tests

First, install the development dependencies by running composer install from the Grav root.

[prism classes="language-bash command-line"]
composer install
[/prism]

Then you can run the tests:

[prism classes="language-bash command-line"]
composer test
[/prism]

This will run the full suite of existing tests which should always be executed successfully on any site.

You can also run a single unit test file, e.g.

[prism classes="language-bash command-line"]
composer test tests/unit/Grav/Common/Markdown/ParsedownTest::testAttributeLinks
[/prism]

An alternative method to calling these tests is:

[prism classes="language-bash command-line"]
./vendor/bin/codecept run
./vendor/bin/codecept run tests/unit/Grav/Common/Markdown/ParsedownTest::testAttributeLinks
[/prism]


## Grav Plugins

Most development effort will probably take the form of a **Grav Plugin**.  Because Grav has plenty of [Event Hooks](../../plugins/event-hooks), it's very easy to provide enhanced and specific functionality via the creation of a plugin.  We have already developed many plugins that work in a variety of ways using many different events to show off the power of this functionality.

There are many benefits of providing functionality in plugins, but a couple of the key benefits are:

1. The Grav Core Remains Lean - You only need to add the plugins you need for a particular site. For example, a blog may need many more plugins than a simple landing page.
2. Third-Party Development of New Functionality - You don't have to wait until Grav gets a bit of functionality you want. You can simply create a plugin to extend Grav to do what you want it to do.

#### Plugin Requirements

A proper Grav plugin requires certain files in order to function properly, be listed in the Grav repository, and be visible in the Grav admin plugin.  Please ensure your plugin contains all these files:

* **yourplugin.php** - plugin PHP file that should be named the same as the folder
* **yourplugin.yaml** - plugin configuration file that contains any options and stream inheritance information
* **blueprints.yaml** - plugin definition file and form definition file
* **CHANGELOG.md** - a changelog file that should be in the proper Grav format for consistent rendering
* **README.md** - required file to explain and preview the plugin
* **LICENSE** - license file, probably MIT if in line with Grav core
* **languages.yaml** (optional) - a language definition file

## Grav Skeletons

A **Grav Skeleton** is effectively an **all-in-one sample site**.  They include the **Grav Core**, required **plugins**, as well as appropriate **pages** for content and a **theme** for pulling it all together.

Grav was designed to make the process of creating a site as easy as possible. For that reason, everything you need for a site can be contained in the `user` folder.  Each of the skeletons we currently have available are simply a `user` folder on GitHub that we package up with various dependencies (required plugins, and theme) into a package that can be simply unzipped to provide a working example.

These skeletons are a base on which you can grow your site, quickly and efficiently. You aren't locked into a specific set of features. It is every bit as flexible as any other Grav install.

#### Skeleton Requirements

A proper Grav skeleton requires certain files in order to function properly, be listed in the Grav repository, and be visible in the Grav admin plugin.  Please ensure your skeleton contains all these files:

* **.dependencies** - A file to define theme and plugin dependencies for this skeleton
* **blueprints.yaml** - skeleton definition file and form definition file
* **CHANGELOG.md** - a changelog file that should be in the proper Grav format for consistent rendering
* **README.md** - required file to explain and preview the plugin
* **LICENSE** - license file, probably MIT if in line with Grav core
* **screenshot.jpg** - a 1:1 aspect ratio preview of the theme.  Should be at least 800px x 800px

## Grav Themes

Because of the tight coupling with Grav pages and themes, a **Grav Theme** is an integral and very important part of a Grav site.  By this we mean that each Grav page references a template in the theme, so your theme needs to provide the appropriate **Twig templates** that your pages are using.

The Twig templating engine is a very powerful system, and because there really are no restrictions by Grav itself, you are free to create any kind of design you wish.  This is one of the great things that sets Grav apart from a traditional CMS that has a loose coupling between content and design.

#### Theme Requirements

A proper Grav theme requires certain files in order to function properly, be listed in the Grav repository, and be visible in the Grav admin plugin.  Please ensure your theme contains all these files:

* **yourtheme.php** - theme PHP file that should be named the same as the folder
* **yourtheme.yaml** - theme configuration file that contains any options and stream inheritance information
* **blueprints.yaml** - theme definition file and form definition file
* **CHANGELOG.md** - a changelog file that should be in the proper Grav format for consistent rendering
* **README.md** - required file to explain and preview the theme
* **LICENSE** - license file, probably MIT if in line with Grav core
* **screenshot.jpg** - a 1:1 aspect ratio preview of the theme.  Should be at least 800px x 800px
* **thumbnail.jpg** - a smaller thumbnail image used by the admin plug. 1:1 aspect ratio and should be at 300px x 300px
* **languages.yaml** (optional) - a language definition file

## Demo Content

You are able to provide demo content as part of a plugin or theme package. This means that anything found in a folder called `_demo/` will be copied over to the `user/` folder as part of the installation procedure.  This means you can provide **pages**, or **configuration** or anything else that sits in the `user/` folder.  The user is prompted to do this, and it's purely optional.

_Please note that demo content is not copied when your plugin or theme is installed via the `Admin` plugin._

## Theme/Plugin Release Process

When you have created your new theme or plugin and would like to see it added to the [Grav Repository](https://getgrav.org/downloads) there are a few standard things that you need to ensure:

1. It is open source with a `LICENSE` file that provides an [MIT](http://en.wikipedia.org/wiki/MIT_License) compatible license [Example Here](https://github.com/getgrav/grav-theme-antimatter/blob/develop/LICENSE)
2. Contains a `README.md` file with a summary of functionality and instructions on how to install and configure it. [Example Here](https://github.com/getgrav/grav-theme-antimatter/blob/develop/README.md)
3. Contains a `blueprints.yaml` file with [all required fields](../blueprints). [Example Here](https://github.com/getgrav/grav-theme-antimatter/blob/develop/blueprints.yaml)
4. Provide a `CHANGELOG.md` in the [correct format](#changelog-format) an [Example Here](https://github.com/getgrav/grav-theme-antimatter/blob/develop/CHANGELOG.md)
5. Provides appropriate attribution if you use any other libraries, scripts, code.
6. [Create a release](https://help.github.com/articles/creating-releases) for your finished plugin/theme. The Grav repository system requires a release and will not find your plugin/theme unless there is a release that contains all of the above.
7. [Add an issue to the Grav issues tracker](https://github.com/getgrav/grav/issues/new?title=[add-resource]%20New%20Plugin/Theme&body=I%20would%20like%20to%20add%20my%20new%20plugin/theme%20to%20the%20Grav%20Repository.%0AHere%20are%20the%20project%20details:%20**user/repository**) with details about your plugin, and we will give it a quick test to ensure it functions, and then add it. Note that you don't have to do this if you're releasing a new version of plugin or theme that's already in the repository. It will be picked up automatically.

! Ensure your **naming for each tag is consistent**. GPM uses this information to determine if your plugin/theme is newer than the last.  We recommend using [Semantic Version Numbers](http://semver.org/) for tags.  E.g. `1.2.4`. Consistency for all tags is paramount!

## ChangeLog Format

The GetGrav.org site uses a custom ChangeLog format that is written in standard markdown but can be manipulated with some simple CSS and [displayed in an attractive format](https://getgrav.org/downloads#changelog).  In order to ensure your ChangeLogs can be parsed and formatted properly, please use this syntax:

[prism classes="language-markdown line-numbers"]